<style type="text/css">

  #suction_piping_table input[type="text"] {
    width: 100px;
  }

  #hydraulic_discharges input[type="text"] {
    width: 50px;
  }

  .discharge_circuit_piping_table input[type="text"] {
    width: 100px;
  }

  .discharge_tables input[type="text"] {
    width: 50px;
  }
</style>
<%= form_for hydraulic_turbine, :url => hydraulic_turbine.new_record? ? admin_hydraulic_turbines_path : admin_hydraulic_turbine_path(hydraulic_turbine), :html => {:class => "form_hydraulic_turbine", :style => 'width:auto;'} do |f| %>
  <%= f.error_messages %>
  <% if hydraulic_turbine.new_record? %>
    <%= f.hidden_field :company_id %>
    <%= f.hidden_field :client_id, :value => @user_project_settings.client_id %>
    <%= f.hidden_field :project_id, :value => @user_project_settings.project_id %>
    <%= f.hidden_field :process_unit_id, :value => @user_project_settings.process_unit_id %>
    <%= f.hidden_field :driver_type, :value => "hydraulic_turbine" %>
  <% end %>

  <div class="form-element-last">		
		<span style="float:left;margin-right:40px;">
			<%= f.label :client_id %><br>
      <%= f.label :client_id, (hydraulic_turbine.client.name rescue @user_project_settings.client.name), :style => "font-weight:bold" %>
		</span>
		<span style="float:left;margin-right:40px;">
			<%= f.label :project_id %><br>
      <%= f.label :project_id, (hydraulic_turbine.project.project_num rescue @user_project_settings.project.project_num), :style => "font-weight:bold" %>
		</span>
		<span style="float:left;margin-right:40px;">
			<%= f.label :process_unit_id %><br>
      <%= f.label :process_unit_id, (hydraulic_turbine.process_unit.name rescue @user_project_settings.process_unit.name), :style => "font-weight:bold" %>
		</span>		
		<span style="float:left;margin-right:40px;">
			<%= f.label :hydraulic_turbine_tag %><br>
      <%= f.text_field :hydraulic_turbine_tag %>
		</span>
    <% unless hydraulic_turbine.new_record? %>
      <span style="float:left;margin-right:40px;">
        <%= label_tag :status %><br>
        <strong><%= sizing_status(hydraulic_turbine) %></strong>
      </span>
      <span style="float:left;margin-right:40px;">
        <br>
        <%= sizing_status_request_button(hydraulic_turbine) %>
      </span>
    <% end %>
    <div class="clear"></div>
  </div>
  <div class="hidden">
    <%= hidden_field_tag :tab %>
    <%= hidden_field_tag :calculate_btn %>
  </div>
  <div class="form-buttons">
    <%= f.submit hydraulic_turbine.new_record? ? 'Create' : 'Update' %>
  </div>
  <!-- tabs -->
  <div>
  <ul class="simple-tabs">
    <li><a href="#tab1" tab="tab1">Suction</a></li>
    <li><a href="#tab2" tab="tab2">Discharge</a></li>
    <li><a href="#tab3" tab="tab3">Hydraulic Turbine Design</a></li>
    <li><a href="#tab4" tab="tab4">HPRT Curve</a></li>
    <li><a href="#tab5" tab="tab5">CV Summary</a></li>
    <li><a href="#tab6" tab="tab6">FE Summary</a></li>
    <li><a href="#tab7" tab="tab7">Review</a></li>
  </ul>
  <div class="tab_container">
  <div id="tab1" class="tab_content">
  <!-- Suction -->
  <table width="100%">
    <tr>
      <td>
        <label class="sub_title">Process Basis</label>&nbsp;&nbsp;&nbsp;
        <%= f.collection_select :su_process_basis_id, @company.heat_and_material_balances, :id, :case, :prompt => true %>
      </td>
    </tr>
    <tr>
      <td>
        Suction Condition Basis&nbsp;&nbsp;&nbsp;
        <%= f.select :su_suction_condition_basis, options_for_select(@suction_condition_basis.collect { |h| [raw(h[:name]), h[:value]] }, hydraulic_turbine.su_suction_condition_basis) %>
      </td>
    </tr>
  </table>

  <table id="upstream_conditions_maximum" class="upstream_coditions_table">
    <tr>
      <td colspan="4"><label class="sub_title">Maximum Upstream Conditions</label></td>
    </tr>
    <tr>
      <td width="25%">Stream No</td>
      <td width="25%"><%= f.collection_select :su_max_stream_no, @streams, :stream_no, :display_stream_no, :prompt => true %></td>
      <td width="25%">Mass Flow Rate</td>
      <td width="25%"><%= f.text_field :su_max_mass_flow_rate, :class => "small-text-100 mass_flow_rate_general" %>&nbsp;<label class="mass_flow_rate_general_unit"></label>
      </td>
    </tr>
    <tr>
      <td>Pressure</td>
      <td><%= f.text_field :su_max_pressure, :class => "small-text-100 pressure_general" %>&nbsp;<label class="pressure_general_unit"></label>
      </td>
      <td>Density</td>
      <td><%= f.text_field :su_max_density, :class => "small-text-100 density_general" %>&nbsp;<label class="density_general_unit"></label>
      </td>
    </tr>
    <tr>
      <td>Temperature</td>
      <td><%= f.text_field :su_max_temperature, :class => "small-text-100 temperature_general" %>&nbsp;<label class="temperature_general_unit"></label>
      </td>
      <td>Viscosity</td>
      <td><%= f.text_field :su_max_viscosity, :class => "small-text-100 viscosity_dynamic" %>&nbsp;<label class="viscosity_dynamic_unit"></label>
      </td>
    </tr>
    <tr>
      <td>Mass Vapor Fraction</td>
      <td><%= f.text_field :su_max_mass_vapor_fraction, :class => "small-text-100 mass_vapor_fraction_dimensionless" %>&nbsp;</td>
      <td>Vapor Pressure</td>
      <td><%= f.text_field :su_max_vapor_pressure, :class => "small-text-100 pressure_general" %>&nbsp;<label class="pressure_general_unit"></label>
      </td>
    </tr>
  </table>

  <table id="upstream_conditions_normal" class="upstream_coditions_table" style="display:none;">
    <tr>
      <td colspan="4"><label class="sub_title">Normal Upstream Conditions</label></td>
    </tr>
    <tr>
      <td width="25%">Stream No</td>
      <td width="25%"><%= f.collection_select :su_nor_stream_no, @streams, :stream_no, :display_stream_no, :prompt => true %></td>
      <td width="25%">Mass Flow Rate</td>
      <td width="25%"><%= f.text_field :su_nor_mass_flow_rate, :class => "small-text-100" %>&nbsp;<%= @project.unit("Mass Flow Rate", "General") %></td>
    </tr>
    <tr>
      <td>Pressure</td>
      <td><%= f.text_field :su_nor_pressure, :class => "small-text-100 pressure_general" %>&nbsp;<label class="pressure_general_unit"></label>
      </td>
      <td>Density</td>
      <td><%= f.text_field :su_nor_density, :class => "small-text-100 density_general" %>&nbsp;<label class="density_general_unit"></label>
      </td>
    </tr>
    <tr>
      <td>Temperature</td>
      <td><%= f.text_field :su_nor_temperature, :class => "small-text-100 temperature_general" %>&nbsp;<label class="temperature_general_unit"></label>
      </td>
      <td>Viscosity</td>
      <td><%= f.text_field :su_nor_viscosity, :class => "small-text-100 viscosity_dynamic" %>&nbsp;<label class="viscosity_dynamic_unit"></label>
      </td>
    </tr>
    <tr>
      <td>Mass Vapor Fraction</td>
      <td><%= f.text_field :su_nor_mass_vapor_fraction, :class => "small-text-100 mass_vapor_fraction_dimensionless" %>&nbsp;</td>
      <td>Vapor Pressure</td>
      <td><%= f.text_field :su_nor_vapor_pressure, :class => "small-text-100 pressure_general" %>&nbsp;<label class="pressure_general_unit"></label>
      </td>
    </tr>
  </table>

  <table id="upstream_conditions_minimum" class="upstream_coditions_table" style="display:none;">
    <tr>
      <td colspan="4"><label class="sub_title">Upstream Conditions Minimum</label></td>
    </tr>
    <tr>
      <td width="25%">Stream No</td>
      <td width="25%"><%= f.collection_select :su_min_stream_no, @streams, :stream_no, :display_stream_no, :prompt => true %></td>
      <td width="25%">Mass Flow Rate</td>
      <td width="25%"><%= f.text_field :su_min_mass_flow_rate, :class => "small-text-100" %>&nbsp;<%= @project.unit("Mass Flow Rate", "General") %></td>
    </tr>
    <tr>
      <td>Pressure</td>
      <td><%= f.text_field :su_min_pressure, :class => "small-text-100 pressure_general" %>&nbsp;<label class="pressure_general_unit"></label>
      </td>
      <td>Density</td>
      <td><%= f.text_field :su_min_density, :class => "small-text-100 density_general" %>&nbsp;<label class="density_general_unit"></label>
      </td>
    </tr>
    <tr>
      <td>Temperature</td>
      <td><%= f.text_field :su_min_temperature, :class => "small-text-100 temperature_general" %>&nbsp;<label class="temperature_general_unit"></label>
      </td>
      <td>Viscosity</td>
      <td><%= f.text_field :su_min_viscosity, :class => "small-text-100 viscosity_dynamic" %>&nbsp;<label class="viscosity_dynamic_unit"></label>
      </td>
    </tr>
    <tr>
      <td>Mass Vapor Fraction</td>
      <td><%= f.text_field :su_min_mass_vapor_fraction, :class => "small-text-100 mass_vapor_fraction_dimensionless" %>&nbsp;</td>
      <td>Vapor Pressure</td>
      <td><%= f.text_field :su_min_vapor_pressure, :class => "small-text-100 pressure_general" %>&nbsp;<label class="pressure_general_unit"></label>
      </td>
    </tr>
  </table>

  <table>
    <tr>
      <td><label class="sub_title">Suction Pipe Configuration</label></td>
    </tr>
    <tr>
      <td>
        <input type="button" value="Enter Circuit Piping" id="enter_circuit_piping"/>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        <input id="suction_calculate" type="button" value="Calculate"/>
      </td>
    </tr>
  </table>

  <table id="suction_loss_maximum" class="suction_loss_table">
    <tr>
      <td colspan="4"><label class="sub_title">Maximum Suction Loss</label></td>
    </tr>
    <tr>
      <td>Fitting &Delta;P</td>
      <td><%= f.text_field :su_fitting_dp_max, :class => "small-text-100 pressure_differential" %>&nbsp;<label class="pressure_differential_unit"></label>
      </td>
      <td>Total suction &Delta;P</td>
      <td><%= f.text_field :su_total_suction_dp_max, :class => "small-text-100 pressure_general" %>&nbsp;<label class="pressure_general_unit"></label>
      </td>
    </tr>
    <tr>
      <td>Equipment &Delta;P</td>
      <td><%= f.text_field :su_equipment_dp_max, :class => "small-text-100 pressure_differential" %>&nbsp;<label class="pressure_differential_unit"></label>
      </td>
      <td>Pressure @ Suction Nozzle</td>
      <td><%= f.text_field :su_pressure_at_suction_nozzle_max, :class => "small-text-100 pressure_general" %>&nbsp;<label class="pressure_general_unit"></label>
      </td>
    </tr>
    <tr>
      <td>Control Valve &Delta;P</td>
      <td><%= f.text_field :su_control_valve_dp_max, :class => "small-text-100 pressure_differential" %>&nbsp;<label class="pressure_differential_unit"></label>
      </td>
      <td>Max Upstream Pressure</td>
      <td><%= f.text_field :su_max_upstream_pressure_max, :class => "small-text-100 pressure_general" %>&nbsp;<label class="pressure_general_unit"></label>
      </td>
    </tr>
    <tr>
      <td>Orifice &Delta;P</td>
      <td><%= f.text_field :su_orifice_dp_max, :class => "small-text-100 pressure_differential" %>&nbsp;<label class="pressure_differential_unit"></label>
      </td>
      <td>Max Pressure @ Suction Nozzle</td>
      <td>
        <%= f.text_field :su_max_pressure_at_suction_nozzle_max, :class => "small-text-100 pressure_general" %>&nbsp;<label class="pressure_general_unit"></label>
        <input id="suction_loss_calculation" class="suction_loss_calculation" type="button" value="Calculate" style="float:right;"/>
      </td>
    </tr>
  </table>

  <table id="suction_loss_normal" class="suction_loss_table" style="display:none;">
    <tr>
      <td colspan="4"><label class="sub_title">Normal Suction Loss</label></td>
    </tr>
    <tr>
      <td>Fitting &Delta;P</td>
      <td><%= f.text_field :su_fitting_dp_nor, :class => "small-text-100 pressure_differential" %>&nbsp;<label class="pressure_differential_unit"></label>
      </td>
      <td>Total suction &Delta;P</td>
      <td><%= f.text_field :su_total_suction_dp_nor, :class => "small-text-100 pressure_general" %>&nbsp;<label class="pressure_general_unit"></label>
      </td>
    </tr>
    <tr>
      <td>Equipment &Delta;P</td>
      <td><%= f.text_field :su_equipment_dp_nor, :class => "small-text-100 pressure_differential" %>&nbsp;<label class="pressure_differential_unit"></label>
      </td>
      <td>Pressure @ Suction Nozzle</td>
      <td><%= f.text_field :su_pressure_at_suction_nozzle_nor, :class => "small-text-100 pressure_general" %>&nbsp;<label class="pressure_general_unit"></label>
      </td>
    </tr>
    <tr>
      <td>Control Valve &Delta;P</td>
      <td><%= f.text_field :su_control_valve_dp_nor, :class => "small-text-100 pressure_differential" %>&nbsp;<label class="pressure_differential_unit"></label>
      </td>
      <td>Max Upstream Pressure</td>
      <td><%= f.text_field :su_max_upstream_pressure_nor, :class => "small-text-100 pressure_general" %>&nbsp;<label class="pressure_general_unit"></label>
      </td>
    </tr>
    <tr>
      <td>Orifice &Delta;P</td>
      <td><%= f.text_field :su_orifice_dp_nor, :class => "small-text-100 pressure_differential" %>&nbsp;<label class="pressure_differential_unit"></label>
      </td>
      <td>Max Pressure @ Suction Nozzle</td>
      <td>
        <%= f.text_field :su_max_pressure_at_suction_nozzle_nor, :class => "small-text-100 pressure_general" %>&nbsp;<label class="pressure_general_unit"></label>
        <input class="suction_loss_calculation" type="button" value="Calculate" style="float:right;"/>
      </td>
    </tr>
  </table>

  <table id="suction_loss_minimum" class="suction_loss_table" style="display:none;">
    <tr>
      <td colspan="4"><label class="sub_title">Minimum Suction Loss</label></td>
    </tr>
    <tr>
      <td>Fitting &Delta;P</td>
      <td><%= f.text_field :su_fitting_dp_min, :class => "small-text-100 pressure_differential" %>&nbsp;<label class="pressure_differential_unit"></label>
      </td>
      <td>Total suction &Delta;P</td>
      <td><%= f.text_field :su_total_suction_dp_min, :class => "small-text-100 pressure_general" %>&nbsp;<label class="pressure_general_unit"></label>
      </td>
    </tr>
    <tr>
      <td>Equipment &Delta;P</td>
      <td><%= f.text_field :su_equipment_dp_min, :class => "small-text-100 pressure_differential" %>&nbsp;<label class="pressure_differential_unit"></label>
      </td>
      <td>Pressure @ Suction Nozzle</td>
      <td><%= f.text_field :su_pressure_at_suction_nozzle_min, :class => "small-text-100 pressure_general" %>&nbsp;<label class="pressure_general_unit"></label>
      </td>
    </tr>
    <tr>
      <td>Control Valve &Delta;P</td>
      <td><%= f.text_field :su_control_valve_dp_min, :class => "small-text-100 pressure_differential" %>&nbsp;<label class="pressure_differential_unit"></label>
      </td>
      <td>Max Upstream Pressure</td>
      <td><%= f.text_field :su_max_upstream_pressure_min, :class => "small-text-100 pressure_general" %>&nbsp;<label class="pressure_general_unit"></label>
      </td>
    </tr>
    <tr>
      <td>Orifice &Delta;P</td>
      <td><%= f.text_field :su_orifice_dp_min, :class => "small-text-100 pressure_differential" %>&nbsp;<label class="pressure_differential_unit"></label>
      </td>
      <td>Max Pressure @ Suction Nozzle</td>
      <td>
        <%= f.text_field :su_max_pressure_at_suction_nozzle_min, :class => "small-text-100 pressure_general" %>&nbsp;<label class="pressure_general_unit"></label>
        <input class="suction_loss_calculation" type="button" value="Calculate" style="float:right;"/>
      </td>
    </tr>
  </table>

  </div>
  <div id="tab2" class="tab_content">
  <!-- Discharge -->
  <div>
    Discharge Condition Basis&nbsp;&nbsp;&nbsp;
    <%= f.select :dc_discharge_condition_basis, options_for_select(@suction_condition_basis.collect { |h| [raw(h[:name]), h[:value]] }, hydraulic_turbine.dc_discharge_condition_basis) %>
  </div>

  <div id="discharge_maximum" class="discharge_tables_div">
    <b>Maximum</b>
    <table id="hydraulic_discharges_maximum_table" class="discharge_tables">
      <tr>
        <th rowspan="2">S.No</th>
        <th rowspan="2">Design Circuit</th>
        <th rowspan="2">Process Basis</th>
        <th rowspan="2">Destination Stream</th>
        <th rowspan="2">Circuit Piping</th>
        <th>Destination Pressure</th>
        <th>Fitting &Delta;P</th>
        <th>Equipment &Delta;P</th>
        <th>Control Valve &Delta;P</th>
        <th>Orifice &Delta;P</th>
        <th>Total System &Delta;P</th>
        <th>Pressure @ Discharge Nozzle</th>
        <th rowspan="2"></th>
      </tr>
      <tr>
        <th><label class="pressure_general_unit"></label></th>
        <th><label class="pressure_differential_unit"></label></th>
        <th><label class="pressure_differential_unit"></label></th>
        <th><label class="pressure_differential_unit"></label></th>
        <th><label class="pressure_differential_unit"></label></th>
        <th><label class="pressure_general_unit"></label></th>
        <th><label class="pressure_general_unit"></label></th>
      </tr>
      <% hydraulic_turbine.discharge_maximum.each_with_index do |dmax, i| %>
        <tr>
          <td>
            <b><%= i+1 %></b>
            <%= hidden_field_tag "hydraulic_turbine[discharge_maximum][#{i+1}][id]", dmax.id, :id => "dmax_discharges_id_#{i+1}" %>
            <%= hidden_field_tag "hydraulic_turbine[discharge_maximum][#{i+1}][path]", "#{i+1}", :id => "dmax_path_#{i+1}" %>
            <%= hidden_field_tag "hydraulic_turbine[discharge_maximum][#{i+1}][delete]", false, :id => "dmax_discharges_delete_#{i+1}" %>
            <%= hidden_field_tag "hydraulic_turbine[discharge_maximum][#{i+1}][discharge_condition_basis]", dmax.discharge_condition_basis %>
          </td>
          <td>
            <%= radio_button_tag "design_circuit", i+1, dmax.design_circuit, :id => "dmax_design_circuit_#{i+1}" %>
            <%= hidden_field_tag "hydraulic_turbine[discharge_maximum][#{i+1}][design_circuit]", dmax.design_circuit, :id => "dmax_discharge_design_circuit_#{i+1}" %>
          </td>
          <td><%= select_tag "hydraulic_turbine[discharge_maximum][#{i+1}][process_basis_id]", options_for_select(@company.heat_and_material_balances.collect { |p| [p[:case], p[:id]] }.insert(0, ''), dmax.process_basis_id), {:id => "dmax_discharge_process_basis_id_#{i+1}", :row_id => "#{i+1}", :class => "discharge_process_basis_id_#{i+1}"} %></td>
          <td><%= select_tag "hydraulic_turbine[discharge_maximum][#{i+1}][destination_stream_no]", options_for_select(Stream.get_stream_nos_by_process_basis(dmax.process_basis_id).collect { |p| [p.display_stream_no, p.stream_no] }.insert(0, ''), dmax.destination_stream_no), :id => "dmax_discharge_destination_stream_no_#{i+1}", :style => "width:100px;", :row_id => "#{i+1}" %></td>
          <td><input type="button" value="Circuit Piping" class="circuit_piping_btn" row_id="<%= i+1 %>"></td>
          <td><%= text_field_tag "hydraulic_turbine[discharge_maximum][#{i+1}][destination_pressure]", dmax.destination_pressure, :id => "dmax_discharge_destination_pressure_#{i+1}", :class => "pressure_general" %></td>
          <td><%= text_field_tag "hydraulic_turbine[discharge_maximum][#{i+1}][fitting_dp]", dmax.fitting_dp, :id => "dmax_discharge_fitting_dp_#{i+1}", :class => "pressure_differential" %></td>
          <td><%= text_field_tag "hydraulic_turbine[discharge_maximum][#{i+1}][equipment_dp]", dmax.equipment_dp, :id => "dmax_discharge_equipment_dp_#{i+1}", :class => "pressure_differential" %></td>
          <td><%= text_field_tag "hydraulic_turbine[discharge_maximum][#{i+1}][control_valve_dp]", dmax.control_valve_dp, :id => "dmax_discharge_control_valve_dp_#{i+1}", :class => "pressure_differential" %></td>
          <td><%= text_field_tag "hydraulic_turbine[discharge_maximum][#{i+1}][orifice_dp]", dmax.orifice_dp, :id => "dmax_discharge_orifice_dp_#{i+1}", :class => "pressure_differential" %></td>
          <td><%= text_field_tag "hydraulic_turbine[discharge_maximum][#{i+1}][total_system_dp]", dmax.total_system_dp, :id => "dmax_discharge_total_system_dp_#{i+1}", :class => "pressure_general" %></td>
          <td><%= text_field_tag "hydraulic_turbine[discharge_maximum][#{i+1}][pressure_at_discharge_nozzle_dp]", dmax.pressure_at_discharge_nozzle_dp, :id => "dmax_discharge_pressure_at_discharge_nozzle_dp_#{i+1}", :class => "pressure_general" %></td>
          <td><%= link_to "X", "#", :class => "discharge_table_close_tr", :row_id => i+1 %></td>
        </tr>
      <% end %>
      <% if hydraulic_turbine.discharge_maximum.empty? %>
        <tr>
          <td>
            <b>1</b>
            <%= hidden_field_tag "hydraulic_turbine[discharge_maximum][1][id]", "", :id => "dmax_discharges_id_1" %>
            <%= hidden_field_tag "hydraulic_turbine[discharge_maximum][1][path]", 1, :id => "dmax_path_1" %>
            <%= hidden_field_tag "hydraulic_turbine[discharge_maximum][1][discharge_condition_basis]", "maximum" %>
          </td>
          <td>
            <%= radio_button_tag "design_circuit", '1', true, :id => "dmax_design_circuit_1" %>
            <%= hidden_field_tag "hydraulic_turbine[discharge_maximum][1][design_circuit]", 1, :id => "dmax_discharge_design_circuit_1" %>
          </td>
          <td><%= select_tag "hydraulic_turbine[discharge_maximum][1][process_basis_id]", options_for_select(@company.heat_and_material_balances.collect { |p| [p[:case], p[:id]] }.insert(0, '')), {:id => "dmax_discharge_process_basis_id_1", :row_id => 1} %></td>
          <td><%= select_tag "hydraulic_turbine[discharge_maximum][1][destination_stream_no]", options_for_select([]), :id => "dmax_discharge_destination_stream_no_1", :style => "width:100px;", :row_id => 1 %></td>
          <td><input type="button" value="Circuit Piping" class="circuit_piping_btn" row_id="1"></td>
          <td><%= text_field_tag "hydraulic_turbine[discharge_maximum][1][destination_pressure]", "", :id => "dmax_discharge_destination_pressure_1", :class => "pressure_general" %></td>
          <td><%= text_field_tag "hydraulic_turbine[discharge_maximum][1][fitting_dp]", "", :id => "dmax_discharge_fitting_dp_1", :class => "pressure_differential" %></td>
          <td><%= text_field_tag "hydraulic_turbine[discharge_maximum][1][equipment_dp]", "", :id => "dmax_discharge_equipment_dp_1", :class => "pressure_differential" %></td>
          <td><%= text_field_tag "hydraulic_turbine[discharge_maximum][1][control_valve_dp]", "", :id => "dmax_discharge_control_valve_dp_1", :class => "pressure_differential" %></td>
          <td><%= text_field_tag "hydraulic_turbine[discharge_maximum][1][orifice_dp]", "", :id => "dmax_discharge_orifice_dp_1", :class => "pressure_differential" %></td>
          <td><%= text_field_tag "hydraulic_turbine[discharge_maximum][1][total_system_dp]", "", :id => "dmax_discharge_total_system_dp_1", :class => "pressure_general" %></td>
          <td><%= text_field_tag "hydraulic_turbine[discharge_maximum][1][pressure_at_discharge_nozzle_dp]", "", :id => "dmax_discharge_pressure_at_discharge_nozzle_dp_1", :class => "pressure_general" %></td>
          <td><%= link_to "X", "#", :class => "discharge_table_close_tr", :row_id => "0" %></td>
        </tr>
      <% end %>
    </table>

    <%= link_to "Add More", "#", :id => "add_new_max_discharge_row", :class => "add_new_discharge_row" %>

    <table class="hidden" id="new_discharge_maximum_row">
      <tr>
        <td>
          <b>#x#</b>
          <%= hidden_field_tag "hydraulic_turbine[discharge_maximum][#x#][id]", "", :id => "dmax_discharges_id_#x#" %>
          <%= hidden_field_tag "hydraulic_turbine[discharge_maximum][#x#][path]", "#x#", :id => "dmax_path_#x#" %>
          <%= hidden_field_tag "hydraulic_turbine[discharge_maximum][#x#][discharge_condition_basis]", "maximum" %>
        </td>
        <td>
          <%= radio_button_tag "design_circuit", '#x#', false, :id => "dmax_design_circuit_#x#" %>
          <%= hidden_field_tag "hydraulic_turbine[discharge_maximum][#x#][design_circuit]", "", :id => "dmax_discharge_design_circuit_#x#" %>
        </td>
        <td><%= select_tag "hydraulic_turbine[discharge_maximum][#x#][process_basis_id]", options_for_select(@company.heat_and_material_balances.collect { |p| [p[:case], p[:id]] }.insert(0, '')), {:id => "dmax_discharge_process_basis_id_#x#", :row_id => "#x#"} %></td>
        <td><%= select_tag "hydraulic_turbine[discharge_maximum][#x#][destination_stream_no]", options_for_select([]), :id => "dmax_discharge_destination_stream_no_#x#", :style => "width:100px;", :row_id => "#x#" %></td>
        <td><input type="button" value="Circuit Piping" class="circuit_piping_btn" row_id="#x#"></td>
        <td><%= text_field_tag "hydraulic_turbine[discharge_maximum][#x#][destination_pressure]", "", :id => "dmax_discharge_destination_pressure_#x#", :class => "pressure_general" %></td>
        <td><%= text_field_tag "hydraulic_turbine[discharge_maximum][#x#][fitting_dp]", "", :id => "dmax_discharge_fitting_dp_#x#", :class => "pressure_differential" %></td>
        <td><%= text_field_tag "hydraulic_turbine[discharge_maximum][#x#][equipment_dp]", "", :id => "dmax_discharge_equipment_dp_#x#", :class => "pressure_differential" %></td>
        <td><%= text_field_tag "hydraulic_turbine[discharge_maximum][#x#][control_valve_dp]", "", :id => "dmax_discharge_control_valve_dp_#x#", :class => "pressure_differential" %></td>
        <td><%= text_field_tag "hydraulic_turbine[discharge_maximum][#x#][orifice_dp]", "", :id => "dmax_discharge_orifice_dp_#x#", :class => "pressure_differential" %></td>
        <td><%= text_field_tag "hydraulic_turbine[discharge_maximum][#x#][total_system_dp]", "", :id => "dmax_discharge_total_system_dp_#x#", :class => "pressure_general" %></td>
        <td><%= text_field_tag "hydraulic_turbine[discharge_maximum][#x#][pressure_at_discharge_nozzle_dp]", "", :id => "dmax_discharge_pressure_at_discharge_nozzle_dp_#x#", :class => "pressure_general" %></td>
        <td><%= link_to "X", "#", :class => "discharge_table_close_tr", :row_id => "#x#" %></td>
      </tr>
    </table>
  </div>

  <div id="discharge_normal" class="discharge_tables_div" style="display:none;">
    <b>Normal</b>
    <table id="hydraulic_discharges_normal_table" class="discharge_tables">
      <tr>
        <th rowspan="2">S.No</th>
        <th rowspan="2">Design Circuit</th>
        <th rowspan="2">Process Basis</th>
        <th rowspan="2">Destination Stream</th>
        <th rowspan="2">Circuit Piping</th>
        <th>Destination Pressure</th>
        <th>Fitting &Delta;P</th>
        <th>Equipment &Delta;P</th>
        <th>Control Valve &Delta;P</th>
        <th>Orifice &Delta;P</th>
        <th>Total System &Delta;P</th>
        <th>Pressure @ Discharge Nozzle</th>
        <th rowspan="2"></th>
      </tr>
      <tr>
        <th><label class="pressure_general_unit"></label></th>
        <th><label class="pressure_differential_unit"></label></th>
        <th><label class="pressure_differential_unit"></label></th>
        <th><label class="pressure_differential_unit"></label></th>
        <th><label class="pressure_differential_unit"></label></th>
        <th><label class="pressure_general_unit"></label></th>
        <th><label class="pressure_general_unit"></label></th>
      </tr>
      <% hydraulic_turbine.discharge_normal.each_with_index do |dnor, i| %>
        <tr>
          <td>
            <b><%= i+1 %></b>
            <%= hidden_field_tag "hydraulic_turbine[discharge_normal][#{i+1}][id]", dnor.id, :id => "dnor_discharges_id_#{i+1}" %>
            <%= hidden_field_tag "hydraulic_turbine[discharge_normal][#{i+1}][path]", "#{i+1}", :id => "dnor_path_#{i+1}" %>
            <%= hidden_field_tag "hydraulic_turbine[discharge_normal][#{i+1}][delete]", false, :id => "dnor_discharges_delete_#{i+1}" %>
            <%= hidden_field_tag "hydraulic_turbine[discharge_normal][#{i+1}][discharge_condition_basis]", dnor.discharge_condition_basis %>
          </td>
          <td>
            <%= radio_button_tag "design_circuit", i+1, dnor.design_circuit, :id => "dnor_design_circuit_#{i+1}" %>
            <%= hidden_field_tag "hydraulic_turbine[discharge_normal][#{i+1}][design_circuit]", dnor.design_circuit, :id => "dnor_discharge_design_circuit_#{i+1}" %>
          </td>
          <td><%= select_tag "hydraulic_turbine[discharge_normal][#{i+1}][process_basis_id]", options_for_select(@company.heat_and_material_balances.collect { |p| [p[:case], p[:id]] }.insert(0, ''), dnor.process_basis_id), {:id => "dnor_discharge_process_basis_id_#{i+1}", :row_id => "#{i+1}", :class => "discharge_process_basis_id_#{i+1}"} %></td>
          <td><%= select_tag "hydraulic_turbine[discharge_normal][#{i+1}][destination_stream_no]", options_for_select(Stream.get_stream_nos_by_process_basis(dnor.process_basis_id).collect { |p| [p.display_stream_no, p.stream_no] }.insert(0, ''), dnor.destination_stream_no), :id => "dnor_discharge_destination_stream_no_#{i+1}", :style => "width:100px;", :row_id => "#{i+1}" %></td>
          <td><input type="button" value="Circuit Piping" class="circuit_piping_btn" row_id="<%= i+1 %>"></td>
          <td><%= text_field_tag "hydraulic_turbine[discharge_normal][#{i+1}][destination_pressure]", dnor.destination_pressure, :id => "dnor_discharge_destination_pressure_#{i+1}", :class => "pressure_general" %></td>
          <td><%= text_field_tag "hydraulic_turbine[discharge_normal][#{i+1}][fitting_dp]", dnor.fitting_dp, :id => "dnor_discharge_fitting_dp_#{i+1}", :class => "pressure_differential" %></td>
          <td><%= text_field_tag "hydraulic_turbine[discharge_normal][#{i+1}][equipment_dp]", dnor.equipment_dp, :id => "dnor_discharge_equipment_dp_#{i+1}", :class => "pressure_differential" %></td>
          <td><%= text_field_tag "hydraulic_turbine[discharge_normal][#{i+1}][control_valve_dp]", dnor.control_valve_dp, :id => "dnor_discharge_control_valve_dp_#{i+1}", :class => "pressure_differential" %></td>
          <td><%= text_field_tag "hydraulic_turbine[discharge_normal][#{i+1}][orifice_dp]", dnor.orifice_dp, :id => "dnor_discharge_orifice_dp_#{i+1}", :class => "pressure_differential" %></td>
          <td><%= text_field_tag "hydraulic_turbine[discharge_normal][#{i+1}][total_system_dp]", dnor.total_system_dp, :id => "dnor_discharge_total_system_dp_#{i+1}", :class => "pressure_general" %></td>
          <td><%= text_field_tag "hydraulic_turbine[discharge_normal][#{i+1}][pressure_at_discharge_nozzle_dp]", dnor.pressure_at_discharge_nozzle_dp, :id => "dnor_discharge_pressure_at_discharge_nozzle_dp_#{i+1}", :class => "pressure_general" %></td>
          <td><%= link_to "X", "#", :class => "discharge_table_close_tr", :row_id => i+1 %></td>
        </tr>
      <% end %>
      <% if hydraulic_turbine.discharge_normal.empty? %>
        <tr>
          <td>
            <b>1</b>
            <%= hidden_field_tag "hydraulic_turbine[discharge_normal][1][id]", "", :id => "dnor_discharges_id_1" %>
            <%= hidden_field_tag "hydraulic_turbine[discharge_normal][1][path]", 1, :id => "dnor_path_1" %>
            <%= hidden_field_tag "hydraulic_turbine[discharge_normal][1][discharge_condition_basis]", "normal" %>
          </td>
          <td>
            <%= radio_button_tag "design_circuit", '1', true, :id => "design_circuit_1" %>
            <%= hidden_field_tag "hydraulic_turbine[discharge_normal][1][design_circuit]", 1, :id => "dnor_discharge_design_circuit_1" %>
          </td>
          <td><%= select_tag "hydraulic_turbine[discharge_normal][1][process_basis_id]", options_for_select(@company.heat_and_material_balances.collect { |p| [p[:case], p[:id]] }.insert(0, '')), {:id => "dnor_discharge_process_basis_id_1", :row_id => 1} %></td>
          <td><%= select_tag "hydraulic_turbine[discharge_normal][1][destination_stream_no]", options_for_select([]), :id => "dnor_discharge_destination_stream_no_1", :style => "width:100px;", :row_id => 1 %></td>
          <td><input type="button" value="Circuit Piping" class="circuit_piping_btn" row_id="1"></td>
          <td><%= text_field_tag "hydraulic_turbine[discharge_normal][1][destination_pressure]", "", :id => "dnor_discharge_destination_pressure_1", :class => "pressure_general" %></td>
          <td><%= text_field_tag "hydraulic_turbine[discharge_normal][1][fitting_dp]", "", :id => "dnor_discharge_fitting_dp_1", :class => "pressure_differential" %></td>
          <td><%= text_field_tag "hydraulic_turbine[discharge_normal][1][equipment_dp]", "", :id => "dnor_discharge_equipment_dp_1", :class => "pressure_differential" %></td>
          <td><%= text_field_tag "hydraulic_turbine[discharge_normal][1][control_valve_dp]", "", :id => "dnor_discharge_control_valve_dp_1", :class => "pressure_differential" %></td>
          <td><%= text_field_tag "hydraulic_turbine[discharge_normal][1][orifice_dp]", "", :id => "dnor_discharge_orifice_dp_1", :class => "pressure_differential" %></td>
          <td><%= text_field_tag "hydraulic_turbine[discharge_normal][1][total_system_dp]", "", :id => "dnor_discharge_total_system_dp_1", :class => "pressure_general" %></td>
          <td><%= text_field_tag "hydraulic_turbine[discharge_normal][1][pressure_at_discharge_nozzle_dp]", "", :id => "dnor_discharge_pressure_at_discharge_nozzle_dp_1", :class => "pressure_general" %></td>
          <td><%= link_to "X", "#", :class => "discharge_table_close_tr", :row_id => "0" %></td>
        </tr>
      <% end %>
    </table>

    <%= link_to "Add More", "#", :id => "add_new_nor_discharge_row", :class => "add_new_discharge_row" %>

    <table class="hidden" id="new_discharge_normal_row">
      <tr>
        <td>
          <b>#x#</b>
          <%= hidden_field_tag "hydraulic_turbine[discharge_normal][#x#][id]", "", :id => "dnor_discharges_id_#x#" %>
          <%= hidden_field_tag "hydraulic_turbine[discharge_normal][#x#][path]", "#x#", :id => "dnor_path_#x#" %>
          <%= hidden_field_tag "hydraulic_turbine[discharge_normal][#x#][discharge_condition_basis]", "normal" %>
        </td>
        <td>
          <%= radio_button_tag "design_circuit", '#x#', false, :id => "design_circuit_#x#" %>
          <%= hidden_field_tag "hydraulic_turbine[discharge_normal][#x#][design_circuit]", "", :id => "dnor_discharge_design_circuit_#x#" %>
        </td>
        <td><%= select_tag "hydraulic_turbine[discharge_normal][#x#][process_basis_id]", options_for_select(@company.heat_and_material_balances.collect { |p| [p[:case], p[:id]] }.insert(0, '')), {:id => "dnor_discharge_process_basis_id_#x#", :row_id => "#x#"} %></td>
        <td><%= select_tag "hydraulic_turbine[discharge_normal][#x#][destination_stream_no]", options_for_select([]), :id => "dnor_discharge_destination_stream_no_#x#", :style => "width:100px;", :row_id => "#x#" %></td>
        <td><input type="button" value="Circuit Piping" class="circuit_piping_btn" row_id="#x#"></td>
        <td><%= text_field_tag "hydraulic_turbine[discharge_normal][#x#][destination_pressure]", "", :id => "dnor_discharge_destination_pressure_#x#", :class => "pressure_general" %></td>
        <td><%= text_field_tag "hydraulic_turbine[discharge_normal][#x#][fitting_dp]", "", :id => "dnor_discharge_fitting_dp_#x#", :class => "pressure_differential" %></td>
        <td><%= text_field_tag "hydraulic_turbine[discharge_normal][#x#][equipment_dp]", "", :id => "dnor_discharge_equipment_dp_#x#", :class => "pressure_differential" %></td>
        <td><%= text_field_tag "hydraulic_turbine[discharge_normal][#x#][control_valve_dp]", "", :id => "dnor_discharge_control_valve_dp_#x#", :class => "pressure_differential" %></td>
        <td><%= text_field_tag "hydraulic_turbine[discharge_normal][#x#][orifice_dp]", "", :id => "dnor_discharge_orifice_dp_#x#", :class => "pressure_differential" %></td>
        <td><%= text_field_tag "hydraulic_turbine[discharge_normal][#x#][total_system_dp]", "", :id => "dnor_discharge_total_system_dp_#x#", :class => "pressure_general" %></td>
        <td><%= text_field_tag "hydraulic_turbine[discharge_normal][#x#][pressure_at_discharge_nozzle_dp]", "", :id => "dnor_discharge_pressure_at_discharge_nozzle_dp_#x#", :class => "pressure_general" %></td>
        <td><%= link_to "X", "#", :class => "discharge_table_close_tr", :row_id => "#x#" %></td>
      </tr>
    </table>
  </div>

  <div id="discharge_minimum" class="discharge_tables_div" style="display:none;">
    <b>Minimum</b>
    <table id="hydraulic_discharges_minimum_table" class="discharge_tables">
      <tr>
        <th rowspan="2">S.No</th>
        <th rowspan="2">Design Circuit</th>
        <th rowspan="2">Process Basis</th>
        <th rowspan="2">Destination Stream</th>
        <th rowspan="2">Circuit Piping</th>
        <th>Destination Pressure</th>
        <th>Fitting &Delta;P</th>
        <th>Equipment &Delta;P</th>
        <th>Control Valve &Delta;P</th>
        <th>Orifice &Delta;P</th>
        <th>Total System &Delta;P</th>
        <th>Pressure @ Discharge Nozzle</th>
        <th rowspan="2"></th>
      </tr>
      <tr>
        <th><label class="destination_pressure_unit"></label></th>
        <th><label class="fitting_dp_unit"></label></th>
        <th><label class="equipment_dp_unit"></label></th>
        <th><label class="control_valve_dp_unit"></label></th>
        <th><label class="orifice_dp_unit"></label></th>
        <th><label class="total_system_dp_unit"></label></th>
        <th><label class="pressure_at_discharge_nozzle_unit"></label></th>
      </tr>
      <% hydraulic_turbine.discharge_minimum.each_with_index do |dmin, i| %>
        <tr>
          <td>
            <b><%= i+1 %></b>
            <%= hidden_field_tag "hydraulic_turbine[discharge_minimum][#{i+1}][id]", dmin.id, :id => "dmin_discharges_id_#{i+1}" %>
            <%= hidden_field_tag "hydraulic_turbine[discharge_minimum][#{i+1}][path]", "#{i+1}", :id => "dmin_path_#{i+1}" %>
            <%= hidden_field_tag "hydraulic_turbine[discharge_minimum][#{i+1}][delete]", false, :id => "dmin_discharges_delete_#{i+1}" %>
            <%= hidden_field_tag "hydraulic_turbine[discharge_minimum][#{i+1}][discharge_condition_basis]", dmin.discharge_condition_basis %>
          </td>
          <td>
            <%= radio_button_tag "design_circuit", i+1, dmin.design_circuit, :id => "design_circuit_#{i+1}" %>
            <%= hidden_field_tag "hydraulic_turbine[discharge_minimum][#{i+1}][design_circuit]", dmin.design_circuit, :id => "dmin_discharge_design_circuit_#{i+1}" %>
          </td>
          <td><%= select_tag "hydraulic_turbine[discharge_minimum][#{i+1}][process_basis_id]", options_for_select(@company.heat_and_material_balances.collect { |p| [p[:case], p[:id]] }.insert(0, ''), dmin.process_basis_id), {:id => "dmin_discharge_process_basis_id_#{i+1}", :row_id => "#{i+1}", :class => "discharge_process_basis_id_#{i+1}"} %></td>
          <td><%= select_tag "hydraulic_turbine[discharge_minimum][#{i+1}][destination_stream_no]", options_for_select(Stream.get_stream_nos_by_process_basis(dmin.process_basis_id).collect { |p| [p.display_stream_no, p.stream_no] }.insert(0, ''), dmin.destination_stream_no), :id => "dmin_discharge_destination_stream_no_#{i+1}", :style => "width:100px;", :row_id => "#{i+1}" %></td>
          <td><input type="button" value="Circuit Piping" class="circuit_piping_btn" row_id="<%= i+1 %>"></td>
          <td><%= text_field_tag "hydraulic_turbine[discharge_minimum][#{i+1}][destination_pressure]", dmin.destination_pressure, :id => "dmin_discharge_destination_pressure_#{i+1}", :class => "pressure_general" %></td>
          <td><%= text_field_tag "hydraulic_turbine[discharge_minimum][#{i+1}][fitting_dp]", dmin.fitting_dp, :id => "dmin_discharge_fitting_dp_#{i+1}", :class => "pressure_differential" %></td>
          <td><%= text_field_tag "hydraulic_turbine[discharge_minimum][#{i+1}][equipment_dp]", dmin.equipment_dp, :id => "dmin_discharge_equipment_dp_#{i+1}", :class => "pressure_differential" %></td>
          <td><%= text_field_tag "hydraulic_turbine[discharge_minimum][#{i+1}][control_valve_dp]", dmin.control_valve_dp, :id => "dmin_discharge_control_valve_dp_#{i+1}", :class => "pressure_differential" %></td>
          <td><%= text_field_tag "hydraulic_turbine[discharge_minimum][#{i+1}][orifice_dp]", dmin.orifice_dp, :id => "dmin_discharge_orifice_dp_#{i+1}", :class => "pressure_differential" %></td>
          <td><%= text_field_tag "hydraulic_turbine[discharge_minimum][#{i+1}][total_system_dp]", dmin.total_system_dp, :id => "dmin_discharge_total_system_dp_#{i+1}", :class => "pressure_general" %></td>
          <td><%= text_field_tag "hydraulic_turbine[discharge_minimum][#{i+1}][pressure_at_discharge_nozzle_dp]", dmin.pressure_at_discharge_nozzle_dp, :id => "dmin_discharge_pressure_at_discharge_nozzle_dp_#{i+1}", :class => "pressure_general" %></td>
          <td><%= link_to "X", "#", :class => "discharge_table_close_tr", :row_id => i+1 %></td>
        </tr>
      <% end %>
      <% if hydraulic_turbine.discharge_minimum.empty? %>
        <tr>
          <td>
            <b>1</b>
            <%= hidden_field_tag "hydraulic_turbine[discharge_minimum][1][id]", "", :id => "dmin_discharges_id_1" %>
            <%= hidden_field_tag "hydraulic_turbine[discharge_minimum][1][path]", 1, :id => "dmin_path_1" %>
            <%= hidden_field_tag "hydraulic_turbine[discharge_minimum][1][discharge_condition_basis]", "minimum" %>
          </td>
          <td>
            <%= radio_button_tag "design_circuit", '1', true, :id => "design_circuit_1" %>
            <%= hidden_field_tag "hydraulic_turbine[discharge_minimum][1][design_circuit]", 1, :id => "dmin_discharge_design_circuit_1" %>
          </td>
          <td><%= select_tag "hydraulic_turbine[discharge_minimum][1][process_basis_id]", options_for_select(@company.heat_and_material_balances.collect { |p| [p[:case], p[:id]] }.insert(0, '')), {:id => "dmin_discharge_process_basis_id_1", :row_id => 1} %></td>
          <td><%= select_tag "hydraulic_turbine[discharge_minimum][1][destination_stream_no]", options_for_select([]), :id => "dmin_discharge_destination_stream_no_1", :style => "width:100px;", :row_id => 1 %></td>
          <td><input type="button" value="Circuit Piping" class="circuit_piping_btn" row_id="1"></td>
          <td><%= text_field_tag "hydraulic_turbine[discharge_minimum][1][destination_pressure]", "", :id => "dmin_discharge_destination_pressure_1", :class => "pressure_general" %></td>
          <td><%= text_field_tag "hydraulic_turbine[discharge_minimum][1][fitting_dp]", "", :id => "dmin_discharge_fitting_dp_1", :class => "pressure_differential" %></td>
          <td><%= text_field_tag "hydraulic_turbine[discharge_minimum][1][equipment_dp]", "", :id => "dmin_discharge_equipment_dp_1", :class => "pressure_differential" %></td>
          <td><%= text_field_tag "hydraulic_turbine[discharge_minimum][1][control_valve_dp]", "", :id => "dmin_discharge_control_valve_dp_1", :class => "pressure_differential" %></td>
          <td><%= text_field_tag "hydraulic_turbine[discharge_minimum][1][orifice_dp]", "", :id => "dmin_discharge_orifice_dp_1", :class => "pressure_differential" %></td>
          <td><%= text_field_tag "hydraulic_turbine[discharge_minimum][1][total_system_dp]", "", :id => "dmin_discharge_total_system_dp_1", :class => "pressure_general" %></td>
          <td><%= text_field_tag "hydraulic_turbine[discharge_minimum][1][pressure_at_discharge_nozzle_dp]", "", :id => "dmin_discharge_pressure_at_discharge_nozzle_dp_1", :class => "pressure_general" %></td>
          <td><%= link_to "X", "#", :class => "discharge_table_close_tr", :row_id => "0" %></td>
        </tr>
      <% end %>
    </table>

    <%= link_to "Add More", "#", :id => "add_new_min_discharge_row", :class => "add_new_discharge_row" %>

    <table class="hidden" id="new_discharge_minimum_row">
      <tr>
        <td>
          <b>#x#</b>
          <%= hidden_field_tag "hydraulic_turbine[discharge_minimum][#x#][id]", "", :id => "dmin_discharges_id_#x#" %>
          <%= hidden_field_tag "hydraulic_turbine[discharge_minimum][#x#][path]", "#x#", :id => "dmin_path_#x#" %>
          <%= hidden_field_tag "hydraulic_turbine[discharge_minimum][#x#][discharge_condition_basis]", "minimum" %>
        </td>
        <td>
          <%= radio_button_tag "design_circuit", '#x#', false, :id => "design_circuit_#x#" %>
          <%= hidden_field_tag "hydraulic_turbine[discharge_minimum][#x#][design_circuit]", "", :id => "dmin_discharge_design_circuit_#x#" %>
        </td>
        <td><%= select_tag "hydraulic_turbine[discharge_minimum][#x#][process_basis_id]", options_for_select(@company.heat_and_material_balances.collect { |p| [p[:case], p[:id]] }.insert(0, '')), {:id => "dmin_discharge_process_basis_id_#x#", :row_id => "#x#"} %></td>
        <td><%= select_tag "hydraulic_turbine[discharge_minimum][#x#][destination_stream_no]", options_for_select([]), :id => "dmin_discharge_destination_stream_no_#x#", :style => "width:100px;", :row_id => "#x#" %></td>
        <td><input type="button" value="Circuit Piping" class="circuit_piping_btn" row_id="#x#"></td>
        <td><%= text_field_tag "hydraulic_turbine[discharge_minimum][#x#][destination_pressure]", "", :id => "dmin_discharge_destination_pressure_#x#", :class => "pressure_general" %></td>
        <td><%= text_field_tag "hydraulic_turbine[discharge_minimum][#x#][fitting_dp]", "", :id => "dmin_discharge_fitting_dp_#x#", :class => "pressure_differential" %></td>
        <td><%= text_field_tag "hydraulic_turbine[discharge_minimum][#x#][equipment_dp]", "", :id => "dmin_discharge_equipment_dp_#x#", :class => "pressure_differential" %></td>
        <td><%= text_field_tag "hydraulic_turbine[discharge_minimum][#x#][control_valve_dp]", "", :id => "dmin_discharge_control_valve_dp_#x#", :class => "pressure_differential" %></td>
        <td><%= text_field_tag "hydraulic_turbine[discharge_minimum][#x#][orifice_dp]", "", :id => "dmin_discharge_orifice_dp_#x#", :class => "pressure_differential" %></td>
        <td><%= text_field_tag "hydraulic_turbine[discharge_minimum][#x#][total_system_dp]", "", :id => "dmin_discharge_total_system_dp_#x#", :class => "pressure_general" %></td>
        <td><%= text_field_tag "hydraulic_turbine[discharge_minimum][#x#][pressure_at_discharge_nozzle_dp]", "", :id => "dmin_discharge_pressure_at_discharge_nozzle_dp_#x#", :class => "pressure_general" %></td>
        <td><%= link_to "X", "#", :class => "discharge_table_close_tr", :row_id => "#x#" %></td>
      </tr>
    </table>
  </div>
  <br>
  <%= f.submit 'Save' if !hydraulic_turbine.new_record? %>
  <input id="discharge_calculate" type="button" value="Calculate"/>

  </div>
  <div id="tab3" class="tab_content">
  <!-- Hydraulic Turbine Design -->
  <table width="100%">
  <tr>
    <td colspan="2"><label class="sub_title">Rotating Equipment Details</label></td>
    <td colspan="2" rowspan="7"></td>
  </tr>
  <tr>
    <td width="25%">Equipment Type</td>
    <td width="25%"><%= f.select :htd_red_equipment_type, options_for_select(StaticData.equipment_type, hydraulic_turbine.htd_red_equipment_type), :include_blank => true %></td>
  </tr>
  <tr>
    <td>Equipment Tag</td>
    <td><%= f.select :htd_red_equipment_tag, options_for_select(@equipment_tags.collect { |h| [raw(h[:tag]), h[:id]] }, hydraulic_turbine.htd_red_equipment_tag), :include_blank => true %></td>
  </tr>
  <tr>
    <td>Capacity</td>
    <td>
      <%= f.text_field :htd_red_capacity, :class => "small-text-100 volumetric_flow_rate_liquid" %>
      &nbsp;<label class="volumetric_flow_rate_liquid_unit"></label>
    </td>
  </tr>
  <tr>
    <td>Differential Pressure</td>
    <td>
      <%= f.text_field :htd_red_differential_pressure, :class => "small-text-100 pressure_differential" %>
      &nbsp;<label class="pressure_differential_unit"></label>
    </td>
  </tr>
  <tr>
    <td>Horsepower</td>
    <td>
      <%= f.text_field :htd_red_horsepower, :class => "small-text-100 power_general" %>
      &nbsp;<label class="power_general_unit"></label>
    </td>
  </tr>
  <tr>
    <td>Speed</td>
    <td>
      <%= f.text_field :htd_red_speed, :class => "small-text-100 revolution_speed_general" %>
      &nbsp;<label class="revolution_speed_general_unit"></label>
    </td>
  </tr>
  <tr>
    <td colspan="4" style="text-align:right;">
      <input id="btn_hydraulic_turbine_design" type="button" value="Design Turbine" style="float:right;">
    </td>
  </tr>
  <tr>
    <td><label class="sub_title">RESULTS</label></td>
    <td><label class="sub_title">Minimum</label></td>
    <td><label class="sub_title">Normal</label></td>
    <td><label class="sub_title">Maximum</label></td>
  </tr>
  <tr>
    <td><b>Turbine Differential</b></td>
    <td></td>
    <td></td>
    <td></td>
  </tr>
  <tr>
    <td>Pressure @ Suction Nozzle</td>
    <td>
      <label id="htd_td_pressure_at_suction_nozzle_max"><%= hydraulic_turbine.htd_td_pressure_at_suction_nozzle_max %></label>
      <%= f.hidden_field :htd_td_pressure_at_suction_nozzle_max, :class => "htd_td_pressure_at_suction_nozzle" %>
      &nbsp;<label class="pressure_general_unit"></label>
    </td>
    <td>
      <label id="htd_td_pressure_at_suction_nozzle_nor"><%= hydraulic_turbine.htd_td_pressure_at_suction_nozzle_nor %></label>
      <%= f.hidden_field :htd_td_pressure_at_suction_nozzle_nor, :class => "htd_td_pressure_at_suction_nozzle" %>
      &nbsp;<label class="pressure_general_unit"></label>
    </td>
    <td>
      <label id="htd_td_pressure_at_suction_nozzle_min"><%= hydraulic_turbine.htd_td_pressure_at_suction_nozzle_min %></label>
      <%= f.hidden_field :htd_td_pressure_at_suction_nozzle_min, :class => "htd_td_pressure_at_suction_nozzle" %>
      &nbsp;<label class="pressure_general_unit"></label>
    </td>
  </tr>
  <tr>
    <td>Pressure @ Discharge Nozzle</td>
    <td>
      <label id="htd_td_pressure_at_discharge_nozzle_max"><%= hydraulic_turbine.htd_td_pressure_at_discharge_nozzle_max %></label>
      <%= f.hidden_field :htd_td_pressure_at_discharge_nozzle_max, :class => "htd_td_pressure_at_discharge_nozzle" %>
      &nbsp;<label class="pressure_general_unit"></label>
    </td>
    <td>
      <label id="htd_td_pressure_at_discharge_nozzle_nor"><%= hydraulic_turbine.htd_td_pressure_at_discharge_nozzle_nor %></label>
      <%= f.hidden_field :htd_td_pressure_at_discharge_nozzle_nor, :class => "htd_td_pressure_at_discharge_nozzle" %>
      &nbsp;<label class="pressure_general_unit"></label>
    </td>
    <td>
      <label id="htd_td_pressure_at_discharge_nozzle_min"><%= hydraulic_turbine.htd_td_pressure_at_discharge_nozzle_min %></label>
      <%= f.hidden_field :htd_td_pressure_at_discharge_nozzle_min, :class => "htd_td_pressure_at_discharge_nozzle" %>
      &nbsp;<label class="pressure_general_unit"></label>
    </td>
  </tr>
  <tr>
    <td>Differential Pressure</td>
    <td>
      <label id="htd_td_differential_pressure_max"><%= hydraulic_turbine.htd_td_differential_pressure_max %></label>
      <%= f.hidden_field :htd_td_differential_pressure_max, :class => "htd_td_differential_pressure" %>
      &nbsp;<label class="pressure_differential_unit"></label>
    </td>
    <td>
      <label id="htd_td_differential_pressure_nor"><%= hydraulic_turbine.htd_td_differential_pressure_nor %></label>
      <%= f.hidden_field :htd_td_differential_pressure_max, :class => "htd_td_differential_pressure" %>
      &nbsp;<label class="pressure_differential_unit"></label>
    </td>
    <td>
      <label id="htd_td_differential_pressure_min"><%= hydraulic_turbine.htd_td_differential_pressure_min %></label>
      <%= f.hidden_field :htd_td_differential_pressure_max, :class => "htd_td_differential_pressure" %>
      &nbsp;<label class="pressure_differential_unit"></label>
    </td>
  </tr>
  <tr>
    <td>Differential Head</td>
    <td>
      <label id="htd_td_differential_head_max"><%= hydraulic_turbine.htd_td_differential_head_max %></label>
      <%= f.hidden_field :htd_td_differential_head_max, :class => "htd_td_differential_head" %>
      &nbsp;<label class="length_large_dimension_length_unit"></label>
    </td>
    <td>
      <label id="htd_td_differential_head_nor"><%= hydraulic_turbine.htd_td_differential_head_nor %></label>
      <%= f.hidden_field :htd_td_differential_head_nor, :class => "htd_td_differential_head" %>
      &nbsp;<label class="length_large_dimension_length_unit"></label>
    </td>
    <td>
      <label id="htd_td_differential_head_min"><%= hydraulic_turbine.htd_td_differential_head_min %></label>
      <%= f.hidden_field :htd_td_differential_head_min, :class => "htd_td_differential_head" %>
      &nbsp;<label class="length_large_dimension_length_unit"></label>
    </td>
  </tr>
  <tr>
    <td><b>Turbine Available Power</b></td>
    <td></td>
    <td></td>
    <td></td>
  </tr>
  <tr>
    <td>Flow Rate</td>
    <td>
      <label id="htd_tap_flow_rate_max"><%= hydraulic_turbine.htd_tap_flow_rate_max %></label>
      <%= f.hidden_field :htd_tap_flow_rate_max, :class => "htd_tap_flow_rate" %>
      &nbsp;<label class="volumetric_flow_rate_liquid_unit"></label>
    </td>
    <td>
      <label id="htd_tap_flow_rate_nor"><%= hydraulic_turbine.htd_tap_flow_rate_nor %></label>
      <%= f.hidden_field :htd_tap_flow_rate_nor, :class => "htd_tap_flow_rate" %>
      &nbsp;<label class="volumetric_flow_rate_liquid_unit"></label>
    </td>
    <td>
      <label id="htd_tap_flow_rate_min"><%= hydraulic_turbine.htd_tap_flow_rate_min %></label>
      <%= f.hidden_field :htd_tap_flow_rate_min, :class => "htd_tap_flow_rate" %>
      &nbsp;<label class="volumetric_flow_rate_liquid_unit"></label>
    </td>
  </tr>
  <tr>
    <td>S.G.</td>
    <td>
      <%= hydraulic_turbine.htd_tap_sg_max %>&nbsp;
    </td>
    <td>
      <%= hydraulic_turbine.htd_tap_sg_nor %>&nbsp;
    </td>
    <td>
      <%= hydraulic_turbine.htd_tap_sg_min %>&nbsp;
    </td>
  </tr>
  <tr>
    <td>Hydraulic HP</td>
    <td>
      <label id="htd_tap_hydraulic_hp_max"><%= hydraulic_turbine.htd_tap_hydraulic_hp_max %></label>
      <%= f.hidden_field :htd_tap_hydraulic_hp_max, :class => "htd_tap_hydraulic_hp" %>
      &nbsp;<label class="horsepower_general_unit"></label>
    </td>
    <td>
      <label id="htd_tap_hydraulic_hp_nor"><%= hydraulic_turbine.htd_tap_hydraulic_hp_nor %></label>
      <%= f.hidden_field :htd_tap_hydraulic_hp_nor, :class => "htd_tap_hydraulic_hp" %>
      &nbsp;<label class="horsepower_general_unit"></label>
    </td>
    <td>
      <label id="htd_tap_hydraulic_hp_min"><%= hydraulic_turbine.htd_tap_hydraulic_hp_min %></label>
      <%= f.hidden_field :htd_tap_hydraulic_hp_max, :class => "htd_tap_hydraulic_hp" %>
      &nbsp;<label class="horsepower_general_unit"></label>
    </td>
  </tr>
  <tr>
    <td>Efficiency</td>
    <td><%= f.text_field :htd_tap_efficiency_max, :class => "small-text-50 htd_tap_efficiency" %>&nbsp;%</td>
    <td><%= f.text_field :htd_tap_efficiency_nor, :class => "small-text-50 htd_tap_efficiency" %>&nbsp;%</td>
    <td><%= f.text_field :htd_tap_efficiency_min, :class => "small-text-50 htd_tap_efficiency" %>&nbsp;%</td>
  </tr>
  <tr>
    <td>Brake Horsepower</td>
    <td>
      <label id="htd_tap_brake_horsepower_max"><%= hydraulic_turbine.htd_tap_brake_horsepower_max %></label>
      <%= f.hidden_field :htd_tap_brake_horsepower_max, :class => "htd_tap_brake_horsepower" %>
      &nbsp;<label class="horsepower_general_unit"></label>
    </td>
    <td>
      <label id="htd_tap_brake_horsepower_nor"><%= hydraulic_turbine.htd_tap_brake_horsepower_nor %></label>
      <%= f.hidden_field :htd_tap_brake_horsepower_nor, :class => "htd_tap_brake_horsepower" %>
      &nbsp;<label class="horsepower_general_unit"></label>
    </td>
    <td>
      <label id="htd_tap_brake_horsepower_min"><%= hydraulic_turbine.htd_tap_brake_horsepower_min %></label>
      <%= f.hidden_field :htd_tap_brake_horsepower_min, :class => "htd_tap_brake_horsepower" %>
      &nbsp;<label class="horsepower_general_unit"></label>
    </td>
  </tr>
  <tr>
    <td><b>Power Balance</b></td>
    <td></td>
    <td></td>
    <td></td>
  </tr>
  <tr>
    <td>Brake Horsepower</td>
    <td>
      <label id="htd_pb_brake_horsepower_max"><%= hydraulic_turbine.htd_pb_brake_horsepower_max %></label>
      <%= f.hidden_field :htd_pb_brake_horsepower_max, :class => "htd_pb_brake_horsepower" %>
      &nbsp;<label class="power_general_unit"></label>
    </td>
    <td>
      <label id="htd_pb_brake_horsepower_nor"><%= hydraulic_turbine.htd_pb_brake_horsepower_nor %></label>
      <%= f.hidden_field :htd_pb_brake_horsepower_nor, :class => "htd_pb_brake_horsepower" %>
      &nbsp;<label class="power_general_unit"></label>
    </td>
    <td>
      <label id="htd_pb_brake_horsepower_min"><%= hydraulic_turbine.htd_pb_brake_horsepower_min %></label>
      <%= f.hidden_field :htd_pb_brake_horsepower_min, :class => "htd_pb_brake_horsepower" %>
      &nbsp;<label class="power_general_unit"></label>
    </td>
  </tr>
  </table>

  </div>
  <div id="tab4" class="tab_content">
    <!-- HPRT Curve -->
    <div class="form-element-last" style="width:150px;">
      <input type="button" value="Turbine Curve">
    </div>
    <div style="width:auto;float:left;">
      <table id="hprt_data_table">
        <tr>
          <td><label class="sub_title">No</label></td>
          <td><label class="sub_title">Capacity</label></td>
          <td><label class="sub_title">System loss</label></td>
          <td rowspan="2"></td>
        </tr>
        <tr>
          <td></td>
          <td><label class="volumetric_flow_rate_liquid_unit"></label></td>
          <td><label class="length_large_dimension_length_unit"></label></td>
        </tr>
        <% if hydraulic_turbine.hprt_datas.empty? %>
          <tr>
            <td>
              1
              <%= hidden_field_tag "hydraulic_turbine[hprt_datas][1][id]", "", :id => "hprt_data_id_1" %>
            </td>
            <td><%= text_field_tag "hydraulic_turbine[hprt_datas][1][capacity]", "", :id => "capacity_1", :class => "small-text-50 volumetric_flow_rate_liquid" %></td>
            <td><%= text_field_tag "hydraulic_turbine[hprt_datas][1][system_loss]", "", :id => "system_loss_1", :class => "small-text-50 length_large_dimension_length" %></td>
            <td><%= link_to "X", "#", :class => "hprt_close_tr", :row_id => "1" %></td>
          </tr>
        <% end %>
        <% hydraulic_turbine.hprt_datas.each_with_index do |hp, i| %>
          <tr>
            <td>
              <%= i+1 %>
              <%= hidden_field_tag "hydraulic_turbine[hprt_datas][#{i+1}][id]", hp.id, :id => "hprt_data_id_#{i+1}" %>
            </td>
            <td><%= text_field_tag "hydraulic_turbine[hprt_datas][#{i+1}][capacity]", hp.capacity, :id => "capacity_#{i+1}", :class => "small-text-50 volumetric_flow_rate_liquid" %></td>
            <td><%= text_field_tag "hydraulic_turbine[hprt_datas][#{i+1}][system_loss]", hp.system_loss, :id => "system_loss_#{i+1}", :class => "small-text-50 length_large_dimension_length_unit" %></td>
            <td><%= link_to "X", "#", :class => "hprt_close_tr", :row_id => "#{i+1}" %></td>
          </tr>
        <% end %>
      </table>

      <%= link_to "Add", "#", :id => "add_hprt_data" %>

      <table id="new_hprt_tr" class="hidden">
        <tr>
          <td>
            #x#
            <%= hidden_field_tag "hydraulic_turbine[hprt_datas][#x#][id]", "", :id => "hprt_data_id_#x#" %>
          </td>
          <td><%= text_field_tag "hydraulic_turbine[hprt_datas][#x#][capacity]", "", :id => "capacity_#x#", :class => "small-text-50 volumetric_flow_rate_liquid" %></td>
          <td><%= text_field_tag "hydraulic_turbine[hprt_datas][#x#][system_loss]", "", :id => "system_loss_#x#", :class => "small-text-50 length_large_dimension_length_unit" %></td>
          <td><%= link_to "X", "#", :class => "hprt_close_tr", :row_id => "#x#" %></td>
        </tr>
      </table>
    </div>
    <div style="float:left;margin:10px;">
      <span>HPRT CURVE</span>

      <div style="border:1px solid #000000;width:400px;height:400px;">

      </div>
    </div>
    <div class="clear"></div>


  </div>
  <div id="tab5" class="tab_content">
    <!-- CV Summary -->
    <table>
      <tr>
        <td><label class="sub_title">No.</label></td>
        <td><label class="sub_title">Circuit</label></td>
        <td><label class="sub_title">Control Value Tag</label></td>
        <td><label class="sub_title">Inlet<br/>Pressure</label></td>
        <td><label class="sub_title">Outlet<br/>Pressure</label></td>
        <td><label class="sub_title">CV Delta P</label></td>
        <td><label class="sub_title">Density</label></td>
        <td><label class="sub_title">CV</label></td>
      </tr>
      <tr>
        <td></td>
        <td></td>
        <td></td>
        <td><label class="pressure_general_unit"></label></td>
        <td><label class="pressure_general_unit"></label></td>
        <td><label class="pressure_differential_unit"></label></td>
        <td><label class="density_general_unit"></label></td>
        <td></td>
      </tr>
    </table>
  </div>
  <div id="tab6" class="tab_content">
    <!-- FE Summary -->
    <table>
      <tr>
        <td><label class="sub_title">No.</label></td>
        <td><label class="sub_title">Circuit</label></td>
        <td><label class="sub_title">Flow Element Tag</label></td>
        <td><label class="sub_title">Inlet<br/>Pressure</label></td>
        <td><label class="sub_title">Outlet<br/>Pressure</label></td>
        <td><label class="sub_title">FE Delta P</label></td>
        <td><label class="sub_title">Density</label></td>
        <td><label class="sub_title">Diameter</label></td>
      </tr>
      <tr>
        <td></td>
        <td></td>
        <td></td>
        <td><label class="pressure_general_unit"></label></td>
        <td><label class="pressure_general_unit"></label></td>
        <td><label class="pressure_differential_unit"></label></td>
        <td><label class="density_general_unit"></label></td>
        <td><label class="length_large_dimension_length_unit"></label></td>
      </tr>
    </table>
  </div>
  <div id="tab7" class="tab_content">
    <!-- Heuristics Review-->
    <table>
      <tr>
        <td>
          Efficiency is greater for larger machines. Motors, 85-95%; steam turbines, 42-78%; gas
          engines and turbines, 28-38%.
        </td>
        <td width="150px">
          <%= f.radio_button :ht_sizing_review_1, "yes" %>&nbsp;Yes&nbsp;
          <%= f.radio_button :ht_sizing_review_1, "no" %>&nbsp;No&nbsp;
          <%= f.radio_button :ht_sizing_review_1, "na" %>&nbsp;N/A&nbsp;
        </td>
      </tr>
      <tr>
        <td>
          For under 74.6 kW(100 hp), electric motors are used almost exclusively. They are made for up
          to 14,900 kW (20,000 hp).
        </td>
        <td width="150px">
          <%= f.radio_button :ht_sizing_review_2, "yes" %>&nbsp;Yes&nbsp;
          <%= f.radio_button :ht_sizing_review_2, "no" %>&nbsp;No&nbsp;
          <%= f.radio_button :ht_sizing_review_2, "na" %>&nbsp;N/A&nbsp;
        </td>
      </tr>
      <tr>
        <td>
          Induction motors are most popular. Synchronous motors are made for speeds as low as 150
          rpm and are thus suited, for example, for low speed reciprocating compressors, but are not
          made smaller than 50 hp. A variety of enclosures are available from weather-proof to
          explosion-proof.
        </td>
        <td width="150px">
          <%= f.radio_button :ht_sizing_review_3, "yes" %>&nbsp;Yes&nbsp;
          <%= f.radio_button :ht_sizing_review_3, "no" %>&nbsp;No&nbsp;
          <%= f.radio_button :ht_sizing_review_3, "na" %>&nbsp;N/A&nbsp;
        </td>
      </tr>
      <tr>
        <td>
          Steam turbines are competitive above 76.6 kW (100 hp). They are speed-controllable. They
          are frequently used as spares in case of power failure.
        </td>
        <td width="150px">
          <%= f.radio_button :ht_sizing_review_4, "yes" %>&nbsp;Yes&nbsp;
          <%= f.radio_button :ht_sizing_review_4, "no" %>&nbsp;No&nbsp;
          <%= f.radio_button :ht_sizing_review_4, "na" %>&nbsp;N/A&nbsp;
        </td>
      </tr>
      <tr>
        <td>
          Combustion engines and turbines are restricted to mobile and remote locations.
        </td>
        <td width="150px">
          <%= f.radio_button :ht_sizing_review_5, "yes" %>&nbsp;Yes&nbsp;
          <%= f.radio_button :ht_sizing_review_5, "no" %>&nbsp;No&nbsp;
          <%= f.radio_button :ht_sizing_review_5, "na" %>&nbsp;N/A&nbsp;
        </td>
      </tr>
      <tr>
        <td>
          Gas expanders for power recovery may be justified at capacities of several hundred hp;
          otherwise any pressure reduction in a process is done with throttling valves.
        </td>
        <td width="150px">
          <%= f.radio_button :ht_sizing_review_6, "yes" %>&nbsp;Yes&nbsp;
          <%= f.radio_button :ht_sizing_review_6, "no" %>&nbsp;No&nbsp;
          <%= f.radio_button :ht_sizing_review_6, "na" %>&nbsp;N/A&nbsp;
        </td>
      </tr>
      <tr>
        <td>
          The following useful definition are give:<br><br>

          <div style="margin-bottom:15px;">
								<span style="float:left;margin-right:5px;padding-top:25px;">
									shaft power = 	
								</span>
								<span style="float:left;">
									<span>theoretical power to pump fluid (liquid or gas)</span><br>
									<span>____________________________________</span><br><br>
									<span>efficiency of pump or compressor, e sh</span>
								</span>

            <div class="clear"></div>
          </div>
          <div>
								<span style="float:left;margin-right:5px;padding-top:25px;">
									shaft power = 	
								</span>
								<span style="float:left;">
									<span>theoretical power to pump fluid (liquid or gas)</span><br>
									<span>____________________________________</span><br><br>
									<span>efficiency of pump or compressor, e dr</span>
								</span>

            <div class="clear"></div>
          </div>
          <br>
          Overall efficiency = eiv = esh * edr
        </td>
        <td width="150px">
          <%= f.radio_button :ht_sizing_review_7, "yes" %>&nbsp;Yes&nbsp;
          <%= f.radio_button :ht_sizing_review_7, "no" %>&nbsp;No&nbsp;
          <%= f.radio_button :ht_sizing_review_7, "na" %>&nbsp;N/A&nbsp;
        </td>
      </tr>
      <tr>
        <td colspan="2"><label class="sub_title">NOTES</label></td>
      </tr>
      <tr>
        <td colspan="2"><%= f.text_area :ht_notes, :size => "140x8" %></td>
      </tr>
    </table>
  </div>
  </div>
  <div class="clear"></div>
  </div>
  <!-- end tabs -->

  <!-- SUCTION PIPING -->
  <div style="display:none;">
    <div id="suction_piping_box">
      <div id="suction_piping_basis" style="font-weight:bold;font-size: 16px;">

      </div>
      <table id="suction_piping_table">
        <tr>
          <th rowspan="2">No.</th>
          <th rowspan="2">Fitting(s)</th>
          <th rowspan="2">Fitting Tag</th>
          <th>Pipe Size</th>
          <th rowspan="2">Pipe Sch.</th>
          <th>Pipe ID</th>
          <th rowspan="2">% Flow</th>
          <th rowspan="2">Ds/Dl<br>or Cv</th>
          <th>Length</th>
          <th>Elev.</th>
          <th class="delta_p_maximum">&Delta;P</th>
          <th class="delta_p_normal">&Delta;P</th>
          <th class="delta_p_minimum">&Delta;P</th>
          <th>Outlet Pressure</th>
          <th rowspan="2"></th>
        </tr>
        <tr>
          <th>inches</th>
          <th><label class="length_pipe_tube_diameter_unit"></label></th>
          <th><label class="length_large_dimension_length_unit"></label></th>
          <th><label class="length_large_dimension_length_unit"></label></th>
          <th class="delta_p_maximum"><label class="pressure_differential_unit"></label></th>
          <th class="delta_p_normal"><label class="pressure_differential_unit"></label></th>
          <th class="delta_p_minimum"><label class="pressure_differential_unit"></label></th>
          <th><label class="pressure_general_unit"></label></th>
        </tr>
        <% hydraulic_turbine.hydraulic_turbine_circuit_pipings.each_with_index do |sp, i| %>
          <tr>
            <td>
              <%= i+1 %>
              <%= hidden_field_tag "hydraulic_turbine[hydraulic_turbine_circuit_pipings][#{i+1}][id]", sp.id, :id => "suction_pipings_id_#{i+1}" %>
            </td>
            <td><%= select_tag "hydraulic_turbine[hydraulic_turbine_circuit_pipings][#{i+1}][fitting]", options_for_select(PipeSizing.fitting.collect { |p| [raw(p[:value]), p[:id]] }.insert(0, ''), sp.fitting), :id => "suction_pipings_fitting_#{i+1}", :style => "width:200px;" %></td>
            <td><%= text_field_tag "hydraulic_turbine[hydraulic_turbine_circuit_pipings][#{i+1}][fitting_tag]", sp.fitting_tag, :id => "suction_pipings_fitting_tag_#{i+1}" %></td>
            <td><%= select_tag "hydraulic_turbine[hydraulic_turbine_circuit_pipings][#{i+1}][pipe_size]", options_for_select(PipeSizing.pipe_sizes.collect { |p| [raw(p[:name]), p[:value]] }.insert(0, ''), sp.pipe_size), :id => "suction_pipings_pipe_size_#{i+1}", :class => "suction_pipings_pipe_size", :row_id => "#{i+1}" %></td>
            <td><%= select_tag "hydraulic_turbine[hydraulic_turbine_circuit_pipings][#{i+1}][pipe_schedule]", options_for_select(PipeSizing.pipe_size_schedules[sp.pipe_size.to_s], sp.pipe_schedule), :id => "suction_pipings_pipe_schedule_#{i+1}", :class => "suction_pipings_pipe_schedule", :row_id => "#{i+1}" %></td>
            <td><%= text_field_tag "hydraulic_turbine[hydraulic_turbine_circuit_pipings][#{i+1}][pipe_id]", sp.pipe_id, :id => "suction_pipings_pipe_id_#{i+1}", :class => "length_pipe_tube_diameter" %></td>
            <td><%= text_field_tag "hydraulic_turbine[hydraulic_turbine_circuit_pipings][#{i+1}][per_flow]", sp.per_flow, :id => "suction_pipings_per_flow_#{i+1}" %></td>
            <td><%= text_field_tag "hydraulic_turbine[hydraulic_turbine_circuit_pipings][#{i+1}][ds_cv]", sp.ds_cv, :id => "suction_pipings_ds_cv_#{i+1}" %></td>
            <td><%= text_field_tag "hydraulic_turbine[hydraulic_turbine_circuit_pipings][#{i+1}][length]", sp.length, :id => "suction_pipings_length_#{i+1}", :class => "length_large_dimension_length" %></td>
            <td><%= text_field_tag "hydraulic_turbine[hydraulic_turbine_circuit_pipings][#{i+1}][elev]", sp.elev, :id => "suction_pipings_elev_#{i+1}", :class => "length_large_dimension_length" %></td>
            <td class="delta_p_maximum"><%= text_field_tag "hydraulic_turbine[hydraulic_turbine_circuit_pipings][#{i+1}][delta_p_max]", sp.delta_p_max, :id => "suction_pipings_delta_p_max_#{i+1}", :class => "pressure_differential" %></td>
            <td class="delta_p_normal"><%= text_field_tag "hydraulic_turbine[hydraulic_turbine_circuit_pipings][#{i+1}][delta_p_nor]", sp.delta_p_nor, :id => "suction_pipings_delta_p_nor_#{i+1}", :class => "pressure_differential" %></td>
            <td class="delta_p_minimum"><%= text_field_tag "hydraulic_turbine[hydraulic_turbine_circuit_pipings][#{i+1}][delta_p_min]", sp.delta_p_min, :id => "suction_pipings_delta_p_min_#{i+1}", :class => "pressure_differential" %></td>
            <td><%= text_field_tag "hydraulic_turbine[hydraulic_turbine_circuit_pipings][#{i+1}][outlet_pressure]", sp.outlet_pressure, :id => "suction_pipings_outlet_pressure_#{i+1}", :class => "pressure_general" %></td>
            <td><%= link_to "X", "#", :class => "hydraulic_turbine_circuit_pipings_close_tr", :suction_piping_id => "#{i+1}" %></td>
          </tr>
        <% end %>
        <% if hydraulic_turbine.hydraulic_turbine_circuit_pipings.empty? %>
          <tr>
            <td>
              1
              <%= hidden_field_tag "hydraulic_turbine[hydraulic_turbine_circuit_pipings][1][id]", "", :id => "suction_pipings_id_1" %>
            </td>
            <td><%= select_tag "hydraulic_turbine[hydraulic_turbine_circuit_pipings][1][fitting]", options_for_select(PipeSizing.fitting.collect { |p| [raw(p[:value]), p[:id]] }.insert(0, '')), :id => "suction_pipings_fitting_1", :style => "width:200px;" %></td>
            <td><%= text_field_tag "hydraulic_turbine[hydraulic_turbine_circuit_pipings][1][fitting_tag]", "", :id => "suction_pipings_fitting_tag_1" %></td>
            <td><%= select_tag "hydraulic_turbine[hydraulic_turbine_circuit_pipings][1][pipe_size]", options_for_select(PipeSizing.pipe_sizes.collect { |p| [raw(p[:name]), p[:value]] }.insert(0, '')), :id => "suction_pipings_pipe_size_1", :class => "suction_pipings_pipe_size", :row_id => "1" %></td>
            <td><%= select_tag "hydraulic_turbine[hydraulic_turbine_circuit_pipings][1][pipe_schedule]", options_for_select([]), :id => "suction_pipings_pipe_schedule_1", :class => "suction_pipings_pipe_schedule", :row_id => "1" %></td>
            <td><%= text_field_tag "hydraulic_turbine[hydraulic_turbine_circuit_pipings][1][pipe_id]", "", :id => "suction_pipings_pipe_id_1", :class => "length_pipe_tube_diameter" %></td>
            <td><%= text_field_tag "hydraulic_turbine[hydraulic_turbine_circuit_pipings][1][per_flow]", "", :id => "suction_pipings_per_flow_1" %></td>
            <td><%= text_field_tag "hydraulic_turbine[hydraulic_turbine_circuit_pipings][1][ds_cv]", "", :id => "suction_pipings_ds_cv_1" %></td>
            <td><%= text_field_tag "hydraulic_turbine[hydraulic_turbine_circuit_pipings][1][length]", "", :id => "suction_pipings_length_1", :class => "length_large_dimension_length" %></td>
            <td><%= text_field_tag "hydraulic_turbine[hydraulic_turbine_circuit_pipings][1][elev]", "", :id => "suction_pipings_elev_1", :class => "length_large_dimension_length" %></td>
            <td class="delta_p_maximum"><%= text_field_tag "hydraulic_turbine[hydraulic_turbine_circuit_pipings][1][delta_p_max]", "", :id => "suction_pipings_delta_p_max_1", :class => "pressure_differential" %></td>
            <td class="delta_p_normal"><%= text_field_tag "hydraulic_turbine[hydraulic_turbine_circuit_pipings][1][delta_p_nor]", "", :id => "suction_pipings_delta_p_nor_1", :class => "pressure_differential" %></td>
            <td class="delta_p_minimum"><%= text_field_tag "hydraulic_turbine[hydraulic_turbine_circuit_pipings][1][delta_p_min]", "", :id => "suction_pipings_delta_p_min_1", :class => "pressure_differential" %></td>
            <td><%= text_field_tag "hydraulic_turbine[hydraulic_turbine_circuit_pipings][1][outlet_pressure]", "", :id => "suction_pipings_outlet_pressure_1", :class => "pressure_general" %></td>
            <td><%= link_to "X", "#", :class => "hydraulic_turbine_circuit_pipings_close_tr", :suction_piping_id => 1 %></td>
          </tr>
        <% end %>
      </table>
      <br>
      <%= link_to "Add", "#", :id => "add_new_suction_piping" %>&nbsp;|&nbsp;<%= link_to "Close", "#", :id => "close_suction_piping" %>
      <!-- new suction piping tr-->
      <table id="new_suction_piping_tr" class="hidden">
        <tr>
          <td>
            #x#
            <%= hidden_field_tag "hydraulic_turbine[hydraulic_turbine_circuit_pipings][#x#][id]", "", :id => "suction_pipings_id_#x#" %>
          </td>
          <td><%= select_tag "hydraulic_turbine[hydraulic_turbine_circuit_pipings][#x#][fitting]", options_for_select(PipeSizing.fitting.collect { |p| [raw(p[:value]), p[:id]] }.insert(0, '')), :id => "suction_pipings_fitting_#x#", :style => "width:200px;" %></td>
          <td><%= text_field_tag "hydraulic_turbine[hydraulic_turbine_circuit_pipings][#x#][fitting_tag]", "", :id => "suction_pipings_fitting_tag_#x#" %></td>
          <td><%= select_tag "hydraulic_turbine[hydraulic_turbine_circuit_pipings][#x#][pipe_size]", options_for_select(PipeSizing.pipe_sizes.collect { |p| [raw(p[:name]), p[:value]] }.insert(0, '')), :id => "suction_pipings_pipe_size_#x#", :class => "suction_pipings_pipe_size", :row_id => "#x#" %></td>
          <td><%= select_tag "hydraulic_turbine[hydraulic_turbine_circuit_pipings][#x#][pipe_schedule]", options_for_select([]), :id => "suction_pipings_pipe_schedule_#x#", :class => "suction_pipings_pipe_schedule", :row_id => "#x#" %></td>
          <td><%= text_field_tag "hydraulic_turbine[hydraulic_turbine_circuit_pipings][#x#][pipe_id]", "", :id => "suction_pipings_pipe_id_#x#", :class => "length_pipe_tube_diameter" %></td>
          <td><%= text_field_tag "hydraulic_turbine[hydraulic_turbine_circuit_pipings][#x#][per_flow]", "", :id => "suction_pipings_per_flow_#x#" %></td>
          <td><%= text_field_tag "hydraulic_turbine[hydraulic_turbine_circuit_pipings][#x#][ds_cv]", "", :id => "suction_pipings_ds_cv_#x#" %></td>
          <td><%= text_field_tag "hydraulic_turbine[hydraulic_turbine_circuit_pipings][#x#][length]", "", :id => "suction_pipings_length_#x#", :class => "length_large_dimension_length" %></td>
          <td><%= text_field_tag "hydraulic_turbine[hydraulic_turbine_circuit_pipings][#x#][elev]", "", :id => "suction_pipings_elev_#x#", :class => "length_large_dimension_length" %></td>
          <td class="delta_p_maximum"><%= text_field_tag "hydraulic_turbine[hydraulic_turbine_circuit_pipings][#x#][delta_p_max]", "", :id => "suction_pipings_delta_p_max_#x#", :class => "pressure_differential" %></td>
          <td class="delta_p_normal"><%= text_field_tag "hydraulic_turbine[hydraulic_turbine_circuit_pipings][#x#][delta_p_nor]", "", :id => "suction_pipings_delta_p_nor_#x#", :class => "pressure_differential" %></td>
          <td class="delta_p_minimum"><%= text_field_tag "hydraulic_turbine[hydraulic_turbine_circuit_pipings][#x#][delta_p_min]", "", :id => "suction_pipings_delta_p_min_#x#", :class => "pressure_differential" %></td>
          <td><%= text_field_tag "hydraulic_turbine[hydraulic_turbine_circuit_pipings][#x#][outlet_pressure]", "", :id => "suction_pipings_outlet_pressure_#x#", :class => "pressure_general" %></td>
          <td><%= link_to "X", "#", :class => "hydraulic_turbine_circuit_pipings_close_tr", :suction_piping_id => 0 %></td>
        </tr>
      </table>
    </div>
  </div>

  <!-- DISCHARGE CIRCUIT PIPING -->
  <div style="display:none;" id="discharge_circuit_piping_div">
    <div id="discharge_circuit_piping_box_#x#">
      <div class="discharge_circuit_piping_basis" style="font-weight:bold;font-size: 16px;">

      </div>
      <table class="discharge_circuit_piping_table">
        <tr>
          <th rowspan="2">No.</th>
          <th rowspan="2">Fitting(s)</th>
          <th rowspan="2">Fitting Tag</th>
          <th>Pipe Size</th>
          <th rowspan="2">Pipe Sch.</th>
          <th>Pipe ID</th>
          <th rowspan="2">% Flow</th>
          <th rowspan="2">Ds/Dl<br>or Cv</th>
          <th>Length</th>
          <th>Elev.</th>
          <th class="discharge_delta_p_maximum">&Delta;P</th>
          <th class="discharge_delta_p_normal">&Delta;P</th>
          <th class="discharge_delta_p_minimum">&Delta;P</th>
          <th>Inlet Pressure</th>
          <th rowspan="2"></th>
        </tr>
        <tr>
          <th>inches</th>
          <th><label class="length_pipe_tube_diameter_unit"></label></th>
          <th><label class="length_large_dimension_length_unit"></label></th>
          <th><label class="length_large_dimension_length_unit"></label></th>
          <th class="discharge_delta_p_maximum"><label class="pressure_differential_unit"></label></th>
          <th class="discharge_delta_p_normal"><label class="pressure_differential_unit"></label></th>
          <th class="discharge_delta_p_minimum"><label class="pressure_differential_unit"></label></th>
          <th><label class="pressure_general_unit"></label></th>
        </tr>
        <tr>
          <td>
            1
            <%= hidden_field_tag "hydraulic_turbine[discharge_maximum][#x#][hydraulic_discharge_circuit_pipings][1][id]", "", :id => "discharge_circuit_piping_id_1" %>
          </td>
          <td><%= select_tag "hydraulic_turbine[discharge_maximum][#x#][hydraulic_discharge_circuit_pipings][1][fitting]", options_for_select(PipeSizing.fitting.collect { |p| [raw(p[:value]), p[:id]] }.insert(0, '')), :id => "discharge_circuit_piping_fitting_1", :style => "width:200px;" %></td>
          <td><%= text_field_tag "hydraulic_turbine[discharge_maximum][#x#][hydraulic_discharge_circuit_pipings][1][fitting_tag]", "", :id => "discharge_circuit_piping_fitting_tag_1" %></td>
          <td><%= select_tag "hydraulic_turbine[discharge_maximum][#x#][hydraulic_discharge_circuit_pipings][1][pipe_size]", options_for_select(PipeSizing.pipe_sizes.collect { |p| [raw(p[:name]), p[:value]] }.insert(0, '')), :id => "discharge_circuit_piping_pipe_size_1", :class => "discharge_circuit_piping_pipe_size", :row_id => "1" %></td>
          <td><%= select_tag "hydraulic_turbine[discharge_maximum][#x#][hydraulic_discharge_circuit_pipings][1][pipe_schedule]", options_for_select([]), :id => "discharge_circuit_piping_pipe_schedule_1", :class => "discharge_circuit_piping_pipe_schedule", :row_id => "1" %></td>
          <td><%= text_field_tag "hydraulic_turbine[discharge_maximum][#x#][hydraulic_discharge_circuit_pipings][1][pipe_id]", "", :id => "discharge_circuit_piping_pipe_id_1", :class => "length_pipe_tube_diameter", :row_id => "1" %></td>
          <td><%= text_field_tag "hydraulic_turbine[discharge_maximum][#x#][hydraulic_discharge_circuit_pipings][1][per_flow]", "", :id => "discharge_circuit_piping_per_flow_1" %></td>
          <td><%= text_field_tag "hydraulic_turbine[discharge_maximum][#x#][hydraulic_discharge_circuit_pipings][1][ds_cv]", "", :id => "discharge_circuit_piping_ds_cv_1" %></td>
          <td><%= text_field_tag "hydraulic_turbine[discharge_maximum][#x#][hydraulic_discharge_circuit_pipings][1][length]", "", :id => "discharge_circuit_piping_length_1", :class => "length_large_dimension_length", :row_id => "1" %></td>
          <td><%= text_field_tag "hydraulic_turbine[discharge_maximum][#x#][hydraulic_discharge_circuit_pipings][1][elev]", "", :id => "discharge_circuit_piping_elev_1", :class => "length_large_dimension_length", :row_id => "1" %></td>
          <td class="discharge_delta_p_maximum"><%= text_field_tag "hydraulic_turbine[discharge_maximum][#x#][hydraulic_discharge_circuit_pipings][1][delta_p_max]", "", :id => "discharge_circuit_piping_delta_p_max_1", :class => "pressure_differential", :row_id => "1" %></td>
          <td class="discharge_delta_p_normal"><%= text_field_tag "hydraulic_turbine[discharge_maximum][#x#][hydraulic_discharge_circuit_pipings][1][delta_p_nor]", "", :id => "discharge_circuit_piping_delta_p_nor_1", :class => "pressure_differential", :row_id => "1" %></td>
          <td class="discharge_delta_p_minimum"><%= text_field_tag "hydraulic_turbine[discharge_maximum][#x#][hydraulic_discharge_circuit_pipings][1][delta_p_min]", "", :id => "discharge_circuit_piping_delta_p_min_1", :class => "pressure_differential", :row_id => "1" %></td>
          <td><%= label_tag "inlet_pressure", "", :class => "pressure_general" %></td>
          <td><%= link_to "X", "#", :class => "discharge_circuit_piping_close_tr", :row_id => 1 %></td>
        </tr>
      </table>

      <%= link_to "Add More", "#", :class => "discharge_circuit_piping_add_more", :table_id => "#x#" %>&nbsp;|&nbsp;<%= link_to "Close", "#", :class => "discharge_circuit_piping_close" %>
    </div>

    <table id="discharge_circuit_pipings_tr">
      <tr>
        <td>
          #y#
          <%= hidden_field_tag "hydraulic_turbine[discharge_maximum][#x#][hydraulic_discharge_circuit_pipings][#y#][id]", "", :id => "discharge_circuit_piping_id_#y#" %>
        </td>
        <td><%= select_tag "hydraulic_turbine[discharge_maximum][#x#][hydraulic_discharge_circuit_pipings][#y#][fitting]", options_for_select(PipeSizing.fitting.collect { |p| [raw(p[:value]), p[:id]] }.insert(0, '')), :id => "discharge_circuit_piping_fitting_#y#", :style => "width:200px;" %></td>
        <td><%= text_field_tag "hydraulic_turbine[discharge_maximum][#x#][hydraulic_discharge_circuit_pipings][#y#][fitting_tag]", "", :id => "discharge_circuit_piping_fitting_tag_#y#" %></td>
        <td><%= select_tag "hydraulic_turbine[discharge_maximum][#x#][hydraulic_discharge_circuit_pipings][#y#][pipe_size]", options_for_select(PipeSizing.pipe_sizes.collect { |p| [raw(p[:name]), p[:value]] }.insert(0, '')), :id => "discharge_circuit_piping_pipe_size_#y#", :class => "discharge_circuit_piping_pipe_size", :row_id => "#y#" %></td>
        <td><%= select_tag "hydraulic_turbine[discharge_maximum][#x#][hydraulic_discharge_circuit_pipings][#y#][pipe_schedule]", options_for_select([]), :id => "discharge_circuit_piping_pipe_schedule_#y#", :class => "discharge_circuit_piping_pipe_schedule", :row_id => "#y#" %></td>
        <td><%= text_field_tag "hydraulic_turbine[discharge_maximum][#x#][hydraulic_discharge_circuit_pipings][#y#][pipe_id]", "", :id => "discharge_circuit_piping_pipe_id_#y#", :class => "length_pipe_tube_diameter", :row_id => "#y#" %></td>
        <td><%= text_field_tag "hydraulic_turbine[discharge_maximum][#x#][hydraulic_discharge_circuit_pipings][#y#][per_flow]", "", :id => "discharge_circuit_piping_per_flow_#y#" %></td>
        <td><%= text_field_tag "hydraulic_turbine[discharge_maximum][#x#][hydraulic_discharge_circuit_pipings][#y#][ds_cv]", "", :id => "discharge_circuit_piping_ds_cv_#y#" %></td>
        <td><%= text_field_tag "hydraulic_turbine[discharge_maximum][#x#][hydraulic_discharge_circuit_pipings][#y#][length]", "", :id => "discharge_circuit_piping_length_#y#", :class => "length_large_dimension_length", :row_id => "#y#" %></td>
        <td><%= text_field_tag "hydraulic_turbine[discharge_maximum][#x#][hydraulic_discharge_circuit_pipings][#y#][elev]", "", :id => "discharge_circuit_piping_elev_#y#", :class => "length_large_dimension_length", :row_id => "#y#" %></td>
        <td class="discharge_delta_p_maximum"><%= text_field_tag "hydraulic_turbine[discharge_maximum][#x#][hydraulic_discharge_circuit_pipings][#y#][delta_p_max]", "", :id => "discharge_circuit_piping_delta_p_max_#y#", :class => "pressure_differential", :row_id => "#y#" %></td>
        <td class="discharge_delta_p_normal"><%= text_field_tag "hydraulic_turbine[discharge_maximum][#x#][hydraulic_discharge_circuit_pipings][#y#][delta_p_nor]", "", :id => "discharge_circuit_piping_delta_p_nor_#y#", :class => "pressure_differential", :row_id => "#y#" %></td>
        <td class="discharge_delta_p_minimum"><%= text_field_tag "hydraulic_turbine[discharge_maximum][#x#][hydraulic_discharge_circuit_pipings][#y#][delta_p_min]", "", :id => "discharge_circuit_piping_delta_p_min_#y#", :class => "pressure_differential", :row_id => "#y#" %></td>
        <td><%= label_tag "inlet_pressure", "", :class => "pressure_general" %></td>
        <td><%= link_to "X", "#", :class => "discharge_circuit_piping_close_tr", :row_id => "#y#" %></td>
      </tr>
    </table>
  </div>

  <!-- list of discharge circuit piping -->
  <div id="list_of_discharge_circuit_piping" style="display:none;">
    <% hydraulic_turbine.discharge_maximum.each_with_index do |hd, i| %>
      <% hd_row_id = i+1 %>
      <% if hd.hydraulic_discharge_circuit_pipings.empty? %>
        <% next %>
      <% end %>
      <div id="discharge_circuit_piping_box_<%= hd_row_id %>">
        <div class="discharge_circuit_piping_basis" style="font-weight:bold;font-size: 16px;">

        </div>
        <table class="discharge_circuit_piping_table">
          <tr>
            <th rowspan="2">No.</th>
            <th rowspan="2">Fitting(s)</th>
            <th rowspan="2">Fitting Tag</th>
            <th>Pipe Size</th>
            <th rowspan="2">Pipe Sch.</th>
            <th>Pipe ID</th>
            <th rowspan="2">% Flow</th>
            <th rowspan="2">Ds/Dl<br>or Cv</th>
            <th>Length</th>
            <th>Elev.</th>
            <th class="discharge_delta_p_maximum">&Delta;P</th>
            <th class="discharge_delta_p_normal">&Delta;P</th>
            <th class="discharge_delta_p_minimum">&Delta;P</th>
            <th>Inlet Pressure</th>
            <th rowspan="2"></th>
          </tr>
          <tr>
            <th>inches</th>
            <th><label class="length_pipe_tube_diameter_unit"></label></th>
            <th><label class="length_large_dimension_length_unit"></label></th>
            <th><label class="length_large_dimension_length_unit"></label></th>
            <th class="discharge_delta_p_maximum"><label class="pressure_differential_unit"></label></th>
            <th class="discharge_delta_p_normal"><label class="pressure_differential_unit"></label></th>
            <th class="discharge_delta_p_minimum"><label class="pressure_differential_unit"></label></th>
            <th><label class="pressure_general"></label></th>
          </tr>
          <% hd.hydraulic_discharge_circuit_pipings.each_with_index do |dcp, j| %>
            <tr>
              <td>
                <%= j+1 %>
                <%= hidden_field_tag "hydraulic_turbine[discharge_maximum][#{hd_row_id}][hydraulic_discharge_circuit_pipings][#{j+1}][id]", dcp.id, :id => "discharge_circuit_piping_id_#{j+1}" %>
              </td>
              <td><%= select_tag "hydraulic_turbine[discharge_maximum][#{hd_row_id}][hydraulic_discharge_circuit_pipings][#{j+1}][fitting]", options_for_select(PipeSizing.fitting.collect { |p| [raw(p[:value]), p[:id]] }.insert(0, ''), dcp.fitting), :id => "discharge_circuit_piping_fitting_#{j+1}", :style => "width:200px;" %></td>
              <td><%= text_field_tag "hydraulic_turbine[discharge_maximum][#{hd_row_id}][hydraulic_discharge_circuit_pipings][#{j+1}][fitting_tag]", dcp.fitting_tag, :id => "discharge_circuit_piping_fitting_tag_#{j+1}" %></td>
              <td><%= select_tag "hydraulic_turbine[discharge_maximum][#{hd_row_id}][hydraulic_discharge_circuit_pipings][#{j+1}][pipe_size]", options_for_select(PipeSizing.pipe_sizes.collect { |p| [raw(p[:name]), p[:value]] }.insert(0, ''), dcp.pipe_size), :id => "discharge_circuit_piping_pipe_size_#{j+1}", :class => "discharge_circuit_piping_pipe_size", :row_id => "#{j+1}" %></td>
              <td><%= select_tag "hydraulic_turbine[discharge_maximum][#{hd_row_id}][hydraulic_discharge_circuit_pipings][#{j+1}][pipe_schedule]", options_for_select(PipeSizing.pipe_size_schedules[dcp.pipe_size.to_s], dcp.pipe_schedule), :id => "discharge_circuit_piping_pipe_schedule_#{j+1}", :class => "discharge_circuit_piping_pipe_schedule", :row_id => "#{j+1}" %></td>
              <td><%= text_field_tag "hydraulic_turbine[discharge_maximum][#{hd_row_id}][hydraulic_discharge_circuit_pipings][#{j+1}][pipe_id]", dcp.pipe_id, :id => "discharge_circuit_piping_pipe_id_#{j+1}", :class => "discharge_circuit_piping_pipe_id", :row_id => "#{j+1}" %></td>
              <td><%= text_field_tag "hydraulic_turbine[discharge_maximum][#{hd_row_id}][hydraulic_discharge_circuit_pipings][#{j+1}][per_flow]", dcp.per_flow, :id => "discharge_circuit_piping_per_flow_#{j+1}" %></td>
              <td><%= text_field_tag "hydraulic_turbine[discharge_maximum][#{hd_row_id}][hydraulic_discharge_circuit_pipings][#{j+1}][ds_cv]", dcp.ds_cv, :id => "discharge_circuit_piping_ds_cv_#{j+1}" %></td>
              <td><%= text_field_tag "hydraulic_turbine[discharge_maximum][#{hd_row_id}][hydraulic_discharge_circuit_pipings][#{j+1}][length]", dcp.length, :id => "discharge_circuit_piping_length_#{j+1}", :class => "discharge_circuit_piping_length", :row_id => "#{j+1}" %></td>
              <td><%= text_field_tag "hydraulic_turbine[discharge_maximum][#{hd_row_id}][hydraulic_discharge_circuit_pipings][#{j+1}][elev]", dcp.elev, :id => "discharge_circuit_piping_elev_#{j+1}", :class => "discharge_circuit_piping_elev", :row_id => "#{j+1}" %></td>
              <td class="discharge_delta_p_maximum"><%= text_field_tag "hydraulic_turbine[discharge_maximum][#{hd_row_id}][hydraulic_discharge_circuit_pipings][#{j+1}][delta_p_max]", dcp.delta_p_max, :id => "discharge_circuit_piping_delta_p_max_#{j+1}", :class => "discharge_circuit_piping_delta_p", :row_id => "#{j+1}" %></td>
              <td class="discharge_delta_p_normal"><%= text_field_tag "hydraulic_turbine[discharge_maximum][#{hd_row_id}][hydraulic_discharge_circuit_pipings][#{j+1}][delta_p_nor]", dcp.delta_p_nor, :id => "discharge_circuit_piping_delta_p_nor_#{j+1}", :class => "discharge_circuit_piping_delta_p", :row_id => "#{j+1}" %></td>
              <td class="discharge_delta_p_minimum"><%= text_field_tag "hydraulic_turbine[discharge_maximum][#{hd_row_id}][hydraulic_discharge_circuit_pipings][#{j+1}][delta_p_min]", dcp.delta_p_min, :id => "discharge_circuit_piping_delta_p_min_#{j+1}", :class => "discharge_circuit_piping_delta_p", :row_id => "#{j+1}" %></td>
              <td><%= label_tag "inlet_pressure", "", :class => "discharge_circuit_piping_inlet_pressure" %></td>
              <td><%= link_to "X", "#", :class => "discharge_circuit_piping_close_tr", :row_id => "#{j+1}" %></td>
            </tr>
          <% end %>
        </table>

        <%= link_to "Add More", "#", :class => "discharge_circuit_piping_add_more", :table_id => hd_row_id %>&nbsp;|&nbsp;<%= link_to "Close", "#", :class => "discharge_circuit_piping_close" %>
      </div>
    <% end %>
  </div>

<% end %>

<% unless hydraulic_turbine.new_record? %>
  <fieldset class="project" style="margin-top:15px;">
    <legend>Attachments</legend>
    <%= render :partial => "attachments/attachments", :locals => {:attachments => @attachments} %>
    <%= render :partial => "attachments/form", :locals => {:attachment => @new_attachment} %>
  </fieldset>
  <fieldset class="project" style="margin-top:15px;">
    <legend>Comments</legend>
    <%= render :partial => "comments/comments", :locals => {:comments => @comments} %>
    <%= render :partial => "comments/form", :locals => {:comment => @new_comment} %>
  </fieldset>
<% end %>

<%= javascript_tag do %>
  var hydraulic_turbine_id = "<%= hydraulic_turbine.id %>";
  var sp_suction_count = <%= hydraulic_turbine.hydraulic_turbine_circuit_pipings.empty? ? 2 : hydraulic_turbine.hydraulic_turbine_circuit_pipings.length+1 %>;
  var dmax_count = <%= hydraulic_turbine.discharge_maximum.empty? ? 2 : hydraulic_turbine.discharge_maximum.length+1 %>;
  var hprt_count = <%= hydraulic_turbine.hprt_datas.empty? ? 2 : hydraulic_turbine.hprt_datas.length+1 %>;

  var pipe_size_schedules = <%= raw PipeSizing.pipe_size_schedules.to_json %>;
  var pipe_size_pipe_ods = <%= raw PipeSizing.pipe_size_pipe_od.to_json %>;
  var pipe_size_wall_thinkness = <%= raw PipeSizing.pipe_size_wall_thinkness.to_json %>;
  var pipe_id_conversion_factor = <%= @project.conversion_factor("Length", "Pipe Tube Diameter") %>;

  $('.delta_p_maximum, .delta_p_normal, .delta_p_minimum').hide();
  $('.discharge_delta_p_maximum, .discharge_delta_p_normal, .discharge_delta_p_minimum').hide();

  <% if hydraulic_turbine.new_record? %>
    $('.htd_tap_efficiency').val(<%= @project.hydraulic_power_recovery_turbine_efficiency.to_s %>);
  <% else %>
    var suction_condition_basis = "<%= hydraulic_turbine.su_suction_condition_basis %>";
    $('.upstream_coditions_table, .suction_loss_table').hide();
    $('#upstream_conditions_'+suction_condition_basis).show();
    $('#suction_loss_'+suction_condition_basis).show();

    var discharge_condition_basis = "<%= hydraulic_turbine.dc_discharge_condition_basis %>";
    $('.discharge_tables_div').hide();
    $('#discharge_'+discharge_condition_basis).show();
  <% end %>
<% end %>

<script type="text/javascript">

  set_project_unit_and_decimals();

  $('form.form_hydraulic_turbine').dirtyForms();

  $("ul.simple-tabs li a").click(function () {
    $('#tab').val($(this).attr('tab'));
  });

  function form_validations() {
    var alert_msg = '';

    if (alert_msg != '') {
      alert(alert_msg);
      return false;
    } else {
      return true;
    }
  }

  //validation
  $('.form_hydraulic_turbine').submit(function (e) {
    var alert_msg = '';

    //suction
    var suction_col = $('#upstream_condition_basis').val();
    var col = {maximum:'max', normal:'nor', minimum:'min'};
    if ($('#hydraulic_turbine_su_' + col[suction_col] + '_pressure').val() == '') {
      alert_msg = alert_msg + 'Please enter pressure.\n';
    }

    if (alert_msg != '') {
      alert(alert_msg);
      return false;
    }
  });

  $('#hydraulic_turbine_su_suction_condition_basis').change(function (e) {
    $('.upstream_coditions_table, .suction_loss_table').hide();
    $('#upstream_conditions_' + $(this).val()).show().find('td').glow('', 5000);
    $('#suction_loss_' + $(this).val()).show().find('td').glow('', 5000);
  });

  $('#hydraulic_turbine_su_process_basis_id').change(function (e) {
    $('#hydraulic_turbine_su_max_stream_no >option, #hydraulic_turbine_su_nor_stream_no >option, #hydraulic_turbine_su_min_stream_no >option').remove();
    $('#hydraulic_turbine_su_max_stream_no,#hydraulic_turbine_su_nor_stream_no,#hydraulic_turbine_su_min_stream_no').append($('<option></option>').val("").html("Please select"));
    $("#tab1 table input[type=text]").val('');
    if ($(this).val() == "") {
      return false;
    }

    $.get('/admin/heat_and_material_balances/get_stream_nos', {process_basis_id:$(this).val()}, function (data) {
      $(data).each(function (k, v) {
        $('#hydraulic_turbine_su_max_stream_no,#hydraulic_turbine_su_nor_stream_no,#hydraulic_turbine_su_min_stream_no').append(
          $('<option></option>').val(v.stream_no).html(v.display_stream_no)
        );
      });
    }, 'json');
  });

  $('#hydraulic_turbine_su_max_stream_no').change(function (e) {
    if ($(this).val() == "") {
      return false;
    }

    $.get('/admin/hydraulic_turbines/get_stream_values',
      {process_basis_id:$('#hydraulic_turbine_su_process_basis_id').val(), stream_no:$('#hydraulic_turbine_su_max_stream_no').val()},
      function (data) {
        $('#hydraulic_turbine_su_max_pressure').val(get_project_field_value1('pressure_general', data["pressure_value"]));
        $('#hydraulic_turbine_su_max_temperature').val(get_project_field_value1('temperature_general', data["temperature_value"]));
        $('#hydraulic_turbine_su_max_mass_vapor_fraction').val(get_project_field_value1('mass_vapor_fraction_dimensionless',data['mass_vapour_fraction']));
        $('#hydraulic_turbine_su_max_mass_flow_rate').val(get_project_field_value1('mass_flow_rate_general', data["mass_flow_rate_value"]));
        $('#hydraulic_turbine_su_max_density').val(get_project_field_value1('density_general', data["vapor_density_value"]));
        $('#hydraulic_turbine_su_max_viscosity').val(get_project_field_value1('viscosity_dynamic', data["vapor_viscosity_value"]));
      },
      'json');
  });

  $('#hydraulic_turbine_su_nor_stream_no').change(function (e) {
    if ($(this).val() == "") {
      return false;
    }

    $.get('/admin/hydraulic_turbines/get_stream_values',
      {process_basis_id:$('#hydraulic_turbine_su_process_basis_id').val(), stream_no:$('#hydraulic_turbine_su_nor_stream_no').val()},
      function (data) {
        $('#hydraulic_turbine_su_nor_pressure').val(get_project_field_value1('pressure_general', data["pressure_value"]));
        $('#hydraulic_turbine_su_nor_temperature').val(get_project_field_value1('temperature_general', data["temperature_value"]));
        $('#hydraulic_turbine_su_nor_mass_vapor_fraction').val(get_project_field_value1('mass_vapor_fraction_dimensionless',data['mass_vapour_fraction']));
        $('#hydraulic_turbine_su_nor_mass_flow_rate').val(get_project_field_value1('mass_flow_rate_general', data["mass_flow_rate_value"]));
        $('#hydraulic_turbine_su_nor_density').val(get_project_field_value1('density_general', data["vapor_density_value"]));
        $('#hydraulic_turbine_su_nor_viscosity').val(get_project_field_value1('viscosity_dynamic', data["vapor_viscosity_value"]));
      },
      'json');
  });

  $('#hydraulic_turbine_su_min_stream_no').change(function (e) {
    if ($(this).val() == "") {
      return false;
    }

    $.get('/admin/hydraulic_turbines/get_stream_values',
      {process_basis_id:$('#hydraulic_turbine_su_process_basis_id').val(), stream_no:$('#hydraulic_turbine_su_min_stream_no').val()},
      function (data) {
        $('#hydraulic_turbine_su_min_pressure').val(get_project_field_value1('pressure_general', data["pressure_value"]));
        $('#hydraulic_turbine_su_min_temperature').val(get_project_field_value1('temperature_general', data["temperature_value"]));
        $('#hydraulic_turbine_su_min_mass_vapor_fraction').val(data['mass_vapour_fraction']);
        $('#hydraulic_turbine_su_min_mass_flow_rate').val(get_project_field_value1('mass_flow_rate_general', data["mass_flow_rate_value"]));
        $('#hydraulic_turbine_su_min_density').val(get_project_field_value1('density_general', data["vapor_density_value"]));
        $('#hydraulic_turbine_su_min_viscosity').val(get_project_field_value1('viscosity_dynamic', data["vapor_viscosity_value"]));
      },
      'json');
  });

  //suction piping
  $('#enter_circuit_piping').click(function (e) {
    $.colorbox({
      href:'#suction_piping_box',
      inline:true,
      width:'100%',
      height:'100%',
      onOpen:function () {
        $('#suction_piping_basis').text($('#hydraulic_turbine_su_suction_condition_basis option:selected').text());
        $('.delta_p_' + $('#hydraulic_turbine_su_suction_condition_basis').val()).show();
      },
      onClosed:function () {
        $('.delta_p_' + $('#hydraulic_turbine_su_suction_condition_basis').val()).hide();
      }
    });
  });

  $('#add_new_suction_piping').click(function (e) {
    var new_suction_piping_tr = $('#new_suction_piping_tr').html().replace(/#x#/g, sp_suction_count);
    $('#suction_piping_table').append($(new_suction_piping_tr));
    sp_suction_count++;
    set_project_unit_decimal1('length_pipe_tube_diameter');
    set_project_unit_decimal1('length_large_dimension_length');
    set_project_unit_decimal1('pressure_differential');
    set_project_unit_decimal1('pressure_general');
    return false;
  });

  $('#close_suction_piping').click(function (e) {
    $.colorbox.close();
    return false;
  });

  $('.hydraulic_turbine_circuit_pipings_close_tr').live('click', function (e) {
    $('#suction_pipings_fitting_' + $(this).attr('suction_piping_id')).val('');
    deleted_tr($(this).parents('tr'));
    return false;
  });

  //discharges
  //Downstream tab
  $('#hydraulic_turbine_dc_discharge_condition_basis').change(function (e) {
    $('.discharge_tables_div').hide();
    $('#discharge_' + $(this).val()).show().find('td').glow('', 4000);
  });

  $('.add_new_discharge_row').click(function (e) {
    var new_discharge_maximum_row = $('#new_discharge_maximum_row').html().replace(/#x#/g, dmax_count);
    $('#hydraulic_discharges_maximum_table').append($(new_discharge_maximum_row));

    var new_discharge_normal_row = $('#new_discharge_normal_row').html().replace(/#x#/g, dmax_count);
    $('#hydraulic_discharges_normal_table').append($(new_discharge_normal_row));

    var new_discharge_minimum_row = $('#new_discharge_minimum_row').html().replace(/#x#/g, dmax_count);
    $('#hydraulic_discharges_minimum_table').append($(new_discharge_minimum_row));

    set_project_unit_decimal1('pressure_general');
    set_project_unit_decimal1('pressure_differential');

    dmax_count++;
    return false;
  });

  $('.discharge_table_close_tr').live('click', function (e) {
    var row_id = $(this).attr('row_id');
    $('#dmax_discharges_delete_' + row_id).val('true');
    $('#dnor_discharges_delete_' + row_id).val('true');
    $('#dmin_discharges_delete_' + row_id).val('true');
    deleted_tr($('#dmax_discharges_delete_' + row_id).parents('tr'));
    deleted_tr($('#dnor_discharges_delete_' + row_id).parents('tr'));
    deleted_tr($('#dmin_discharges_delete_' + row_id).parents('tr'));
    return false;
  });

  $('#hydraulic_discharges input[name=design_circuit]').live('click', function (e) {
    $("input[id^=discharge_design_circuit_]").val("");
    $('#discharge_design_circuit_' + $(this).val()).val(true);
  });

  $('select[id^="dmax_discharge_process_basis_id_"]').live('change', function (e) {
    var row_id = $(this).attr('row_id');
    $('#dmax_discharge_destination_stream_no_' + row_id + ' >option').remove();
    $('#dmax_discharge_destination_stream_no_' + row_id).append($('<option></option>').val("").html(""));
    if ($(this).val() == "") {
      return false;
    }

    $.get('/admin/heat_and_material_balances/get_stream_nos',
      {process_basis_id:$(this).val()},
      function (data) {
        $(data).each(function (k, v) {
          $('#dmax_discharge_destination_stream_no_' + row_id).append(
            $('<option></option>').val(v.stream_no).html(v.display_stream_no)
          );
        });
      },
      'json'
    );
  });

  $('select[id^="dmax_discharge_destination_stream_no_"]').live('change', function (e) {
    var row_id = $(this).attr('row_id');
    $('#dmax_discharge_destination_pressure_' + row_id).val('');
    if ($(this).val() == "") {
      return false;
    }

    $.get('/admin/hydraulic_turbines/get_discharge_stream_nos',
      {process_basis_id:$('#dmax_discharge_process_basis_id_' + row_id).val(), stream_no:$(this).val()},
      function (data) {
        $('#dmax_discharge_destination_pressure_' + row_id).val(data['pressure']);
      },
      'json'
    );
  });

  $('select[id^="dnor_discharge_process_basis_id_"]').live('change', function (e) {
    var row_id = $(this).attr('row_id');
    $('#dnor_discharge_destination_stream_no_' + row_id + ' >option').remove();
    $('#dnor_discharge_destination_stream_no_' + row_id).append($('<option></option>').val("").html(""));
    if ($(this).val() == "") {
      return false;
    }

    $.get('/admin/heat_and_material_balances/get_stream_nos',
      {process_basis_id:$(this).val()},
      function (data) {
        $(data).each(function (k, v) {
          $('#dnor_discharge_destination_stream_no_' + row_id).append(
            $('<option></option>').val(v.stream_no).html(v.display_stream_no)
          );
        });
      },
      'json'
    );
  });

  $('select[id^="dnor_discharge_destination_stream_no_"]').live('change', function (e) {
    var row_id = $(this).attr('row_id');
    $('#dnor_discharge_destination_pressure_' + row_id).val('');
    if ($(this).val() == "") {
      return false;
    }

    $.get('/admin/hydraulic_turbines/get_discharge_stream_nos',
      {process_basis_id:$('#dnor_discharge_process_basis_id_' + row_id).val(), stream_no:$(this).val()},
      function (data) {
        $('#dnor_discharge_destination_pressure_' + row_id).val(data['pressure']);
      },
      'json'
    );
  });

  $('select[id^="dmin_discharge_process_basis_id_"]').live('change', function (e) {
    var row_id = $(this).attr('row_id');
    $('#dmin_discharge_destination_stream_no_' + row_id + ' >option').remove();
    $('#dmin_discharge_destination_stream_no_' + row_id).append($('<option></option>').val("").html(""));
    if ($(this).val() == "") {
      return false;
    }

    $.get('/admin/heat_and_material_balances/get_stream_nos',
      {process_basis_id:$(this).val()},
      function (data) {
        $(data).each(function (k, v) {
          $('#dmin_discharge_destination_stream_no_' + row_id).append(
            $('<option></option>').val(v.stream_no).html(v.display_stream_no)
          );
        });
      },
      'json'
    );
  });

  $('select[id^="dmin_discharge_destination_stream_no_"]').live('change', function (e) {
    var row_id = $(this).attr('row_id');
    $('#dmin_discharge_destination_pressure_' + row_id).val('');
    if ($(this).val() == "") {
      return false;
    }

    $.get('/admin/hydraulic_turbines/get_discharge_stream_nos',
      {process_basis_id:$('#dmin_discharge_process_basis_id_' + row_id).val(), stream_no:$(this).val()},
      function (data) {
        $('#dmin_discharge_destination_pressure_' + row_id).val(data['pressure']);
      },
      'json'
    );
  });

  //discharge_circuit_piping
  $('.circuit_piping_btn').live('click', function (e) {
    var row_id = $(this).attr('row_id');
    if ($('#discharge_circuit_piping_box_' + row_id).text() == "") {
      var discharge_circuit_piping_box = $('#discharge_circuit_piping_div').html().replace(/#x#/g, row_id);
      $('#list_of_discharge_circuit_piping').append($(discharge_circuit_piping_box));
    }
    $.colorbox({
      href:'#discharge_circuit_piping_box_' + row_id,
      inline:true,
      width:'100%',
      height:'100%',
      onOpen:function () {
        $('.discharge_circuit_piping_basis').text($('#hydraulic_turbine_dc_discharge_condition_basis option:selected').text());
        $('.discharge_delta_p_' + $('#hydraulic_turbine_dc_discharge_condition_basis').val()).show();
      },
      onClosed:function () {
        $('.discharge_delta_p_' + $('#hydraulic_turbine_dc_discharge_condition_basis').val()).hide();
      },
      onComplete:function () {
        var tr_row_id = parseInt($('#discharge_circuit_piping_box_' + row_id + ' table tr:last td:last a').attr('row_id')) + 1;
        $('#discharge_circuit_piping_box_' + row_id).data({tr_row_id:tr_row_id, discharge_row_id:row_id});
        return false;
      }
    });
    set_project_unit_decimal('.discharge_circuit_piping_pipe_id', unit_decimals);
    set_project_unit_decimal('.discharge_circuit_piping_length', unit_decimals);
    set_project_unit_decimal('.discharge_circuit_piping_elev', unit_decimals);
    set_project_unit_decimal('.discharge_circuit_piping_delta_p', unit_decimals);
    return false;
  });

  $('.discharge_circuit_piping_add_more').live('click', function (e) {
    var table_id = $(this).attr('table_id');
    var tr_row_id = $('#discharge_circuit_piping_box_' + table_id).data()['tr_row_id'];
    var new_discharge_circuit_pipings_tr = $('#discharge_circuit_pipings_tr').html().replace(/#x#/g, table_id);
    new_discharge_circuit_pipings_tr = new_discharge_circuit_pipings_tr.replace(/#y#/g, tr_row_id);
    $('#discharge_circuit_piping_box_' + table_id + ' table').append($(new_discharge_circuit_pipings_tr));
    $('#discharge_circuit_piping_box_' + table_id).data()['tr_row_id'] = tr_row_id + 1;
    set_project_unit_decimal('.discharge_circuit_piping_pipe_id', unit_decimals);
    set_project_unit_decimal('.discharge_circuit_piping_length', unit_decimals);
    set_project_unit_decimal('.discharge_circuit_piping_elev', unit_decimals);
    set_project_unit_decimal('.discharge_circuit_piping_delta_p', unit_decimals);
    return false;
  });

  $('.discharge_circuit_piping_close').live('click', function (e) {
    $.colorbox.close();
    return false;
  });

  $('.discharge_circuit_piping_close_tr').live('click', function (e) {
    $(this).parents('tr').find('#discharge_circuit_piping_fitting_' + $(this).attr('row_id')).val("");
    deleted_tr($(this).parents('tr'));
    return false;
  });

  //hprt
  $('#add_hprt_data').click(function (e) {
    var new_hprt_tr = $('#new_hprt_tr').html().replace(/#x#/g, hprt_count);
    $('#hprt_data_table').append($(new_hprt_tr));

    set_project_unit_decimal('.hprt_capacity', unit_decimals);
    set_project_unit_decimal('.hprt_system_loss', unit_decimals);
    hprt_count++;
    return false;
  });

  $('.hprt_close_tr').live('click', function (e) {
    $(this).closest('tr').find('#capacity_' + $(this).attr('row_id')).val("");
    deleted_tr($(this).parents('tr'));
    return false;
  });

  // Suction_piping
  $('.suction_pipings_pipe_size').live('change', function (k) {
    var row_id = $(this).attr('row_id');
    $('#suction_pipings_pipe_id_' + row_id).val('');
    $('#suction_pipings_pipe_schedule_' + row_id + '>option').remove();
    $('#suction_pipings_pipe_schedule_' + row_id).append($('<option></option>').val("").html(""));
    $(pipe_size_schedules[$(this).val()]).each(function (k, v) {
      $('#suction_pipings_pipe_schedule_' + row_id).append($('<option></option>').val(v).html(v));
    });
  });

  $('.suction_pipings_pipe_schedule').live('change', function (k) {
    var row_id = $(this).attr('row_id');
    $('#suction_pipings_pipe_id_' + row_id).val('');
    if ($(this).val() == '') {
      return false;
    }
    var pipe_od = pipe_size_pipe_ods[$('#suction_pipings_pipe_size_' + row_id).val()] / pipe_id_conversion_factor;
    var wall_thickness = pipe_size_wall_thinkness[$('#suction_pipings_pipe_size_' + row_id).val()][$(this).val()] / pipe_id_conversion_factor;
    var pipe_id = pipe_od - (2 * wall_thickness);
    $('#suction_pipings_pipe_id_' + row_id).val(get_project_field_value('.suction_pipings_pipe_id', pipe_id, unit_decimals));
  });


  // discharge_circuit_piping
  $('.discharge_circuit_piping_pipe_size').live('change', function (k) {
    var row_id = $(this).attr('row_id');
    $('#discharge_circuit_piping_pipe_id_' + row_id).val('');
    $('#discharge_circuit_piping_pipe_schedule_' + row_id + '>option').remove();
    $('#discharge_circuit_piping_pipe_schedule_' + row_id).append($('<option></option>').val("").html(""));
    $(pipe_size_schedules[$(this).val()]).each(function (k, v) {
      $('#discharge_circuit_piping_pipe_schedule_' + row_id).append($('<option></option>').val(v).html(v));
    });
  });


  $('.discharge_circuit_piping_pipe_schedule').live('change', function (k) {
    var row_id = $(this).attr('row_id');
    $('#discharge_circuit_piping_pipe_id_' + row_id).val('');
    if ($(this).val() == '') {
      return false;
    }
    var pipe_od = pipe_size_pipe_ods[$('#discharge_circuit_piping_pipe_size_' + row_id).val()] / pipe_id_conversion_factor;
    var wall_thickness = pipe_size_wall_thinkness[$('#discharge_circuit_piping_pipe_size_' + row_id).val()][$(this).val()] / pipe_id_conversion_factor;
    var pipe_id = pipe_od - (2 * wall_thickness);
    $('#discharge_circuit_piping_pipe_id_' + row_id).val(get_project_field_value('.discharge_circuit_piping_pipe_id', pipe_id, unit_decimals));
  });

  //Suction loss -- Calculate
  $('.suction_loss_calculation').click(function (e) {
    $('#tab').val($("ul.simple-tabs li.active a").attr('tab'));
    $('#calculate_btn').val('suction_loss_calculation');
    if (form_validations() == false) {
      return false;
    }
    if (hydraulic_turbine_id == "" || $('form.form_hydraulic_turbine').isDirty()) {
      $('form.form_hydraulic_turbine').submit();
      return false;
    }

    $.get('/admin/hydraulic_turbines/suction_calculation',
      {hydraulic_turbine_id:hydraulic_turbine_id},
      function (data) {
        alert('Calculation is completed successfully');
        window.location = location.pathname;
      },
      'json'
    ).error(function () {
        alert("error");
      });
    ;
  });

  //Hydraulic Turbine Design -- Design Turbine
  $('#btn_hydraulic_turbine_design').click(function (e) {
    var tab = $("ul.simple-tabs li.active a").attr('tab');
    $('#tab').val(tab);
    $('#calculate_btn').val('btn_hydraulic_turbine_design');

    if (!form_validations()) {
      return false;
    }
    if (hydraulic_turbine_id == "" || $('form.form_hydraulic_turbine').isDirty()) {
      $('form.form_hydraulic_turbine').submit();
      return false;
    }

    $.get("/admin/hydraulic_turbines/hydraulic_turbine_design",
      {hydraulic_turbine_id:hydraulic_turbine_id, tab:tab, calculate_btn:'btn_hydraulic_turbine_design'},
      function (data) {
        alert('Calculation is completed successfully');
        window.location = location.pathname;
      },
      'json'
    ).error(
      function () {
        alert("error");
      }
    );
  });

  $("input#suction_calculate").click(function () {
    $('#tab').val($("ul.simple-tabs li.active a").attr('tab'));
    $('#calculate_btn').val('suction_calculate');
    if (form_validations() == false) {
      return false;
    }
    if (hydraulic_turbine_id == "" || $('form.form_hydraulic_turbine').isDirty()) {
      $('form.form_hydraulic_turbine').submit();
      return false;
    }

    $.get("/admin/hydraulic_turbines/hprt_suctionside_hydraulics",
      {hydraulic_turbine_id:hydraulic_turbine_id},
      function (data) {
        alert('Calculation is completed successfully');
        window.location = location.pathname;
      },
      'json'
    ).error(
      function () {
        alert("error");
      }
    );
  });

  //Discharge calculate
  $('#discharge_calculate').click(function (e) {
    $('#tab').val($("ul.simple-tabs li.active a").attr('tab'));
    $('#calculate_btn').val('discharge_calculate');
    if (!form_validations()) {
      return false;
    }

    if (hydraulic_turbine_id == "" || $('form.form_hydraulic_turbine').isDirty()) {
      $('form.form_hydraulic_turbine').submit();
      return false;
    }

    $.get('/admin/hydraulic_turbines/hprt_dischargeside_hydraulics',
      {hydraulic_turbine_id:hydraulic_turbine_id},
      function (data) {
        alert('Calculation is completed successfully');
        window.location = location.pathname
      },
      'json'
    ).error(
      function () {
        alert('error');
      }
    );

  });

  //get equipment tag by equipment type
  $('#hydraulic_turbine_htd_red_equipment_type').change(function (e) {
    $('#hydraulic_turbine_htd_red_equipment_tag >option').remove();
    $('#hydraulic_turbine_htd_red_equipment_tag').append($('<option></option>').val('').html(''));
    if ($(this).val() == "") {
      return false;
    }
    $.get('/admin/hydraulic_turbines/get_equiment_tag_by_equiment_type',
      {project_id:$('#hydraulic_turbine_project_id').val(),
        equipment_type:$(this).val()},
      function (data) {
        $.each(data, function (k, v) {
          $('#hydraulic_turbine_htd_red_equipment_tag').append(
            $('<option></option>').val(v.id).html(v.tag)
          );
        });
      },
      'json'
    );
  });

  //get rotating equipment details
  $('#hydraulic_turbine_htd_red_equipment_tag').change(function (e) {
    if ($('#hydraulic_turbine_htd_red_equipment_type').val() == "" || $(this).val() == "") {
      alert('Select equipement type and equipment tag');
      return false;
    }

    $.get('/admin/hydraulic_turbines/get_rotating_equipment_details',
      {equipment_type:$('#hydraulic_turbine_htd_red_equipment_type').val(),
        equipment_tag:$(this).val()},
      function (data) {
        $('#hydraulic_turbine_htd_red_capacity').val(data['capacity']);
        $('#hydraulic_turbine_htd_red_differential_pressure').val(data['differential_pressure']);
        $('#hydraulic_turbine_htd_red_horsepower').val(data['horsepower']);
        $('#hydraulic_turbine_htd_red_speed').val(data['speed']);
      },
      'json'
    );
  });
</script>
<%= javascript_tag do %>
  //hit calculate button
  var calculate_btn = "<%= params[:calculate_btn] %>";
  if(calculate_btn == "suction_calculate") {
  $('#suction_calculate').trigger('click');
  } else if (calculate_btn == "suction_loss_calculation") {
  $('#suction_loss_calculation').trigger('click');
  } else if (calculate_btn == "discharge_calculate") {
  $('#discharge_calculate').trigger('click');
  } else if (calculate_btn == "btn_hydraulic_turbine_design") {
  $('#btn_hydraulic_turbine_design').trigger('click');
  }

<% end %>
