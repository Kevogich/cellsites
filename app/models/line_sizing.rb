class LineSizing < ActiveRecord::Base
  belongs_to :company
  belongs_to :client
  belongs_to :project
  belongs_to :process_unit
  belongs_to :sizing_criteria_category
  belongs_to :sizing_criteria_category_type
  belongs_to :sizing_criteria
  belongs_to :pipe
  has_many :pipe_sizings, :dependent => :destroy
  has_many :attachments, :as => :attachable, :dependent => :destroy
  has_many :sizing_status_activities, :as => :sizing, :dependent => :destroy

  #to store all the calculated results for 33 iterations in one blob
  serialize :calculated_results, Hash

  acts_as_commentable

  validates_presence_of :line_number, :project_id

  validates_presence_of :pressure, :temperature, :flowrate, :liquid_density, :liquid_viscosity, :liquid_mw, :liquid_surface_tension, :system_equivalent_length, :system_maximum_deltaP, :pipe_roughness, :if => Proc.new {|l| l.vapour_fraction == 0}

  validates_presence_of :pressure, :temperature, :flowrate, :vapor_density, :vapor_viscosity, :vapor_mw, :vapor_cp_cv, :vapor_z, :system_equivalent_length, :system_maximum_deltaP, :pipe_roughness, :if => Proc.new {|l| l.vapour_fraction == 1}


  #:process_unit_id, :description, :company_id, :stream_no, :process_basis_id, :flowrate, :pressure, :temperature, :vapour_fraction, :liquid_density, :liquid_viscosity, :vapor_density, :vapor_viscosity, :vapor_mw, :vapor_cp_cv, :vapor_z, :pipe_roughness, :pipe_id, :system_equivalent_length, :system_maximum_deltaP

  validates_numericality_of :liquid_density, :if => Proc.new {|l| l.vapour_fraction == 0}
  validates_numericality_of :vapor_density, :if => Proc.new {|l| l.vapour_fraction == 1}


  after_save :save_pipe_sizings

  #validates_format_of [:reviewer,:approver], :with => /^([^@\s]+)@((?:[-a-z0-9]+\.)+[a-z]{2,})$/i, :message => "should be vaild email."

  def downstream_vaporization
    {1 => "Significant", 2 => "Insignificant"}[downstream_vaporization_id]
  end

def pipe_sizings=(ps_params)
    @ps_params = ps_params
end

def save_pipe_sizings
    #raise @ps_params.to_yaml
    @ps_params.each do |i, ps_param|
      ps = pipe_sizings.where(:id => ps_param[:id]).first
      #raise ps_param.to_yaml
      pipe_sizings.create(ps_param) if ps.nil? && !ps_param[:fitting_id].blank? #create
      ps.delete if !ps.nil? && ps_param[:fitting_id].blank? #delete
      ps.update_attributes(ps_param) if !ps.nil? && !ps_param[:fitting_id].blank? #update
  end if !@ps_params.nil?
end

def get_stream_phase
    if self.vapour_fraction == 1
      stream_phase = "vapor"
  elsif self.vapour_fraction == 0
      stream_phase = "liquid";
  elsif self.vapour_fraction > 0 && self.vapour_fraction < 1
      stream_phase = "two-phase";
  end
end


  #convert values
  def convert_values(multiply_factor)

  end

  def target_two_phase_regime
   stream_flow_rate = self.flowrate
   wl = stream_flow_rate * (1 - self.vapour_fraction);
   wg = stream_flow_rate * self.vapour_fraction;
   pl = self.liquid_density
   pg = self.vapor_density
   ul = self.liquid_viscosity
   ol = self.vapor_viscosity

   bx = 531.0 * (wl / wg) * (((pl * pg) ** 0.5) / (pl ** (2.0 / 3.0))) * (ul ** (1.0 / 3.0) / ol)

   b = ""
   if bx >= 0.0 and bx < 0.75
    b =  "bx_range_1"
elsif  bx >= 0.75 and bx < 3.0
    b =  "bx_range_2"
elsif bx >= 3.0 and bx < 20.0
    b =  "bx_range_3"
elsif bx >= 20.0 and bx < 80.0
    b =  "bx_range_4"
elsif bx >= 80.0 and bx < 150.0
    b =  "bx_range_5"
elsif bx >= 150.0 and bx < 2200.0
    b = "bx_range_6"
elsif bx >= 2200.0 and bx < 10000.0
    b =  "bx_range_7"
end


default = nil
default = "Annular" if bx < 125
default = "Bubble/Froth" if bx >= 125.0

if b == ""
    return {:options => [], :default => default}
else
    return {:options => StaticData.send(b.to_sym).collect {|i| [i,i] }, :default => default}
end
end


def uom_mapping
    {
      :pressure                             => ['Pressure', 'General'],
      :vapour_fraction                      => ['Mass Vapor Fraction', 'Dimensionless'],
      :temperature                          => ['Temperature', 'General'],
      :flowrate                             => ['Mass Flow Rate', 'General'],
      :vapor_density                        => ['Density', 'General'],
      :vapor_viscosity                      => ['Viscosity', 'Dynamic'],
      :vapor_mw                             => ['Molecular Weight', 'Dimensionless'],
      :vapor_cp_cv                          => ['Specific Heat Capacity Ratio', 'Dimensionless'],
      :vapor_z                              => ['Compressiblity', 'Dimensionless'],
      :liquid_density                       => ['Density ', 'General'],
      :liquid_viscosity                     => ['Viscosity', 'Dynamic'],
      :liquid_surface_tension               => ['Surface Tension', 'General'],
      :liquid_mw                            => ['Molecular Weight', 'Dimensionless'],
      :system_equivalent_length             => ['Length', 'Large Dimension Length'],
      :system_maximum_deltaP                => ['Pressure', 'Differential'],
      :pipe_roughness                       => ['Length', 'Small Dimension Length'],
      :sc_required_id                       => ['Length', 'Small Dimension Length'],
      :sc_proposed_id                       => ['Length', 'Small Dimension Length'],
      :sc_pipe_size                         => ['Length', 'Small Dimension Length'],
      :sc_calculated_system_dp              => ['Pressure', 'Differential'],
      :sc_calculated_velocity               => ['Velocity', 'General'],
      :sc_system_equivalent_length          => ['Length', 'Large Dimension Length'],
      :sc_fluid_momentum                    => ['Fluid Momentum', 'General'],
      :dc_source_design_pressure            => ['Pressure', 'General'],
      :dc_source_design_temperature         => ['Temperature', 'General'],
      :dc_source_statice_frictional_dp      => ['Pressure', 'Differential'],
      :dc_destination_design_pressure       => ['Pressure', 'General'],
      :dc_destination_design_temperature    => ['Temperature', 'General'],
      :dc_destination_statice_frictional_dp => ['Pressure', 'Differential'],
      :dc_maximum_operating_pressure        => ['Pressure', 'General'],
      :dc_maximum_operating_temperature     => ['Temperature', 'General'],
      :dc_pressure_allowance                => ['Pressure', 'Differential'],
      :dc_temperature_allowance             => ['Temperature', 'General'],
      :dc_design_pressure                   => ['Pressure', 'General'],
      :dc_design_tempreature                => ['Temperature', 'General'],
      :dc_design_vaccum                     => ['Pressure', 'Absolute'],
      :dc_min_design_temperature            => ['Temperature', 'General'],
      :dc_spt_pipe_outer_diameter           => ['Length', 'Small Dimension Length'],
      :dc_spt_design_perssure               => ['Pressure', 'General'],
      :dc_spt_minimum_required_thickness    => ['Length', 'Small Dimension Length'],
      :dc_spt_pressure_required_thickness   => ['Length', 'Small Dimension Length'],
      :pipe_sizing_length                   => ['Length','Large Dimension Length'],
      :pipe_sizing_elevation                => ['Length','Large Dimension Length'],
      :pipe_sizing_p_outlet                 => ['Pressure','General']
  }
end


def convert_to_base_unit(att,value=nil)
    value = self.send(att) if value.nil?
    units = uom_mapping[att]

    if units[0] == 'Temperature'
      uom = self.project.get_uom_details(:mtype => units[0], :msub_type => units[1])
      converted = value.to_f.send(uom[:current_unit][:unit_name].downcase.to_sym).to.fahrenheit
  else
      cf = self.project.base_unit_cf(:mtype => units[0], :msub_type => units[1])
      converted = (value * cf[:factor]).round(cf[:decimals])
  end
rescue Exception => e
    converted = nil
else
    return converted
end


def convert_to_project_unit(att,value)
    units = uom_mapping[att]

    if units[0] == 'Temperature'
      uom = self.project.get_uom_details(:mtype => units[0], :msub_type => units[1])
      converted = value.to_f.fahrenheit.to.send(uom[:current_unit][:unit_name].downcase.to_sym)
  else
      cf = self.project.base_unit_cf(:mtype => units[0], :msub_type => units[1])
      converted = (value/cf[:factor]).round(cf[:decimals])
  end
  return converted
end

def large_flange_pressure_temperatre_rating(pressure,temperature,material_group,unit_type)
    if material_group == 1.1
        if temperature >= -20 and temperature <= 100
            if pressure < 140
              flange_class = "75"
              pressure_rating = 140
              temperature_rating = 100
          elsif pressure > 140 and pressure <= 285
              flange_class = "150"
              pressure_rating = 285
              temperature_rating = 100
          elsif pressure > 285 and pressure <= 740
              flange_class = "300"
              pressure_rating = 740
              temperature_rating = 100
          elsif pressure > 740 and pressure <= 985
              flange_class = "400"
              pressure_rating = 985
              temperature_rating = 100
          elsif pressure > 985 and pressure <= 1480
              flange_class = "600"
              pressure_rating = 1480
              temperature_rating = 100
          elsif pressure > 1480 and pressure <= 2220
              flange_class = "900"
              pressure_rating = 2220
              temperature_rating = 100
          end
      elsif temperature > 100 and temperature <= 200
        if pressure < 130 
          flange_class = "75"
          pressure_rating = 130
          temperature_rating = 200
      elsif pressure > 130 and pressure <= 260
          flange_class = "150"
          pressure_rating = 260
          temperature_rating = 200
      elsif pressure > 260 and pressure <= 680
          flange_class = "300"
          pressure_rating = 680
          temperature_rating = 200
      elsif pressure > 680 and pressure <= 905
          flange_class = "400"
          pressure_rating = 905
          temperature_rating = 200
      elsif pressure > 905 and pressure <= 1360
          flange_class = "600"
          pressure_rating = 1360
          temperature_rating = 200
      elsif pressure > 1360 and pressure <= 2035
          flange_class = "900"
          pressure_rating = 2035
          temperature_rating = 200
      end
  elsif temperature > 200 and temperature <= 300
    if pressure < 115
      flange_class = "75"
      pressure_rating = 115
      temperature_rating = 300
  elsif pressure > 115 and pressure <= 230
      flange_class = "150"
      pressure_rating = 230
      temperature_rating = 300
  elsif pressure > 230 and pressure <= 655
      flange_class = "300"
      pressure_rating = 655
      temperature_rating = 300
  elsif pressure > 655 and pressure <= 870 
      flange_class = "400"
      pressure_rating = 870
      temperature_rating = 300
  elsif pressure > 870 and pressure <= 1310 
      flange_class = "600"
      pressure_rating = 1310
      temperature_rating = 300
  elsif pressure > 1310 and pressure <= 1965 
      flange_class = "900"
      pressure_rating = 1965
      temperature_rating = 300
  end
elsif temperature > 300 and temperature <= 400 
    if pressure < 100 
      flange_class = "75"
      pressure_rating = 100
      temperature_rating = 400
  elsif pressure > 100 and pressure <= 200 
      flange_class = "150"
      pressure_rating = 285
      temperature_rating = 400
  elsif pressure > 200 and pressure <= 635 
      flange_class = "300"
      pressure_rating = 635
      temperature_rating = 400
  elsif pressure > 635 and pressure <= 845 
      flange_class = "400"
      pressure_rating = 845
      temperature_rating = 400
  elsif pressure > 845 and pressure <= 1265 
      flange_class = "600"
      pressure_rating = 1265
      temperature_rating = 400
  elsif pressure > 1265 and pressure <= 1900 
      flange_class = "900"
      pressure_rating = 1900
      temperature_rating = 400
  end
elsif temperature > 400 and temperature <= 500 
    if pressure < 85 
      flange_class = "75"
      pressure_rating = 85
      temperature_rating = 500
  elsif pressure > 85 and pressure <= 170 
      flange_class = "150"
      pressure_rating = 170
      temperature_rating = 500
  elsif pressure > 170 and pressure <= 605 
      flange_class = "300"
      pressure_rating = 605
      temperature_rating = 500
  elsif pressure > 605 and pressure <= 805 
      flange_class = "400"
      pressure_rating = 805
      temperature_rating = 500
  elsif pressure > 805 and pressure <= 1205 
      flange_class = "600"
      pressure_rating = 1205
      temperature_rating = 500
  elsif pressure > 1205 and pressure <= 1810 
      flange_class = "900"
      pressure_rating = 1810
      temperature_rating = 500
  end
elsif temperature > 500 and temperature <= 600 
    if pressure < 70 
      flange_class = "75"
      pressure_rating = 70
      temperature_rating = 600
  elsif pressure > 70 and pressure <= 140 
      flange_class = "150"
      pressure_rating = 140
      temperature_rating = 600
  elsif pressure > 140 and pressure <= 570 
      flange_class = "300"
      pressure_rating = 570
      temperature_rating = 600
  elsif pressure > 570 and pressure <= 755 
      flange_class = "400"
      pressure_rating = 755
      temperature_rating = 600
  elsif pressure > 755 and pressure <= 1135 
      flange_class = "600"
      pressure_rating = 1135
      temperature_rating = 600
  elsif pressure > 1135 and pressure <= 1705 
      flange_class = "900"
      pressure_rating = 1705
      temperature_rating = 600
  end
elsif temperature > 600 and temperature <= 650 
    if pressure < 60 
      flange_class = "75"
      pressure_rating = 60
      temperature_rating = 650
  elsif pressure > 60 and pressure <= 125 
      flange_class = "150"
      pressure_rating = 125
      temperature_rating = 650
  elsif pressure > 125 and pressure <= 550 
      flange_class = "300"
      pressure_rating = 550
      temperature_rating = 650
  elsif pressure > 550 and pressure <= 730 
      flange_class = "400"
      pressure_rating = 730
      temperature_rating = 650
  elsif pressure > 730 and pressure <= 1100 
      flange_class = "600"
      pressure_rating = 1100
      temperature_rating = 650
  elsif pressure > 1100 and pressure <= 1650 
      flange_class = "900"
      pressure_rating = 1650
      temperature_rating = 650
  end
elsif temperature > 650 and temperature <= 700 
    if pressure <= 110 
      flange_class = "150"
      pressure_rating = 110
      temperature_rating = 700
  elsif pressure > 110 and pressure <= 530 
      flange_class = "300"
      pressure_rating = 530
      temperature_rating = 700
  elsif pressure > 530 and pressure <= 710 
      flange_class = "400"
      pressure_rating = 710
      temperature_rating = 700
  elsif pressure > 710 and pressure <= 1060 
      flange_class = "600"
      pressure_rating = 1060
      temperature_rating = 700
  elsif pressure > 1060 and pressure <= 1590 
      flange_class = "900"
      pressure_rating = 1590
      temperature_rating = 700
  end
elsif temperature > 700 and temperature <= 750 
    if pressure <= 95 
      flange_class = "150"
      pressure_rating = 95
      temperature_rating = 750
  elsif pressure > 95 and pressure <= 505 
      flange_class = "300"
      pressure_rating = 505
      temperature_rating = 750
  elsif pressure > 505 and pressure <= 675 
      flange_class = "400"
      pressure_rating = 675
      temperature_rating = 750
  elsif pressure > 675 and pressure <= 1015 
      flange_class = "600"
      pressure_rating = 1015
      temperature_rating = 750
  elsif pressure > 1015 and pressure <= 1520 
      flange_class = "900"
      pressure_rating = 1520
      temperature_rating = 750
  end
elsif temperature > 750 and temperature <= 800 
    if pressure <= 80 
      flange_class = "150"
      pressure_rating = 80
      temperature_rating = 800
  elsif pressure > 80 and pressure <= 410 
      flange_class = "300"
      pressure_rating = 410
      temperature_rating = 800
  elsif pressure > 740 and pressure <= 550 
      flange_class = "400"
      pressure_rating = 550
      temperature_rating = 800
  elsif pressure > 985 and pressure <= 825 
      flange_class = "600"
      pressure_rating = 825
      temperature_rating = 800
  elsif pressure > 1480 and pressure <= 1235 
      flange_class = "900"
      pressure_rating = 1235
      temperature_rating = 800
  end
elsif temperature > 800 and temperature <= 850 
    if pressure <= 65 
      flange_class = "150"
      pressure_rating = 65
      temperature_rating = 850
  elsif pressure > 65 and pressure <= 320 
      flange_class = "300"
      pressure_rating = 320
      temperature_rating = 850
  elsif pressure > 320 and pressure <= 425 
      flange_class = "400"
      pressure_rating = 425
      temperature_rating = 850
  elsif pressure > 425 and pressure <= 640 
      flange_class = "600"
      pressure_rating = 640
      temperature_rating = 850
  elsif pressure > 640 and pressure <= 955 
      flange_class = "900"
      pressure_rating = 955
      temperature_rating = 850
  end
elsif temperature > 850 and temperature <= 900 
    if pressure <= 50 
      flange_class = "150"
      pressure_rating = 50
      temperature_rating = 900
  elsif pressure > 50 and pressure <= 230 
      flange_class = "300"
      pressure_rating = 230
      temperature_rating = 900
  elsif pressure > 230 and pressure <= 305 
      flange_class = "400"
      pressure_rating = 305
      temperature_rating = 900
  elsif pressure > 305 and pressure <= 460 
      flange_class = "600"
      pressure_rating = 460
      temperature_rating = 900
  elsif pressure > 460 and pressure <= 690 
      flange_class = "900"
      pressure_rating = 690
      temperature_rating = 900
  end
elsif temperature > 900 and temperature <= 950 
    if pressure <= 35 
      flange_class = "150"
      pressure_rating = 35
      temperature_rating = 950
  elsif pressure > 35 and pressure <= 135 
      flange_class = "300"
      pressure_rating = 135
      temperature_rating = 950
  elsif pressure > 135 and pressure <= 185 
      flange_class = "400"
      pressure_rating = 185
      temperature_rating = 950
  elsif pressure > 185 and pressure <= 275 
      flange_class = "600"
      pressure_rating = 275
      temperature_rating = 950
  elsif pressure > 275 and pressure <= 410 
      flange_class = "900"
      pressure_rating = 410
      temperature_rating = 950
  end
elsif temperature > 950 and temperature <= 1000 
    if pressure <= 20 
      flange_class = "150"
      pressure_rating = 20
      temperature_rating = 1000
  elsif pressure > 20 and pressure <= 85 
      flange_class = "300"
      pressure_rating = 85
      temperature_rating = 1000
  elsif pressure > 85 and pressure <= 115 
      flange_class = "400"
      pressure_rating = 115
      temperature_rating = 1000
  elsif pressure > 115 and pressure <= 170 
      flange_class = "600"
      pressure_rating = 170
      temperature_rating = 1000
  elsif pressure > 170 and pressure <= 255 
      flange_class = "900"
      pressure_rating = 255
      temperature_rating = 1000
  end
end
end 



if material_group == "1.2"
    if temperature >= -20 and temperature <= 100 
      if pressure < 145 
        flange_class = "75"
        pressure_rating = 145
        temperature_rating = 100
    elsif pressure > 75 and pressure <= 290 
        flange_class = "150"
        pressure_rating = 290
        temperature_rating = 100
    elsif pressure > 290 and pressure <= 750 
        flange_class = "300"
        pressure_rating = 750
        temperature_rating = 100
    elsif pressure > 750 and pressure <= 1000 
        flange_class = "400"
        pressure_rating = 1000
        temperature_rating = 100
    elsif pressure > 1000 and pressure <= 1500 
        flange_class = "600"
        pressure_rating = 1500
        temperature_rating = 100
    elsif pressure > 1500 and pressure <= 2250 
        flange_class = "900"
        pressure_rating = 2250
        temperature_rating = 100
    end
elsif temperature > 100 and temperature <= 200 
  if pressure < 130 
      flange_class = "75"
      pressure_rating = 130
      temperature_rating = 200
  elsif pressure > 130 and pressure <= 260 
      flange_class = "150"
      pressure_rating = 260
      temperature_rating = 200
  elsif pressure > 260 and pressure <= 750 
      flange_class = "300"
      pressure_rating = 750
      temperature_rating = 200
  elsif pressure > 750 and pressure <= 1000 
      flange_class = "400"
      pressure_rating = 1000
      temperature_rating = 200
  elsif pressure > 1000 and pressure <= 1500 
      flange_class = "600"
      pressure_rating = 1500
      temperature_rating = 200
  elsif pressure > 1500 and pressure <= 2250 
      flange_class = "900"
      pressure_rating = 2250
      temperature_rating = 200
  end
elsif temperature > 200 and temperature <= 300 
    if pressure < 115 
        flange_class = "75"
        pressure_rating = 115
        temperature_rating = 300
    elsif pressure > 115 and pressure <= 230 
        flange_class = "150"
        pressure_rating = 230
        temperature_rating = 300
    elsif pressure > 230 and pressure <= 730 
        flange_class = "300"
        pressure_rating = 730
        temperature_rating = 300
    elsif pressure > 730 and pressure <= 970 
        flange_class = "400"
        pressure_rating = 970
        temperature_rating = 300
    elsif pressure > 970 and pressure <= 1455 
        flange_class = "600"
        pressure_rating = 1455
        temperature_rating = 300
    elsif pressure > 1455 and pressure <= 2185 
        flange_class = "900"
        pressure_rating = 2185
        temperature_rating = 300
    end
elsif temperature > 300 and temperature <= 400 
  if pressure < 100 
      flange_class = "75"
      pressure_rating = 100
      temperature_rating = 400
  elsif pressure > 100 and pressure <= 200 
      flange_class = "150"
      pressure_rating = 200
      temperature_rating = 400
  elsif pressure > 200 and pressure <= 705 
      flange_class = "300"
      pressure_rating = 705
      temperature_rating = 400
  elsif pressure > 705 and pressure <= 940 
      flange_class = "400"
      pressure_rating = 940
      temperature_rating = 400
  elsif pressure > 940 and pressure <= 1405 
      flange_class = "600"
      pressure_rating = 1405
      temperature_rating = 400
  elsif pressure > 1405 and pressure <= 2110 
      flange_class = "900"
      pressure_rating = 2110
      temperature_rating = 400
  end
elsif temperature > 400 and temperature <= 500 
  if pressure < 85 
      flange_class = "75"
      pressure_rating = 85
      temperature_rating = 500
  elsif pressure > 85 and pressure <= 170 
      flange_class = "150"
      pressure_rating = 170
      temperature_rating = 500
  elsif pressure > 170 and pressure <= 665 
      flange_class = "300"
      pressure_rating = 665
      temperature_rating = 500
  elsif pressure > 665 and pressure <= 885 
      flange_class = "400"
      pressure_rating = 885
      temperature_rating = 500
  elsif pressure > 855 and pressure <= 1330 
      flange_class = "600"
      pressure_rating = 1330
      temperature_rating = 500
  elsif pressure > 1330 and pressure <= 1995 
      flange_class = "900"
      pressure_rating = 1995
      temperature_rating = 500
  end
elsif temperature > 500 and temperature <= 600 
  if pressure < 70 
      flange_class = "75"
      pressure_rating = 70
      temperature_rating = 600
  elsif pressure > 70 and pressure <= 140 
      flange_class = "150"
      pressure_rating = 140
      temperature_rating = 600
  elsif pressure > 140 and pressure <= 605 
      flange_class = "300"
      pressure_rating = 605
      temperature_rating = 600
  elsif pressure > 605 and pressure <= 805 
      flange_class = "400"
      pressure_rating = 805
      temperature_rating = 600
  elsif pressure > 805 and pressure <= 1210 
      flange_class = "600"
      pressure_rating = 1210
      temperature_rating = 600
  elsif pressure > 1210 and pressure <= 1815 
      flange_class = "900"
      pressure_rating = 1815
      temperature_rating = 600
  end
elsif temperature > 600 and temperature <= 650 
  if pressure < 60 
      flange_class = "75"
      pressure_rating = 60
      temperature_rating = 650
  elsif pressure > 60 and pressure <= 125 
      flange_class = "150"
      pressure_rating = 125
      temperature_rating = 650
  elsif pressure > 125 and pressure <= 590 
      flange_class = "300"
      pressure_rating = 590
      temperature_rating = 650
  elsif pressure > 590 and pressure <= 785 
      flange_class = "400"
      pressure_rating = 785
      temperature_rating = 650
  elsif pressure > 785 and pressure <= 1175 
      flange_class = "600"
      pressure_rating = 1175
      temperature_rating = 650
  elsif pressure > 1175 and pressure <= 1765 
      flange_class = "900"
      pressure_rating = 1765
      temperature_rating = 650
  end
elsif temperature > 650 and temperature <= 700 
  if pressure <= 110 
      flange_class = "150"
      pressure_rating = 110
      temperature_rating = 700
  elsif pressure > 110 and pressure <= 555 
      flange_class = "300"
      pressure_rating = 555
      temperature_rating = 700
  elsif pressure > 555 and pressure <= 740 
      flange_class = "400"
      pressure_rating = 740
      temperature_rating = 700
  elsif pressure > 740 and pressure <= 1110 
      flange_class = "600"
      pressure_rating = 1110
      temperature_rating = 700
  elsif pressure > 1110 and pressure <= 1665 
      flange_class = "900"
      pressure_rating = 1665
      temperature_rating = 700
  end
elsif temperature > 700 and temperature <= 750 
  if pressure <= 95 
      flange_class = "150"
      pressure_rating = 95
      temperature_rating = 750
  elsif pressure > 95 and pressure <= 505 
      flange_class = "300"
      pressure_rating = 505
      temperature_rating = 750
  elsif pressure > 505 and pressure <= 675 
      flange_class = "400"
      pressure_rating = 675
      temperature_rating = 750
  elsif pressure > 675 and pressure <= 1015 
      flange_class = "600"
      pressure_rating = 1015
      temperature_rating = 750
  elsif pressure > 1015 and pressure <= 1520 
      flange_class = "900"
      pressure_rating = 1520
      temperature_rating = 750
  end
elsif temperature > 750 and temperature <= 800 
  if pressure <= 80 
      flange_class = "150"
      pressure_rating = 80
      temperature_rating = 800
  elsif pressure > 80 and pressure <= 410 
      flange_class = "300"
      pressure_rating = 410
      temperature_rating = 800
  elsif pressure > 410 and pressure <= 550 
      flange_class = "400"
      pressure_rating = 550
      temperature_rating = 800
  elsif pressure > 550 and pressure <= 825 
      flange_class = "600"
      pressure_rating = 825
      temperature_rating = 800
  elsif pressure > 825 and pressure <= 1235 
      flange_class = "900"
      pressure_rating = 1235
      temperature_rating = 800
  end
elsif temperature > 800 and temperature <= 850 
  if pressure <= 65 
      flange_class = "150"
      pressure_rating = 65
      temperature_rating = 850
  elsif pressure > 65 and pressure <= 320 
      flange_class = "300"
      pressure_rating = 320
      temperature_rating = 850
  elsif pressure > 320 and pressure <= 425 
      flange_class = "400"
      pressure_rating = 425
      temperature_rating = 850
  elsif pressure > 425 and pressure <= 640 
      flange_class = "600"
      pressure_rating = 640
      temperature_rating = 850
  elsif pressure > 640 and pressure <= 955 
      flange_class = "900"
      pressure_rating = 955
      temperature_rating = 850
  end
elsif temperature > 850 and temperature <= 900 
  if pressure <= 50 
      flange_class = "150"
      pressure_rating = 50
      temperature_rating = 900
  elsif pressure > 50 and pressure <= 225 
      flange_class = "300"
      pressure_rating = 225
      temperature_rating = 900
  elsif pressure > 225 and pressure <= 295 
      flange_class = "400"
      pressure_rating = 295
      temperature_rating = 900
  elsif pressure > 295 and pressure <= 445 
      flange_class = "600"
      pressure_rating = 445
      temperature_rating = 900
  elsif pressure > 445 and pressure <= 670 
      flange_class = "900"
      pressure_rating = 670
      temperature_rating = 900
  end
elsif temperature > 900 and temperature <= 950 
  if pressure <= 35 
      flange_class = "150"
      pressure_rating = 35
      temperature_rating = 950
  elsif pressure > 35 and pressure <= 135 
      flange_class = "300"
      pressure_rating = 135
      temperature_rating = 950
  elsif pressure > 135 and pressure <= 185 
      flange_class = "400"
      pressure_rating = 185
      temperature_rating = 950
  elsif pressure > 185 and pressure <= 275 
      flange_class = "600"
      pressure_rating = 275
      temperature_rating = 950
  elsif pressure > 275 and pressure <= 410 
      flange_class = "900"
      pressure_rating = 410
      temperature_rating = 950
  end
elsif temperature > 950 and temperature <= 1000 
  if pressure <= 20 
      flange_class = "150"
      pressure_rating = 20
      temperature_rating = 1000
  elsif pressure > 20 and pressure <= 85 
      flange_class = "300"
      pressure_rating = 85
      temperature_rating = 1000
  elsif pressure > 85 and pressure <= 115 
      flange_class = "400"
      pressure_rating = 115
      temperature_rating = 1000
  elsif pressure > 115 and pressure <= 170 
      flange_class = "600"
      pressure_rating = 170
      temperature_rating = 1000
  elsif pressure > 170 and pressure <= 255 
      flange_class = "900"
      pressure_rating = 255
      temperature_rating = 1000
  end 
end
end

if material_group == "1.3"
if temperature >= -20 and temperature <= 100
    if pressure < 135
        flange_class = "75"
        pressure_rating = 135
        temperature_rating = 100
    elsif pressure > 135 and pressure <= 265
        flange_class = "150"
        pressure_rating = 265
        temperature_rating = 100
    elsif pressure > 265 and pressure <= 695
        flange_class = "300"
        pressure_rating = 695
        temperature_rating = 100
    elsif pressure > 695 and pressure <= 930
        flange_class = "400"
        pressure_rating = 930
        temperature_rating = 100
    elsif pressure > 930 and pressure <= 1395
        flange_class = "600"
        pressure_rating = 1395
        temperature_rating = 100
    elsif pressure > 1395 and pressure <= 2090
        flange_class = "900"
        pressure_rating = 2090
        temperature_rating = 100
    end
elsif temperature > 100 and temperature <= 200 
    if pressure < 125
        flange_class = "75"
        pressure_rating = 125
        temperature_rating = 200
    elsif pressure > 125 and pressure <= 255
        flange_class = "150"
        pressure_rating = 255
        temperature_rating = 200
    elsif pressure > 255 and pressure <= 660
        flange_class = "300"
        pressure_rating = 660
        temperature_rating = 200
    elsif pressure > 660 and pressure <= 880
        flange_class = "400"
        pressure_rating = 880
        temperature_rating = 200
    elsif pressure > 880 and pressure <= 1320
        flange_class = "600"
        pressure_rating = 1320
        temperature_rating = 200
    elsif pressure > 1320 and pressure <= 1980
        flange_class = "900"
        pressure_rating = 1980
        temperature_rating = 200
    end
elsif temperature > 200 and temperature <= 300 
    if pressure < 115
        flange_class = "75"
        pressure_rating = 115
        temperature_rating = 300
    elsif pressure > 115 and pressure <= 230
        flange_class = "150"
        pressure_rating = 230
        temperature_rating = 300
    elsif pressure > 230 and pressure <= 640
        flange_class = "300"
        pressure_rating = 640
        temperature_rating = 300
    elsif pressure > 640 and pressure <= 850
        flange_class = "400"
        pressure_rating = 850
        temperature_rating = 300
    elsif pressure > 850 and pressure <= 1275
        flange_class = "600"
        pressure_rating = 1275
        temperature_rating = 300
    elsif pressure > 1275 and pressure <= 1915
        flange_class = "900"
        pressure_rating = 1915
        temperature_rating = 300
    end
elsif temperature > 300 and temperature <= 400 
    if pressure < 100
        flange_class = "75"
        pressure_rating = 100
        temperature_rating = 400
    elsif pressure > 100 and pressure <= 200
        flange_class = "150"
        pressure_rating = 200
        temperature_rating = 400
    elsif pressure > 200 and pressure <= 615
        flange_class = "300"
        pressure_rating = 615
        temperature_rating = 400
    elsif pressure > 615 and pressure <= 820
        flange_class = "400"
        pressure_rating = 820
        temperature_rating = 400
    elsif pressure > 820 and pressure <= 1230
        flange_class = "600"
        pressure_rating = 1230
        temperature_rating = 400
    elsif pressure > 1230 and pressure <= 1845
        flange_class = "900"
        pressure_rating = 1845
        temperature_rating = 400
    end
elsif temperature > 400 and temperature <= 500 
    if pressure < 85
        flange_class = "75"
        pressure_rating = 85
        temperature_rating = 500
    elsif pressure > 85 and pressure <= 170
        flange_class = "150"
        pressure_rating = 170
        temperature_rating = 500
    elsif pressure > 170 and pressure <= 585
        flange_class = "300"
        pressure_rating = 585
        temperature_rating = 500
    elsif pressure > 585 and pressure <= 780
        flange_class = "400"
        pressure_rating = 780
        temperature_rating = 500
    elsif pressure > 780 and pressure <= 1175
        flange_class = "600"
        pressure_rating = 1175
        temperature_rating = 500
    elsif pressure > 1175 and pressure <= 1760
        flange_class = "900"
        pressure_rating = 1760
        temperature_rating = 500
    end
elsif temperature > 500 and temperature <= 600 
    if pressure < 70
        flange_class = "75"
        pressure_rating = 70
        temperature_rating = 600
    elsif pressure > 70 and pressure <= 140
        flange_class = "150"
        pressure_rating = 140
        temperature_rating = 600
    elsif pressure > 140 and pressure <= 550
        flange_class = "300"
        pressure_rating = 550
        temperature_rating = 600
    elsif pressure > 550 and pressure <= 735
        flange_class = "400"
        pressure_rating = 735
        temperature_rating = 600
    elsif pressure > 735 and pressure <= 1105
        flange_class = "600"
        pressure_rating = 1105
        temperature_rating = 600
    elsif pressure > 1105 and pressure <= 1655
        flange_class = "900"
        pressure_rating = 1655
        temperature_rating = 600
    end
elsif temperature > 600 and temperature <= 650 
    if pressure < 60
        flange_class = "75"
        pressure_rating = 60
        temperature_rating = 650
    elsif pressure > 60 and pressure <= 125
        flange_class = "150"
        pressure_rating = 125
        temperature_rating = 650
    elsif pressure > 125 and pressure <= 535
        flange_class = "300"
        pressure_rating = 535
        temperature_rating = 650
    elsif pressure > 535 and pressure <= 710
        flange_class = "400"
        pressure_rating = 710
        temperature_rating = 650
    elsif pressure > 710 and pressure <= 1065
        flange_class = "600"
        pressure_rating = 1065
        temperature_rating = 650
    elsif pressure > 1065 and pressure <= 1600
        flange_class = "900"
        pressure_rating = 1600
        temperature_rating = 650
    end
elsif temperature > 650 and temperature <= 700 
    if pressure <= 110
        flange_class = "150"
        pressure_rating = 110
        temperature_rating = 700
    elsif pressure > 110 and pressure <= 510
        flange_class = "300"
        pressure_rating = 510
        temperature_rating = 700
    elsif pressure > 510 and pressure <= 685
        flange_class = "400"
        pressure_rating = 685
        temperature_rating = 700
    elsif pressure > 685 and pressure <= 1025
        flange_class = "600"
        pressure_rating = 1025
        temperature_rating = 700
    elsif pressure > 1025 and pressure <= 1535
        flange_class = "900"
        pressure_rating = 1535
        temperature_rating = 700
    end
elsif temperature > 700 and temperature <= 750 
    if pressure <= 95
        flange_class = "150"
        pressure_rating = 95
        temperature_rating = 750
    elsif pressure > 95 and pressure <= 475
        flange_class = "300"
        pressure_rating = 475
        temperature_rating = 750
    elsif pressure > 475 and pressure <= 635
        flange_class = "400"
        pressure_rating = 635
        temperature_rating = 750
    elsif pressure > 635 and pressure <= 955
        flange_class = "600"
        pressure_rating = 955
        temperature_rating = 750
    elsif pressure > 955 and pressure <= 1430
        flange_class = "900"
        pressure_rating = 1430
        temperature_rating = 750
    end
elsif temperature > 750 and temperature <= 800 
    if pressure <= 80
        flange_class = "150"
        pressure_rating = 80
        temperature_rating = 800
    elsif pressure > 80 and pressure <= 390
        flange_class = "300"
        pressure_rating = 390
        temperature_rating = 800
    elsif pressure > 390 and pressure <= 520
        flange_class = "400"
        pressure_rating = 520
        temperature_rating = 800
    elsif pressure > 520 and pressure <= 780
        flange_class = "600"
        pressure_rating = 780
        temperature_rating = 800
    elsif pressure > 780 and pressure <= 1175
        flange_class = "900"
        pressure_rating = 1175
        temperature_rating = 800
    end
elsif temperature > 800 and temperature <= 850 
    if pressure <= 65
        flange_class = "150"
        pressure_rating = 65
        temperature_rating = 850
    elsif pressure > 65 and pressure <= 300
        flange_class = "300"
        pressure_rating = 300
        temperature_rating = 850
    elsif pressure > 300 and pressure <= 400
        flange_class = "400"
        pressure_rating = 400
        temperature_rating = 850
    elsif pressure > 400 and pressure <= 595
        flange_class = "600"
        pressure_rating = 595
        temperature_rating = 850
    elsif pressure > 595 and pressure <= 895
        flange_class = "900"
        pressure_rating = 895
        temperature_rating = 850
    end
elsif temperature > 850 and temperature <= 900 
    if pressure <= 50
        flange_class = "150"
        pressure_rating = 50
        temperature_rating = 900
    elsif pressure > 50 and pressure <= 200
        flange_class = "300"
        pressure_rating = 200
        temperature_rating = 900
    elsif pressure > 200 and pressure <= 270
        flange_class = "400"
        pressure_rating = 270
        temperature_rating = 900
    elsif pressure > 270 and pressure <= 405
        flange_class = "600"
        pressure_rating = 405
        temperature_rating = 900
    elsif pressure > 405 and pressure <= 605
        flange_class = "900"
        pressure_rating = 605
        temperature_rating = 900
    end
elsif temperature > 900 and temperature <= 950 
    if pressure <= 35
        flange_class = "150"
        pressure_rating = 35
        temperature_rating = 950
    elsif pressure > 35 and pressure <= 135
        flange_class = "300"
        pressure_rating = 135
        temperature_rating = 950
    elsif pressure > 135 and pressure <= 185
        flange_class = "400"
        pressure_rating = 185
        temperature_rating = 950
    elsif pressure > 185 and pressure <= 275
        flange_class = "600"
        pressure_rating = 275
        temperature_rating = 950
    elsif pressure > 275 and pressure <= 410
        flange_class = "900"
        pressure_rating = 410
        temperature_rating = 950
    end
elsif temperature > 950 and temperature <= 1000
    if pressure <= 20
        flange_class = "150"
        pressure_rating = 20
        temperature_rating = 1000
    elsif pressure > 20 and pressure <= 85
        flange_class = "300"
        pressure_rating = 85
        temperature_rating = 1000
    elsif pressure > 85 and pressure <= 115
        flange_class = "400"
        pressure_rating = 115
        temperature_rating = 1000
    elsif pressure > 115 and pressure <= 170
        flange_class = "600"
        pressure_rating = 170
        temperature_rating = 1000
    elsif pressure > 170 and pressure <= 255
        flange_class = "900"
        pressure_rating = 255
        temperature_rating = 1000
    end
end
end

if material_group == "1.4"
if temperature >= -20 and temperature <= 100
    if pressure < 120
        flange_class = "75"
        pressure_rating = 120
        temperature_rating = 100
    elsif pressure > 120 and pressure <= 235
        flange_class = "150"
        pressure_rating = 235
        temperature_rating = 100
    elsif pressure > 235 and pressure <= 615
        flange_class = "300"
        pressure_rating = 615
        temperature_rating = 100
    elsif pressure > 615 and pressure <= 825
        flange_class = "400"
        pressure_rating = 825
        temperature_rating = 100
    elsif pressure > 825 and pressure <= 1235
        flange_class = "600"
        pressure_rating = 1235
        temperature_rating = 100
    elsif pressure > 1235 and pressure <= 1850
        flange_class = "900"
        pressure_rating = 1850
        temperature_rating = 100
    end
elsif temperature > 100 and temperature <= 200 
    if pressure < 110
        flange_class = "75"
        pressure_rating = 110
        temperature_rating = 200
    elsif pressure > 110 and pressure <= 215
        flange_class = "150"
        pressure_rating = 215
        temperature_rating = 200
    elsif pressure > 215 and pressure <= 565
        flange_class = "300"
        pressure_rating = 565
        temperature_rating = 200
    elsif pressure > 565 and pressure <= 755
        flange_class = "400"
        pressure_rating = 755
        temperature_rating = 200
    elsif pressure > 755 and pressure <= 1130
        flange_class = "600"
        pressure_rating = 1130
        temperature_rating = 200
    elsif pressure > 1130 and pressure <= 1695
        flange_class = "900"
        pressure_rating = 1695
        temperature_rating = 200
    end
elsif temperature > 200 and temperature <= 300 
    if pressure < 105
        flange_class = "75"
        pressure_rating = 105
        temperature_rating = 300
    elsif pressure > 105 and pressure <= 210
        flange_class = "150"
        pressure_rating = 210
        temperature_rating = 300
    elsif pressure > 210 and pressure <= 545
        flange_class = "300"
        pressure_rating = 545
        temperature_rating = 300
    elsif pressure > 545 and pressure <= 725
        flange_class = "400"
        pressure_rating = 725
        temperature_rating = 300
    elsif pressure > 725 and pressure <= 1090
        flange_class = "600"
        pressure_rating = 1090
        temperature_rating = 300
    elsif pressure > 1090 and pressure <= 1635
        flange_class = "900"
        pressure_rating = 1635
        temperature_rating = 300
    end
elsif temperature > 300 and temperature <= 400 
    if pressure < 100
        flange_class = "75"
        pressure_rating = 100
        temperature_rating = 400
    elsif pressure > 100 and pressure <= 200
        flange_class = "150"
        pressure_rating = 200
        temperature_rating = 400
    elsif pressure > 200 and pressure <= 525
        flange_class = "300"
        pressure_rating = 525
        temperature_rating = 400
    elsif pressure > 525 and pressure <= 700
        flange_class = "400"
        pressure_rating = 700
        temperature_rating = 400
    elsif pressure > 700 and pressure <= 1055
        flange_class = "600"
        pressure_rating = 1055
        temperature_rating = 400
    elsif pressure > 1055 and pressure <= 1580
        flange_class = "900"
        pressure_rating = 1580
        temperature_rating = 400
    end
elsif temperature > 400 and temperature <= 500 
    if pressure < 85
        flange_class = "75"
        pressure_rating = 85
        temperature_rating = 500
    elsif pressure > 85 and pressure <= 170
        flange_class = "150"
        pressure_rating = 170
        temperature_rating = 500
    elsif pressure > 170 and pressure <= 500
        flange_class = "300"
        pressure_rating = 500
        temperature_rating = 500
    elsif pressure > 500 and pressure <= 670
        flange_class = "400"
        pressure_rating = 670
        temperature_rating = 500
    elsif pressure > 670 and pressure <= 1005
        flange_class = "600"
        pressure_rating = 1005
        temperature_rating = 500
    elsif pressure > 1005 and pressure <= 1505
        flange_class = "900"
        pressure_rating = 1505
        temperature_rating = 500
    end
elsif temperature > 500 and temperature <= 600 
    if pressure < 70
        flange_class = "75"
        pressure_rating = 70
        temperature_rating = 600
    elsif pressure > 70 and pressure <= 140
        flange_class = "150"
        pressure_rating = 140
        temperature_rating = 600
    elsif pressure > 140 and pressure <= 475
        flange_class = "300"
        pressure_rating = 475
        temperature_rating = 600
    elsif pressure > 475 and pressure <= 630
        flange_class = "400"
        pressure_rating = 630
        temperature_rating = 600
    elsif pressure > 630 and pressure <= 945
        flange_class = "600"
        pressure_rating = 945
        temperature_rating = 600
    elsif pressure > 945 and pressure <= 1420
        flange_class = "900"
        pressure_rating = 1420
        temperature_rating = 600
    end
elsif temperature > 600 and temperature <= 650 
    if pressure < 60
        flange_class = "75"
        pressure_rating = 60
        temperature_rating = 650
    elsif pressure > 60 and pressure <= 125
        flange_class = "150"
        pressure_rating = 125
        temperature_rating = 650
    elsif pressure > 125 and pressure <= 455
        flange_class = "300"
        pressure_rating = 455
        temperature_rating = 650
    elsif pressure > 455 and pressure <= 610
        flange_class = "400"
        pressure_rating = 610
        temperature_rating = 650
    elsif pressure > 610 and pressure <= 915
        flange_class = "600"
        pressure_rating = 915
        temperature_rating = 650
    elsif pressure > 915 and pressure <= 1370
        flange_class = "900"
        pressure_rating = 1370
        temperature_rating = 650
    end
elsif temperature > 650 and temperature <= 700 
    if pressure <= 110
        flange_class = "150"
        pressure_rating = 110
        temperature_rating = 700
    elsif pressure > 110 and pressure <= 440
        flange_class = "300"
        pressure_rating = 440
        temperature_rating = 700
    elsif pressure > 440 and pressure <= 590
        flange_class = "400"
        pressure_rating = 590
        temperature_rating = 700
    elsif pressure > 590 and pressure <= 885
        flange_class = "600"
        pressure_rating = 885
        temperature_rating = 700
    elsif pressure > 885 and pressure <= 1325
        flange_class = "900"
        pressure_rating = 1325
        temperature_rating = 700
    end
elsif temperature > 700 and temperature <= 750 
    if pressure <= 95
        flange_class = "150"
        pressure_rating = 95
        temperature_rating = 750
    elsif pressure > 95 and pressure <= 430
        flange_class = "300"
        pressure_rating = 430
        temperature_rating = 750
    elsif pressure > 430 and pressure <= 570
        flange_class = "400"
        pressure_rating = 570
        temperature_rating = 750
    elsif pressure > 570 and pressure <= 855
        flange_class = "600"
        pressure_rating = 855
        temperature_rating = 750
    elsif pressure > 855 and pressure <= 1285
        flange_class = "900"
        pressure_rating = 1285
        temperature_rating = 750
    end
elsif temperature > 750 and temperature <= 800 
    if pressure <= 80
        flange_class = "150"
        pressure_rating = 80
        temperature_rating = 800
    elsif pressure > 80 and pressure <= 370
        flange_class = "300"
        pressure_rating = 370
        temperature_rating = 800
    elsif pressure > 370 and pressure <= 495
        flange_class = "400"
        pressure_rating = 495
        temperature_rating = 800
    elsif pressure > 495 and pressure <= 740
        flange_class = "600"
        pressure_rating = 740
        temperature_rating = 800
    elsif pressure > 740 and pressure <= 1110
        flange_class = "900"
        pressure_rating = 1110
        temperature_rating = 800
    end
elsif temperature > 800 and temperature <= 850 
    if pressure <= 65
        flange_class = "150"
        pressure_rating = 65
        temperature_rating = 850
    elsif pressure > 65 and pressure <= 300
        flange_class = "300"
        pressure_rating = 300
        temperature_rating = 850
    elsif pressure > 300 and pressure <= 400
        flange_class = "400"
        pressure_rating = 400
        temperature_rating = 850
    elsif pressure > 400 and pressure <= 595
        flange_class = "600"
        pressure_rating = 595
        temperature_rating = 850
    elsif pressure > 595 and pressure <= 895
        flange_class = "900"
        pressure_rating = 895
        temperature_rating = 850
    end
elsif temperature > 850 and temperature <= 900 
    if pressure <= 50
        flange_class = "150"
        pressure_rating = 50
        temperature_rating = 900
    elsif pressure > 50 and pressure <= 170
        flange_class = "300"
        pressure_rating = 170
        temperature_rating = 900
    elsif pressure > 170 and pressure <= 230
        flange_class = "400"
        pressure_rating = 230
        temperature_rating = 900
    elsif pressure > 230 and pressure <= 345
        flange_class = "600"
        pressure_rating = 345
        temperature_rating = 900
    elsif pressure > 345 and pressure <= 515
        flange_class = "900"
        pressure_rating = 515
        temperature_rating = 900
    end
elsif temperature > 900 and temperature <= 950 
    if pressure <= 35
        flange_class = "150"
        pressure_rating = 35
        temperature_rating = 950
    elsif pressure > 35 and pressure <= 135
        flange_class = "300"
        pressure_rating = 135
        temperature_rating = 950
    elsif pressure > 135 and pressure <= 185
        flange_class = "400"
        pressure_rating = 185
        temperature_rating = 950
    elsif pressure > 185 and pressure <= 275
        flange_class = "600"
        pressure_rating = 275
        temperature_rating = 950
    elsif pressure > 275 and pressure <= 410
        flange_class = "900"
        pressure_rating = 410
        temperature_rating = 950
    end
elsif temperature > 950 and temperature <= 1000
    if pressure <= 20
        flange_class = "150"
        pressure_rating = 20
        temperature_rating = 1000
    elsif pressure > 20 and pressure <= 85
        flange_class = "300"
        pressure_rating = 85
        temperature_rating = 1000
    elsif pressure > 85 and pressure <= 115
        flange_class = "400"
        pressure_rating = 115
        temperature_rating = 1000
    elsif pressure > 115 and pressure <= 170
        flange_class = "600"
        pressure_rating = 170
        temperature_rating = 1000
    elsif pressure > 170 and pressure <= 255
        flange_class = "900"
        pressure_rating = 255
        temperature_rating = 1000
    end
end
end

 
if material_group == "1.5"
if temperature >= -20 and temperature <= 100
    if pressure < 135
        flange_class = "75"
        pressure_rating = 135
        temperature_rating = 100
    elsif pressure > 135 and pressure <= 265
        flange_class = "150"
        pressure_rating = 265
        temperature_rating = 100
    elsif pressure > 265 and pressure <= 695
        flange_class = "300"
        pressure_rating = 695
        temperature_rating = 100
    elsif pressure > 695 and pressure <= 930
        flange_class = "400"
        pressure_rating = 930
        temperature_rating = 100
    elsif pressure > 930 and pressure <= 1395
        flange_class = "600"
        pressure_rating = 1395
        temperature_rating = 100
    elsif pressure > 1395 and pressure <= 2090
        flange_class = "900"
        pressure_rating = 2090
        temperature_rating = 100
    end
elsif temperature > 100 and temperature <= 200 
    if pressure < 130
        flange_class = "75"
        pressure_rating = 130
        temperature_rating = 200
    elsif pressure > 130 and pressure <= 260
        flange_class = "150"
        pressure_rating = 260
        temperature_rating = 200
    elsif pressure > 260 and pressure <= 695
        flange_class = "300"
        pressure_rating = 695
        temperature_rating = 200
    elsif pressure > 695 and pressure <= 930
        flange_class = "400"
        pressure_rating = 930
        temperature_rating = 200
    elsif pressure > 930 and pressure <= 1395
        flange_class = "600"
        pressure_rating = 1395
        temperature_rating = 200
    elsif pressure > 1395 and pressure <= 2090
        flange_class = "900"
        pressure_rating = 2090
        temperature_rating = 200
    end
elsif temperature > 200 and temperature <= 300 
    if pressure < 115
        flange_class = "75"
        pressure_rating = 115
        temperature_rating = 300
    elsif pressure > 115 and pressure <= 230
        flange_class = "150"
        pressure_rating = 230
        temperature_rating = 300
    elsif pressure > 230 and pressure <= 685
        flange_class = "300"
        pressure_rating = 685
        temperature_rating = 300
    elsif pressure > 685 and pressure <= 915
        flange_class = "400"
        pressure_rating = 915
        temperature_rating = 300
    elsif pressure > 915 and pressure <= 1375
        flange_class = "600"
        pressure_rating = 1375
        temperature_rating = 300
    elsif pressure > 1375 and pressure <= 2060
        flange_class = "900"
        pressure_rating = 2060
        temperature_rating = 300
    end
elsif temperature > 300 and temperature <= 400 
    if pressure < 100
        flange_class = "75"
        pressure_rating = 100
        temperature_rating = 400
    elsif pressure > 100 and pressure <= 200
        flange_class = "150"
        pressure_rating = 200
        temperature_rating = 400
    elsif pressure > 200 and pressure <= 660
        flange_class = "300"
        pressure_rating = 660
        temperature_rating = 400
    elsif pressure > 660 and pressure <= 885
        flange_class = "400"
        pressure_rating = 885
        temperature_rating = 400
    elsif pressure > 885 and pressure <= 1325
        flange_class = "600"
        pressure_rating = 1325
        temperature_rating = 400
    elsif pressure > 1325 and pressure <= 1985
        flange_class = "900"
        pressure_rating = 1985
        temperature_rating = 400
    end
elsif temperature > 400 and temperature <= 500 
    if pressure < 85
        flange_class = "75"
        pressure_rating = 85
        temperature_rating = 500
    elsif pressure > 85 and pressure <= 170
        flange_class = "150"
        pressure_rating = 170
        temperature_rating = 500
    elsif pressure > 170 and pressure <= 640
        flange_class = "300"
        pressure_rating = 640
        temperature_rating = 500
    elsif pressure > 640 and pressure <= 855
        flange_class = "400"
        pressure_rating = 855
        temperature_rating = 500
    elsif pressure > 855 and pressure <= 1285
        flange_class = "600"
        pressure_rating = 1285
        temperature_rating = 500
    elsif pressure > 1285 and pressure <= 1925
        flange_class = "900"
        pressure_rating = 1925
        temperature_rating = 500
    end
elsif temperature > 500 and temperature <= 600 
    if pressure < 70
        flange_class = "75"
        pressure_rating = 70
        temperature_rating = 600
    elsif pressure > 70 and pressure <= 140
        flange_class = "150"
        pressure_rating = 150
        temperature_rating = 600
    elsif pressure > 140 and pressure <= 605
        flange_class = "300"
        pressure_rating = 605
        temperature_rating = 600
    elsif pressure > 605 and pressure <= 805
        flange_class = "400"
        pressure_rating = 805
        temperature_rating = 600
    elsif pressure > 805 and pressure <= 1210
        flange_class = "600"
        pressure_rating = 1210
        temperature_rating = 600
    elsif pressure > 1210 and pressure <= 1815
        flange_class = "900"
        pressure_rating = 1815
        temperature_rating = 600
    end
elsif temperature > 600 and temperature <= 650 
    if pressure < 60
        flange_class = "75"
        pressure_rating = 60
        temperature_rating = 650
    elsif pressure > 60 and pressure <= 125
        flange_class = "150"
        pressure_rating = 125
        temperature_rating = 650
    elsif pressure > 125 and pressure <= 590
        flange_class = "300"
        pressure_rating = 590
        temperature_rating = 650
    elsif pressure > 590 and pressure <= 785
        flange_class = "400"
        pressure_rating = 785
        temperature_rating = 650
    elsif pressure > 785 and pressure <= 1175
        flange_class = "600"
        pressure_rating = 1175
        temperature_rating = 650
    elsif pressure > 1175 and pressure <= 1765
        flange_class = "900"
        pressure_rating = 1765
        temperature_rating = 650
    end
elsif temperature > 650 and temperature <= 700 
    if pressure <= 110
        flange_class = "150"
        pressure_rating = 110
        temperature_rating = 700
    elsif pressure > 110 and pressure <= 570
        flange_class = "300"
        pressure_rating = 570
        temperature_rating = 700
    elsif pressure > 570 and pressure <= 755
        flange_class = "400"
        pressure_rating = 755
        temperature_rating = 700
    elsif pressure > 755 and pressure <= 1135
        flange_class = "600"
        pressure_rating = 1135
        temperature_rating = 700
    elsif pressure > 1135 and pressure <= 1705
        flange_class = "900"
        pressure_rating = 1705
        temperature_rating = 700
    end
elsif temperature > 700 and temperature <= 750 
    if pressure <= 95
        flange_class = "150"
        pressure_rating = 95
        temperature_rating = 750
    elsif pressure > 95 and pressure <= 530
        flange_class = "300"
        pressure_rating = 530
        temperature_rating = 750
    elsif pressure > 530 and pressure <= 710
        flange_class = "400"
        pressure_rating = 710
        temperature_rating = 750
    elsif pressure > 710 and pressure <= 1065
        flange_class = "600"
        pressure_rating = 1065
        temperature_rating = 750
    elsif pressure > 1065 and pressure <= 1595
        flange_class = "900"
        pressure_rating = 1595
        temperature_rating = 750
    end
elsif temperature > 750 and temperature <= 800 
    if pressure <= 80
        flange_class = "150"
        pressure_rating = 80
        temperature_rating = 800
    elsif pressure > 80 and pressure <= 510
        flange_class = "300"
        pressure_rating = 510
        temperature_rating = 800
    elsif pressure > 510 and pressure <= 675
        flange_class = "400"
        pressure_rating = 675
        temperature_rating = 800
    elsif pressure > 675 and pressure <= 1015
        flange_class = "600"
        pressure_rating = 1015
        temperature_rating = 800
    elsif pressure > 1015 and pressure <= 1525
        flange_class = "900"
        pressure_rating = 1525
        temperature_rating = 800
    end
elsif temperature > 800 and temperature <= 850 
    if pressure <= 65
        flange_class = "150"
        pressure_rating = 65
        temperature_rating = 850
    elsif pressure > 65 and pressure <= 485
        flange_class = "300"
        pressure_rating = 485
        temperature_rating = 850
    elsif pressure > 485 and pressure <= 650
        flange_class = "400"
        pressure_rating = 650
        temperature_rating = 850
    elsif pressure > 650 and pressure <= 975
        flange_class = "600"
        pressure_rating = 975
        temperature_rating = 850
    elsif pressure > 975 and pressure <= 1460
        flange_class = "900"
        pressure_rating = 1460
        temperature_rating = 850
    end
elsif temperature > 850 and temperature <= 900 
    if pressure <= 50
        flange_class = "150"
        pressure_rating = 50
        temperature_rating = 900
    elsif pressure > 50 and pressure <= 450
        flange_class = "300"
        pressure_rating = 450
        temperature_rating = 900
    elsif pressure > 450 and pressure <= 600
        flange_class = "400"
        pressure_rating = 600
        temperature_rating = 900
    elsif pressure > 600 and pressure <= 900
        flange_class = "600"
        pressure_rating = 900
        temperature_rating = 900
    elsif pressure > 900 and pressure <= 1350
        flange_class = "900"
        pressure_rating = 1350
        temperature_rating = 900
    end
elsif temperature > 900 and temperature <= 950 
    if pressure <= 35
        flange_class = "150"
        pressure_rating = 35
        temperature_rating = 950
    elsif pressure > 35 and pressure <= 280
        flange_class = "300"
        pressure_rating = 280
        temperature_rating = 950
    elsif pressure > 280 and pressure <= 375
        flange_class = "400"
        pressure_rating = 375
        temperature_rating = 950
    elsif pressure > 375 and pressure <= 560
        flange_class = "600"
        pressure_rating = 560
        temperature_rating = 950
    elsif pressure > 560 and pressure <= 845
        flange_class = "900"
        pressure_rating = 845
        temperature_rating = 950
    end
elsif temperature > 950 and temperature <= 1000
    if pressure <= 20
        flange_class = "150"
        pressure_rating = 20
        temperature_rating = 1000
    elsif pressure > 20 and pressure <= 165
        flange_class = "300"
        pressure_rating = 165
        temperature_rating = 1000
    elsif pressure > 165 and pressure <= 220
        flange_class = "400"
        pressure_rating = 220
        temperature_rating = 1000
    elsif pressure > 220 and pressure <= 330
        flange_class = "600"
        pressure_rating = 330
        temperature_rating = 1000
    elsif pressure > 330 and pressure <= 495
        flange_class = "900"
        pressure_rating = 495
        temperature_rating = 1000
    end
end
end

if material_group == "1.7"
if temperature >= -20 and temperature <= 100
    if pressure <= 145
        flange_class = "75"
        pressure_rating = 145
        temperature_rating = 100
    elsif pressure > 145 and pressure <= 290
        flange_class = "150"
        pressure_rating = 290
        temperature_rating = 100
    elsif pressure > 290 and pressure <= 750
        flange_class = "300"
        pressure_rating = 750
        temperature_rating = 100
    elsif pressure > 750 and pressure <= 1000
        flange_class = "400"
        pressure_rating = 1000
        temperature_rating = 100
    elsif pressure > 1000 and pressure <= 1500
        flange_class = "600"
        pressure_rating = 1500
        temperature_rating = 100
    elsif pressure > 1500 and pressure <= 2250
        flange_class = "900"
        pressure_rating = 2250
        temperature_rating = 100
    end
elsif temperature > 100 and temperature <= 200 
    if pressure <= 130
        flange_class = "75"
        pressure_rating = 130
        temperature_rating = 200
    elsif pressure > 130 and pressure <= 260
        flange_class = "150"
        pressure_rating = 260
        temperature_rating = 200
    elsif pressure > 260 and pressure <= 750
        flange_class = "300"
        pressure_rating = 750
        temperature_rating = 200
    elsif pressure > 750 and pressure <= 1000
        flange_class = "400"
        pressure_rating = 1000
        temperature_rating = 200
    elsif pressure > 1000 and pressure <= 1500
        flange_class = "600"
        pressure_rating = 1500
        temperature_rating = 200
    elsif pressure > 1500 and pressure <= 2250
        flange_class = "900"
        pressure_rating = 2250
        temperature_rating = 200
    end
elsif temperature > 200 and temperature <= 300 
    if pressure <= 115
        flange_class = "75"
        pressure_rating = 115
        temperature_rating = 300
    elsif pressure > 115 and pressure <= 230
        flange_class = "150"
        pressure_rating = 230
        temperature_rating = 300
    elsif pressure > 230 and pressure <= 730
        flange_class = "300"
        pressure_rating = 730
        temperature_rating = 300
    elsif pressure > 730 and pressure <= 970
        flange_class = "400"
        pressure_rating = 970
        temperature_rating = 300
    elsif pressure > 970 and pressure <= 1455
        flange_class = "600"
        pressure_rating = 1455
        temperature_rating = 300
    elsif pressure > 1455 and pressure <= 2185
        flange_class = "900"
        pressure_rating = 2185
        temperature_rating = 300
    end
elsif temperature > 300 and temperature <= 400 
    if pressure <= 100
        flange_class = "75"
        pressure_rating = 100
        temperature_rating = 400
    elsif pressure > 100 and pressure <= 200
        flange_class = "150"
        pressure_rating = 200
        temperature_rating = 400
    elsif pressure > 200 and pressure <= 705
        flange_class = "300"
        pressure_rating = 705
        temperature_rating = 400
    elsif pressure > 705 and pressure <= 940
        flange_class = "400"
        pressure_rating = 940
        temperature_rating = 400
    elsif pressure > 940 and pressure <= 1410
        flange_class = "600"
        pressure_rating = 1410
        temperature_rating = 400
    elsif pressure > 1410 and pressure <= 2115
        flange_class = "900"
        pressure_rating = 2115
        temperature_rating = 400
    end
elsif temperature > 400 and temperature <= 500 
    if pressure <= 85
        flange_class = "75"
        pressure_rating = 85
        temperature_rating = 500
    elsif pressure > 85 and pressure <= 170
        flange_class = "150"
        pressure_rating = 170
        temperature_rating = 500
    elsif pressure > 170 and pressure <= 665
        flange_class = "300"
        pressure_rating = 665
        temperature_rating = 500
    elsif pressure > 665 and pressure <= 885
        flange_class = "400"
        pressure_rating = 885
        temperature_rating = 500
    elsif pressure > 885 and pressure <= 1330
        flange_class = "600"
        pressure_rating = 1330
        temperature_rating = 500
    elsif pressure > 1330 and pressure <= 1995
        flange_class = "900"
        pressure_rating = 1995
        temperature_rating = 500
    end
elsif temperature > 500 and temperature <= 600 
    if pressure <= 70
        flange_class = "75"
        pressure_rating = 70
        temperature_rating = 600
    elsif pressure > 70 and pressure <= 140
        flange_class = "150"
        pressure_rating = 140
        temperature_rating = 600
    elsif pressure > 140 and pressure <= 605
        flange_class = "300"
        pressure_rating = 605
        temperature_rating = 600
    elsif pressure > 605 and pressure <= 805
        flange_class = "400"
        pressure_rating = 805
        temperature_rating = 600
    elsif pressure > 805 and pressure <= 1210
        flange_class = "600"
        pressure_rating = 1210
        temperature_rating = 600
    elsif pressure > 1210 and pressure <= 1815
        flange_class = "900"
        pressure_rating = 1815
        temperature_rating = 600
    end
elsif temperature > 600 and temperature <= 650 
    if pressure <= 60
        flange_class = "75"
        pressure_rating = 60
        temperature_rating = 650
    elsif pressure > 60 and pressure <= 125
        flange_class = "150"
        pressure_rating = 125
        temperature_rating = 650
    elsif pressure > 125 and pressure <= 590
        flange_class = "300"
        pressure_rating = 590
        temperature_rating = 650
    elsif pressure > 590 and pressure <= 785
        flange_class = "400"
        pressure_rating = 785
        temperature_rating = 650
    elsif pressure > 785 and pressure <= 1175
        flange_class = "600"
        pressure_rating = 1175
        temperature_rating = 650
    elsif pressure > 1175 and pressure <= 1765
        flange_class = "900"
        pressure_rating = 1765
        temperature_rating = 650
    end
elsif temperature > 650 and temperature <= 700 
    if pressure <= 110
        flange_class = "150"
        pressure_rating = 110
        temperature_rating = 700
    elsif pressure > 110 and pressure <= 570
        flange_class = "300"
        pressure_rating = 570
        temperature_rating = 700
    elsif pressure > 570 and pressure <= 755
        flange_class = "400"
        pressure_rating = 755
        temperature_rating = 700
    elsif pressure > 755 and pressure <= 1135
        flange_class = "600"
        pressure_rating = 1135
        temperature_rating = 700
    elsif pressure > 1135 and pressure <= 1705
        flange_class = "900"
        pressure_rating = 1705
        temperature_rating = 700
    end
elsif temperature > 700 and temperature <= 750 
    if pressure <= 95
        flange_class = "150"
        pressure_rating = 95
        temperature_rating = 750
    elsif pressure > 95 and pressure <= 530
        flange_class = "300"
        pressure_rating = 530
        temperature_rating = 750
    elsif pressure > 530 and pressure <= 710
        flange_class = "400"
        pressure_rating = 710
        temperature_rating = 750
    elsif pressure > 710 and pressure <= 1065
        flange_class = "600"
        pressure_rating = 1065
        temperature_rating = 750
    elsif pressure > 1065 and pressure <= 1595
        flange_class = "900"
        pressure_rating = 1595
        temperature_rating = 750
    end
elsif temperature > 750 and temperature <= 800 
    if pressure <= 80
        flange_class = "150"
        pressure_rating = 80
        temperature_rating = 800
    elsif pressure > 80 and pressure <= 510
        flange_class = "300"
        pressure_rating = 510
        temperature_rating = 800
    elsif pressure > 510 and pressure <= 675
        flange_class = "400"
        pressure_rating = 675
        temperature_rating = 800
    elsif pressure > 675 and pressure <= 1015
        flange_class = "600"
        pressure_rating = 1015
        temperature_rating = 800
    elsif pressure > 1015 and pressure <= 1525
        flange_class = "900"
        pressure_rating = 1525
        temperature_rating = 800
    end
elsif temperature > 800 and temperature <= 850 
    if pressure <= 65
        flange_class = "150"
        pressure_rating = 65
        temperature_rating = 850
    elsif pressure > 65 and pressure <= 485
        flange_class = "300"
        pressure_rating = 485
        temperature_rating = 850
    elsif pressure > 485 and pressure <= 650
        flange_class = "400"
        pressure_rating = 650
        temperature_rating = 850
    elsif pressure > 650 and pressure <= 975
        flange_class = "600"
        pressure_rating = 975
        temperature_rating = 850
    elsif pressure > 975 and pressure <= 1460
        flange_class = "900"
        pressure_rating = 1460
        temperature_rating = 850
    end
elsif temperature > 850 and temperature <= 900 
    if pressure <= 50
        flange_class = "150"
        pressure_rating = 50
        temperature_rating = 900
    elsif pressure > 50 and pressure <= 450
        flange_class = "300"
        pressure_rating = 450
        temperature_rating = 900
    elsif pressure > 450 and pressure <= 600
        flange_class = "400"
        pressure_rating = 600
        temperature_rating = 900
    elsif pressure > 600 and pressure <= 900
        flange_class = "600"
        pressure_rating = 900
        temperature_rating = 900
    elsif pressure > 900 and pressure <= 1350
        flange_class = "900"
        pressure_rating = 1350
        temperature_rating = 900
    end
elsif temperature > 900 and temperature <= 950 
    if pressure <= 35
        flange_class = "150"
        pressure_rating = 35
        temperature_rating = 950
    elsif pressure > 35 and pressure <= 315
        flange_class = "300"
        pressure_rating = 315
        temperature_rating = 950
    elsif pressure > 315 and pressure <= 420
        flange_class = "400"
        pressure_rating = 420
        temperature_rating = 950
    elsif pressure > 420 and pressure <= 630
        flange_class = "600"
        pressure_rating = 630
        temperature_rating = 950
    elsif pressure > 630 and pressure <= 945
        flange_class = "900"
        pressure_rating = 945
        temperature_rating = 950
    end
elsif temperature > 950 and temperature <= 1000
    if pressure <= 20
        flange_class = "150"
        pressure_rating = 20
        temperature_rating = 1000
    elsif pressure > 20 and pressure <= 200
        flange_class = "300"
        pressure_rating = 200
        temperature_rating = 1000
    elsif pressure > 200 and pressure <= 270
        flange_class = "400"
        pressure_rating = 270
        temperature_rating = 1000
    elsif pressure > 270 and pressure <= 405
        flange_class = "600"
        pressure_rating = 405
        temperature_rating = 1000
    elsif pressure > 405 and pressure <= 605
        flange_class = "900"
        pressure_rating = 605
        temperature_rating = 1000
    end
elsif temperature > 1000 and temperature <= 105
    if pressure > 160
        flange_class = "300"
        pressure_rating = 160
        temperature_rating = 1200
    elsif pressure > 160 and pressure <= 210
        flange_class = "400"
        pressure_rating = 210
        temperature_rating = 1200
    elsif pressure > 210 and pressure <= 315
        flange_class = "600"
        pressure_rating = 315
        temperature_rating = 1200
    elsif pressure > 315 and pressure <= 475
        flange_class = "900"
        pressure_rating = 475
        temperature_rating = 1200
    end
end
end

if material_group == "1.9"
if temperature >= -20 and temperature <= 100
    if pressure <= 145
        flange_class = "75"
        pressure_rating = 145
        temperature_rating = 100
    elsif pressure > 145 and pressure <= 290
        flange_class = "150"
        pressure_rating = 290
        temperature_rating = 100
    elsif pressure > 290 and pressure <= 750
        flange_class = "300"
        pressure_rating = 750
        temperature_rating = 100
    elsif pressure > 750 and pressure <= 1000
        flange_class = "400"
        pressure_rating = 1000
        temperature_rating = 100
    elsif pressure > 1000 and pressure <= 1500
        flange_class = "600"
        pressure_rating = 1500
        temperature_rating = 100
    elsif pressure > 1500 and pressure <= 2250
        flange_class = "900"
        pressure_rating = 2250
        temperature_rating = 100
    end
elsif temperature > 100 and temperature <= 200 
    if pressure <= 130
        flange_class = "75"
        pressure_rating = 130
        temperature_rating = 200
    elsif pressure > 130 and pressure <= 260
        flange_class = "150"
        pressure_rating = 260
        temperature_rating = 200
    elsif pressure > 260 and pressure <= 750
        flange_class = "300"
        pressure_rating = 750
        temperature_rating = 200
    elsif pressure > 750 and pressure <= 1000
        flange_class = "400"
        pressure_rating = 1000
        temperature_rating = 200
    elsif pressure > 1000 and pressure <= 1500
        flange_class = "600"
        pressure_rating = 1500
        temperature_rating = 200
    elsif pressure > 1500 and pressure <= 2250
        flange_class = "900"
        pressure_rating = 2250
        temperature_rating = 200
    end
elsif temperature > 200 and temperature <= 300 
    if pressure <= 115
        flange_class = "75"
        pressure_rating = 115
        temperature_rating = 300
    elsif pressure > 115 and pressure <= 230
        flange_class = "150"
        pressure_rating = 230
        temperature_rating = 300
    elsif pressure > 230 and pressure <= 720
        flange_class = "300"
        pressure_rating = 720
        temperature_rating = 300
    elsif pressure > 720 and pressure <= 965
        flange_class = "400"
        pressure_rating = 965
        temperature_rating = 300
    elsif pressure > 965 and pressure <= 1445
        flange_class = "600"
        pressure_rating = 1445
        temperature_rating = 300
    elsif pressure > 1445 and pressure <= 2165
        flange_class = "900"
        pressure_rating = 2165
        temperature_rating = 300
    end
elsif temperature > 300 and temperature <= 400 
    if pressure <= 100
        flange_class = "75"
        pressure_rating = 100
        temperature_rating = 400
    elsif pressure > 100 and pressure <= 200
        flange_class = "150"
        pressure_rating = 200
        temperature_rating = 400
    elsif pressure > 200 and pressure <= 695
        flange_class = "300"
        pressure_rating = 695
        temperature_rating = 400
    elsif pressure > 695 and pressure <= 925
        flange_class = "400"
        pressure_rating = 925
        temperature_rating = 400
    elsif pressure > 925 and pressure <= 1385
        flange_class = "600"
        pressure_rating = 1385
        temperature_rating = 400
    elsif pressure > 1385 and pressure <= 2080
        flange_class = "900"
        pressure_rating = 2080
        temperature_rating = 400
    end
elsif temperature > 400 and temperature <= 500 
    if pressure <= 85
        flange_class = "75"
        pressure_rating = 85
        temperature_rating = 500
    elsif pressure > 85 and pressure <= 170
        flange_class = "150"
        pressure_rating = 170
        temperature_rating = 500
    elsif pressure > 170 and pressure <= 665
        flange_class = "300"
        pressure_rating = 665
        temperature_rating = 500
    elsif pressure > 665 and pressure <= 885
        flange_class = "400"
        pressure_rating = 885
        temperature_rating = 500
    elsif pressure > 885 and pressure <= 1330
        flange_class = "600"
        pressure_rating = 1330
        temperature_rating = 500
    elsif pressure > 1330 and pressure <= 1995
        flange_class = "900"
        pressure_rating = 1995
        temperature_rating = 500
    end
elsif temperature > 500 and temperature <= 600 
    if pressure <= 70
        flange_class = "75"
        pressure_rating = 70
        temperature_rating = 600
    elsif pressure > 70 and pressure <= 140
        flange_class = "150"
        pressure_rating = 150
        temperature_rating = 600
    elsif pressure > 140 and pressure <= 605
        flange_class = "300"
        pressure_rating = 605
        temperature_rating = 600
    elsif pressure > 605 and pressure <= 805
        flange_class = "400"
        pressure_rating = 805
        temperature_rating = 600
    elsif pressure > 805 and pressure <= 1210
        flange_class = "600"
        pressure_rating = 1210
        temperature_rating = 600
    elsif pressure > 1210 and pressure <= 1815
        flange_class = "900"
        pressure_rating = 1815
        temperature_rating = 600
    end
elsif temperature > 600 and temperature <= 650 
    if pressure <= 60
        flange_class = "75"
        pressure_rating = 60
        temperature_rating = 650
    elsif pressure > 60 and pressure <= 125
        flange_class = "150"
        pressure_rating = 125
        temperature_rating = 650
    elsif pressure > 125 and pressure <= 590
        flange_class = "300"
        pressure_rating = 590
        temperature_rating = 650
    elsif pressure > 590 and pressure <= 785
        flange_class = "400"
        pressure_rating = 785
        temperature_rating = 650
    elsif pressure > 785 and pressure <= 1175
        flange_class = "600"
        pressure_rating = 1175
        temperature_rating = 650
    elsif pressure > 1175 and pressure <= 1765
        flange_class = "900"
        pressure_rating = 1765
        temperature_rating = 650
    end
elsif temperature > 650 and temperature <= 700 
    if pressure <= 110
        flange_class = "150"
        pressure_rating = 110
        temperature_rating = 700
    elsif pressure > 110 and pressure <= 570
        flange_class = "300"
        pressure_rating = 570
        temperature_rating = 700
    elsif pressure > 570 and pressure <= 755
        flange_class = "400"
        pressure_rating = 755
        temperature_rating = 700
    elsif pressure > 755 and pressure <= 1135
        flange_class = "600"
        pressure_rating = 1135
        temperature_rating = 700
    elsif pressure > 1135 and pressure <= 1705
        flange_class = "900"
        pressure_rating = 1705
        temperature_rating = 700
    end
elsif temperature > 700 and temperature <= 750 
    if pressure <= 95
        flange_class = "150"
        pressure_rating = 95
        temperature_rating = 750
    elsif pressure > 95 and pressure <= 530
        flange_class = "300"
        pressure_rating = 530
        temperature_rating = 750
    elsif pressure > 530 and pressure <= 710
        flange_class = "400"
        pressure_rating = 710
        temperature_rating = 750
    elsif pressure > 710 and pressure <= 1065
        flange_class = "600"
        pressure_rating = 1065
        temperature_rating = 750
    elsif pressure > 1065 and pressure <= 1595
        flange_class = "900"
        pressure_rating = 1595
        temperature_rating = 750
    end
elsif temperature > 750 and temperature <= 800 
    if pressure <= 80
        flange_class = "150"
        pressure_rating = 80
        temperature_rating = 800
    elsif pressure > 80 and pressure <= 510
        flange_class = "300"
        pressure_rating = 510
        temperature_rating = 800
    elsif pressure > 510 and pressure <= 675
        flange_class = "400"
        pressure_rating = 675
        temperature_rating = 800
    elsif pressure > 675 and pressure <= 1015
        flange_class = "600"
        pressure_rating = 1015
        temperature_rating = 800
    elsif pressure > 1015 and pressure <= 1525
        flange_class = "900"
        pressure_rating = 1525
        temperature_rating = 800
    end
elsif temperature > 800 and temperature <= 850 
    if pressure <= 65
        flange_class = "150"
        pressure_rating = 65
        temperature_rating = 850
    elsif pressure > 65 and pressure <= 485
        flange_class = "300"
        pressure_rating = 485
        temperature_rating = 850
    elsif pressure > 485 and pressure <= 650
        flange_class = "400"
        pressure_rating = 650
        temperature_rating = 850
    elsif pressure > 650 and pressure <= 975
        flange_class = "600"
        pressure_rating = 975
        temperature_rating = 850
    elsif pressure > 975 and pressure <= 1460
        flange_class = "900"
        pressure_rating = 1460
        temperature_rating = 850
    end
elsif temperature > 850 and temperature <= 900 
    if pressure <= 50
        flange_class = "150"
        pressure_rating = 50
        temperature_rating = 900
    elsif pressure > 50 and pressure <= 450
        flange_class = "300"
        pressure_rating = 450
        temperature_rating = 900
    elsif pressure > 450 and pressure <= 600
        flange_class = "400"
        pressure_rating = 600
        temperature_rating = 900
    elsif pressure > 600 and pressure <= 900
        flange_class = "600"
        pressure_rating = 900
        temperature_rating = 900
    elsif pressure > 900 and pressure <= 1350
        flange_class = "900"
        pressure_rating = 1350
        temperature_rating = 900
    end
elsif temperature > 900 and temperature <= 950 
    if pressure <= 35
        flange_class = "150"
        pressure_rating = 35
        temperature_rating = 950
    elsif pressure > 35 and pressure <= 320
        flange_class = "300"
        pressure_rating = 320
        temperature_rating = 950
    elsif pressure > 320 and pressure <= 425
        flange_class = "400"
        pressure_rating = 425
        temperature_rating = 950
    elsif pressure > 425 and pressure <= 640
        flange_class = "600"
        pressure_rating = 640
        temperature_rating = 950
    elsif pressure > 640 and pressure <= 955
        flange_class = "900"
        pressure_rating = 955
        temperature_rating = 950
    end
elsif temperature > 950 and temperature <= 1000
    if pressure <= 20
        flange_class = "150"
        pressure_rating = 20
        temperature_rating = 1000
    elsif pressure > 20 and pressure <= 215
        flange_class = "300"
        pressure_rating = 215
        temperature_rating = 1000
    elsif pressure > 215 and pressure <= 290
        flange_class = "400"
        pressure_rating = 290
        temperature_rating = 1000
    elsif pressure > 290 and pressure <= 430
        flange_class = "600"
        pressure_rating = 430
        temperature_rating = 1000
    elsif pressure > 430 and pressure <= 650
        flange_class = "900"
        pressure_rating = 650
        temperature_rating = 1000
    end
elsif temperature > 1000 and temperature <= 105
    if pressure > 145
        flange_class = "300"
        pressure_rating = 145
        temperature_rating = 1050
    elsif pressure > 145 and pressure <= 190
        flange_class = "400"
        pressure_rating = 190
        temperature_rating = 1050
    elsif pressure > 190 and pressure <= 290
        flange_class = "600"
        pressure_rating = 290
        temperature_rating = 1050
    elsif pressure > 290 and pressure <= 430
        flange_class = "900"
        pressure_rating = 430
        temperature_rating = 1050
    end
elsif temperature > 1050 and temperature <= 110
    if pressure > 95
        flange_class = "300"
        pressure_rating = 95
        temperature_rating = 1100
    elsif pressure > 95 and pressure <= 130
        flange_class = "400"
        pressure_rating = 130
        temperature_rating = 1100
    elsif pressure > 130 and pressure <= 190
        flange_class = "600"
        pressure_rating = 190
        temperature_rating = 1100
    elsif pressure > 190 and pressure <= 290
        flange_class = "900"
        pressure_rating = 290
        temperature_rating = 1100
    end
elsif temperature > 1100 and temperature <= 115
    if pressure > 65
        flange_class = "300"
        pressure_rating = 65
        temperature_rating = 1150
    elsif pressure > 65 and pressure <= 85
        flange_class = "400"
        pressure_rating = 85
        temperature_rating = 1150
    elsif pressure > 85 and pressure <= 130
        flange_class = "600"
        pressure_rating = 130
        temperature_rating = 1150
    elsif pressure > 130 and pressure <= 195
        flange_class = "900"
        pressure_rating = 195
        temperature_rating = 1150
    end
elsif temperature > 1150 and temperature <= 120
    if pressure > 40
        flange_class = "300"
        pressure_rating = 40
        temperature_rating = 1200
    elsif pressure > 40 and pressure <= 55
        flange_class = "400"
        pressure_rating = 55
        temperature_rating = 1200
    elsif pressure > 55 and pressure <= 80
        flange_class = "600"
        pressure_rating = 80
        temperature_rating = 1200
    elsif pressure > 80 and pressure <= 125
        flange_class = "900"
        pressure_rating = 125
        temperature_rating = 1200
    end
end
end

if material_group == "1.10"
if temperature >= -20 and temperature <= 100
    if pressure <= 145
        flange_class = "75"
        pressure_rating = 145
        temperature_rating = 100
    elsif pressure > 145 and pressure <= 290
        flange_class = "150"
        pressure_rating = 290
        temperature_rating = 100
    elsif pressure > 290 and pressure <= 750
        flange_class = "300"
        pressure_rating = 750
        temperature_rating = 100
    elsif pressure > 750 and pressure <= 1000
        flange_class = "400"
        pressure_rating = 1000
        temperature_rating = 100
    elsif pressure > 1000 and pressure <= 1500
        flange_class = "600"
        pressure_rating = 1500
        temperature_rating = 100
    elsif pressure > 1500 and pressure <= 2250
        flange_class = "900"
        pressure_rating = 2250
        temperature_rating = 100
    end
elsif temperature > 100 and temperature <= 200 
    if pressure <= 130
        flange_class = "75"
        pressure_rating = 130
        temperature_rating = 200
    elsif pressure > 130 and pressure <= 260
        flange_class = "150"
        pressure_rating = 260
        temperature_rating = 200
    elsif pressure > 260 and pressure <= 750
        flange_class = "300"
        pressure_rating = 750
        temperature_rating = 200
    elsif pressure > 750 and pressure <= 1000
        flange_class = "400"
        pressure_rating = 1000
        temperature_rating = 200
    elsif pressure > 1000 and pressure <= 1500
        flange_class = "600"
        pressure_rating = 1500
        temperature_rating = 200
    elsif pressure > 1500 and pressure <= 2250
        flange_class = "900"
        pressure_rating = 2250
        temperature_rating = 200
    end
elsif temperature > 200 and temperature <= 300 
    if pressure <= 115
        flange_class = "75"
        pressure_rating = 115
        temperature_rating = 300
    elsif pressure > 115 and pressure <= 230
        flange_class = "150"
        pressure_rating = 230
        temperature_rating = 300
    elsif pressure > 230 and pressure <= 720
        flange_class = "300"
        pressure_rating = 720
        temperature_rating = 300
    elsif pressure > 720 and pressure <= 970
        flange_class = "400"
        pressure_rating = 970
        temperature_rating = 300
    elsif pressure > 970 and pressure <= 1455
        flange_class = "600"
        pressure_rating = 1445
        temperature_rating = 300
    elsif pressure > 1445 and pressure <= 2185
        flange_class = "900"
        pressure_rating = 2185
        temperature_rating = 300
    end
elsif temperature > 300 and temperature <= 400 
    if pressure <= 100
        flange_class = "75"
        pressure_rating = 100
        temperature_rating = 400
    elsif pressure > 100 and pressure <= 200
        flange_class = "150"
        pressure_rating = 200
        temperature_rating = 400
    elsif pressure > 200 and pressure <= 705
        flange_class = "300"
        pressure_rating = 705
        temperature_rating = 400
    elsif pressure > 705 and pressure <= 940
        flange_class = "400"
        pressure_rating = 940
        temperature_rating = 400
    elsif pressure > 940 and pressure <= 1410
        flange_class = "600"
        pressure_rating = 1410
        temperature_rating = 400
    elsif pressure > 1410 and pressure <= 2115
        flange_class = "900"
        pressure_rating = 2115
        temperature_rating = 400
    end
elsif temperature > 400 and temperature <= 500 
    if pressure <= 85
        flange_class = "75"
        pressure_rating = 85
        temperature_rating = 500
    elsif pressure > 85 and pressure <= 170
        flange_class = "150"
        pressure_rating = 170
        temperature_rating = 500
    elsif pressure > 170 and pressure <= 665
        flange_class = "300"
        pressure_rating = 665
        temperature_rating = 500
    elsif pressure > 665 and pressure <= 885
        flange_class = "400"
        pressure_rating = 885
        temperature_rating = 500
    elsif pressure > 885 and pressure <= 1330
        flange_class = "600"
        pressure_rating = 1330
        temperature_rating = 500
    elsif pressure > 1330 and pressure <= 1995
        flange_class = "900"
        pressure_rating = 1995
        temperature_rating = 500
    end
elsif temperature > 500 and temperature <= 600 
    if pressure <= 70
        flange_class = "75"
        pressure_rating = 70
        temperature_rating = 600
    elsif pressure > 70 and pressure <= 140
        flange_class = "150"
        pressure_rating = 150
        temperature_rating = 600
    elsif pressure > 140 and pressure <= 605
        flange_class = "300"
        pressure_rating = 605
        temperature_rating = 600
    elsif pressure > 605 and pressure <= 805
        flange_class = "400"
        pressure_rating = 805
        temperature_rating = 600
    elsif pressure > 805 and pressure <= 1210
        flange_class = "600"
        pressure_rating = 1210
        temperature_rating = 600
    elsif pressure > 1210 and pressure <= 1815
        flange_class = "900"
        pressure_rating = 1815
        temperature_rating = 600
    end
elsif temperature > 600 and temperature <= 650 
    if pressure <= 60
        flange_class = "75"
        pressure_rating = 60
        temperature_rating = 650
    elsif pressure > 60 and pressure <= 125
        flange_class = "150"
        pressure_rating = 125
        temperature_rating = 650
    elsif pressure > 125 and pressure <= 590
        flange_class = "300"
        pressure_rating = 590
        temperature_rating = 650
    elsif pressure > 590 and pressure <= 785
        flange_class = "400"
        pressure_rating = 785
        temperature_rating = 650
    elsif pressure > 785 and pressure <= 1175
        flange_class = "600"
        pressure_rating = 1175
        temperature_rating = 650
    elsif pressure > 1175 and pressure <= 1765
        flange_class = "900"
        pressure_rating = 1765
        temperature_rating = 650
    end
elsif temperature > 650 and temperature <= 700 
    if pressure <= 110
        flange_class = "150"
        pressure_rating = 110
        temperature_rating = 700
    elsif pressure > 110 and pressure <= 570
        flange_class = "300"
        pressure_rating = 570
        temperature_rating = 700
    elsif pressure > 570 and pressure <= 755
        flange_class = "400"
        pressure_rating = 755
        temperature_rating = 700
    elsif pressure > 755 and pressure <= 1135
        flange_class = "600"
        pressure_rating = 1135
        temperature_rating = 700
    elsif pressure > 1135 and pressure <= 1705
        flange_class = "900"
        pressure_rating = 1705
        temperature_rating = 700
    end
elsif temperature > 700 and temperature <= 750 
    if pressure <= 95
        flange_class = "150"
        pressure_rating = 95
        temperature_rating = 750
    elsif pressure > 95 and pressure <= 530
        flange_class = "300"
        pressure_rating = 530
        temperature_rating = 750
    elsif pressure > 530 and pressure <= 710
        flange_class = "400"
        pressure_rating = 710
        temperature_rating = 750
    elsif pressure > 710 and pressure <= 1065
        flange_class = "600"
        pressure_rating = 1065
        temperature_rating = 750
    elsif pressure > 1065 and pressure <= 1595
        flange_class = "900"
        pressure_rating = 1595
        temperature_rating = 750
    end
elsif temperature > 750 and temperature <= 800 
    if pressure <= 80
        flange_class = "150"
        pressure_rating = 80
        temperature_rating = 800
    elsif pressure > 80 and pressure <= 510
        flange_class = "300"
        pressure_rating = 510
        temperature_rating = 800
    elsif pressure > 510 and pressure <= 675
        flange_class = "400"
        pressure_rating = 675
        temperature_rating = 800
    elsif pressure > 675 and pressure <= 1015
        flange_class = "600"
        pressure_rating = 1015
        temperature_rating = 800
    elsif pressure > 1015 and pressure <= 1525
        flange_class = "900"
        pressure_rating = 1525
        temperature_rating = 800
    end
elsif temperature > 800 and temperature <= 850 
    if pressure <= 65
        flange_class = "150"
        pressure_rating = 65
        temperature_rating = 850
    elsif pressure > 65 and pressure <= 485
        flange_class = "300"
        pressure_rating = 485
        temperature_rating = 850
    elsif pressure > 485 and pressure <= 650
        flange_class = "400"
        pressure_rating = 650
        temperature_rating = 850
    elsif pressure > 650 and pressure <= 975
        flange_class = "600"
        pressure_rating = 975
        temperature_rating = 850
    elsif pressure > 975 and pressure <= 1460
        flange_class = "900"
        pressure_rating = 1460
        temperature_rating = 850
    end
elsif temperature > 850 and temperature <= 900 
    if pressure <= 50
        flange_class = "150"
        pressure_rating = 50
        temperature_rating = 900
    elsif pressure > 50 and pressure <= 450
        flange_class = "300"
        pressure_rating = 450
        temperature_rating = 900
    elsif pressure > 450 and pressure <= 600
        flange_class = "400"
        pressure_rating = 600
        temperature_rating = 900
    elsif pressure > 600 and pressure <= 900
        flange_class = "600"
        pressure_rating = 900
        temperature_rating = 900
    elsif pressure > 900 and pressure <= 1350
        flange_class = "900"
        pressure_rating = 1350
        temperature_rating = 900
    end
elsif temperature > 900 and temperature <= 950 
    if pressure <= 35
        flange_class = "150"
        pressure_rating = 35
        temperature_rating = 950
    elsif pressure > 35 and pressure <= 385
        flange_class = "300"
        pressure_rating = 385
        temperature_rating = 950
    elsif pressure > 385 and pressure <= 515
        flange_class = "400"
        pressure_rating = 515
        temperature_rating = 950
    elsif pressure > 515 and pressure <= 755
        flange_class = "600"
        pressure_rating = 755
        temperature_rating = 950
    elsif pressure > 755 and pressure <= 1160
        flange_class = "900"
        pressure_rating = 1160
        temperature_rating = 950
    end
elsif temperature > 950 and temperature <= 1000
    if pressure <= 20
        flange_class = "150"
        pressure_rating = 20
        temperature_rating = 1000
    elsif pressure > 20 and pressure <= 265
        flange_class = "300"
        pressure_rating = 265
        temperature_rating = 1000
    elsif pressure > 265 and pressure <= 355
        flange_class = "400"
        pressure_rating = 355
        temperature_rating = 1000
    elsif pressure > 355 and pressure <= 535
        flange_class = "600"
        pressure_rating = 535
        temperature_rating = 1000
    elsif pressure > 535 and pressure <= 800
        flange_class = "900"
        pressure_rating = 800
        temperature_rating = 1000
    end
elsif temperature > 1000 and temperature <= 105
    if pressure > 175
        flange_class = "300"
        pressure_rating = 175
        temperature_rating = 1050
    elsif pressure > 175 and pressure <= 235
        flange_class = "400"
        pressure_rating = 235
        temperature_rating = 1050
    elsif pressure > 235 and pressure <= 350
        flange_class = "600"
        pressure_rating = 350
        temperature_rating = 1050
    elsif pressure > 350 and pressure <= 525
        flange_class = "900"
        pressure_rating = 525
        temperature_rating = 1050
    end
elsif temperature > 1050 and temperature <= 110
    if pressure > 110
        flange_class = "300"
        pressure_rating = 110
        temperature_rating = 1100
    elsif pressure > 110 and pressure <= 145
        flange_class = "400"
        pressure_rating = 145
        temperature_rating = 1100
    elsif pressure > 145 and pressure <= 220
        flange_class = "600"
        pressure_rating = 220
        temperature_rating = 1100
    elsif pressure > 220 and pressure <= 330
        flange_class = "900"
        pressure_rating = 330
        temperature_rating = 1100
    end
elsif temperature > 1100 and temperature <= 115
    if pressure > 70
        flange_class = "300"
        pressure_rating = 70
        temperature_rating = 1150
    elsif pressure > 70 and pressure <= 90
        flange_class = "400"
        pressure_rating = 90
        temperature_rating = 1150
    elsif pressure > 90 and pressure <= 135
        flange_class = "600"
        pressure_rating = 135
        temperature_rating = 1150
    elsif pressure > 135 and pressure <= 205
        flange_class = "900"
        pressure_rating = 205
        temperature_rating = 1150
    end
elsif temperature > 1150 and temperature <= 120
    if pressure > 40
        flange_class = "300"
        pressure_rating = 40
        temperature_rating = 1200
    elsif pressure > 40 and pressure <= 55
        flange_class = "400"
        pressure_rating = 55
        temperature_rating = 1200
    elsif pressure > 55 and pressure <= 80
        flange_class = "600"
        pressure_rating = 80
        temperature_rating = 1200
    elsif pressure > 80 and pressure <= 125
        flange_class = "900"
        pressure_rating = 125
        temperature_rating = 1200
    end
end
end

if material_group == "1.11"
    if temperature >= -20 and temperature <= 100
        if pressure <= 145
            flange_class = "75"
            pressure_rating = 145
            temperature_rating = 100
        elsif pressure > 100 and pressure <= 290
            flange_class = "150"
            pressure_rating = 290
            temperature_rating = 100
        elsif pressure > 290 and pressure <= 750
            flange_class = "300"
            pressure_rating = 750
            temperature_rating = 100
        elsif pressure > 750 and pressure <= 1000
            flange_class = "400"
            pressure_rating = 1000
            temperature_rating = 100
        elsif pressure > 1000 and pressure <= 1500
            flange_class = "600"
            pressure_rating = 1500
            temperature_rating = 100
        elsif pressure > 1500 and pressure <= 2250
            flange_class = "900"
            pressure_rating = 2250
            temperature_rating = 100
        end
    elsif temperature > 100 and temperature <= 200 
        if pressure <= 130
            flange_class = "75"
            pressure_rating = 130
            temperature_rating = 200
        elsif pressure > 130 and pressure <= 260
            flange_class = "150"
            pressure_rating = 260
            temperature_rating = 200
        elsif pressure > 260 and pressure <= 750
            flange_class = "300"
            pressure_rating = 750
            temperature_rating = 200
        elsif pressure > 750 and pressure <= 1000
            flange_class = "400"
            pressure_rating = 1000
            temperature_rating = 200
        elsif pressure > 1000 and pressure <= 1500
            flange_class = "600"
            pressure_rating = 1500
            temperature_rating = 200
        elsif pressure > 1500 and pressure <= 2250
            flange_class = "900"
            pressure_rating = 2250
            temperature_rating = 200
        end
    elsif temperature > 200 and temperature <= 300 
        if pressure <= 115
            flange_class = "75"
            pressure_rating = 115
            temperature_rating = 300
        elsif pressure > 115 and pressure <= 230
            flange_class = "150"
            pressure_rating = 230
            temperature_rating = 300
        elsif pressure > 230 and pressure <= 730
            flange_class = "300"
            pressure_rating = 730
            temperature_rating = 300
        elsif pressure > 730 and pressure <= 970
            flange_class = "400"
            pressure_rating = 970
            temperature_rating = 300
        elsif pressure > 970 and pressure <= 1455
            flange_class = "600"
            pressure_rating = 1455
            temperature_rating = 300
        elsif pressure > 1455 and pressure <= 2185
            flange_class = "900"
            pressure_rating = 2185
            temperature_rating = 300
        end
    elsif temperature > 300 and temperature <= 400 
        if pressure <= 100
            flange_class = "75"
            pressure_rating = 100
            temperature_rating = 400
        elsif pressure > 100 and pressure <= 200
            flange_class = "150"
            pressure_rating = 200
            temperature_rating = 400
        elsif pressure > 200 and pressure <= 705
            flange_class = "300"
            pressure_rating = 705
            temperature_rating = 400
        elsif pressure > 705 and pressure <= 940
            flange_class = "400"
            pressure_rating = 940
            temperature_rating = 400
        elsif pressure > 940 and pressure <= 1410
            flange_class = "600"
            pressure_rating = 1410
            temperature_rating = 400
        elsif pressure > 1410 and pressure <= 2115
            flange_class = "900"
            pressure_rating = 2115
        end
    elsif temperature > 400 and temperature <= 500 
        if pressure <= 85
            flange_class = "75"
            pressure_rating = 85
            temperature_rating = 500
        elsif pressure > 85 and pressure <= 170
            flange_class = "150"
            pressure_rating = 170
            temperature_rating = 500
        elsif pressure > 170 and pressure <= 665
            flange_class = "300"
            pressure_rating = 665
            temperature_rating = 500
        elsif pressure > 665 and pressure <= 885
            flange_class = "400"
            pressure_rating = 885
            temperature_rating = 500
        elsif pressure > 885 and pressure <= 1330
            flange_class = "600"
            pressure_rating = 1330
            temperature_rating = 500
        elsif pressure > 1330 and pressure <= 1995
            flange_class = "900"
            pressure_rating = 1995
            temperature_rating = 500
        end
    elsif temperature > 500 and temperature <= 600 
        if pressure <= 70
            flange_class = "75"
            pressure_rating = 70
            temperature_rating = 600
        elsif pressure > 70 and pressure <= 140
            flange_class = "150"
            pressure_rating = 140
            temperature_rating = 600
        elsif pressure > 140 and pressure <= 605
            flange_class = "300"
            pressure_rating = 605
            temperature_rating = 600
        elsif pressure > 605 and pressure <= 805
            flange_class = "400"
            pressure_rating = 805
            temperature_rating = 600
        elsif pressure > 805 and pressure <= 1210
            flange_class = "600"
            pressure_rating = 1210
            temperature_rating = 600
        elsif pressure > 1210 and pressure <= 1815
            flange_class = "900"
            pressure_rating = 1815
            temperature_rating = 600
        end
    elsif temperature > 600 and temperature <= 650 
        if pressure <= 60
            flange_class = "75"
            pressure_rating = 60
            temperature_rating = 650
        elsif pressure > 60 and pressure <= 125
            flange_class = "150"
            pressure_rating = 125
            temperature_rating = 650
        elsif pressure > 125 and pressure <= 590
            flange_class = "300"
            pressure_rating = 590
            temperature_rating = 650
        elsif pressure > 590 and pressure <= 785
            flange_class = "400"
            pressure_rating = 785
            temperature_rating = 650
        elsif pressure > 785 and pressure <= 1175
            flange_class = "600"
            pressure_rating = 1175
            temperature_rating = 650
        elsif pressure > 1175 and pressure <= 1765
            flange_class = "900"
            pressure_rating = 1765
            temperature_rating = 650
        end
    elsif temperature > 650 and temperature <= 700 
        if pressure <= 110
            flange_class = "150"
            pressure_rating = 110
            temperature_rating = 700
        elsif pressure > 110 and pressure <= 570
            flange_class = "300"
            pressure_rating = 570
            temperature_rating = 700
        elsif pressure > 570 and pressure <= 755
            flange_class = "400"
            pressure_rating = 755
            temperature_rating = 700
        elsif pressure > 755 and pressure <= 1135
            flange_class = "600"
            pressure_rating = 1135
            temperature_rating = 700
        elsif pressure > 1135 and pressure <= 1705
            flange_class = "900"
            pressure_rating = 1705
            temperature_rating = 700
        end
    elsif temperature > 700 and temperature <= 750 
        if pressure <= 95
            flange_class = "150"
            pressure_rating = 95
            temperature_rating = 750
        elsif pressure > 95 and pressure <= 530
            flange_class = "300"
            pressure_rating = 530
            temperature_rating = 750
        elsif pressure > 530 and pressure <= 710
            flange_class = "400"
            pressure_rating = 710
            temperature_rating = 750
        elsif pressure > 710 and pressure <= 1065
            flange_class = "600"
            pressure_rating = 1065
            temperature_rating = 750
        elsif pressure > 1065 and pressure <= 1595
            flange_class = "900"
            pressure_rating = 1595
            temperature_rating = 750
        end
    elsif temperature > 750 and temperature <= 800 
        if pressure <= 80
            flange_class = "150"
            pressure_rating = 80
            temperature_rating = 800
        elsif pressure > 80 and pressure <= 510
            flange_class = "300"
            pressure_rating = 510
            temperature_rating = 800
        elsif pressure > 510 and pressure <= 675
            flange_class = "400"
            pressure_rating = 675
            temperature_rating = 800
        elsif pressure > 675 and pressure <= 1015
            flange_class = "600"
            pressure_rating = 1015
            temperature_rating = 800
        elsif pressure > 1015 and pressure <= 1525
            flange_class = "900"
            pressure_rating = 1525
            temperature_rating = 800
        end
    elsif temperature > 800 and temperature <= 850 
        if pressure <= 65
            flange_class = "150"
            pressure_rating = 65
            temperature_rating = 850
        elsif pressure > 65 and pressure <= 485
            flange_class = "300"
            pressure_rating = 485
            temperature_rating = 850
        elsif pressure > 485 and pressure <= 650
            flange_class = "400"
            pressure_rating = 650
            temperature_rating = 850
        elsif pressure > 650 and pressure <= 975
            flange_class = "600"
            pressure_rating = 975
            temperature_rating = 850
        elsif pressure > 975 and pressure <= 1460
            flange_class = "900"
            pressure_rating = 1460
            temperature_rating = 850
        end
    elsif temperature > 850 and temperature <= 900 
        if pressure <= 50
            flange_class = "150"
            pressure_rating = 50
            temperature_rating = 900
        elsif pressure > 50 and pressure <= 450
            flange_class = "300"
            pressure_rating = 450
            temperature_rating = 900
        elsif pressure > 450 and pressure <= 600
            flange_class = "400"
            pressure_rating = 600
            temperature_rating = 900
        elsif pressure > 600 and pressure <= 900
            flange_class = "600"
            pressure_rating = 900
            temperature_rating = 900
        elsif pressure > 900 and pressure <= 1345
            flange_class = "900"
            pressure_rating = 1345
            temperature_rating = 900
        end
    elsif temperature > 900 and temperature <= 950 
        if pressure <= 35
            flange_class = "150"
            pressure_rating = 35
            temperature_rating = 950
        elsif pressure > 35 and pressure <= 280
            flange_class = "300"
            pressure_rating = 280
            temperature_rating = 950
        elsif pressure > 280 and pressure <= 375
            flange_class = "400"
            pressure_rating = 375
            temperature_rating = 950
        elsif pressure > 375 and pressure <= 560
            flange_class = "600"
            pressure_rating = 560
            temperature_rating = 950
        elsif pressure > 560 and pressure <= 845
            flange_class = "900"
            pressure_rating = 845
            temperature_rating = 950
        end
    elsif temperature > 950 and temperature <= 1000
        if pressure <= 20
            flange_class = "150"
            pressure_rating = 20
            temperature_rating = 1000
        elsif pressure > 20 and pressure <= 165
            flange_class = "300"
            pressure_rating = 165
            temperature_rating = 1000
        elsif pressure > 165 and pressure <= 220
            flange_class = "400"
            pressure_rating = 220
            temperature_rating = 1000
        elsif pressure > 220 and pressure <= 330
            flange_class = "600"
            pressure_rating = 330
            temperature_rating = 1000
        elsif pressure > 330 and pressure <= 495
            flange_class = "900"
            pressure_rating = 495
            temperature_rating = 1000
        end
    elsif temperature > 1000 and temperature <= 105
        if pressure > 165
            flange_class = "300"
            pressure_rating = 165
            temperature_rating = 1050
        elsif pressure > 165 and pressure <= 220
            flange_class = "400"
            pressure_rating = 220
            temperature_rating = 1050
        elsif pressure > 220 and pressure <= 330
            flange_class = "600"
            pressure_rating = 330
            temperature_rating = 1050
        elsif pressure > 330 and pressure <= 495
            flange_class = "900"
            pressure_rating = 495
            temperature_rating = 1050
        end
    elsif temperature > 1050 and temperature <= 110
        if pressure > 110
            flange_class = "300"
            pressure_rating = 110
            temperature_rating = 1050
        elsif pressure > 110 and pressure <= 145
            flange_class = "400"
            pressure_rating = 145
            temperature_rating = 1050
        elsif pressure > 145 and pressure <= 220
            flange_class = "600"
            pressure_rating = 220
            temperature_rating = 1050
        elsif pressure > 220 and pressure <= 330
            flange_class = "900"
            pressure_rating = 330
            temperature_rating = 1050
        end
    elsif temperature > 1100 and temperature <= 115 
        if pressure > 80
            flange_class = "300"
            pressure_rating = 80
            temperature_rating = 1050
        elsif pressure > 80 and pressure <= 110
            flange_class = "400"
            pressure_rating = 110
            temperature_rating = 1050
        elsif pressure > 110 and pressure <= 165
            flange_class = "600"
            pressure_rating = 165
            temperature_rating = 1050
        elsif pressure > 165 and pressure <= 245
            flange_class = "900"
            pressure_rating = 245
            temperature_rating = 1050
        end
    elsif temperature > 1150 and temperature <= 120
        if pressure > 45
            flange_class = "300"
            pressure_rating = 45
            temperature_rating = 1200
        elsif pressure > 45 and pressure <= 60
            flange_class = "400"
            pressure_rating = 60
            temperature_rating = 1200
        elsif pressure > 60 and pressure <= 90
            flange_class = "600"
            pressure_rating = 90
            temperature_rating = 1200
        elsif pressure > 90 and pressure <= 135
            flange_class = "900"
            pressure_rating = 135
            temperature_rating = 1200
        end
    end
end

  
if material_group == "1.13"
if temperature >= -20 and temperature <= 100
    if pressure <= 145
        flange_class = "75"
        pressure_rating = 145
        temperature_rating = 100
    elsif pressure > 100 and pressure <= 290
        flange_class = "150"
        pressure_rating = 290
        temperature_rating = 100
    elsif pressure > 290 and pressure <= 750
        flange_class = "300"
        pressure_rating = 750
        temperature_rating = 100
    elsif pressure > 750 and pressure <= 1000
        flange_class = "400"
        pressure_rating = 1000
        temperature_rating = 100
    elsif pressure > 1000 and pressure <= 1500
        flange_class = "600"
        pressure_rating = 1500
        temperature_rating = 100
    elsif pressure > 1500 and pressure <= 2250
        flange_class = "900"
        pressure_rating = 2250
        temperature_rating = 100
    end
elsif temperature > 100 and temperature <= 200 
    if pressure <= 130
        flange_class = "75"
        pressure_rating = 130
        temperature_rating = 200
    elsif pressure > 130 and pressure <= 260
        flange_class = "150"
        pressure_rating = 260
        temperature_rating = 200
    elsif pressure > 260 and pressure <= 750
        flange_class = "300"
        pressure_rating = 750
        temperature_rating = 200
    elsif pressure > 750 and pressure <= 1000
        flange_class = "400"
        pressure_rating = 1000
        temperature_rating = 200
    elsif pressure > 1000 and pressure <= 1500
        flange_class = "600"
        pressure_rating = 1500
        temperature_rating = 200
    elsif pressure > 1500 and pressure <= 2250
        flange_class = "900"
        pressure_rating = 2250
        temperature_rating = 200
    end
elsif temperature > 200 and temperature <= 300 
    if pressure <= 115
        flange_class = "75"
        pressure_rating = 115
        temperature_rating = 300
    elsif pressure > 115 and pressure <= 230
        flange_class = "150"
        pressure_rating = 230
        temperature_rating = 300
    elsif pressure > 230 and pressure <= 730
        flange_class = "300"
        pressure_rating = 730
        temperature_rating = 300
    elsif pressure > 730 and pressure <= 970
        flange_class = "400"
        pressure_rating = 970
        temperature_rating = 300
    elsif pressure > 970 and pressure <= 1455
        flange_class = "600"
        pressure_rating = 1455
        temperature_rating = 300
    elsif pressure > 1455 and pressure <= 2185
        flange_class = "900"
        pressure_rating = 2185
        temperature_rating = 300
    end
elsif temperature > 300 and temperature <= 400 
    if pressure <= 100
        flange_class = "75"
        pressure_rating = 100
        temperature_rating = 400
    elsif pressure > 100 and pressure <= 200
        flange_class = "150"
        pressure_rating = 200
        temperature_rating = 400
    elsif pressure > 200 and pressure <= 705
        flange_class = "300"
        pressure_rating = 705
        temperature_rating = 400
    elsif pressure > 705 and pressure <= 940
        flange_class = "400"
        pressure_rating = 940
        temperature_rating = 400
    elsif pressure > 940 and pressure <= 1410
        flange_class = "600"
        pressure_rating = 1410
        temperature_rating = 400
    elsif pressure > 1410 and pressure <= 2115
        flange_class = "900"
        pressure_rating = 2115
        temperature_rating = 400
    end
elsif temperature > 400 and temperature <= 500 
    if pressure <= 85
        flange_class = "75"
        pressure_rating = 85
        temperature_rating = 500
    elsif pressure > 85 and pressure <= 170
        flange_class = "150"
        pressure_rating = 170
        temperature_rating = 500
    elsif pressure > 170 and pressure <= 665
        flange_class = "300"
        pressure_rating = 665
        temperature_rating = 500
    elsif pressure > 665 and pressure <= 885
        flange_class = "400"
        pressure_rating = 885
        temperature_rating = 500
    elsif pressure > 885 and pressure <= 1330
        flange_class = "600"
        pressure_rating = 1330
        temperature_rating = 500
    elsif pressure > 1330 and pressure <= 1995
        flange_class = "900"
        pressure_rating = 1995
        temperature_rating = 500
    end
elsif temperature > 500 and temperature <= 600 
    if pressure <= 70
        flange_class = "75"
        pressure_rating = 70
        temperature_rating = 600
    elsif pressure > 70 and pressure <= 140
        flange_class = "150"
        pressure_rating = 140
        temperature_rating = 600
    elsif pressure > 140 and pressure <= 605
        flange_class = "300"
        pressure_rating = 605
        temperature_rating = 600
    elsif pressure > 605 and pressure <= 805
        flange_class = "400"
        pressure_rating = 805
        temperature_rating = 600
    elsif pressure > 805 and pressure <= 1210
        flange_class = "600"
        pressure_rating = 1210
        temperature_rating = 600
    elsif pressure > 1210 and pressure <= 1815
        flange_class = "900"
        pressure_rating = 1815
        temperature_rating = 600
    end
elsif temperature > 600 and temperature <= 650 
    if pressure <= 60
        flange_class = "75"
        pressure_rating = 60
        temperature_rating = 650
    elsif pressure > 60 and pressure <= 125
        flange_class = "150"
        pressure_rating = 125
        temperature_rating = 650
    elsif pressure > 125 and pressure <= 590
        flange_class = "300"
        pressure_rating = 590
        temperature_rating = 650
    elsif pressure > 590 and pressure <= 785
        flange_class = "400"
        pressure_rating = 785
        temperature_rating = 650
    elsif pressure > 785 and pressure <= 1175
        flange_class = "600"
        pressure_rating = 1175
        temperature_rating = 650
    elsif pressure > 1175 and pressure <= 1765
        flange_class = "900"
        pressure_rating = 1765
        temperature_rating = 650
    end
elsif temperature > 650 and temperature <= 700 
    if pressure <= 110
        flange_class = "150"
        pressure_rating = 110
        temperature_rating = 700
    elsif pressure > 110 and pressure <= 570
        flange_class = "300"
        pressure_rating = 570
        temperature_rating = 700
    elsif pressure > 570 and pressure <= 755
        flange_class = "400"
        pressure_rating = 755
        temperature_rating = 700
    elsif pressure > 755 and pressure <= 1135
        flange_class = "600"
        pressure_rating = 1135
        temperature_rating = 700
    elsif pressure > 1135 and pressure <= 1705
        flange_class = "900"
        pressure_rating = 1705
        temperature_rating = 700
    end
elsif temperature > 700 and temperature <= 750 
    if pressure <= 95
        flange_class = "150"
        pressure_rating = 95
        temperature_rating = 750
    elsif pressure > 95 and pressure <= 530
        flange_class = "300"
        pressure_rating = 530
        temperature_rating = 750
    elsif pressure > 530 and pressure <= 710
        flange_class = "400"
        pressure_rating = 710
        temperature_rating = 750
    elsif pressure > 710 and pressure <= 1065
        flange_class = "600"
        pressure_rating = 1065
        temperature_rating = 750
    elsif pressure > 1065 and pressure <= 1595
        flange_class = "900"
        pressure_rating = 1595
        temperature_rating = 750
    end
elsif temperature > 750 and temperature <= 800 
    if pressure <= 80
        flange_class = "150"
        pressure_rating = 80
        temperature_rating = 800
    elsif pressure > 80 and pressure <= 510
        flange_class = "300"
        pressure_rating = 510
        temperature_rating = 800
    elsif pressure > 510 and pressure <= 675
        flange_class = "400"
        pressure_rating = 675
        temperature_rating = 800
    elsif pressure > 675 and pressure <= 1015
        flange_class = "600"
        pressure_rating = 1015
        temperature_rating = 800
    elsif pressure > 1015 and pressure <= 1525
        flange_class = "900"
        pressure_rating = 1525
        temperature_rating = 800
    end
elsif temperature > 800 and temperature <= 850 
    if pressure <= 65
        flange_class = "150"
        pressure_rating = 65
        temperature_rating = 850
    elsif pressure > 65 and pressure <= 485
        flange_class = "300"
        pressure_rating = 485
        temperature_rating = 850
    elsif pressure > 485 and pressure <= 650
        flange_class = "400"
        pressure_rating = 650
        temperature_rating = 850
    elsif pressure > 650 and pressure <= 975
        flange_class = "600"
        pressure_rating = 975
        temperature_rating = 850
    elsif pressure > 975 and pressure <= 1460
        flange_class = "900"
        pressure_rating = 1460
        temperature_rating = 850
    end
elsif temperature > 850 and temperature <= 900 
    if pressure <= 50
        flange_class = "150"
        pressure_rating = 50
        temperature_rating = 900
    elsif pressure > 50 and pressure <= 375
        flange_class = "300"
        pressure_rating = 375
        temperature_rating = 900
    elsif pressure > 375 and pressure <= 500
        flange_class = "400"
        pressure_rating = 500
        temperature_rating = 900
    elsif pressure > 500 and pressure <= 745
        flange_class = "600"
        pressure_rating = 745
        temperature_rating = 900
    elsif pressure > 745 and pressure <= 1120
        flange_class = "900"
        pressure_rating = 1120
        temperature_rating = 900
    end
elsif temperature > 900 and temperature <= 950 
    if pressure <= 35
        flange_class = "150"
        pressure_rating = 35
        temperature_rating = 950
    elsif pressure > 35 and pressure <= 375
        flange_class = "300"
        pressure_rating = 375
        temperature_rating = 950
    elsif pressure > 375 and pressure <= 500
        flange_class = "400"
        pressure_rating = 500
        temperature_rating = 950
    elsif pressure > 500 and pressure <= 745
        flange_class = "600"
        pressure_rating = 745
        temperature_rating = 950
    elsif pressure > 745 and pressure <= 1120
        flange_class = "900"
        pressure_rating = 1120
        temperature_rating = 950
    end
elsif temperature > 950 and temperature <= 1000
    if pressure <= 20
        flange_class = "150"
        pressure_rating = 20
        temperature_rating = 1000
    elsif pressure > 20 and pressure <= 200
        flange_class = "300"
        pressure_rating = 200
        temperature_rating = 1000
    elsif pressure > 200 and pressure <= 265
        flange_class = "400"
        pressure_rating = 265
        temperature_rating = 1000
    elsif pressure > 265 and pressure <= 400
        flange_class = "600"
        pressure_rating = 400
        temperature_rating = 1000
    elsif pressure > 400 and pressure <= 595
        flange_class = "900"
        pressure_rating = 595
        temperature_rating = 1000
    end
elsif temperature > 1000 and temperature <= 105
    if pressure > 145 
        flange_class = "300"
        pressure_rating = 145
        temperature_rating = 1050
    elsif pressure > 145 and pressure <= 190
        flange_class = "400"
        pressure_rating = 190
        temperature_rating = 1050
    elsif pressure > 190 and pressure <= 290
        flange_class = "600"
        pressure_rating = 290
        temperature_rating = 1050
    elsif pressure > 290 and pressure <= 430
        flange_class = "900"
        pressure_rating = 430
        temperature_rating = 1050
    end
elsif temperature > 1050 and temperature <= 110
    if pressure > 100 
        flange_class = "300"
        pressure_rating = 100
        temperature_rating = 1100
    elsif pressure > 100 and pressure <= 135
        flange_class = "400"
        pressure_rating = 135
        temperature_rating = 1100
    elsif pressure > 135 and pressure <= 200
        flange_class = "600"
        pressure_rating = 200
        temperature_rating = 1100
    elsif pressure > 200 and pressure <= 300
        flange_class = "900"
        pressure_rating = 300
        temperature_rating = 1100
    end
elsif temperature > 1100 and temperature <= 115
    if pressure > 60 
        flange_class = "300"
        pressure_rating = 60
        temperature_rating = 1150
    elsif pressure > 60 and pressure <= 80
        flange_class = "400"
        pressure_rating = 80
        temperature_rating = 1150
    elsif pressure > 80 and pressure <= 125
        flange_class = "600"
        pressure_rating = 125
        temperature_rating = 1150
    elsif pressure > 125 and pressure <= 185
        flange_class = "900"
        pressure_rating = 185
        temperature_rating = 1150
    end
elsif temperature > 1150 and temperature <= 120
    if pressure > 35 
        flange_class = "300"
        pressure_rating = 35
        temperature_rating = 1200
    elsif pressure > 35 and pressure <= 45
        flange_class = "400"
        pressure_rating = 45
        temperature_rating = 1200
    elsif pressure > 45 and pressure <= 70
        flange_class = "600"
        pressure_rating = 70
        temperature_rating = 1200
    elsif pressure > 70 and pressure <= 105
        flange_class = "900"
        pressure_rating = 105
        temperature_rating = 1200
    end
end
end

  
if material_group == "1.14"
if temperature >= -20 and temperature <= 100 
    if pressure <= 145 
        flange_class = "75"
        pressure_rating = 145
        temperature_rating = 100
    elsif pressure > 100 and pressure <= 290
        flange_class = "150"
        pressure_rating = 290
        temperature_rating = 100
    elsif pressure > 290 and pressure <= 750
        flange_class = "300"
        pressure_rating = 750
        temperature_rating = 100
    elsif pressure > 750 and pressure <= 1000
        flange_class = "400"
        pressure_rating = 1000
        temperature_rating = 100
    elsif pressure > 1000 and pressure <= 1500
        flange_class = "600"
        pressure_rating = 1500
        temperature_rating = 100
    elsif pressure > 1500 and pressure <= 2250
        flange_class = "900"
        pressure_rating = 2250
        temperature_rating = 100
    end
elsif temperature > 100 and temperature <= 200 
    if pressure <= 130 
        flange_class = "75"
        pressure_rating = 130
        temperature_rating = 200
    elsif pressure > 130 and pressure <= 260
        flange_class = "150"
        pressure_rating = 260
        temperature_rating = 200
    elsif pressure > 260 and pressure <= 750
        flange_class = "300"
        pressure_rating = 750
        temperature_rating = 200
    elsif pressure > 750 and pressure <= 1000
        flange_class = "400"
        pressure_rating = 1000
        temperature_rating = 200
    elsif pressure > 1000 and pressure <= 1500
        flange_class = "600"
        pressure_rating = 1500
        temperature_rating = 200
    elsif pressure > 1500 and pressure <= 2250
        flange_class = "900"
        pressure_rating = 2250
        temperature_rating = 200
    end
elsif temperature > 200 and temperature <= 300 
    if pressure <= 115 
        flange_class = "75"
        pressure_rating = 115
        temperature_rating = 300
    elsif pressure > 115 and pressure <= 230
        flange_class = "150"
        pressure_rating = 230
        temperature_rating = 300
    elsif pressure > 230 and pressure <= 730
        flange_class = "300"
        pressure_rating = 730
        temperature_rating = 300
    elsif pressure > 730 and pressure <= 970
        flange_class = "400"
        pressure_rating = 970
        temperature_rating = 300
    elsif pressure > 970 and pressure <= 1455
        flange_class = "600"
        pressure_rating = 1455
        temperature_rating = 300
    elsif pressure > 1455 and pressure <= 2185
        flange_class = "900"
        pressure_rating = 2185
        temperature_rating = 300
    end
elsif temperature > 300 and temperature <= 400 
    if pressure <= 100 
        flange_class = "75"
        pressure_rating = 100
        temperature_rating = 400
    elsif pressure > 100 and pressure <= 200
        flange_class = "150"
        pressure_rating = 200
        temperature_rating = 400
    elsif pressure > 200 and pressure <= 705
        flange_class = "300"
        pressure_rating = 705
        temperature_rating = 400
    elsif pressure > 705 and pressure <= 940
        flange_class = "400"
        pressure_rating = 940
        temperature_rating = 400
    elsif pressure > 940 and pressure <= 1410
        flange_class = "600"
        pressure_rating = 1410
        temperature_rating = 400
    elsif pressure > 1410 and pressure <= 2115
        flange_class = "900"
        pressure_rating = 2115
        temperature_rating = 400
    end
elsif temperature > 400 and temperature <= 500 
    if pressure <= 85 
        flange_class = "75"
        pressure_rating = 85
        temperature_rating = 500
    elsif pressure > 85 and pressure <= 170
        flange_class = "150"
        pressure_rating = 170
        temperature_rating = 500
    elsif pressure > 170 and pressure <= 665
        flange_class = "300"
        pressure_rating = 665
        temperature_rating = 500
    elsif pressure > 665 and pressure <= 885
        flange_class = "400"
        pressure_rating = 885
        temperature_rating = 500
    elsif pressure > 885 and pressure <= 1330
        flange_class = "600"
        pressure_rating = 1330
        temperature_rating = 500
    elsif pressure > 1330 and pressure <= 1995
        flange_class = "900"
        pressure_rating = 1995
        temperature_rating = 500
    end
elsif temperature > 500 and temperature <= 600 
    if pressure <= 70 
        flange_class = "75"
        pressure_rating = 70
        temperature_rating = 600
    elsif pressure > 70 and pressure <= 140
        flange_class = "150"
        pressure_rating = 140
        temperature_rating = 600
    elsif pressure > 140 and pressure <= 605
        flange_class = "300"
        pressure_rating = 605
        temperature_rating = 600
    elsif pressure > 605 and pressure <= 805
        flange_class = "400"
        pressure_rating = 805
        temperature_rating = 600
    elsif pressure > 805 and pressure <= 1210
        flange_class = "600"
        pressure_rating = 1210
        temperature_rating = 600
    elsif pressure > 1210 and pressure <= 1815
        flange_class = "900"
        pressure_rating = 1815
        temperature_rating = 600
    end
elsif temperature > 600 and temperature <= 650 
    if pressure <= 60 
        flange_class = "75"
        pressure_rating = 60
        temperature_rating = 650
    elsif pressure > 60 and pressure <= 125
        flange_class = "150"
        pressure_rating = 125
        temperature_rating = 650
    elsif pressure > 125 and pressure <= 590
        flange_class = "300"
        pressure_rating = 590
        temperature_rating = 650
    elsif pressure > 590 and pressure <= 785
        flange_class = "400"
        pressure_rating = 785
        temperature_rating = 650
    elsif pressure > 785 and pressure <= 1175
        flange_class = "600"
        pressure_rating = 1175
        temperature_rating = 650
    elsif pressure > 1175 and pressure <= 1765
        flange_class = "900"
        pressure_rating = 1765
        temperature_rating = 650
    end
elsif temperature > 650 and temperature <= 700 
    if pressure <= 110 
        flange_class = "150"
        pressure_rating = 110
        temperature_rating = 700
    elsif pressure > 110 and pressure <= 570
        flange_class = "300"
        pressure_rating = 570
        temperature_rating = 700
    elsif pressure > 570 and pressure <= 755
        flange_class = "400"
        pressure_rating = 755
        temperature_rating = 700
    elsif pressure > 755 and pressure <= 1135
        flange_class = "600"
        pressure_rating = 1135
        temperature_rating = 700
    elsif pressure > 1135 and pressure <= 1705
        flange_class = "900"
        pressure_rating = 1705
        temperature_rating = 700
    end
elsif temperature > 700 and temperature <= 750 
    if pressure <= 95 
        flange_class = "150"
        pressure_rating = 95
        temperature_rating = 750
    elsif pressure > 95 and pressure <= 530
        flange_class = "300"
        pressure_rating = 530
        temperature_rating = 750
    elsif pressure > 530 and pressure <= 710
        flange_class = "400"
        pressure_rating = 710
        temperature_rating = 750
    elsif pressure > 710 and pressure <= 1065
        flange_class = "600"
        pressure_rating = 1065
        temperature_rating = 750
    elsif pressure > 1065 and pressure <= 1595
        flange_class = "900"
        pressure_rating = 1595
        temperature_rating = 750
    end
elsif temperature > 750 and temperature <= 800 
    if pressure <= 80 
        flange_class = "150"
        pressure_rating = 80
        temperature_rating = 800
    elsif pressure > 80 and pressure <= 510
        flange_class = "300"
        pressure_rating = 510
        temperature_rating = 800
    elsif pressure > 510 and pressure <= 675
        flange_class = "400"
        pressure_rating = 675
        temperature_rating = 800
    elsif pressure > 675 and pressure <= 1015
        flange_class = "600"
        pressure_rating = 1015
        temperature_rating = 800
    elsif pressure > 1015 and pressure <= 1525
        flange_class = "900"
        pressure_rating = 1525
        temperature_rating = 800
    end
elsif temperature > 800 and temperature <= 850 
    if pressure <= 65 
        flange_class = "150"
        pressure_rating = 65
        temperature_rating = 850
    elsif pressure > 65 and pressure <= 485
        flange_class = "300"
        pressure_rating = 485
        temperature_rating = 850
    elsif pressure > 485 and pressure <= 650
        flange_class = "400"
        pressure_rating = 650
        temperature_rating = 850
    elsif pressure > 650 and pressure <= 975
        flange_class = "600"
        pressure_rating = 975
        temperature_rating = 850
    elsif pressure > 975 and pressure <= 1460
        flange_class = "900"
        pressure_rating = 1460
        temperature_rating = 850
    end
elsif temperature > 850 and temperature <= 900 
    if pressure <= 50 
        flange_class = "150"
        pressure_rating = 50
        temperature_rating = 900
    elsif pressure > 50 and pressure <= 450
        flange_class = "300"
        pressure_rating = 450
        temperature_rating = 900
    elsif pressure > 450 and pressure <= 600
        flange_class = "400"
        pressure_rating = 600
        temperature_rating = 900
    elsif pressure > 600 and pressure <= 900
        flange_class = "600"
        pressure_rating = 900
        temperature_rating = 900
    elsif pressure > 900 and pressure <= 1350
        flange_class = "900"
        pressure_rating = 1350
        temperature_rating = 900
    end
elsif temperature > 900 and temperature <= 950 
    if pressure <= 35 
        flange_class = "150"
        pressure_rating = 35
        temperature_rating = 950
    elsif pressure > 35 and pressure <= 375
        flange_class = "300"
        pressure_rating = 375
        temperature_rating = 950
    elsif pressure > 375 and pressure <= 505
        flange_class = "400"
        pressure_rating = 505
        temperature_rating = 950
    elsif pressure > 505 and pressure <= 755
        flange_class = "600"
        pressure_rating = 755
        temperature_rating = 950
    elsif pressure > 755 and pressure <= 1130
        flange_class = "900"
        pressure_rating = 1130
        temperature_rating = 950
    end
elsif temperature > 950 and temperature <= 1000
    if pressure <= 20 
        flange_class = "150"
        pressure_rating = 20
        temperature_rating = 1000
    elsif pressure > 20 and pressure <= 255
        flange_class = "300"
        pressure_rating = 255
        temperature_rating = 1000
    elsif pressure > 255 and pressure <= 340
        flange_class = "400"
        pressure_rating = 340
        temperature_rating = 1000
    elsif pressure > 340 and pressure <= 505
        flange_class = "600"
        pressure_rating = 505
        temperature_rating = 1000
    elsif pressure > 505 and pressure <= 760
        flange_class = "900"
        pressure_rating = 760
        temperature_rating = 1000
    end
elsif temperature > 1000 and temperature <= 105
    if pressure > 170 
        flange_class = "300"
        pressure_rating = 170
        temperature_rating = 1050
    elsif pressure > 170 and pressure <= 230
        flange_class = "400"
        pressure_rating = 230
        temperature_rating = 1050
    elsif pressure > 230 and pressure <= 345
        flange_class = "600"
        pressure_rating = 345
        temperature_rating = 1050
    elsif pressure > 345 and pressure <= 515
        flange_class = "900"
        pressure_rating = 515
        temperature_rating = 1050
    end
elsif temperature > 1050 and temperature <= 110
    if pressure > 115 
        flange_class = "300"
        pressure_rating = 115
        temperature_rating = 1100
    elsif pressure > 115 and pressure <= 150
        flange_class = "400"
        pressure_rating = 150
        temperature_rating = 1100
    elsif pressure > 150 and pressure <= 225
        flange_class = "600"
        pressure_rating = 225
        temperature_rating = 1100
    elsif pressure > 225 and pressure <= 340
        flange_class = "900"
        pressure_rating = 340
        temperature_rating = 1100
    end
elsif temperature > 1100 and temperature <= 115
    if pressure > 75 
        flange_class = "300"
        pressure_rating = 75
        temperature_rating = 1150
    elsif pressure > 75 and pressure <= 100
        flange_class = "400"
        pressure_rating = 100
        temperature_rating = 1150
    elsif pressure > 100 and pressure <= 150
        flange_class = "600"
        pressure_rating = 150
        temperature_rating = 1150
    elsif pressure > 150 and pressure <= 225
        flange_class = "900"
        pressure_rating = 225
        temperature_rating = 1150
    end
elsif temperature > 1150 and temperature <= 120
    if pressure > 50 
        flange_class = "300"
        pressure_rating = 50
        temperature_rating = 1200
    elsif pressure > 50 and pressure <= 70
        flange_class = "400"
        pressure_rating = 70
        temperature_rating = 1200
    elsif pressure > 70 and pressure <= 105
        flange_class = "600"
        pressure_rating = 105
        temperature_rating = 1200
    elsif pressure > 105 and pressure <= 155
        flange_class = "900"
        pressure_rating = 155
        temperature_rating = 1200
    end
end
end


if material_group == "1.15"
if temperature >= -20 and temperature <= 100 
    if pressure <= 145
        flange_class = "75"
        pressure_rating = 145
        temperature_rating = 100
    elsif pressure > 100 and pressure <= 290
        flange_class = "150"
        pressure_rating = 290
        temperature_rating = 100
    elsif pressure > 290 and pressure <= 750
        flange_class = "300"
        pressure_rating = 750
        temperature_rating = 100
    elsif pressure > 750 and pressure <= 1000
        flange_class = "400"
        pressure_rating = 1000
        temperature_rating = 100
    elsif pressure > 1000 and pressure <= 1500
        flange_class = "600"
        pressure_rating = 1500
        temperature_rating = 100
    elsif pressure > 1500 and pressure <= 2250
        flange_class = "900"
        pressure_rating = 2250
        temperature_rating = 100
    end
elsif temperature > 100 and temperature <= 200 
    if pressure <= 130 
        flange_class = "75"
        pressure_rating = 130
        temperature_rating = 200
    elsif pressure > 130 and pressure <= 260
        flange_class = "150"
        pressure_rating = 260
        temperature_rating = 200
    elsif pressure > 260 and pressure <= 750
        flange_class = "300"
        pressure_rating = 750
        temperature_rating = 200
    elsif pressure > 750 and pressure <= 1000
        flange_class = "400"
        pressure_rating = 1000
        temperature_rating = 200
    elsif pressure > 1000 and pressure <= 1500
        flange_class = "600"
        pressure_rating = 1500
        temperature_rating = 200
    elsif pressure > 1500 and pressure <= 2250
        flange_class = "900"
        pressure_rating = 2250
        temperature_rating = 200
    end
elsif temperature > 200 and temperature <= 300 
    if pressure <= 115 
        flange_class = "75"
        pressure_rating = 115
        temperature_rating = 300
    elsif pressure > 115 and pressure <= 230
        flange_class = "150"
        pressure_rating = 230
        temperature_rating = 300
    elsif pressure > 230 and pressure <= 730
        flange_class = "300"
        pressure_rating = 730
        temperature_rating = 300
    elsif pressure > 730 and pressure <= 970
        flange_class = "400"
        pressure_rating = 970
        temperature_rating = 300
    elsif pressure > 970 and pressure <= 1455
        flange_class = "600"
        pressure_rating = 1455
        temperature_rating = 300
    elsif pressure > 1455 and pressure <= 2185
        flange_class = "900"
        pressure_rating = 2185
        temperature_rating = 300
    end
elsif temperature > 300 and temperature <= 400 
    if pressure <= 100 
        flange_class = "75"
        pressure_rating = 100
        temperature_rating = 400
    elsif pressure > 100 and pressure <= 200
        flange_class = "150"
        pressure_rating = 200
        temperature_rating = 400
    elsif pressure > 200 and pressure <= 705
        flange_class = "300"
        pressure_rating = 705
        temperature_rating = 400
    elsif pressure > 705 and pressure <= 940
        flange_class = "400"
        pressure_rating = 940
        temperature_rating = 400
    elsif pressure > 940 and pressure <= 1410
        flange_class = "600"
        pressure_rating = 1410
        temperature_rating = 400
    elsif pressure > 1410 and pressure <= 2115
        flange_class = "900"
        pressure_rating = 2115
        temperature_rating = 400
    end
elsif temperature > 400 and temperature <= 500 
    if pressure <= 85 
        flange_class = "75"
        pressure_rating = 85
        temperature_rating = 500
    elsif pressure > 85 and pressure <= 170
        flange_class = "150"
        pressure_rating = 170
        temperature_rating = 500
    elsif pressure > 170 and pressure <= 665
        flange_class = "300"
        pressure_rating = 665
        temperature_rating = 500
    elsif pressure > 665 and pressure <= 885
        flange_class = "400"
        pressure_rating = 885
        temperature_rating = 500
    elsif pressure > 885 and pressure <= 1330
        flange_class = "600"
        pressure_rating = 1330
        temperature_rating = 500
    elsif pressure > 1330 and pressure <= 1995
        flange_class = "900"
        pressure_rating = 1995
        temperature_rating = 500
    end
elsif temperature > 500 and temperature <= 600 
    if pressure <= 70 
        flange_class = "75"
        pressure_rating = 70
        temperature_rating = 600
    elsif pressure > 70 and pressure <= 140
        flange_class = "150"
        pressure_rating = 140
        temperature_rating = 600
    elsif pressure > 140 and pressure <= 605
        flange_class = "300"
        pressure_rating = 605
        temperature_rating = 600
    elsif pressure > 605 and pressure <= 805
        flange_class = "400"
        pressure_rating = 805
        temperature_rating = 600
    elsif pressure > 805 and pressure <= 1210
        flange_class = "600"
        pressure_rating = 1210
        temperature_rating = 600
    elsif pressure > 1210 and pressure <= 1815
        flange_class = "900"
        pressure_rating = 1815
        temperature_rating = 600
    end
elsif temperature > 600 and temperature <= 650 
    if pressure <= 60 
        flange_class = "75"
        pressure_rating = 60
        temperature_rating = 650
    elsif pressure > 60 and pressure <= 125
        flange_class = "150"
        pressure_rating = 125
        temperature_rating = 650
    elsif pressure > 125 and pressure <= 590
        flange_class = "300"
        pressure_rating = 590
        temperature_rating = 650
    elsif pressure > 590 and pressure <= 785
        flange_class = "400"
        pressure_rating = 785
        temperature_rating = 650
    elsif pressure > 785 and pressure <= 1175
        flange_class = "600"
        pressure_rating = 1175
        temperature_rating = 650
    elsif pressure > 1175 and pressure <= 1765
        flange_class = "900"
        pressure_rating = 1765
        temperature_rating = 650
    end
elsif temperature > 650 and temperature <= 700 
    if pressure <= 110 
        flange_class = "150"
        pressure_rating = 110
        temperature_rating = 700
    elsif pressure > 110 and pressure <= 570
        flange_class = "300"
        pressure_rating = 570
        temperature_rating = 700
    elsif pressure > 570 and pressure <= 755
        flange_class = "400"
        pressure_rating = 755
        temperature_rating = 700
    elsif pressure > 755 and pressure <= 1135
        flange_class = "600"
        pressure_rating = 1135
        temperature_rating = 700
    elsif pressure > 1135 and pressure <= 1705
        flange_class = "900"
        pressure_rating = 1705
        temperature_rating = 700
    end
elsif temperature > 700 and temperature <= 750 
    if pressure <= 95 
        flange_class = "150"
        pressure_rating = 95
        temperature_rating = 750
    elsif pressure > 95 and pressure <= 530
        flange_class = "300"
        pressure_rating = 530
        temperature_rating = 750
    elsif pressure > 530 and pressure <= 710
        flange_class = "400"
        pressure_rating = 710
        temperature_rating = 750
    elsif pressure > 710 and pressure <= 1065
        flange_class = "600"
        pressure_rating = 1065
        temperature_rating = 750
    elsif pressure > 1065 and pressure <= 1595
        flange_class = "900"
        pressure_rating = 1595
        temperature_rating = 750
    end
elsif temperature > 750 and temperature <= 800 
    if pressure <= 80 
        flange_class = "150"
        pressure_rating = 80
        temperature_rating = 800
    elsif pressure > 80 and pressure <= 510
        flange_class = "300"
        pressure_rating = 510
        temperature_rating = 800
    elsif pressure > 510 and pressure <= 675
        flange_class = "400"
        pressure_rating = 675
        temperature_rating = 800
    elsif pressure > 675 and pressure <= 1015
        flange_class = "600"
        pressure_rating = 1015
        temperature_rating = 800
    elsif pressure > 1015 and pressure <= 1525
        flange_class = "900"
        pressure_rating = 1525
        temperature_rating = 800
    end
elsif temperature > 800 and temperature <= 850 
    if pressure <= 65 
        flange_class = "150"
        pressure_rating = 65
        temperature_rating = 850
    elsif pressure > 65 and pressure <= 485
        flange_class = "300"
        pressure_rating = 485
        temperature_rating = 850
    elsif pressure > 485 and pressure <= 650
        flange_class = "400"
        pressure_rating = 650
        temperature_rating = 850
    elsif pressure > 650 and pressure <= 975
        flange_class = "600"
        pressure_rating = 975
        temperature_rating = 850
    elsif pressure > 975 and pressure <= 1460
        flange_class = "900"
        pressure_rating = 1460
        temperature_rating = 850
    end
elsif temperature > 850 and temperature <= 900 
    if pressure <= 50 
        flange_class = "150"
        pressure_rating = 50
        temperature_rating = 900
    elsif pressure > 50 and pressure <= 450
        flange_class = "300"
        pressure_rating = 450
        temperature_rating = 900
    elsif pressure > 450 and pressure <= 600
        flange_class = "400"
        pressure_rating = 600
        temperature_rating = 900
    elsif pressure > 600 and pressure <= 900
        flange_class = "600"
        pressure_rating = 900
        temperature_rating = 900
    elsif pressure > 900 and pressure <= 1350
        flange_class = "900"
        pressure_rating = 1350
        temperature_rating = 900
    end
elsif temperature > 900 and temperature <= 950 
    if pressure <= 35 
        flange_class = "150"
        pressure_rating = 35
        temperature_rating = 950
    elsif pressure > 35 and pressure <= 385
        flange_class = "300"
        pressure_rating = 385
        temperature_rating = 950
    elsif pressure > 385 and pressure <= 515
        flange_class = "400"
        pressure_rating = 515
        temperature_rating = 950
    elsif pressure > 515 and pressure <= 775
        flange_class = "600"
        pressure_rating = 775
        temperature_rating = 950
    elsif pressure > 775 and pressure <= 1160
        flange_class = "900"
        pressure_rating = 1160
        temperature_rating = 950
    end
elsif temperature > 950 and temperature <= 1000
    if pressure <= 20 
        flange_class = "150"
        pressure_rating = 20
        temperature_rating = 1000
    elsif pressure > 20 and pressure <= 360
        flange_class = "300"
        pressure_rating = 360
        temperature_rating = 1000
    elsif pressure > 360 and pressure <= 480
        flange_class = "400"
        pressure_rating = 480
        temperature_rating = 1000
    elsif pressure > 480 and pressure <= 720
        flange_class = "600"
        pressure_rating = 720
        temperature_rating = 1000
    elsif pressure > 720 and pressure <= 1080
        flange_class = "900"
        pressure_rating = 1080
        temperature_rating = 1000
    end
elsif temperature > 1000 and temperature <= 105
    if pressure <= 20 
        flange_class = "150"
        pressure_rating = 20
        temperature_rating = 1050
    elsif pressure > 20 and pressure > 360
        flange_class = "300"
        pressure_rating = 360
        temperature_rating = 1050
    elsif pressure > 360 and pressure <= 480
        flange_class = "400"
        pressure_rating = 480
        temperature_rating = 1050
    elsif pressure > 480 and pressure <= 720
        flange_class = "600"
        pressure_rating = 720
        temperature_rating = 1050
    elsif pressure > 720 and pressure <= 1080
        flange_class = "900"
        pressure_rating = 1080
        temperature_rating = 1050
    end
elsif temperature > 1050 and temperature <= 110
    if pressure > 300 
        flange_class = "300"
        pressure_rating = 300
        temperature_rating = 1100
    elsif pressure > 300 and pressure <= 400
        flange_class = "400"
        pressure_rating = 400
        temperature_rating = 1100
    elsif pressure > 400 and pressure <= 605
        flange_class = "600"
        pressure_rating = 605
        temperature_rating = 1100
    elsif pressure > 605 and pressure <= 905
        flange_class = "900"
        pressure_rating = 905
        temperature_rating = 1100
    end
elsif temperature > 1100 and temperature <= 115
    if pressure > 225 
        flange_class = "300"
        pressure_rating = 225
        temperature_rating = 1150
    elsif pressure > 225 and pressure <= 295
        flange_class = "400"
        pressure_rating = 295
        temperature_rating = 1150
    elsif pressure > 295 and pressure <= 445
        flange_class = "600"
        pressure_rating = 445
        temperature_rating = 1150
    elsif pressure > 445 and pressure <= 670
        flange_class = "900"
        pressure_rating = 670
        temperature_rating = 1150
    end
elsif temperature > 1150 and temperature <= 120
    if pressure > 145 
        flange_class = "300"
        pressure_rating = 145
        temperature_rating = 1200
    elsif pressure > 145 and pressure <= 190
        flange_class = "400"
        pressure_rating = 190
        temperature_rating = 1200
    elsif pressure > 190 and pressure <= 290
        flange_class = "600"
        pressure_rating = 290
        temperature_rating = 1200
    elsif pressure > 290 and pressure <= 430
        flange_class = "900"
        pressure_rating = 430
        temperature_rating = 1200
    end
end
end

if material_group == "1.17" 
    if temperature >= -20 and temperature <= 100 
        if pressure <= 145 
            flange_class = "75"
            pressure_rating = 145
            temperature_rating = 100
        elsif pressure > 145 and pressure <= 290
            flange_class = "150"
            pressure_rating = 290
            temperature_rating = 100
        elsif pressure > 290 and pressure <= 750
            flange_class = "300"
            pressure_rating = 750
            temperature_rating = 100
        elsif pressure > 750 and pressure <= 1000
            flange_class = "400"
            pressure_rating = 1000
            temperature_rating = 100
        elsif pressure > 1000 and pressure <= 1500
            flange_class = "600"
            pressure_rating = 1500
            temperature_rating = 100
        elsif pressure > 1500 and pressure <= 2250
            flange_class = "900"
            pressure_rating = 2250
            temperature_rating = 100
        end
    elsif temperature > 100 and temperature <= 200 
        if pressure <= 130 
            flange_class = "75"
            pressure_rating = 130
            temperature_rating = 200
        elsif pressure > 130 and pressure <= 260
            flange_class = "150"
            pressure_rating = 260
            temperature_rating = 200
        elsif pressure > 260 and pressure <= 735
            flange_class = "300"
            pressure_rating = 735
            temperature_rating = 200
        elsif pressure > 735 and pressure <= 980
            flange_class = "400"
            pressure_rating = 980
            temperature_rating = 200
        elsif pressure > 980 and pressure <= 1470
            flange_class = "600"
            pressure_rating = 1470
            temperature_rating = 200
        elsif pressure > 1470 and pressure <= 2210
            flange_class = "900"
            pressure_rating = 2210
            temperature_rating = 200
        end
    elsif temperature > 200 and temperature <= 300 
        if pressure <= 115 
            flange_class = "75"
            pressure_rating = 115
            temperature_rating = 300
        elsif pressure > 115 and pressure <= 230
            flange_class = "150"
            pressure_rating = 230
            temperature_rating = 300
        elsif pressure > 230 and pressure <= 700
            flange_class = "300"
            pressure_rating = 700
            temperature_rating = 300
        elsif pressure > 700 and pressure <= 935
            flange_class = "400"
            pressure_rating = 935
            temperature_rating = 300
        elsif pressure > 935 and pressure <= 1400
            flange_class = "600"
            pressure_rating = 1400
            temperature_rating = 300
        elsif pressure > 1400 and pressure <= 2100
            flange_class = "900"
            pressure_rating = 2100
            temperature_rating = 300
        end
    elsif temperature > 300 and temperature <= 400 
        if pressure <= 100 
            flange_class = "75"
            pressure_rating = 100
            temperature_rating = 400
        elsif pressure > 100 and pressure <= 200
            flange_class = "150"
            pressure_rating = 200
            temperature_rating = 400
        elsif pressure > 200 and pressure <= 670
            flange_class = "300"
            pressure_rating = 670
            temperature_rating = 400
        elsif pressure > 670 and pressure <= 890
            flange_class = "400"
            pressure_rating = 890
            temperature_rating = 400
        elsif pressure > 890 and pressure <= 1335
            flange_class = "600"
            pressure_rating = 1335
            temperature_rating = 400
        elsif pressure > 1335 and pressure <= 2005
            flange_class = "900"
            pressure_rating = 2005
            temperature_rating = 400
        end
    elsif temperature > 400 and temperature <= 500 
        if pressure <= 85 
            flange_class = "75"
            pressure_rating = 85
            temperature_rating = 500
        elsif pressure > 85 and pressure <= 170
            flange_class = "150"
            pressure_rating = 170
            temperature_rating = 500
        elsif pressure > 170 and pressure <= 645
            flange_class = "300"
            pressure_rating = 645
            temperature_rating = 500
        elsif pressure > 645 and pressure <= 860
            flange_class = "400"
            pressure_rating = 860
            temperature_rating = 500
        elsif pressure > 860 and pressure <= 1290
            flange_class = "600"
            pressure_rating = 1290
            temperature_rating = 500
        elsif pressure > 1290 and pressure <= 1940
            flange_class = "900"
            pressure_rating = 1940
            temperature_rating = 500
        end
    elsif temperature > 500 and temperature <= 600 
        if pressure <= 70 
            flange_class = "75"
            pressure_rating = 70
            temperature_rating = 600
        elsif pressure > 70 and pressure <= 140
            flange_class = "150"
            pressure_rating = 140
            temperature_rating = 600
        elsif pressure > 140 and pressure <= 605
            flange_class = "300"
            pressure_rating = 605
            temperature_rating = 600
        elsif pressure > 605 and pressure <= 805
            flange_class = "400"
            pressure_rating = 805
            temperature_rating = 600
        elsif pressure > 805 and pressure <= 1210
            flange_class = "600"
            pressure_rating = 1210
            temperature_rating = 600
        elsif pressure > 1210 and pressure <= 1815
            flange_class = "900"
            pressure_rating = 1815
            temperature_rating = 600
        end
    elsif temperature > 600 and temperature <= 650 
        if pressure <= 60 
            flange_class = "75"
            pressure_rating = 60
            temperature_rating = 600
        elsif pressure > 60 and pressure <= 125
            flange_class = "150"
            pressure_rating = 125
            temperature_rating = 650
        elsif pressure > 125 and pressure <= 590
            flange_class = "300"
            pressure_rating = 590
            temperature_rating = 650
        elsif pressure > 590 and pressure <= 785
            flange_class = "400"
            pressure_rating = 785
            temperature_rating = 650
        elsif pressure > 785 and pressure <= 1175
            flange_class = "600"
            pressure_rating = 1175
            temperature_rating = 650
        elsif pressure > 1175 and pressure <= 1765
            flange_class = "900"
            pressure_rating = 1765
            temperature_rating = 650
        end
    elsif temperature > 650 and temperature <= 700 
        if pressure <= 110 
            flange_class = "150"
            pressure_rating = 110
            temperature_rating = 700
        elsif pressure > 110 and pressure <= 570
            flange_class = "300"
            pressure_rating = 570
            temperature_rating = 700
        elsif pressure > 570 and pressure <= 755
            flange_class = "400"
            pressure_rating = 755
            temperature_rating = 700
        elsif pressure > 755 and pressure <= 1135
            flange_class = "600"
            pressure_rating = 1135
            temperature_rating = 700
        elsif pressure > 1135 and pressure <= 1705
            flange_class = "900"
            pressure_rating = 1705
            temperature_rating = 700
        end
    elsif temperature > 700 and temperature <= 750 
        if pressure <= 95 
            flange_class = "150"
            pressure_rating = 95
            temperature_rating = 750
        elsif pressure > 95 and pressure <= 530
            flange_class = "300"
            pressure_rating = 530
            temperature_rating = 750
        elsif pressure > 530 and pressure <= 710
            flange_class = "400"
            pressure_rating = 710
            temperature_rating = 750
        elsif pressure > 710 and pressure <= 1065
            flange_class = "600"
            pressure_rating = 1065
            temperature_rating = 750
        elsif pressure > 1065 and pressure <= 1595
            flange_class = "900"
            pressure_rating = 1595
            temperature_rating = 750
        end
    elsif temperature > 750 and temperature <= 800 
        if pressure <= 80 
            flange_class = "150"
            pressure_rating = 80
            temperature_rating = 800
        elsif pressure > 80 and pressure <= 510
            flange_class = "300"
            pressure_rating = 510
            temperature_rating = 800
        elsif pressure > 510 and pressure <= 675
            flange_class = "400"
            pressure_rating = 675
            temperature_rating = 800
        elsif pressure > 675 and pressure <= 1015
            flange_class = "600"
            pressure_rating = 1015
            temperature_rating = 800
        elsif pressure > 1015 and pressure <= 1525
            flange_class = "900"
            pressure_rating = 1525
            temperature_rating = 800
        end
    elsif temperature > 800 and temperature <= 850 
        if pressure <= 65 
            flange_class = "150"
            pressure_rating = 65
            temperature_rating = 850
        elsif pressure > 65 and pressure <= 485
            flange_class = "300"
            pressure_rating = 485
            temperature_rating = 850
        elsif pressure > 485 and pressure <= 650
            flange_class = "400"
            pressure_rating = 650
            temperature_rating = 850
        elsif pressure > 650 and pressure <= 975
            flange_class = "600"
            pressure_rating = 975
            temperature_rating = 850
        elsif pressure > 975 and pressure <= 1460
            flange_class = "900"
            pressure_rating = 1460
            temperature_rating = 850
        end
    elsif temperature > 850 and temperature <= 900 
        if pressure <= 50 
            flange_class = "150"
            pressure_rating = 50
            temperature_rating = 900
        elsif pressure > 50 and pressure <= 375
            flange_class = "300"
            pressure_rating = 375
            temperature_rating = 900
        elsif pressure > 375 and pressure <= 500
            flange_class = "400"
            pressure_rating = 500
            temperature_rating = 900
        elsif pressure > 500 and pressure <= 745
            flange_class = "600"
            pressure_rating = 745
            temperature_rating = 900
        elsif pressure > 745 and pressure <= 1120
            flange_class = "900"
            pressure_rating = 1120
            temperature_rating = 900
        end
    elsif temperature > 900 and temperature <= 950 
        if pressure <= 35 
            flange_class = "150"
            pressure_rating = 35
            temperature_rating = 950
        elsif pressure > 35 and pressure <= 275
            flange_class = "300"
            pressure_rating = 275
            temperature_rating = 950
        elsif pressure > 275 and pressure <= 365
            flange_class = "400"
            pressure_rating = 365
            temperature_rating = 950
        elsif pressure > 365 and pressure <= 550
            flange_class = "600"
            pressure_rating = 550
            temperature_rating = 950
        elsif pressure > 550 and pressure <= 825
            flange_class = "900"
            pressure_rating = 825
            temperature_rating = 950
        end
    elsif temperature > 950 and temperature <= 1000
        if pressure <= 20 
            flange_class = "150"
            pressure_rating = 20
            temperature_rating = 1000
        elsif pressure > 20 and pressure <= 200
            flange_class = "300"
            pressure_rating = 200
            temperature_rating = 1000
        elsif pressure > 200 and pressure <= 265
            flange_class = "400"
            pressure_rating = 265
            temperature_rating = 1000
        elsif pressure > 265 and pressure <= 400
            flange_class = "600"
            pressure_rating = 400
            temperature_rating = 1000
        elsif pressure > 400 and pressure <= 595
            flange_class = "900"
            pressure_rating = 595
            temperature_rating = 1000
        end
    elsif temperature > 1000 and temperature <= 105
        if pressure > 145 
            flange_class = "300"
            pressure_rating = 145
            temperature_rating = 1050
        elsif pressure > 145 and pressure <= 190
            flange_class = "400"
            pressure_rating = 190
            temperature_rating = 1050
        elsif pressure > 190 and pressure <= 290
            flange_class = "600"
            pressure_rating = 290
            temperature_rating = 1050
        elsif pressure > 290 and pressure <= 430
            flange_class = "900"
            pressure_rating = 430
            temperature_rating = 1050
        end
    elsif temperature > 1050 and temperature <= 110
        if pressure > 95 
            flange_class = "300"
            pressure_rating = 95
            temperature_rating = 1100
        elsif pressure > 95 and pressure <= 130
            flange_class = "400"
            pressure_rating = 130
            temperature_rating = 1100
        elsif pressure > 130 and pressure <= 190
            flange_class = "600"
            pressure_rating = 190
            temperature_rating = 1100
        elsif pressure > 190 and pressure <= 290
            flange_class = "900"
            pressure_rating = 290
            temperature_rating = 1100
        end
    elsif temperature > 1100 and temperature <= 115
        if pressure > 60 
            flange_class = "300"
            pressure_rating = 60
            temperature_rating = 1150
        elsif pressure > 60 and pressure <= 80
            flange_class = "400"
            pressure_rating = 80
            temperature_rating = 1150
        elsif pressure > 80 and pressure <= 125
            flange_class = "600"
            pressure_rating = 125
            temperature_rating = 1150
        elsif pressure > 125 and pressure <= 185
            flange_class = "900"
            pressure_rating = 185
            temperature_rating = 1150
        end
    elsif temperature > 1150 and temperature <= 120
        if pressure > 35 
            flange_class = "300"
            pressure_rating = 35
            temperature_rating = 1200
        elsif pressure > 35 and pressure <= 45
            flange_class = "400"
            pressure_rating = 45
            temperature_rating = 1200
        elsif pressure > 45 and pressure <= 70
            flange_class = "600"
            pressure_rating = 70
            temperature_rating = 1200
        elsif pressure > 70 and pressure <= 105
            flange_class = "900"
            pressure_rating = 105
            temperature_rating = 1200
        end
    end
end

  
if material_group == "2.1"
if temperature >= -20 and temperature <= 100 
    if pressure <= 140 
        flange_class = "75"
        pressure_rating = 140
        temperature_rating = 100
    elsif pressure > 140 and pressure <= 275
        flange_class = "150"
        pressure_rating = 275
        temperature_rating = 100
    elsif pressure > 275 and pressure <= 720
        flange_class = "300"
        pressure_rating = 720
        temperature_rating = 100
    elsif pressure > 720 and pressure <= 960
        flange_class = "400"
        pressure_rating = 960
        temperature_rating = 100
    elsif pressure > 960 and pressure <= 1440
        flange_class = "600"
        pressure_rating = 1440
        temperature_rating = 100
    elsif pressure > 1440 and pressure <= 2160
        flange_class = "900"
        pressure_rating = 2160
        temperature_rating = 100
    end
elsif temperature > 100 and temperature <= 200 
    if pressure <= 115 
        flange_class = "75"
        pressure_rating = 115
        temperature_rating = 200
    elsif pressure > 115 and pressure <= 230
        flange_class = "150"
        pressure_rating = 230
        temperature_rating = 200
    elsif pressure > 230 and pressure <= 600
        flange_class = "300"
        pressure_rating = 600
        temperature_rating = 200
    elsif pressure > 600 and pressure <= 800
        flange_class = "400"
        pressure_rating = 800
        temperature_rating = 200
    elsif pressure > 800 and pressure <= 1200
        flange_class = "600"
        pressure_rating = 1200
        temperature_rating = 200
    elsif pressure > 1200 and pressure <= 1800
        flange_class = "900"
        pressure_rating = 1800
        temperature_rating = 200
    end
elsif temperature > 200 and temperature <= 300 
    if pressure <= 105 
        flange_class = "75"
        pressure_rating = 105
        temperature_rating = 300
    elsif pressure > 105 and pressure <= 205
        flange_class = "150"
        pressure_rating = 205
        temperature_rating = 300
    elsif pressure > 205 and pressure <= 540
        flange_class = "300"
        pressure_rating = 540
        temperature_rating = 300
    elsif pressure > 540 and pressure <= 715
        flange_class = "400"
        pressure_rating = 715
        temperature_rating = 300
    elsif pressure > 715 and pressure <= 1075
        flange_class = "600"
        pressure_rating = 1075
        temperature_rating = 300
    elsif pressure > 1075 and pressure <= 1615
        flange_class = "900"
        pressure_rating = 1615
        temperature_rating = 300
    end
elsif temperature > 300 and temperature <= 400 
    if pressure <= 95 
        flange_class = "75"
        pressure_rating = 95
        temperature_rating = 400
    elsif pressure > 95 and pressure <= 190
        flange_class = "150"
        pressure_rating = 190
        temperature_rating = 400
    elsif pressure > 190 and pressure <= 495
        flange_class = "300"
        pressure_rating = 495
        temperature_rating = 400
    elsif pressure > 495 and pressure <= 660
        flange_class = "400"
        pressure_rating = 660
        temperature_rating = 400
    elsif pressure > 660 and pressure <= 995
        flange_class = "600"
        pressure_rating = 995
        temperature_rating = 400
    elsif pressure > 995 and pressure <= 1490
        flange_class = "900"
        pressure_rating = 1490
        temperature_rating = 400
    end
elsif temperature > 400 and temperature <= 500 
    if pressure <= 85 
        flange_class = "75"
        pressure_rating = 85
        temperature_rating = 100
    elsif pressure > 85 and pressure <= 170
        flange_class = "150"
        pressure_rating = 170
        temperature_rating = 500
    elsif pressure > 170 and pressure <= 465
        flange_class = "300"
        pressure_rating = 465
        temperature_rating = 500
    elsif pressure > 465 and pressure <= 620
        flange_class = "400"
        pressure_rating = 620
        temperature_rating = 500
    elsif pressure > 620 and pressure <= 930
        flange_class = "600"
        pressure_rating = 930
        temperature_rating = 500
    elsif pressure > 930 and pressure <= 1395
        flange_class = "900"
        pressure_rating = 1395
        temperature_rating = 500
    end
elsif temperature > 500 and temperature <= 600 
    if pressure <= 70 
        flange_class = "75"
        pressure_rating = 70
        temperature_rating = 100
    elsif pressure > 70 and pressure <= 140
        flange_class = "150"
        pressure_rating = 140
        temperature_rating = 600
    elsif pressure > 140 and pressure <= 440
        flange_class = "300"
        pressure_rating = 440
        temperature_rating = 600
    elsif pressure > 440 and pressure <= 590
        flange_class = "400"
        pressure_rating = 590
        temperature_rating = 600
    elsif pressure > 590 and pressure <= 885
        flange_class = "600"
        pressure_rating = 885
        temperature_rating = 600
    elsif pressure > 885 and pressure <= 1325
        flange_class = "900"
        pressure_rating = 1325
        temperature_rating = 600
    end
elsif temperature > 600 and temperature <= 650 
    if pressure <= 60 
        flange_class = "75"
        pressure_rating = 60
        temperature_rating = 650
    elsif pressure > 60 and pressure <= 125
        flange_class = "150"
        pressure_rating = 125
        temperature_rating = 650
    elsif pressure > 125 and pressure <= 430
        flange_class = "300"
        pressure_rating = 430
        temperature_rating = 650
    elsif pressure > 430 and pressure <= 575
        flange_class = "400"
        pressure_rating = 575
        temperature_rating = 650
    elsif pressure > 575 and pressure <= 865
        flange_class = "600"
        pressure_rating = 865
        temperature_rating = 650
    elsif pressure > 865 and pressure <= 1295
        flange_class = "900"
        pressure_rating = 1295
        temperature_rating = 650
    end
elsif temperature > 650 and temperature <= 700 
    if pressure <= 110 
        flange_class = "150"
        pressure_rating = 110
        temperature_rating = 700
    elsif pressure > 110 and pressure <= 420
        flange_class = "300"
        pressure_rating = 420
        temperature_rating = 700
    elsif pressure > 420 and pressure <= 565
        flange_class = "400"
        pressure_rating = 565
        temperature_rating = 700
    elsif pressure > 565 and pressure <= 845
        flange_class = "600"
        pressure_rating = 845
        temperature_rating = 700
    elsif pressure > 845 and pressure <= 1265
        flange_class = "900"
        pressure_rating = 1265
        temperature_rating = 700
    end
elsif temperature > 700 and temperature <= 750 
    if pressure <= 95 
        flange_class = "150"
        pressure_rating = 95
        temperature_rating = 750
    elsif pressure > 95 and pressure <= 415
        flange_class = "300"
        pressure_rating = 415
        temperature_rating = 750
    elsif pressure > 415 and pressure <= 550
        flange_class = "400"
        pressure_rating = 550
        temperature_rating = 750
    elsif pressure > 550 and pressure <= 825
        flange_class = "600"
        pressure_rating = 825
        temperature_rating = 750
    elsif pressure > 825 and pressure <= 1240
        flange_class = "900"
        pressure_rating = 1240
        temperature_rating = 750
    end
elsif temperature > 750 and temperature <= 800 
    if pressure <= 80 
        flange_class = "150"
        pressure_rating = 80
        temperature_rating = 800
    elsif pressure > 80 and pressure <= 405
        flange_class = "300"
        pressure_rating = 405
        temperature_rating = 800
    elsif pressure > 405 and pressure <= 540
        flange_class = "400"
        pressure_rating = 540
        temperature_rating = 800
    elsif pressure > 540 and pressure <= 810
        flange_class = "600"
        pressure_rating = 810
        temperature_rating = 800
    elsif pressure > 810 and pressure <= 1215
        flange_class = "900"
        pressure_rating = 1215
        temperature_rating = 800
    end
elsif temperature > 800 and temperature <= 850 
    if pressure <= 65 
        flange_class = "150"
        pressure_rating = 65
        temperature_rating = 850
    elsif pressure > 65 and pressure <= 395
        flange_class = "300"
        pressure_rating = 395
        temperature_rating = 850
    elsif pressure > 395 and pressure <= 530
        flange_class = "400"
        pressure_rating = 530
        temperature_rating = 850
    elsif pressure > 530 and pressure <= 790
        flange_class = "600"
        pressure_rating = 790
        temperature_rating = 850
    elsif pressure > 790 and pressure <= 1190
        flange_class = "900"
        pressure_rating = 1190
        temperature_rating = 850
    end
elsif temperature > 850 and temperature <= 900 
    if pressure <= 50 
        flange_class = "150"
        pressure_rating = 50
        temperature_rating = 900
    elsif pressure > 50 and pressure <= 390
        flange_class = "300"
        pressure_rating = 390
        temperature_rating = 900
    elsif pressure > 390 and pressure <= 520
        flange_class = "400"
        pressure_rating = 520
        temperature_rating = 900
    elsif pressure > 520 and pressure <= 780
        flange_class = "600"
        pressure_rating = 780
        temperature_rating = 900
    elsif pressure > 780 and pressure <= 1165
        flange_class = "900"
        pressure_rating = 1165
        temperature_rating = 900
    end
elsif temperature > 900 and temperature <= 950 
    if pressure <= 35 
        flange_class = "150"
        pressure_rating = 35
        temperature_rating = 950
    elsif pressure > 35 and pressure <= 380
        flange_class = "300"
        pressure_rating = 380
        temperature_rating = 950
    elsif pressure > 380 and pressure <= 510
        flange_class = "400"
        pressure_rating = 510
        temperature_rating = 950
    elsif pressure > 510 and pressure <= 765
        flange_class = "600"
        pressure_rating = 765
        temperature_rating = 950
    elsif pressure > 755 and pressure <= 1145
        flange_class = "900"
        pressure_rating = 1145
        temperature_rating = 950
    end
elsif temperature > 950 and temperature <= 1000
    if pressure <= 20 
        flange_class = "150"
        pressure_rating = 20
        temperature_rating = 1000
    elsif pressure > 20 and pressure <= 355
        flange_class = "300"
        pressure_rating = 355
        temperature_rating = 1000
    elsif pressure > 355 and pressure <= 470
        flange_class = "400"
        pressure_rating = 470
        temperature_rating = 1000
    elsif pressure > 470 and pressure <= 710
        flange_class = "600"
        pressure_rating = 710
        temperature_rating = 1000
    elsif pressure > 710 and pressure <= 1065
        flange_class = "900"
        pressure_rating = 1065
        temperature_rating = 1000
    end
elsif temperature > 1000 and temperature <= 105
    if pressure > 325 
        flange_class = "300"
        pressure_rating = 325
        temperature_rating = 1050
    elsif pressure > 325 and pressure <= 435
        flange_class = "400"
        pressure_rating = 435
        temperature_rating = 1050
    elsif pressure > 435 and pressure <= 650
        flange_class = "600"
        pressure_rating = 650
        temperature_rating = 1050
    elsif pressure > 650 and pressure <= 975
        flange_class = "900"
        pressure_rating = 975
        temperature_rating = 1050
    end
elsif temperature > 1050 and temperature <= 110
    if pressure > 325 
        flange_class = "300"
        pressure_rating = 325
        temperature_rating = 1100
    elsif pressure > 325 and pressure <= 435
        flange_class = "400"
        pressure_rating = 435
        temperature_rating = 1100
    elsif pressure > 435 and pressure <= 650
        flange_class = "600"
        pressure_rating = 650
        temperature_rating = 1100
    elsif pressure > 650 and pressure <= 975
        flange_class = "900"
        pressure_rating = 975
        temperature_rating = 1100
    end
elsif temperature > 1100 and temperature <= 115
    if pressure > 205 
        flange_class = "300"
        pressure_rating = 205
        temperature_rating = 1150
    elsif pressure > 205 and pressure <= 275
        flange_class = "400"
        pressure_rating = 275
        temperature_rating = 1150
    elsif pressure > 275 and pressure <= 410
        flange_class = "600"
        pressure_rating = 410
        temperature_rating = 1150
    elsif pressure > 410 and pressure <= 615
        flange_class = "900"
        pressure_rating = 615
        temperature_rating = 1150
    end
elsif temperature > 1150 and temperature <= 120
    if pressure > 165 
        flange_class = "300"
        pressure_rating = 165
        temperature_rating = 1200
    elsif pressure > 165 and pressure <= 220
        flange_class = "400"
        pressure_rating = 220
        temperature_rating = 1200
    elsif pressure > 220 and pressure <= 330
        flange_class = "600"
        pressure_rating = 330
        temperature_rating = 1200
    elsif pressure > 330 and pressure <= 495
        flange_class = "900"
        pressure_rating = 495
        temperature_rating = 1200
    end
elsif temperature > 1200 and temperature <= 125
    if pressure > 135 
        flange_class = "300"
        pressure_rating = 135
        temperature_rating = 1250
    elsif pressure > 135 and pressure <= 180
        flange_class = "400"
        pressure_rating = 180
        temperature_rating = 1250
    elsif pressure > 180 and pressure <= 265
        flange_class = "600"
        pressure_rating = 265
        temperature_rating = 1250
    elsif pressure > 265 and pressure <= 400
        flange_class = "900"
        pressure_rating = 400
        temperature_rating = 1250
    end
elsif temperature > 1250 and temperature <= 130
    if pressure > 115 
        flange_class = "300"
        pressure_rating = 115
        temperature_rating = 1300
    elsif pressure > 115 and pressure <= 150
        flange_class = "400"
        pressure_rating = 150
        temperature_rating = 1300
    elsif pressure > 150 and pressure <= 225
        flange_class = "600"
        pressure_rating = 225
        temperature_rating = 1300
    elsif pressure > 225 and pressure <= 400
        flange_class = "900"
        pressure_rating = 400
        temperature_rating = 1300
    end
elsif temperature > 1300 and temperature <= 135
    if pressure > 95 
        flange_class = "300"
        pressure_rating = 95
        temperature_rating = 1350
    elsif pressure > 95 and pressure <= 125
        flange_class = "400"
        pressure_rating = 125
        temperature_rating = 1350
    elsif pressure > 125 and pressure <= 185
        flange_class = "600"
        pressure_rating = 185
        temperature_rating = 1350
    elsif pressure > 185 and pressure <= 280
        flange_class = "900"
        pressure_rating = 280
        temperature_rating = 1350
    end
elsif temperature > 1350 and temperature <= 140
    if pressure > 75 
        flange_class = "300"
        pressure_rating = 75
        temperature_rating = 1400
    elsif pressure > 75 and pressure <= 100
        flange_class = "400"
        pressure_rating = 100
        temperature_rating = 1400
    elsif pressure > 100 and pressure <= 150
        flange_class = "600"
        pressure_rating = 150
        temperature_rating = 1400
    elsif pressure > 150 and pressure <= 225
        flange_class = "900"
        pressure_rating = 225
        temperature_rating = 1400
    end
elsif temperature > 1400 and temperature <= 145
    if pressure > 60 
        flange_class = "300"
        pressure_rating = 60
        temperature_rating = 1450
    elsif pressure > 60 and pressure <= 80
        flange_class = "400"
        pressure_rating = 80
        temperature_rating = 1450
    elsif pressure > 80 and pressure <= 115
        flange_class = "600"
        pressure_rating = 115
        temperature_rating = 1450
    elsif pressure > 115 and pressure <= 175
        flange_class = "900"
        pressure_rating = 175
        temperature_rating = 1450
    end
elsif temperature > 1450 and temperature <= 150
    if pressure > 40 
        flange_class = "300"
        pressure_rating = 40
        temperature_rating = 1500
    elsif pressure > 40 and pressure <= 55
        flange_class = "400"
        pressure_rating = 55
        temperature_rating = 1500
    elsif pressure > 55 and pressure <= 85
        flange_class = "600"
        pressure_rating = 85
        temperature_rating = 1500
    elsif pressure > 85 and pressure <= 125
        flange_class = "900"
        pressure_rating = 125
        temperature_rating = 1500
    end
end
end

  
if material_group == "2.2"
if temperature >= -20 and temperature <= 100
    if pressure <= 140 
        flange_class = "75"
        pressure_rating = 140
        temperature_rating = 100
    elsif pressure > 140 and pressure <= 275
        flange_class = "150"
        pressure_rating = 275
        temperature_rating = 100
    elsif pressure > 275 and pressure <= 720
        flange_class = "300"
        pressure_rating = 720
        temperature_rating = 100
    elsif pressure > 720 and pressure <= 960
        flange_class = "400"
        pressure_rating = 960
        temperature_rating = 100
    elsif pressure > 960 and pressure <= 1440
        flange_class = "600"
        pressure_rating = 1440
        temperature_rating = 100
    elsif pressure > 1440 and pressure <= 2160
        flange_class = "900"
        pressure_rating = 2160
        temperature_rating = 100
    end
elsif temperature > 100 and temperature <= 200 
    if pressure <= 120 
        flange_class = "75"
        pressure_rating = 120
        temperature_rating = 200
    elsif pressure > 120 and pressure <= 235
        flange_class = "150"
        pressure_rating = 235
        temperature_rating = 200
    elsif pressure > 235 and pressure <= 620
        flange_class = "300"
        pressure_rating = 620
        temperature_rating = 200
    elsif pressure > 620 and pressure <= 825
        flange_class = "400"
        pressure_rating = 825
        temperature_rating = 200
    elsif pressure > 825 and pressure <= 1240
        flange_class = "600"
        pressure_rating = 1240
        temperature_rating = 200
    elsif pressure > 1240 and pressure <= 1860
        flange_class = "900"
        pressure_rating = 1860
        temperature_rating = 200
    end
elsif temperature > 200 and temperature <= 300 
    if pressure <= 105 
        flange_class = "75"
        pressure_rating = 105
        temperature_rating = 300
    elsif pressure > 105 and pressure <= 215
        flange_class = "150"
        pressure_rating = 215
        temperature_rating = 300
    elsif pressure > 215 and pressure <= 560
        flange_class = "300"
        pressure_rating = 560
        temperature_rating = 300
    elsif pressure > 560 and pressure <= 745
        flange_class = "400"
        pressure_rating = 745
        temperature_rating = 300
    elsif pressure > 745 and pressure <= 1120
        flange_class = "600"
        pressure_rating = 1120
        temperature_rating = 300
    elsif pressure > 1120 and pressure <= 1680
        flange_class = "900"
        pressure_rating = 1680
        temperature_rating = 300
    end
elsif temperature > 300 and temperature <= 400 
    if pressure <= 100 
        flange_class = "75"
        pressure_rating = 100
        temperature_rating = 400
    elsif pressure > 100 and pressure <= 195
        flange_class = "150"
        pressure_rating = 195
        temperature_rating = 400
    elsif pressure > 195 and pressure <= 515
        flange_class = "300"
        pressure_rating = 515
        temperature_rating = 400
    elsif pressure > 515 and pressure <= 685
        flange_class = "400"
        pressure_rating = 685
        temperature_rating = 400
    elsif pressure > 685 and pressure <= 1025
        flange_class = "600"
        pressure_rating = 1025
        temperature_rating = 400
    elsif pressure > 1025 and pressure <= 1540
        flange_class = "900"
        pressure_rating = 1540
        temperature_rating = 400
    end
elsif temperature > 400 and temperature <= 500 
    if pressure <= 85 
        flange_class = "75"
        pressure_rating = 85
        temperature_rating = 500
    elsif pressure > 85 and pressure <= 170
        flange_class = "150"
        pressure_rating = 170
        temperature_rating = 500
    elsif pressure > 170 and pressure <= 480
        flange_class = "300"
        pressure_rating = 480
        temperature_rating = 500
    elsif pressure > 480 and pressure <= 635
        flange_class = "400"
        pressure_rating = 635
        temperature_rating = 500
    elsif pressure > 635 and pressure <= 955
        flange_class = "600"
        pressure_rating = 955
        temperature_rating = 500
    elsif pressure > 955 and pressure <= 1435
        flange_class = "900"
        pressure_rating = 1435
        temperature_rating = 500
    end
elsif temperature > 500 and temperature <= 600 
    if pressure <= 70 
        flange_class = "75"
        pressure_rating = 70
        temperature_rating = 600
    elsif pressure > 70 and pressure <= 140
        flange_class = "150"
        pressure_rating = 140
        temperature_rating = 600
    elsif pressure > 140 and pressure <= 450
        flange_class = "300"
        pressure_rating = 450
        temperature_rating = 600
    elsif pressure > 450 and pressure <= 600
        flange_class = "400"
        pressure_rating = 600
        temperature_rating = 600
    elsif pressure > 600 and pressure <= 900
        flange_class = "600"
        pressure_rating = 900
        temperature_rating = 600
    elsif pressure > 900 and pressure <= 1355
        flange_class = "900"
        pressure_rating = 1355
        temperature_rating = 600
    end
elsif temperature > 600 and temperature <= 650 
    if pressure <= 60 
        flange_class = "75"
        pressure_rating = 60
        temperature_rating = 650
    elsif pressure > 60 and pressure <= 125
        flange_class = "150"
        pressure_rating = 125
        temperature_rating = 650
    elsif pressure > 125 and pressure <= 440
        flange_class = "300"
        pressure_rating = 440
        temperature_rating = 650
    elsif pressure > 440 and pressure <= 590
        flange_class = "400"
        pressure_rating = 590
        temperature_rating = 650
    elsif pressure > 590 and pressure <= 885
        flange_class = "600"
        pressure_rating = 885
        temperature_rating = 650
    elsif pressure > 885 and pressure <= 1325
        flange_class = "900"
        pressure_rating = 1325
        temperature_rating = 650
    end
elsif temperature > 650 and temperature <= 700 
    if pressure <= 110 
        flange_class = "150"
        pressure_rating = 110
        temperature_rating = 700
    elsif pressure > 110 and pressure <= 435
        flange_class = "300"
        pressure_rating = 435
        temperature_rating = 700
    elsif pressure > 570 and pressure <= 580
        flange_class = "400"
        pressure_rating = 580
        temperature_rating = 700
    elsif pressure > 580 and pressure <= 870
        flange_class = "600"
        pressure_rating = 870
        temperature_rating = 700
    elsif pressure > 870 and pressure <= 1305
        flange_class = "900"
        pressure_rating = 1305
        temperature_rating = 700
    end
elsif temperature > 700 and temperature <= 750 
    if pressure <= 95 
        flange_class = "150"
        pressure_rating = 95
        temperature_rating = 750
    elsif pressure > 95 and pressure <= 425
        flange_class = "300"
        pressure_rating = 425
        temperature_rating = 750
    elsif pressure > 425 and pressure <= 570
        flange_class = "400"
        pressure_rating = 570
        temperature_rating = 750
    elsif pressure > 570 and pressure <= 855
        flange_class = "600"
        pressure_rating = 855
        temperature_rating = 750
    elsif pressure > 855 and pressure <= 1280
        flange_class = "900"
        pressure_rating = 1280
        temperature_rating = 750
    end
elsif temperature > 750 and temperature <= 800 
    if pressure <= 80 
        flange_class = "150"
        pressure_rating = 80
        temperature_rating = 800
    elsif pressure > 80 and pressure <= 420
        flange_class = "300"
        pressure_rating = 420
        temperature_rating = 800
    elsif pressure > 420 and pressure <= 565
        flange_class = "400"
        pressure_rating = 565
        temperature_rating = 800
    elsif pressure > 565 and pressure <= 845
        flange_class = "600"
        pressure_rating = 845
        temperature_rating = 800
    elsif pressure > 845 and pressure <= 1265
        flange_class = "900"
        pressure_rating = 1265
        temperature_rating = 800
    end
elsif temperature > 800 and temperature <= 850 
    if pressure <= 65 
        flange_class = "150"
        pressure_rating = 65
        temperature_rating = 850
    elsif pressure > 65 and pressure <= 420
        flange_class = "300"
        pressure_rating = 420
        temperature_rating = 850
    elsif pressure > 420 and pressure <= 555
        flange_class = "400"
        pressure_rating = 555
        temperature_rating = 850
    elsif pressure > 555 and pressure <= 835
        flange_class = "600"
        pressure_rating = 835
        temperature_rating = 850
    elsif pressure > 835 and pressure <= 1255
        flange_class = "900"
        pressure_rating = 1255
        temperature_rating = 850
    end
elsif temperature > 850 and temperature <= 900 
    if pressure <= 50 
        flange_class = "150"
        pressure_rating = 50
        temperature_rating = 900
    elsif pressure > 50 and pressure <= 415
        flange_class = "300"
        pressure_rating = 415
        temperature_rating = 900
    elsif pressure > 415 and pressure <= 555
        flange_class = "400"
        pressure_rating = 555
        temperature_rating = 900
    elsif pressure > 555 and pressure <= 830
        flange_class = "600"
        pressure_rating = 830
        temperature_rating = 900
    elsif pressure > 830 and pressure <= 1245
        flange_class = "900"
        pressure_rating = 1245
        temperature_rating = 900
    end
elsif temperature > 900 and temperature <= 950 
    if pressure <= 35 
        flange_class = "150"
        pressure_rating = 35
        temperature_rating = 950
    elsif pressure > 35 and pressure <= 385
        flange_class = "300"
        pressure_rating = 385
        temperature_rating = 950
    elsif pressure > 385 and pressure <= 515
        flange_class = "400"
        pressure_rating = 515
        temperature_rating = 950
    elsif pressure > 515 and pressure <= 775
        flange_class = "600"
        pressure_rating = 775
        temperature_rating = 950
    elsif pressure > 775 and pressure <= 1160
        flange_class = "900"
        pressure_rating = 1160
        temperature_rating = 950
    end
elsif temperature > 950 and temperature <= 1000
    if pressure <= 20 
        flange_class = "150"
        pressure_rating = 20
        temperature_rating = 1000
    elsif pressure > 20 and pressure <= 365
        flange_class = "300"
        pressure_rating = 365
        temperature_rating = 1000
    elsif pressure > 365 and pressure <= 485
        flange_class = "400"
        pressure_rating = 485
        temperature_rating = 1000
    elsif pressure > 485 and pressure <= 725
        flange_class = "600"
        pressure_rating = 725
        temperature_rating = 1000
    elsif pressure > 725 and pressure <= 1090
        flange_class = "900"
        pressure_rating = 1090
        temperature_rating = 1000
    end
elsif temperature > 1000 and temperature <= 105
    if pressure > 360 
        flange_class = "300"
        pressure_rating = 360
        temperature_rating = 1050
    elsif pressure > 360 and pressure <= 480
        flange_class = "400"
        pressure_rating = 480
        temperature_rating = 1050
    elsif pressure > 480 and pressure <= 720
        flange_class = "600"
        pressure_rating = 720
        temperature_rating = 1050
    elsif pressure > 720 and pressure <= 1080
        flange_class = "900"
        pressure_rating = 1080
        temperature_rating = 1050
    end
elsif temperature > 1050 and temperature <= 110
    if pressure > 305 
        flange_class = "300"
        pressure_rating = 305
        temperature_rating = 1100
    elsif pressure > 305 and pressure <= 405
        flange_class = "400"
        pressure_rating = 405
        temperature_rating = 1100
    elsif pressure > 405 and pressure <= 610
        flange_class = "600"
        pressure_rating = 610
        temperature_rating = 1100
    elsif pressure > 610 and pressure <= 915
        flange_class = "900"
        pressure_rating = 915
        temperature_rating = 1100
    end
elsif temperature > 1100 and temperature <= 115
    if pressure > 235 
        flange_class = "300"
        pressure_rating = 235
        temperature_rating = 1150
    elsif pressure > 235 and pressure <= 315
        flange_class = "400"
        pressure_rating = 315
        temperature_rating = 1150
    elsif pressure > 315 and pressure <= 475
        flange_class = "600"
        pressure_rating = 475
        temperature_rating = 1150
    elsif pressure > 475 and pressure <= 710
        flange_class = "900"
        pressure_rating = 710
        temperature_rating = 1150
    end
elsif temperature > 1150 and temperature <= 120
    if pressure > 185 
        flange_class = "300"
        pressure_rating = 185
        temperature_rating = 1200
    elsif pressure > 185 and pressure <= 245
        flange_class = "400"
        pressure_rating = 245
        temperature_rating = 1200
    elsif pressure > 245 and pressure <= 370
        flange_class = "600"
        pressure_rating = 370
        temperature_rating = 1200
    elsif pressure > 370 and pressure <= 555
        flange_class = "900"
        pressure_rating = 555
        temperature_rating = 1200
    end
elsif temperature > 1200 and temperature <= 125
    if pressure > 115 
        flange_class = "300"
        pressure_rating = 115
        temperature_rating = 1250
    elsif pressure > 115 and pressure <= 155
        flange_class = "400"
        pressure_rating = 155
        temperature_rating = 1250
    elsif pressure > 155 and pressure <= 235
        flange_class = "600"
        pressure_rating = 235
        temperature_rating = 1250
    elsif pressure > 235 and pressure <= 350
        flange_class = "900"
        pressure_rating = 350
        temperature_rating = 1250
    end
elsif temperature > 1250 and temperature <= 130
    if pressure > 115 
        flange_class = "300"
        pressure_rating = 115
        temperature_rating = 1300
    elsif pressure > 115 and pressure <= 155
        flange_class = "400"
        pressure_rating = 155
        temperature_rating = 1300
    elsif pressure > 155 and pressure <= 235
        flange_class = "600"
        pressure_rating = 235
        temperature_rating = 1300
    elsif pressure > 235 and pressure <= 350
        flange_class = "900"
        pressure_rating = 350
        temperature_rating = 1300
    end
elsif temperature > 1300 and temperature <= 135
    if pressure > 95 
        flange_class = "300"
        pressure_rating = 95
        temperature_rating = 1350
    elsif pressure > 95 and pressure <= 130
        flange_class = "400"
        pressure_rating = 130
        temperature_rating = 1350
    elsif pressure > 130 and pressure <= 190
        flange_class = "600"
        pressure_rating = 190
        temperature_rating = 1350
    elsif pressure > 190 and pressure <= 290
        flange_class = "900"
        pressure_rating = 290
        temperature_rating = 1350
    end
elsif temperature > 1350 and temperature <= 140
    if pressure > 75 
        flange_class = "300"
        pressure_rating = 75
        temperature_rating = 1400
    elsif pressure > 75 and pressure <= 100
        flange_class = "400"
        pressure_rating = 100
        temperature_rating = 1400
    elsif pressure > 100 and pressure <= 150
        flange_class = "600"
        pressure_rating = 150
        temperature_rating = 1400
    elsif pressure > 150 and pressure <= 225
        flange_class = "900"
        pressure_rating = 225
        temperature_rating = 1400
    end
elsif temperature > 1400 and temperature <= 145
    if pressure > 60 
        flange_class = "300"
        pressure_rating = 60
        temperature_rating = 1450
    elsif pressure > 60 and pressure <= 80
        flange_class = "400"
        pressure_rating = 80
        temperature_rating = 1450
    elsif pressure > 80 and pressure <= 115
        flange_class = "600"
        pressure_rating = 115
        temperature_rating = 1450
    elsif pressure > 115 and pressure <= 175
        flange_class = "900"
        pressure_rating = 175
        temperature_rating = 1450
    end
elsif temperature > 1450 and temperature <= 150
    if pressure > 40 
        flange_class = "300"
        pressure_rating = 40
        temperature_rating = 1500
    elsif pressure > 40 and pressure <= 55
        flange_class = "400"
        pressure_rating = 55
        temperature_rating = 1500
    elsif pressure > 55 and pressure <= 85
        flange_class = "600"
        pressure_rating = 85
        temperature_rating = 1500
    elsif pressure > 85 and pressure <= 125
        flange_class = "900"
        pressure_rating = 125
        temperature_rating = 1500
    end
end
end

  
if material_group == "2.3"
if temperature >= -20 and temperature <= 100 
    if pressure <= 115 
        flange_class = "75"
        pressure_rating = 115
        temperature_rating = 100
    elsif pressure > 115 and pressure <= 230
        flange_class = "150"
        pressure_rating = 230
        temperature_rating = 100
    elsif pressure > 230 and pressure <= 600
        flange_class = "300"
        pressure_rating = 600
        temperature_rating = 100
    elsif pressure > 600 and pressure <= 800
        flange_class = "400"
        pressure_rating = 800
        temperature_rating = 100
    elsif pressure > 800 and pressure <= 1200
        flange_class = "600"
        pressure_rating = 1200
        temperature_rating = 100
    elsif pressure > 1200 and pressure <= 1800
        flange_class = "900"
        pressure_rating = 1800
        temperature_rating = 100
    end
elsif temperature > 100 and temperature <= 200 
    if pressure <= 100 
        flange_class = "75"
        pressure_rating = 100
        temperature_rating = 200
    elsif pressure > 100 and pressure <= 195
        flange_class = "150"
        pressure_rating = 195
        temperature_rating = 200
    elsif pressure > 195 and pressure <= 510
        flange_class = "300"
        pressure_rating = 510
        temperature_rating = 200
    elsif pressure > 510 and pressure <= 680
        flange_class = "400"
        pressure_rating = 680
        temperature_rating = 200
    elsif pressure > 680 and pressure <= 1020
        flange_class = "600"
        pressure_rating = 1020
        temperature_rating = 200
    elsif pressure > 1020 and pressure <= 1535
        flange_class = "900"
        pressure_rating = 1535
        temperature_rating = 200
    end
elsif temperature > 200 and temperature <= 300 
    if pressure <= 85 
        flange_class = "75"
        pressure_rating = 85
        temperature_rating = 300
    elsif pressure > 85 and pressure <= 175
        flange_class = "150"
        pressure_rating = 175
        temperature_rating = 300
    elsif pressure > 175 and pressure <= 455
        flange_class = "300"
        pressure_rating = 455
        temperature_rating = 300
    elsif pressure > 455 and pressure <= 610
        flange_class = "400"
        pressure_rating = 610
        temperature_rating = 300
    elsif pressure > 610 and pressure <= 910
        flange_class = "600"
        pressure_rating = 910
        temperature_rating = 300
    elsif pressure > 910 and pressure <= 1370
        flange_class = "900"
        pressure_rating = 1370
        temperature_rating = 300
    end
elsif temperature > 300 and temperature <= 400 
    if pressure <= 80 
        flange_class = "75"
        pressure_rating = 80
        temperature_rating = 400
    elsif pressure > 80 and pressure <= 160
        flange_class = "150"
        pressure_rating = 160
        temperature_rating = 400
    elsif pressure > 160 and pressure <= 420
        flange_class = "300"
        pressure_rating = 420
        temperature_rating = 400
    elsif pressure > 420 and pressure <= 560
        flange_class = "400"
        pressure_rating = 560
        temperature_rating = 400
    elsif pressure > 560 and pressure <= 840
        flange_class = "600"
        pressure_rating = 840
        temperature_rating = 400
    elsif pressure > 840 and pressure <= 1260
        flange_class = "900"
        pressure_rating = 1260
        temperature_rating = 400
    end
elsif temperature > 400 and temperature <= 500 
    if pressure <= 75 
        flange_class = "75"
        pressure_rating = 75
        temperature_rating = 500
    elsif pressure > 75 and pressure <= 150
        flange_class = "150"
        pressure_rating = 150
        temperature_rating = 500
    elsif pressure > 150 and pressure <= 395
        flange_class = "300"
        pressure_rating = 395
        temperature_rating = 500
    elsif pressure > 395 and pressure <= 525
        flange_class = "400"
        pressure_rating = 525
        temperature_rating = 500
    elsif pressure > 525 and pressure <= 785
        flange_class = "600"
        pressure_rating = 785
        temperature_rating = 500
    elsif pressure > 785 and pressure <= 1180
        flange_class = "900"
        pressure_rating = 1180
        temperature_rating = 500
    end
elsif temperature > 500 and temperature <= 600 
    if pressure <= 70 
        flange_class = "75"
        pressure_rating = 70
        temperature_rating = 600
    elsif pressure > 70 and pressure <= 140
        flange_class = "150"
        pressure_rating = 140
        temperature_rating = 600
    elsif pressure > 140 and pressure <= 370
        flange_class = "300"
        pressure_rating = 370
        temperature_rating = 600
    elsif pressure > 370 and pressure <= 495
        flange_class = "400"
        pressure_rating = 495
        temperature_rating = 600
    elsif pressure > 495 and pressure <= 745
        flange_class = "600"
        pressure_rating = 745
        temperature_rating = 600
    elsif pressure > 745 and pressure <= 1115
        flange_class = "900"
        pressure_rating = 1115
        temperature_rating = 600
    end
elsif temperature > 600 and temperature <= 650 
    if pressure <= 60 
        flange_class = "75"
        pressure_rating = 60
        temperature_rating = 650
    elsif pressure > 60 and pressure <= 125
        flange_class = "150"
        pressure_rating = 125
        temperature_rating = 650
    elsif pressure > 125 and pressure <= 365
        flange_class = "300"
        pressure_rating = 365
        temperature_rating = 650
    elsif pressure > 365 and pressure <= 485
        flange_class = "400"
        pressure_rating = 485
        temperature_rating = 650
    elsif pressure > 485 and pressure <= 730
        flange_class = "600"
        pressure_rating = 730
        temperature_rating = 650
    elsif pressure > 730 and pressure <= 1095
        flange_class = "900"
        pressure_rating = 1095
        temperature_rating = 650
    end
elsif temperature > 650 and temperature <= 700 
    if pressure <= 110 
        flange_class = "150"
        pressure_rating = 110
        temperature_rating = 700
    elsif pressure > 110 and pressure <= 360
        flange_class = "300"
        pressure_rating = 360
        temperature_rating = 700
    elsif pressure > 360 and pressure <= 480
        flange_class = "400"
        pressure_rating = 480
        temperature_rating = 700
    elsif pressure > 480 and pressure <= 720
        flange_class = "600"
        pressure_rating = 720
        temperature_rating = 700
    elsif pressure > 720 and pressure <= 1080
        flange_class = "900"
        pressure_rating = 1080
        temperature_rating = 700
    end
elsif temperature > 700 and temperature <= 750 
    if pressure <= 95 
        flange_class = "150"
        pressure_rating = 95
        temperature_rating = 750
    elsif pressure > 95 and pressure <= 355
        flange_class = "300"
        pressure_rating = 355
        temperature_rating = 750
    elsif pressure > 355 and pressure <= 470
        flange_class = "400"
        pressure_rating = 470
        temperature_rating = 750
    elsif pressure > 470 and pressure <= 705
        flange_class = "600"
        pressure_rating = 705
        temperature_rating = 750
    elsif pressure > 705 and pressure <= 1060
        flange_class = "900"
        pressure_rating = 1060
        temperature_rating = 750
    end
elsif temperature > 750 and temperature <= 800 
    if pressure <= 80 
        flange_class = "150"
        pressure_rating = 80
        temperature_rating = 800
    elsif pressure > 80 and pressure <= 345
        flange_class = "300"
        pressure_rating = 345
        temperature_rating = 800
    elsif pressure > 345 and pressure <= 460
        flange_class = "400"
        pressure_rating = 460
        temperature_rating = 800
    elsif pressure > 460 and pressure <= 690
        flange_class = "600"
        pressure_rating = 690
        temperature_rating = 800
    elsif pressure > 690 and pressure <= 1035
        flange_class = "900"
        pressure_rating = 1035
        temperature_rating = 800
    end
elsif temperature > 800 and temperature <= 850 
    if pressure <= 65 
        flange_class = "150"
        pressure_rating = 65
        temperature_rating = 850
    elsif pressure > 65 and pressure <= 340
        flange_class = "300"
        pressure_rating = 340
        temperature_rating = 850
    elsif pressure > 340 and pressure <= 450
        flange_class = "400"
        pressure_rating = 450
        temperature_rating = 850
    elsif pressure > 450 and pressure <= 675
        flange_class = "600"
        pressure_rating = 675
        temperature_rating = 850
    elsif pressure > 675 and pressure <= 1015
        flange_class = "900"
        pressure_rating = 1015
        temperature_rating = 850
    end
end
end

  
if material_group == "2.4"
if temperature >= -20 and temperature <= 100 
    if pressure <= 140 
        flange_class = "75"
        pressure_rating = 140
        temperature_rating = 100
    elsif pressure > 140 and pressure <= 275
        flange_class = "150"
        pressure_rating = 275
        temperature_rating = 100
    elsif pressure > 275 and pressure <= 720
        flange_class = "300"
        pressure_rating = 720
        temperature_rating = 100
    elsif pressure > 720 and pressure <= 960
        flange_class = "400"
        pressure_rating = 960
        temperature_rating = 100
    elsif pressure > 960 and pressure <= 1440
        flange_class = "600"
        pressure_rating = 1440
        temperature_rating = 100
    elsif pressure > 1440 and pressure <= 2160
        flange_class = "900"
        pressure_rating = 2160
        temperature_rating = 100
    end
elsif temperature > 100 and temperature <= 200 
    if pressure <= 125 
        flange_class = "75"
        pressure_rating = 125
        temperature_rating = 200
    elsif pressure > 125 and pressure <= 250
        flange_class = "150"
        pressure_rating = 250
        temperature_rating = 200
    elsif pressure > 250 and pressure <= 650
        flange_class = "300"
        pressure_rating = 650
        temperature_rating = 200
    elsif pressure > 650 and pressure <= 865
        flange_class = "400"
        pressure_rating = 865
        temperature_rating = 200
    elsif pressure > 865 and pressure <= 1295
        flange_class = "600"
        pressure_rating = 1295
        temperature_rating = 200
    elsif pressure > 1295 and pressure <= 1945
        flange_class = "900"
        pressure_rating = 1945
        temperature_rating = 200
    end
elsif temperature > 200 and temperature <= 300 
    if pressure <= 115 
        flange_class = "75"
        pressure_rating = 115
        temperature_rating = 300
    elsif pressure > 115 and pressure <= 230
        flange_class = "150"
        pressure_rating = 230
        temperature_rating = 300
    elsif pressure > 230 and pressure <= 595
        flange_class = "300"
        pressure_rating = 595
        temperature_rating = 300
    elsif pressure > 595 and pressure <= 795
        flange_class = "400"
        pressure_rating = 795
        temperature_rating = 300
    elsif pressure > 795 and pressure <= 1190
        flange_class = "600"
        pressure_rating = 1190
        temperature_rating = 300
    elsif pressure > 1190 and pressure <= 1785
        flange_class = "900"
        pressure_rating = 1785
        temperature_rating = 300
    end
elsif temperature > 300 and temperature <= 400 
    if pressure <= 100 
        flange_class = "75"
        pressure_rating = 100
        temperature_rating = 400
    elsif pressure > 100 and pressure <= 200
        flange_class = "150"
        pressure_rating = 200
        temperature_rating = 400
    elsif pressure > 200 and pressure <= 550
        flange_class = "300"
        pressure_rating = 550
        temperature_rating = 400
    elsif pressure > 550 and pressure <= 735
        flange_class = "400"
        pressure_rating = 735
        temperature_rating = 400
    elsif pressure > 735 and pressure <= 1105
        flange_class = "600"
        pressure_rating = 1105
        temperature_rating = 400
    elsif pressure > 1105 and pressure <= 1655
        flange_class = "900"
        pressure_rating = 1655
        temperature_rating = 400
    end
elsif temperature > 400 and temperature <= 500 
    if pressure <= 85 
        flange_class = "75"
        pressure_rating = 85
        temperature_rating = 500
    elsif pressure > 85 and pressure <= 170
        flange_class = "150"
        pressure_rating = 170
        temperature_rating = 500
    elsif pressure > 170 and pressure <= 515
        flange_class = "300"
        pressure_rating = 515
        temperature_rating = 500
    elsif pressure > 515 and pressure <= 690
        flange_class = "400"
        pressure_rating = 690
        temperature_rating = 500
    elsif pressure > 690 and pressure <= 1030
        flange_class = "600"
        pressure_rating = 1030
        temperature_rating = 500
    elsif pressure > 1030 and pressure <= 1550
        flange_class = "900"
        pressure_rating = 1550
        temperature_rating = 500
    end
elsif temperature > 500 and temperature <= 600 
    if pressure <= 70 
        flange_class = "75"
        pressure_rating = 70
        temperature_rating = 600
    elsif pressure > 70 and pressure <= 140
        flange_class = "150"
        pressure_rating = 140
        temperature_rating = 600
    elsif pressure > 140 and pressure <= 485
        flange_class = "300"
        pressure_rating = 485
        temperature_rating = 600
    elsif pressure > 485 and pressure <= 650
        flange_class = "400"
        pressure_rating = 650
        temperature_rating = 600
    elsif pressure > 650 and pressure <= 975
        flange_class = "600"
        pressure_rating = 975
        temperature_rating = 600
    elsif pressure > 975 and pressure <= 1460
        flange_class = "900"
        pressure_rating = 1460
        temperature_rating = 600
    end
elsif temperature > 600 and temperature <= 650 
    if pressure <= 60 
        flange_class = "75"
        pressure_rating = 60
        temperature_rating = 650
    elsif pressure > 60 and pressure <= 125
        flange_class = "150"
        pressure_rating = 125
        temperature_rating = 650
    elsif pressure > 125 and pressure <= 475
        flange_class = "300"
        pressure_rating = 475
        temperature_rating = 650
    elsif pressure > 475 and pressure <= 635
        flange_class = "400"
        pressure_rating = 635
        temperature_rating = 650
    elsif pressure > 635 and pressure <= 950
        flange_class = "600"
        pressure_rating = 950
        temperature_rating = 650
    elsif pressure > 950 and pressure <= 1425
        flange_class = "900"
        pressure_rating = 1425
        temperature_rating = 650
    end
elsif temperature > 650 and temperature <= 700 
    if pressure <= 110 
        flange_class = "150"
        pressure_rating = 110
        temperature_rating = 700
    elsif pressure > 110 and pressure <= 465
        flange_class = "300"
        pressure_rating = 465
        temperature_rating = 700
    elsif pressure > 465 and pressure <= 620
        flange_class = "400"
        pressure_rating = 620
        temperature_rating = 700
    elsif pressure > 620 and pressure <= 930
        flange_class = "600"
        pressure_rating = 930
        temperature_rating = 700
    elsif pressure > 930 and pressure <= 1395
        flange_class = "900"
        pressure_rating = 1395
        temperature_rating = 700
    end
elsif temperature > 700 and temperature <= 750 
    if pressure <= 95 
        flange_class = "150"
        pressure_rating = 95
        temperature_rating = 750
    elsif pressure > 95 and pressure <= 460
        flange_class = "300"
        pressure_rating = 460
        temperature_rating = 750
    elsif pressure > 460 and pressure <= 610
        flange_class = "400"
        pressure_rating = 610
        temperature_rating = 750
    elsif pressure > 610 and pressure <= 915
        flange_class = "600"
        pressure_rating = 915
        temperature_rating = 750
    elsif pressure > 915 and pressure <= 1375
        flange_class = "900"
        pressure_rating = 1375
        temperature_rating = 750
    end
elsif temperature > 750 and temperature <= 800 
    if pressure <= 80 
        flange_class = "150"
        pressure_rating = 80
        temperature_rating = 800
    elsif pressure > 80 and pressure <= 450
        flange_class = "300"
        pressure_rating = 450
        temperature_rating = 800
    elsif pressure > 450 and pressure <= 600
        flange_class = "400"
        pressure_rating = 600
        temperature_rating = 800
    elsif pressure > 600 and pressure <= 900
        flange_class = "600"
        pressure_rating = 900
        temperature_rating = 800
    elsif pressure > 900 and pressure <= 1355
        flange_class = "900"
        pressure_rating = 1355
        temperature_rating = 800
    end
elsif temperature > 800 and temperature <= 850 
    if pressure <= 65 
        flange_class = "150"
        pressure_rating = 65
        temperature_rating = 850
    elsif pressure > 65 and pressure <= 445
        flange_class = "300"
        pressure_rating = 445
        temperature_rating = 850
    elsif pressure > 445 and pressure <= 595
        flange_class = "400"
        pressure_rating = 595
        temperature_rating = 850
    elsif pressure > 595 and pressure <= 895
        flange_class = "600"
        pressure_rating = 895
        temperature_rating = 850
    elsif pressure > 895 and pressure <= 1340
        flange_class = "900"
        pressure_rating = 1340
        temperature_rating = 850
    end
elsif temperature > 850 and temperature <= 900 
    if pressure <= 50 
        flange_class = "150"
        pressure_rating = 50
        temperature_rating = 900
    elsif pressure > 50 and pressure <= 440
        flange_class = "300"
        pressure_rating = 440
        temperature_rating = 900
    elsif pressure > 440 and pressure <= 590
        flange_class = "400"
        pressure_rating = 590
        temperature_rating = 900
    elsif pressure > 590 and pressure <= 885
        flange_class = "600"
        pressure_rating = 885
        temperature_rating = 900
    elsif pressure > 885 and pressure <= 1325
        flange_class = "900"
        pressure_rating = 1325
        temperature_rating = 900
    end
elsif temperature > 900 and temperature <= 950 
    if pressure <= 35 
        flange_class = "150"
        pressure_rating = 35
        temperature_rating = 950
    elsif pressure > 35 and pressure <= 385
        flange_class = "300"
        pressure_rating = 385
        temperature_rating = 950
    elsif pressure > 385 and pressure <= 515
        flange_class = "400"
        pressure_rating = 515
        temperature_rating = 950
    elsif pressure > 515 and pressure <= 775
        flange_class = "600"
        pressure_rating = 775
        temperature_rating = 950
    elsif pressure > 775 and pressure <= 1160
        flange_class = "900"
        pressure_rating = 1160
        temperature_rating = 950
    end
elsif temperature > 950 and temperature <= 1000
    if pressure <= 20 
        flange_class = "150"
        pressure_rating = 20
        temperature_rating = 1000
    elsif pressure > 20 and pressure <= 365
        flange_class = "300"
        pressure_rating = 365
        temperature_rating = 1000
    elsif pressure > 365 and pressure <= 485
        flange_class = "400"
        pressure_rating = 485
        temperature_rating = 1000
    elsif pressure > 485 and pressure <= 725
        flange_class = "600"
        pressure_rating = 725
        temperature_rating = 1000
    elsif pressure > 725 and pressure <= 1090
        flange_class = "900"
        pressure_rating = 1090
        temperature_rating = 1000
    end
elsif temperature > 1000 and temperature <= 105
    if pressure > 360 
        flange_class = "300"
        pressure_rating = 360
        temperature_rating = 1050
    elsif pressure > 360 and pressure <= 480
        flange_class = "400"
        pressure_rating = 480
        temperature_rating = 1050
    elsif pressure > 480 and pressure <= 720
        flange_class = "600"
        pressure_rating = 720
        temperature_rating = 1050
    elsif pressure > 720 and pressure <= 1080
        flange_class = "900"
        pressure_rating = 1080
        temperature_rating = 1050
    end
elsif temperature > 1050 and temperature <= 110
    if pressure > 310 
        flange_class = "300"
        pressure_rating = 310
        temperature_rating = 1100
    elsif pressure > 310 and pressure <= 415
        flange_class = "400"
        pressure_rating = 415
        temperature_rating = 1100
    elsif pressure > 415 and pressure <= 625
        flange_class = "600"
        pressure_rating = 625
        temperature_rating = 1100
    elsif pressure > 625 and pressure <= 935
        flange_class = "900"
        pressure_rating = 935
        temperature_rating = 1100
    end
elsif temperature > 1100 and temperature <= 115
    if pressure > 235 
        flange_class = "300"
        pressure_rating = 235
        temperature_rating = 1150
    elsif pressure > 235 and pressure <= 315
        flange_class = "400"
        pressure_rating = 315
        temperature_rating = 1150
    elsif pressure > 315 and pressure <= 475
        flange_class = "600"
        pressure_rating = 475
        temperature_rating = 1150
    elsif pressure > 475 and pressure <= 710
        flange_class = "900"
        pressure_rating = 710
        temperature_rating = 1150
    end
elsif temperature > 1150 and temperature <= 120
    if pressure > 185 
        flange_class = "300"
        pressure_rating = 185
        temperature_rating = 1200
    elsif pressure > 185 and pressure <= 245
        flange_class = "400"
        pressure_rating = 245
        temperature_rating = 1200
    elsif pressure > 245 and pressure <= 370
        flange_class = "600"
        pressure_rating = 370
        temperature_rating = 1200
    elsif pressure > 370 and pressure <= 555
        flange_class = "900"
        pressure_rating = 555
        temperature_rating = 1200
    end
elsif temperature > 1200 and temperature <= 125
    if pressure > 140 
        flange_class = "300"
        pressure_rating = 140
        temperature_rating = 1250
    elsif pressure > 140 and pressure <= 185
        flange_class = "400"
        pressure_rating = 185
        temperature_rating = 1250
    elsif pressure > 185 and pressure <= 280
        flange_class = "600"
        pressure_rating = 280
        temperature_rating = 1250
    elsif pressure > 280 and pressure <= 420
        flange_class = "900"
        pressure_rating = 420
        temperature_rating = 1250
    end
elsif temperature > 1250 and temperature <= 130
    if pressure > 110 
        flange_class = "300"
        pressure_rating = 110
        temperature_rating = 1300
    elsif pressure > 110 and pressure <= 145
        flange_class = "400"
        pressure_rating = 145
        temperature_rating = 1300
    elsif pressure > 145 and pressure <= 220
        flange_class = "600"
        pressure_rating = 220
        temperature_rating = 1300
    elsif pressure > 220 and pressure <= 330
        flange_class = "900"
        pressure_rating = 330
        temperature_rating = 1300
    end
elsif temperature > 1300 and temperature <= 135
    if pressure > 85 
        flange_class = "300"
        pressure_rating = 85
        temperature_rating = 1350
    elsif pressure > 85 and pressure <= 115
        flange_class = "400"
        pressure_rating = 115
        temperature_rating = 1350
    elsif pressure > 115 and pressure <= 170
        flange_class = "600"
        pressure_rating = 170
        temperature_rating = 1350
    elsif pressure > 170 and pressure <= 255
        flange_class = "900"
        pressure_rating = 255
        temperature_rating = 1350
    end
elsif temperature > 1350 and temperature <= 140
    if pressure > 65 
        flange_class = "300"
        pressure_rating = 65
        temperature_rating = 1400
    elsif pressure > 65 and pressure <= 85
        flange_class = "400"
        pressure_rating = 85
        temperature_rating = 1400
    elsif pressure > 85 and pressure <= 130
        flange_class = "600"
        pressure_rating = 130
        temperature_rating = 1400
    elsif pressure > 130 and pressure <= 195
        flange_class = "900"
        pressure_rating = 195
        temperature_rating = 1400
    end
elsif temperature > 1400 and temperature <= 145
    if pressure > 50 
        flange_class = "300"
        pressure_rating = 50
        temperature_rating = 1450
    elsif pressure > 50 and pressure <= 70
        flange_class = "400"
        pressure_rating = 70
        temperature_rating = 1450
    elsif pressure > 70 and pressure <= 105
        flange_class = "600"
        pressure_rating = 105
        temperature_rating = 1450
    elsif pressure > 105 and pressure <= 155
        flange_class = "900"
        pressure_rating = 155
        temperature_rating = 1450
    end
elsif temperature > 1450 and temperature <= 150
    if pressure > 40 
        flange_class = "300"
        pressure_rating = 40
        temperature_rating = 1500
    elsif pressure > 40 and pressure <= 50
        flange_class = "400"
        pressure_rating = 50
        temperature_rating = 1500
    elsif pressure > 50 and pressure <= 75
        flange_class = "600"
        pressure_rating = 75
        temperature_rating = 1500
    elsif pressure > 75 and pressure <= 115
        flange_class = "900"
        pressure_rating = 115
        temperature_rating = 1500
    end
end
end

if material_group == "2.5"
    if temperature >= -20 and temperature <= 100 
        if pressure <= 140 
            flange_class = "75"
            pressure_rating = 140
            temperature_rating = 100
        elsif pressure > 140 and pressure <= 275
            flange_class = "150"
            pressure_rating = 275
            temperature_rating = 100
        elsif pressure > 275 and pressure <= 720
            flange_class = "300"
            pressure_rating = 720
            temperature_rating = 100
        elsif pressure > 720 and pressure <= 960
            flange_class = "400"
            pressure_rating = 960
            temperature_rating = 100
        elsif pressure > 960 and pressure <= 1440
            flange_class = "600"
            pressure_rating = 1440
            temperature_rating = 100
        elsif pressure > 1440 and pressure <= 2160
            flange_class = "900"
            pressure_rating = 2160
            temperature_rating = 100
        end
    elsif temperature > 100 and temperature <= 200 
        if pressure <= 125 
            flange_class = "75"
            pressure_rating = 125
            temperature_rating = 200
        elsif pressure > 125 and pressure <= 255
            flange_class = "150"
            pressure_rating = 255
            temperature_rating = 200
        elsif pressure > 255 and pressure <= 660
            flange_class = "300"
            pressure_rating = 660
            temperature_rating = 200
        elsif pressure > 660 and pressure <= 885
            flange_class = "400"
            pressure_rating = 885
            temperature_rating = 200
        elsif pressure > 885 and pressure <= 1325
            flange_class = "600"
            pressure_rating = 1325
            temperature_rating = 200
        elsif pressure > 1325 and pressure <= 1985
            flange_class = "900"
            pressure_rating = 1985
            temperature_rating = 200
        end
    elsif temperature > 200 and temperature <= 300 
        if pressure <= 115 
            flange_class = "75"
            pressure_rating = 115
            temperature_rating = 300
        elsif pressure > 115 and pressure <= 230
            flange_class = "150"
            pressure_rating = 230
            temperature_rating = 300
        elsif pressure > 230 and pressure <= 615
            flange_class = "300"
            pressure_rating = 615
            temperature_rating = 300
        elsif pressure > 615 and pressure <= 820
            flange_class = "400"
            pressure_rating = 820
            temperature_rating = 300
        elsif pressure > 820 and pressure <= 1235
            flange_class = "600"
            pressure_rating = 1235
            temperature_rating = 300
        elsif pressure > 1235 and pressure <= 1850
            flange_class = "900"
            pressure_rating = 1850
            temperature_rating = 300
        end
    elsif temperature > 300 and temperature <= 400 
        if pressure <= 100 
            flange_class = "75"
            pressure_rating = 100
            temperature_rating = 400
        elsif pressure > 100 and pressure <= 200
            flange_class = "150"
            pressure_rating = 200
            temperature_rating = 400
        elsif pressure > 200 and pressure <= 575
            flange_class = "300"
            pressure_rating = 575
            temperature_rating = 400
        elsif pressure > 575 and pressure <= 770
            flange_class = "400"
            pressure_rating = 770
            temperature_rating = 400
        elsif pressure > 770 and pressure <= 1150
            flange_class = "600"
            pressure_rating = 1150
            temperature_rating = 400
        elsif pressure > 1150 and pressure <= 1730
            flange_class = "900"
            pressure_rating = 1730
            temperature_rating = 400
        end
    elsif temperature > 400 and temperature <= 500 
        if pressure <= 85 
            flange_class = "75"
            pressure_rating = 85
            temperature_rating = 500
        elsif pressure > 85 and pressure <= 170
            flange_class = "150"
            pressure_rating = 170
            temperature_rating = 500
        elsif pressure > 170 and pressure <= 540
            flange_class = "300"
            pressure_rating = 540
            temperature_rating = 500
        elsif pressure > 540 and pressure <= 725
            flange_class = "400"
            pressure_rating = 725
            temperature_rating = 500
        elsif pressure > 725 and pressure <= 1085
            flange_class = "600"
            pressure_rating = 1085
            temperature_rating = 500
        elsif pressure > 1085 and pressure <= 1625
            flange_class = "900"
            pressure_rating = 1625
            temperature_rating = 500
        end
    elsif temperature > 500 and temperature <= 600 
        if pressure <= 70 
            flange_class = "75"
            pressure_rating = 70
            temperature_rating = 600
        elsif pressure > 70 and pressure <= 140
            flange_class = "150"
            pressure_rating = 140
            temperature_rating = 600
        elsif pressure > 140 and pressure <= 515
            flange_class = "300"
            pressure_rating = 515
            temperature_rating = 600
        elsif pressure > 515 and pressure <= 690
            flange_class = "400"
            pressure_rating = 690
            temperature_rating = 600
        elsif pressure > 690 and pressure <= 1030
            flange_class = "600"
            pressure_rating = 1030
            temperature_rating = 600
        elsif pressure > 1030 and pressure <= 1550
            flange_class = "900"
            pressure_rating = 1550
            temperature_rating = 600
        end
    elsif temperature > 600 and temperature <= 650 
        if pressure <= 60 
            flange_class = "75"
            pressure_rating = 60
            temperature_rating = 650
        elsif pressure > 60 and pressure <= 125
            flange_class = "150"
            pressure_rating = 125
            temperature_rating = 650
        elsif pressure > 125 and pressure <= 505
            flange_class = "300"
            pressure_rating = 505
            temperature_rating = 650
        elsif pressure > 505 and pressure <= 675
            flange_class = "400"
            pressure_rating = 675
            temperature_rating = 650
        elsif pressure > 675 and pressure <= 1015
            flange_class = "600"
            pressure_rating = 1015
            temperature_rating = 650
        elsif pressure > 1015 and pressure <= 1520
            flange_class = "900"
            pressure_rating = 1520
            temperature_rating = 650
        end
    elsif temperature > 650 and temperature <= 700 
        if pressure <= 110 
            flange_class = "150"
            pressure_rating = 110
            temperature_rating = 700
        elsif pressure > 110 and pressure <= 495
            flange_class = "300"
            pressure_rating = 495
            temperature_rating = 700
        elsif pressure > 495 and pressure <= 660
            flange_class = "400"
            pressure_rating = 660
            temperature_rating = 700
        elsif pressure > 660 and pressure <= 995
            flange_class = "600"
            pressure_rating = 995
            temperature_rating = 700
        elsif pressure > 995 and pressure <= 1490
            flange_class = "900"
            pressure_rating = 1490
            temperature_rating = 700
        end
    elsif temperature > 700 and temperature <= 750 
        if pressure <= 95 
            flange_class = "150"
            pressure_rating = 95
            temperature_rating = 750
        elsif pressure > 95 and pressure <= 490
            flange_class = "300"
            pressure_rating = 490
            temperature_rating = 750
        elsif pressure > 490 and pressure <= 655
            flange_class = "400"
            pressure_rating = 655
            temperature_rating = 750
        elsif pressure > 655 and pressure <= 985
            flange_class = "600"
            pressure_rating = 985
            temperature_rating = 750
        elsif pressure > 985 and pressure <= 1475
            flange_class = "900"
            pressure_rating = 1475
            temperature_rating = 750
        end
    elsif temperature > 750 and temperature <= 800 
        if pressure <= 80 
            flange_class = "150"
            pressure_rating = 80
            temperature_rating = 800
        elsif pressure > 80 and pressure <= 485
            flange_class = "300"
            pressure_rating = 485
            temperature_rating = 800
        elsif pressure > 485 and pressure <= 650
            flange_class = "400"
            pressure_rating = 650
            temperature_rating = 800
        elsif pressure > 650 and pressure <= 975
            flange_class = "600"
            pressure_rating = 975
            temperature_rating = 800
        elsif pressure > 975 and pressure <= 1460
            flange_class = "900"
            pressure_rating = 1460
            temperature_rating = 800
        end
    elsif temperature > 800 and temperature <= 850 
        if pressure <= 65 
            flange_class = "150"
            pressure_rating = 65
            temperature_rating = 850
        elsif pressure > 65 and pressure <= 485
            flange_class = "300"
            pressure_rating = 485
            temperature_rating = 850
        elsif pressure > 485 and pressure <= 645
            flange_class = "400"
            pressure_rating = 645
            temperature_rating = 850
        elsif pressure > 645 and pressure <= 970
            flange_class = "600"
            pressure_rating = 970
            temperature_rating = 850
        elsif pressure > 970 and pressure <= 1455
            flange_class = "900"
            pressure_rating = 1455
            temperature_rating = 850
        end
    elsif temperature > 850 and temperature <= 900 
        if pressure <= 50 
            flange_class = "150"
            pressure_rating = 50
            temperature_rating = 900
        elsif pressure > 50 and pressure <= 450
            flange_class = "300"
            pressure_rating = 450
            temperature_rating = 900
        elsif pressure > 450 and pressure <= 600
            flange_class = "400"
            pressure_rating = 600
            temperature_rating = 900
        elsif pressure > 600 and pressure <= 900
            flange_class = "600"
            pressure_rating = 900
            temperature_rating = 900
        elsif pressure > 900 and pressure <= 1350
            flange_class = "900"
            pressure_rating = 1350
            temperature_rating = 900
        end
    elsif temperature > 900 and temperature <= 950 
        if pressure <= 35 
            flange_class = "150"
            pressure_rating = 35
            temperature_rating = 950
        elsif pressure > 35 and pressure <= 385
            flange_class = "300"
            pressure_rating = 385
            temperature_rating = 950
        elsif pressure > 385 and pressure <= 515
            flange_class = "400"
            pressure_rating = 515
            temperature_rating = 950
        elsif pressure > 515 and pressure <= 775
            flange_class = "600"
            pressure_rating = 775
            temperature_rating = 950
        elsif pressure > 775 and pressure <= 1160
            flange_class = "900"
            pressure_rating = 1160
            temperature_rating = 950
        end
    elsif temperature > 950 and temperature <= 1000
        if pressure <= 20 
            flange_class = "150"
            pressure_rating = 20
            temperature_rating = 1000
        elsif pressure > 20 and pressure <= 365
            flange_class = "300"
            pressure_rating = 365
            temperature_rating = 1000
        elsif pressure > 365 and pressure <= 485
            flange_class = "400"
            pressure_rating = 485
            temperature_rating = 1000
        elsif pressure > 485 and pressure <= 725
            flange_class = "600"
            pressure_rating = 725
            temperature_rating = 1000
        elsif pressure > 725 and pressure <= 1090
            flange_class = "900"
            pressure_rating = 1090
            temperature_rating = 1000
        end
    elsif temperature > 1000 and temperature <= 105
        if pressure > 360 
            flange_class = "300"
            pressure_rating = 360
            temperature_rating = 1050
        elsif pressure > 360 and pressure <= 480
            flange_class = "400"
            pressure_rating = 480
            temperature_rating = 1050
        elsif pressure > 480 and pressure <= 720
            flange_class = "600"
            pressure_rating = 720
            temperature_rating = 1050
        elsif pressure > 720 and pressure <= 1080
            flange_class = "900"
            pressure_rating = 1080
            temperature_rating = 1050
        end
    elsif temperature > 1050 and temperature <= 110
        if pressure > 325 
            flange_class = "300"
            pressure_rating = 325
            temperature_rating = 1100
        elsif pressure > 325 and pressure <= 430
            flange_class = "400"
            pressure_rating = 430
            temperature_rating = 1100
        elsif pressure > 430 and pressure <= 645
            flange_class = "600"
            pressure_rating = 645
            temperature_rating = 1100
        elsif pressure > 645 and pressure <= 965
            flange_class = "900"
            pressure_rating = 965
            temperature_rating = 1100
        end
    elsif temperature > 1100 and temperature <= 115
        if pressure > 275 
            flange_class = "300"
            pressure_rating = 275
            temperature_rating = 1150
        elsif pressure > 275 and pressure <= 365
            flange_class = "400"
            pressure_rating = 365
            temperature_rating = 1150
        elsif pressure > 365 and pressure <= 550
            flange_class = "600"
            pressure_rating = 550
            temperature_rating = 1150
        elsif pressure > 550 and pressure <= 825
            flange_class = "900"
            pressure_rating = 825
            temperature_rating = 1150
        end
    elsif temperature > 1150 and temperature <= 120
        if pressure > 205 
            flange_class = "300"
            pressure_rating = 205
            temperature_rating = 1200
        elsif pressure > 205 and pressure <= 275
            flange_class = "400"
            pressure_rating = 275
            temperature_rating = 1200
        elsif pressure > 275 and pressure <= 410
            flange_class = "600"
            pressure_rating = 410
            temperature_rating = 1200
        elsif pressure > 410 and pressure <= 620
            flange_class = "900"
            pressure_rating = 620
            temperature_rating = 1200
        end
    elsif temperature > 1200 and temperature <= 125
        if pressure > 180 
            flange_class = "300"
            pressure_rating = 150
            temperature_rating = 1250
        elsif pressure > 180 and pressure <= 245
            flange_class = "400"
            pressure_rating = 245
            temperature_rating = 1250
        elsif pressure > 245 and pressure <= 365
            flange_class = "600"
            pressure_rating = 365
            temperature_rating = 1250
        elsif pressure > 365 and pressure <= 545
            flange_class = "900"
            pressure_rating = 545
            temperature_rating = 1250
        end
    elsif temperature > 1250 and temperature <= 130
        if pressure > 140 
            flange_class = "300"
            pressure_rating = 140
            temperature_rating = 1300
        elsif pressure > 140 and pressure <= 185
            flange_class = "400"
            pressure_rating = 185
            temperature_rating = 1300
        elsif pressure > 185 and pressure <= 275
            flange_class = "600"
            pressure_rating = 275
            temperature_rating = 1300
        elsif pressure > 275 and pressure <= 410
            flange_class = "900"
            pressure_rating = 410
            temperature_rating = 1300
        end
    elsif temperature > 1300 and temperature <= 135
        if pressure > 105 
            flange_class = "300"
            pressure_rating = 105
            temperature_rating = 1350
        elsif pressure > 105 and pressure <= 140
            flange_class = "400"
            pressure_rating = 140
            temperature_rating = 1350
        elsif pressure > 140 and pressure <= 205
            flange_class = "600"
            pressure_rating = 205
            temperature_rating = 1350
        elsif pressure > 205 and pressure <= 310
            flange_class = "900"
            pressure_rating = 310
            temperature_rating = 1350
        end
    elsif temperature > 1350 and temperature <= 140
        if pressure > 75 
            flange_class = "300"
            pressure_rating = 75
            temperature_rating = 1400
        elsif pressure > 75 and pressure <= 100
            flange_class = "400"
            pressure_rating = 100
            temperature_rating = 1400
        elsif pressure > 100 and pressure <= 150
            flange_class = "600"
            pressure_rating = 150
            temperature_rating = 1400
        elsif pressure > 150 and pressure <= 225
            flange_class = "900"
            pressure_rating = 225
            temperature_rating = 1400
        end
    elsif temperature > 1400 and temperature <= 145
        if pressure > 60 
            flange_class = "300"
            pressure_rating = 60
            temperature_rating = 1450
        elsif pressure > 60 and pressure <= 80
            flange_class = "400"
            pressure_rating = 80
            temperature_rating = 1450
        elsif pressure > 80 and pressure <= 115
            flange_class = "600"
            pressure_rating = 115
            temperature_rating = 1450
        elsif pressure > 115 and pressure <= 175
            flange_class = "900"
            pressure_rating = 175
            temperature_rating = 1450
        end
    elsif temperature > 1450 and temperature <= 150
        if pressure > 40 
            flange_class = "300"
            pressure_rating = 40
            temperature_rating = 1500
        elsif pressure > 40 and pressure <= 55
            flange_class = "400"
            pressure_rating = 55
            temperature_rating = 1500
        elsif pressure > 55 and pressure <= 85
            flange_class = "600"
            pressure_rating = 85
            temperature_rating = 1500
        elsif pressure > 85 and pressure <= 125
            flange_class = "900"
            pressure_rating = 125
            temperature_rating = 1500
        end
    end
end

  
if material_group == "2.6"
if temperature >= -20 and temperature <= 100 
    if pressure <= 140 
        flange_class = "75"
        pressure_rating = 140
        temperature_rating = 100
    elsif pressure > 140 and pressure <= 275
        flange_class = "150"
        pressure_rating = 275
        temperature_rating = 100
    elsif pressure > 275 and pressure <= 720
        flange_class = "300"
        pressure_rating = 720
        temperature_rating = 100
    elsif pressure > 720 and pressure <= 960
        flange_class = "400"
        pressure_rating = 960
        temperature_rating = 100
    elsif pressure > 960 and pressure <= 1440
        flange_class = "600"
        pressure_rating = 1440
        temperature_rating = 100
    elsif pressure > 1440 and pressure <= 2160
        flange_class = "900"
        pressure_rating = 2160
        temperature_rating = 100
    end
elsif temperature > 100 and temperature <= 200 
    if pressure <= 120 
        flange_class = "75"
        pressure_rating = 120
        temperature_rating = 200
    elsif pressure > 120 and pressure <= 240
        flange_class = "150"
        pressure_rating = 240
        temperature_rating = 200
    elsif pressure > 240 and pressure <= 630
        flange_class = "300"
        pressure_rating = 630
        temperature_rating = 200
    elsif pressure > 630 and pressure <= 840
        flange_class = "400"
        pressure_rating = 840
        temperature_rating = 200
    elsif pressure > 840 and pressure <= 1260
        flange_class = "600"
        pressure_rating = 1260
        temperature_rating = 200
    elsif pressure > 1260 and pressure <= 1895
        flange_class = "900"
        pressure_rating = 1895
        temperature_rating = 200
    end
elsif temperature > 200 and temperature <= 300 
    if pressure <= 110 
        flange_class = "75"
        pressure_rating = 110
        temperature_rating = 300
    elsif pressure > 110 and pressure <= 225
        flange_class = "150"
        pressure_rating = 225
        temperature_rating = 300
    elsif pressure > 225 and pressure <= 580
        flange_class = "300"
        pressure_rating = 580
        temperature_rating = 300
    elsif pressure > 580 and pressure <= 775
        flange_class = "400"
        pressure_rating = 775
        temperature_rating = 300
    elsif pressure > 775 and pressure <= 1160
        flange_class = "600"
        pressure_rating = 1160
        temperature_rating = 300
    elsif pressure > 1160 and pressure <= 1740
        flange_class = "900"
        pressure_rating = 1740
        temperature_rating = 300
    end
elsif temperature > 300 and temperature <= 400 
    if pressure <= 100 
        flange_class = "75"
        pressure_rating = 100
        temperature_rating = 400
    elsif pressure > 100 and pressure <= 200
        flange_class = "150"
        pressure_rating = 200
        temperature_rating = 400
    elsif pressure > 200 and pressure <= 545
        flange_class = "300"
        pressure_rating = 545
        temperature_rating = 400
    elsif pressure > 545 and pressure <= 725
        flange_class = "400"
        pressure_rating = 725
        temperature_rating = 400
    elsif pressure > 725 and pressure <= 1090
        flange_class = "600"
        pressure_rating = 1090
        temperature_rating = 400
    elsif pressure > 1090 and pressure <= 1635
        flange_class = "900"
        pressure_rating = 1635
        temperature_rating = 400
    end
elsif temperature > 400 and temperature <= 500 
    if pressure <= 85 
        flange_class = "75"
        pressure_rating = 85
        temperature_rating = 500
    elsif pressure > 85 and pressure <= 170
        flange_class = "150"
        pressure_rating = 170
        temperature_rating = 500
    elsif pressure > 170 and pressure <= 520
        flange_class = "300"
        pressure_rating = 520
        temperature_rating = 500
    elsif pressure > 520 and pressure <= 690
        flange_class = "400"
        pressure_rating = 690
        temperature_rating = 500
    elsif pressure > 690 and pressure <= 1035
        flange_class = "600"
        pressure_rating = 1035
        temperature_rating = 500
    elsif pressure > 1035 and pressure <= 1555
        flange_class = "900"
        pressure_rating = 1555
        temperature_rating = 500
    end
elsif temperature > 500 and temperature <= 600 
    if pressure <= 70 
        flange_class = "75"
        pressure_rating = 70
        temperature_rating = 600
    elsif pressure > 70 and pressure <= 140
        flange_class = "150"
        pressure_rating = 140
        temperature_rating = 600
    elsif pressure > 140 and pressure <= 500
        flange_class = "300"
        pressure_rating = 500
        temperature_rating = 600
    elsif pressure > 500 and pressure <= 665
        flange_class = "400"
        pressure_rating = 665
        temperature_rating = 600
    elsif pressure > 665 and pressure <= 1000
        flange_class = "600"
        pressure_rating = 1000
        temperature_rating = 600
    elsif pressure > 1000 and pressure <= 1500
        flange_class = "900"
        pressure_rating = 1500
        temperature_rating = 600
    end
elsif temperature > 600 and temperature <= 650 
    if pressure <= 60 
        flange_class = "75"
        pressure_rating = 60
        temperature_rating = 650
    elsif pressure > 60 and pressure <= 125
        flange_class = "150"
        pressure_rating = 125
        temperature_rating = 650
    elsif pressure > 125 and pressure <= 490
        flange_class = "300"
        pressure_rating = 490
        temperature_rating = 650
    elsif pressure > 490 and pressure <= 655
        flange_class = "400"
        pressure_rating = 655
        temperature_rating = 650
    elsif pressure > 655 and pressure <= 985
        flange_class = "600"
        pressure_rating = 985
        temperature_rating = 650
    elsif pressure > 985 and pressure <= 1475
        flange_class = "900"
        pressure_rating = 1475
        temperature_rating = 650
    end
elsif temperature > 650 and temperature <= 700 
    if pressure <= 110 
        flange_class = "150"
        pressure_rating = 110
        temperature_rating = 700
    elsif pressure > 110 and pressure <= 485
        flange_class = "300"
        pressure_rating = 485
        temperature_rating = 700
    elsif pressure > 485 and pressure <= 645
        flange_class = "400"
        pressure_rating = 645
        temperature_rating = 700
    elsif pressure > 645 and pressure <= 970
        flange_class = "600"
        pressure_rating = 970
        temperature_rating = 700
    elsif pressure > 970 and pressure <= 1455
        flange_class = "900"
        pressure_rating = 1455
        temperature_rating = 700
    end
elsif temperature > 700 and temperature <= 750 
    if pressure <= 95 
        flange_class = "150"
        pressure_rating = 95
        temperature_rating = 750
    elsif pressure > 95 and pressure <= 480
        flange_class = "300"
        pressure_rating = 480
        temperature_rating = 750
    elsif pressure > 480 and pressure <= 640
        flange_class = "400"
        pressure_rating = 640
        temperature_rating = 750
    elsif pressure > 640 and pressure <= 960
        flange_class = "600"
        pressure_rating = 960
        temperature_rating = 750
    elsif pressure > 960 and pressure <= 1440
        flange_class = "900"
        pressure_rating = 1440
        temperature_rating = 750
    end
elsif temperature > 750 and temperature <= 800 
    if pressure <= 80 
        flange_class = "150"
        pressure_rating = 80
        temperature_rating = 800
    elsif pressure > 80 and pressure <= 475
        flange_class = "300"
        pressure_rating = 475
        temperature_rating = 800
    elsif pressure > 475 and pressure <= 630
        flange_class = "400"
        pressure_rating = 630
        temperature_rating = 800
    elsif pressure > 630 and pressure <= 945
        flange_class = "600"
        pressure_rating = 945
        temperature_rating = 800
    elsif pressure > 945 and pressure <= 1420
        flange_class = "900"
        pressure_rating = 1420
        temperature_rating = 800
    end
elsif temperature > 800 and temperature <= 850 
    if pressure <= 65 
        flange_class = "150"
        pressure_rating = 65
        temperature_rating = 850
    elsif pressure > 65 and pressure <= 465
        flange_class = "300"
        pressure_rating = 465
        temperature_rating = 850
    elsif pressure > 465 and pressure <= 620
        flange_class = "400"
        pressure_rating = 620
        temperature_rating = 850
    elsif pressure > 620 and pressure <= 930
        flange_class = "600"
        pressure_rating = 930
        temperature_rating = 850
    elsif pressure > 930 and pressure <= 1395
        flange_class = "900"
        pressure_rating = 1395
        temperature_rating = 850
    end
elsif temperature > 850 and temperature <= 900 
    if pressure <= 50 
        flange_class = "150"
        pressure_rating = 50
        temperature_rating = 900
    elsif pressure > 50 and pressure <= 450
        flange_class = "300"
        pressure_rating = 450
        temperature_rating = 900
    elsif pressure > 450 and pressure <= 600
        flange_class = "400"
        pressure_rating = 600
        temperature_rating = 900
    elsif pressure > 600 and pressure <= 900
        flange_class = "600"
        pressure_rating = 900
        temperature_rating = 900
    elsif pressure > 900 and pressure <= 1350
        flange_class = "900"
        pressure_rating = 1350
        temperature_rating = 900
    end
elsif temperature > 900 and temperature <= 950 
    if pressure <= 35 
        flange_class = "150"
        pressure_rating = 35
        temperature_rating = 950
    elsif pressure > 35 and pressure <= 385
        flange_class = "300"
        pressure_rating = 385
        temperature_rating = 950
    elsif pressure > 385 and pressure <= 515
        flange_class = "400"
        pressure_rating = 515
        temperature_rating = 950
    elsif pressure > 515 and pressure <= 775
        flange_class = "600"
        pressure_rating = 775
        temperature_rating = 950
    elsif pressure > 775 and pressure <= 1160
        flange_class = "900"
        pressure_rating = 1160
        temperature_rating = 950
    end
elsif temperature > 950 and temperature <= 1000
    if pressure <= 20 
        flange_class = "150"
        pressure_rating = 20
        temperature_rating = 1000
    elsif pressure > 20 and pressure <= 365
        flange_class = "300"
        pressure_rating = 365
        temperature_rating = 1000
    elsif pressure > 365 and pressure <= 485
        flange_class = "400"
        pressure_rating = 485
        temperature_rating = 1000
    elsif pressure > 485 and pressure <= 725
        flange_class = "600"
        pressure_rating = 725
        temperature_rating = 1000
    elsif pressure > 725 and pressure <= 1090
        flange_class = "900"
        pressure_rating = 1090
        temperature_rating = 1000
    end
elsif temperature > 1000 and temperature <= 105
    if pressure > 355 
        flange_class = "300"
        pressure_rating = 355
        temperature_rating = 1050
    elsif pressure > 355 and pressure <= 470
        flange_class = "400"
        pressure_rating = 470
        temperature_rating = 1050
    elsif pressure > 470 and pressure <= 705
        flange_class = "600"
        pressure_rating = 705
        temperature_rating = 1050
    elsif pressure > 705 and pressure <= 1060
        flange_class = "900"
        pressure_rating = 1060
        temperature_rating = 1050
    end
elsif temperature > 1050 and temperature <= 110
    if pressure > 260 
        flange_class = "300"
        pressure_rating = 260
        temperature_rating = 1100
    elsif pressure > 260 and pressure <= 345
        flange_class = "400"
        pressure_rating = 345
        temperature_rating = 1100
    elsif pressure > 345 and pressure <= 520
        flange_class = "600"
        pressure_rating = 520
        temperature_rating = 1100
    elsif pressure > 520 and pressure <= 780
        flange_class = "900"
        pressure_rating = 780
        temperature_rating = 1100
    end
elsif temperature > 1100 and temperature <= 115
    if pressure > 190 
        flange_class = "300"
        pressure_rating = 190
        temperature_rating = 1150
    elsif pressure > 190 and pressure <= 250
        flange_class = "400"
        pressure_rating = 250
        temperature_rating = 1150
    elsif pressure > 250 and pressure <= 375
        flange_class = "600"
        pressure_rating = 375
        temperature_rating = 1150
    elsif pressure > 375 and pressure <= 565
        flange_class = "900"
        pressure_rating = 565
        temperature_rating = 1150
    end
elsif temperature > 1150 and temperature <= 120
    if pressure > 135 
        flange_class = "300"
        pressure_rating = 135
        temperature_rating = 1200
    elsif pressure > 135 and pressure <= 185
        flange_class = "400"
        pressure_rating = 185
        temperature_rating = 1200
    elsif pressure > 185 and pressure <= 275
        flange_class = "600"
        pressure_rating = 275
        temperature_rating = 1200
    elsif pressure > 275 and pressure <= 410
        flange_class = "900"
        pressure_rating = 410
        temperature_rating = 1200
    end
elsif temperature > 1200 and temperature <= 125
    if pressure > 105 
        flange_class = "300"
        pressure_rating = 105
        temperature_rating = 1250
    elsif pressure > 105 and pressure <= 135
        flange_class = "400"
        pressure_rating = 135
        temperature_rating = 1250
    elsif pressure > 135 and pressure <= 205
        flange_class = "600"
        pressure_rating = 205
        temperature_rating = 1250
    elsif pressure > 205 and pressure <= 310
        flange_class = "900"
        pressure_rating = 310
        temperature_rating = 1250
    end
elsif temperature > 1250 and temperature <= 130
    if pressure > 75 
        flange_class = "300"
        pressure_rating = 75
        temperature_rating = 1300
    elsif pressure > 75 and pressure <= 100
        flange_class = "400"
        pressure_rating = 100
        temperature_rating = 1300
    elsif pressure > 100 and pressure <= 150
        flange_class = "600"
        pressure_rating = 150
        temperature_rating = 1300
    elsif pressure > 150 and pressure <= 225
        flange_class = "900"
        pressure_rating = 225
        temperature_rating = 1300
    end
elsif temperature > 1300 and temperature <= 135
    if pressure > 60 
        flange_class = "300"
        pressure_rating = 60
        temperature_rating = 1350
    elsif pressure > 60 and pressure <= 80
        flange_class = "400"
        pressure_rating = 80
        temperature_rating = 1350
    elsif pressure > 80 and pressure <= 115
        flange_class = "600"
        pressure_rating = 115
        temperature_rating = 1350
    elsif pressure > 115 and pressure <= 175
        flange_class = "900"
        pressure_rating = 175
        temperature_rating = 1350
    end
elsif temperature > 1350 and temperature <= 140
    if pressure > 45 
        flange_class = "300"
        pressure_rating = 45
        temperature_rating = 1400
    elsif pressure > 45 and pressure <= 60
        flange_class = "400"
        pressure_rating = 60
        temperature_rating = 1400
    elsif pressure > 60 and pressure <= 90
        flange_class = "600"
        pressure_rating = 90
        temperature_rating = 1400
    elsif pressure > 90 and pressure <= 135
        flange_class = "900"
        pressure_rating = 135
        temperature_rating = 1400
    end
elsif temperature > 1400 and temperature <= 145
    if pressure > 35 
        flange_class = "300"
        pressure_rating = 35
        temperature_rating = 1450
    elsif pressure > 35 and pressure <= 45
        flange_class = "400"
        pressure_rating = 45
        temperature_rating = 1450
    elsif pressure > 45 and pressure <= 70
        flange_class = "600"
        pressure_rating = 70
        temperature_rating = 1450
    elsif pressure > 70 and pressure <= 105
        flange_class = "900"
        pressure_rating = 105
        temperature_rating = 1450
    end
elsif temperature > 1450 and temperature <= 150
    if pressure > 25 
        flange_class = "300"
        pressure_rating = 25
        temperature_rating = 1500
    elsif pressure > 25 and pressure <= 35
        flange_class = "400"
        pressure_rating = 35
        temperature_rating = 1500
    elsif pressure > 35 and pressure <= 50
        flange_class = "600"
        pressure_rating = 50
        temperature_rating = 1500
    elsif pressure > 50 and pressure <= 75
        flange_class = "900"
        pressure_rating = 75
        temperature_rating = 1500
    end
end
end

  
if material_group == "2.7"
if temperature >= -20 and temperature <= 100 
    if pressure <= 140 
        flange_class = "75"
        pressure_rating = 140
        temperature_rating = 100
    elsif pressure > 140 and pressure <= 275
        flange_class = "150"
        pressure_rating = 275
        temperature_rating = 100
    elsif pressure > 275 and pressure <= 720
        flange_class = "300"
        pressure_rating = 720
        temperature_rating = 100
    elsif pressure > 720 and pressure <= 960
        flange_class = "400"
        pressure_rating = 960
        temperature_rating = 100
    elsif pressure > 960 and pressure <= 1440
        flange_class = "600"
        pressure_rating = 1440
        temperature_rating = 100
    elsif pressure > 1440 and pressure <= 2160
        flange_class = "900"
        pressure_rating = 2160
        temperature_rating = 100
    end
elsif temperature > 100 and temperature <= 200 
    if pressure <= 120 
        flange_class = "75"
        pressure_rating = 120
        temperature_rating = 200
    elsif pressure > 120 and pressure <= 245
        flange_class = "150"
        pressure_rating = 245
        temperature_rating = 200
    elsif pressure > 245 and pressure <= 635
        flange_class = "300"
        pressure_rating = 635
        temperature_rating = 200
    elsif pressure > 635 and pressure <= 850
        flange_class = "400"
        pressure_rating = 850
        temperature_rating = 200
    elsif pressure > 850 and pressure <= 1270
        flange_class = "600"
        pressure_rating = 1270
        temperature_rating = 200
    elsif pressure > 1270 and pressure <= 1910
        flange_class = "900"
        pressure_rating = 1910
        temperature_rating = 200
    end
elsif temperature > 200 and temperature <= 300 
    if pressure <= 110 
        flange_class = "75"
        pressure_rating = 110
        temperature_rating = 300
    elsif pressure > 110 and pressure <= 225
        flange_class = "150"
        pressure_rating = 225
        temperature_rating = 300
    elsif pressure > 225 and pressure <= 580
        flange_class = "300"
        pressure_rating = 580
        temperature_rating = 300
    elsif pressure > 580 and pressure <= 775
        flange_class = "400"
        pressure_rating = 775
        temperature_rating = 300
    elsif pressure > 775 and pressure <= 1160
        flange_class = "600"
        pressure_rating = 1160
        temperature_rating = 300
    elsif pressure > 1160 and pressure <= 1740
        flange_class = "900"
        pressure_rating = 1740
        temperature_rating = 300
    end
elsif temperature > 300 and temperature <= 400 
    if pressure <= 100 
        flange_class = "75"
        pressure_rating = 100
        temperature_rating = 400
    elsif pressure > 100 and pressure <= 200
        flange_class = "150"
        pressure_rating = 200
        temperature_rating = 400
    elsif pressure > 200 and pressure <= 540
        flange_class = "300"
        pressure_rating = 540
        temperature_rating = 400
    elsif pressure > 540 and pressure <= 725
        flange_class = "400"
        pressure_rating = 725
        temperature_rating = 400
    elsif pressure > 725 and pressure <= 1085
        flange_class = "600"
        pressure_rating = 1085
        temperature_rating = 400
    elsif pressure > 1085 and pressure <= 1625
        flange_class = "900"
        pressure_rating = 1625
        temperature_rating = 400
    end
elsif temperature > 400 and temperature <= 500 
    if pressure <= 85 
        flange_class = "75"
        pressure_rating = 85
        temperature_rating = 500
    elsif pressure > 85 and pressure <= 170
        flange_class = "150"
        pressure_rating = 170
        temperature_rating = 500
    elsif pressure > 170 and pressure <= 515
        flange_class = "300"
        pressure_rating = 515
        temperature_rating = 500
    elsif pressure > 515 and pressure <= 685
        flange_class = "400"
        pressure_rating = 685
        temperature_rating = 500
    elsif pressure > 685 and pressure <= 1025
        flange_class = "600"
        pressure_rating = 1025
        temperature_rating = 500
    elsif pressure > 1025 and pressure <= 1540
        flange_class = "900"
        pressure_rating = 1540
        temperature_rating = 500
    end
elsif temperature > 500 and temperature <= 600 
    if pressure <= 70 
        flange_class = "75"
        pressure_rating = 70
        temperature_rating = 600
    elsif pressure > 70 and pressure <= 140
        flange_class = "150"
        pressure_rating = 140
        temperature_rating = 600
    elsif pressure > 140 and pressure <= 495
        flange_class = "300"
        pressure_rating = 495
        temperature_rating = 600
    elsif pressure > 495 and pressure <= 660
        flange_class = "400"
        pressure_rating = 660
        temperature_rating = 600
    elsif pressure > 660 and pressure <= 990
        flange_class = "600"
        pressure_rating = 990
        temperature_rating = 600
    elsif pressure > 990 and pressure <= 1485
        flange_class = "900"
        pressure_rating = 1485
        temperature_rating = 600
    end
elsif temperature > 600 and temperature <= 650 
    if pressure <= 60 
        flange_class = "75"
        pressure_rating = 60
        temperature_rating = 100
    elsif pressure > 60 and pressure <= 125
        flange_class = "150"
        pressure_rating = 125
        temperature_rating = 650
    elsif pressure > 125 and pressure <= 485
        flange_class = "300"
        pressure_rating = 485
        temperature_rating = 650
    elsif pressure > 485 and pressure <= 645
        flange_class = "400"
        pressure_rating = 645
        temperature_rating = 650
    elsif pressure > 645 and pressure <= 970
        flange_class = "600"
        pressure_rating = 970
        temperature_rating = 650
    elsif pressure > 970 and pressure <= 1455
        flange_class = "900"
        pressure_rating = 1455
        temperature_rating = 650
    end
elsif temperature > 650 and temperature <= 700 
    if pressure <= 110 
        flange_class = "150"
        pressure_rating = 110
        temperature_rating = 700
    elsif pressure > 110 and pressure <= 480
        flange_class = "300"
        pressure_rating = 480
        temperature_rating = 700
    elsif pressure > 480 and pressure <= 635
        flange_class = "400"
        pressure_rating = 635
        temperature_rating = 700
    elsif pressure > 635 and pressure <= 955
        flange_class = "600"
        pressure_rating = 955
        temperature_rating = 700
    elsif pressure > 955 and pressure <= 1435
        flange_class = "900"
        pressure_rating = 1435
        temperature_rating = 700
    end
elsif temperature > 700 and temperature <= 750 
    if pressure <= 95 
        flange_class = "150"
        pressure_rating = 95
        temperature_rating = 750
    elsif pressure > 95 and pressure <= 470
        flange_class = "300"
        pressure_rating = 470
        temperature_rating = 750
    elsif pressure > 470 and pressure <= 625
        flange_class = "400"
        pressure_rating = 625
        temperature_rating = 750
    elsif pressure > 625 and pressure <= 940
        flange_class = "600"
        pressure_rating = 940
        temperature_rating = 750
    elsif pressure > 940 and pressure <= 1410
        flange_class = "900"
        pressure_rating = 1410
        temperature_rating = 750
    end
elsif temperature > 750 and temperature <= 800 
    if pressure <= 80 
        flange_class = "150"
        pressure_rating = 80
        temperature_rating = 800
    elsif pressure > 80 and pressure <= 465
        flange_class = "300"
        pressure_rating = 465
        temperature_rating = 800
    elsif pressure > 465 and pressure <= 620
        flange_class = "400"
        pressure_rating = 620
        temperature_rating = 800
    elsif pressure > 620 and pressure <= 930
        flange_class = "600"
        pressure_rating = 930
        temperature_rating = 800
    elsif pressure > 930 and pressure <= 1395
        flange_class = "900"
        pressure_rating = 1395
        temperature_rating = 800
    end
elsif temperature > 800 and temperature <= 850 
    if pressure <= 65 
        flange_class = "150"
        pressure_rating = 65
        temperature_rating = 850
    elsif pressure > 65 and pressure <= 460
        flange_class = "300"
        pressure_rating = 460
        temperature_rating = 850
    elsif pressure > 460 and pressure <= 610
        flange_class = "400"
        pressure_rating = 610
        temperature_rating = 850
    elsif pressure > 610 and pressure <= 915
        flange_class = "600"
        pressure_rating = 915
        temperature_rating = 850
    elsif pressure > 915 and pressure <= 1375
        flange_class = "900"
        pressure_rating = 1375
        temperature_rating = 850
    end
elsif temperature > 850 and temperature <= 900 
    if pressure <= 50 
        flange_class = "150"
        pressure_rating = 50
        temperature_rating = 900
    elsif pressure > 50 and pressure <= 450
        flange_class = "300"
        pressure_rating = 450
        temperature_rating = 900
    elsif pressure > 450 and pressure <= 600
        flange_class = "400"
        pressure_rating = 600
        temperature_rating = 900
    elsif pressure > 600 and pressure <= 900
        flange_class = "600"
        pressure_rating = 900
        temperature_rating = 900
    elsif pressure > 900 and pressure <= 1350
        flange_class = "900"
        pressure_rating = 1350
        temperature_rating = 900
    end
elsif temperature > 900 and temperature <= 950 
    if pressure <= 35 
        flange_class = "150"
        pressure_rating = 35
        temperature_rating = 950
    elsif pressure > 35 and pressure <= 385
        flange_class = "300"
        pressure_rating = 385
        temperature_rating = 950
    elsif pressure > 385 and pressure <= 515
        flange_class = "400"
        pressure_rating = 515
        temperature_rating = 950
    elsif pressure > 515 and pressure <= 775
        flange_class = "600"
        pressure_rating = 775
        temperature_rating = 950
    elsif pressure > 775 and pressure <= 1160
        flange_class = "900"
        pressure_rating = 1160
        temperature_rating = 950
    end
elsif temperature > 950 and temperature <= 1000
    if pressure <= 20 
        flange_class = "150"
        pressure_rating = 20
        temperature_rating = 1000
    elsif pressure > 20 and pressure <= 365
        flange_class = "300"
        pressure_rating = 365
        temperature_rating = 1000
    elsif pressure > 365 and pressure <= 485
        flange_class = "400"
        pressure_rating = 485
        temperature_rating = 1000
    elsif pressure > 485 and pressure <= 725
        flange_class = "600"
        pressure_rating = 725
        temperature_rating = 1000
    elsif pressure > 725 and pressure <= 1090
        flange_class = "900"
        pressure_rating = 1090
        temperature_rating = 1000
    end
elsif temperature > 1000 and temperature <= 105
    if pressure > 355 
        flange_class = "300"
        pressure_rating = 355
        temperature_rating = 1050
    elsif pressure > 355 and pressure <= 470
        flange_class = "400"
        pressure_rating = 470
        temperature_rating = 1050
    elsif pressure > 470 and pressure <= 705
        flange_class = "600"
        pressure_rating = 705
        temperature_rating = 1050
    elsif pressure > 705 and pressure <= 1060
        flange_class = "900"
        pressure_rating = 1060
        temperature_rating = 1050
    end
elsif temperature > 1050 and temperature <= 110
    if pressure > 260 
        flange_class = "300"
        pressure_rating = 260
        temperature_rating = 1100
    elsif pressure > 260 and pressure <= 345
        flange_class = "400"
        pressure_rating = 345
        temperature_rating = 1100
    elsif pressure > 345 and pressure <= 520
        flange_class = "600"
        pressure_rating = 520
        temperature_rating = 1100
    elsif pressure > 520 and pressure <= 780
        flange_class = "900"
        pressure_rating = 780
        temperature_rating = 1100
    end
elsif temperature > 1100 and temperature <= 115
    if pressure > 190 
        flange_class = "300"
        pressure_rating = 190
        temperature_rating = 1150
    elsif pressure > 190 and pressure <= 250
        flange_class = "400"
        pressure_rating = 250
        temperature_rating = 1150
    elsif pressure > 250 and pressure <= 375
        flange_class = "600"
        pressure_rating = 375
        temperature_rating = 1150
    elsif pressure > 375 and pressure <= 565
        flange_class = "900"
        pressure_rating = 565
        temperature_rating = 1150
    end
elsif temperature > 1150 and temperature <= 120
    if pressure > 135 
        flange_class = "300"
        pressure_rating = 135
        temperature_rating = 1200
    elsif pressure > 135 and pressure <= 185
        flange_class = "400"
        pressure_rating = 185
        temperature_rating = 1200
    elsif pressure > 185 and pressure <= 275
        flange_class = "600"
        pressure_rating = 275
        temperature_rating = 1200
    elsif pressure > 275 and pressure <= 410
        flange_class = "900"
        pressure_rating = 410
        temperature_rating = 1200
    end
elsif temperature > 1200 and temperature <= 125
    if pressure > 105 
        flange_class = "300"
        pressure_rating = 105
        temperature_rating = 1250
    elsif pressure > 105 and pressure <= 135
        flange_class = "400"
        pressure_rating = 135
        temperature_rating = 1250
    elsif pressure > 135 and pressure <= 205
        flange_class = "600"
        pressure_rating = 205
        temperature_rating = 1250
    elsif pressure > 205 and pressure <= 310
        flange_class = "900"
        pressure_rating = 310
        temperature_rating = 1250
    end
elsif temperature > 1250 and temperature <= 130
    if pressure > 75 
        flange_class = "300"
        pressure_rating = 75
        temperature_rating = 1300
    elsif pressure > 75 and pressure <= 100
        flange_class = "400"
        pressure_rating = 100
        temperature_rating = 1300
    elsif pressure > 100 and pressure <= 150
        flange_class = "600"
        pressure_rating = 150
        temperature_rating = 1300
    elsif pressure > 150 and pressure <= 225
        flange_class = "900"
        pressure_rating = 225
        temperature_rating = 1300
    end
elsif temperature > 1300 and temperature <= 135
    if pressure > 60 
        flange_class = "300"
        pressure_rating = 60
        temperature_rating = 1350
    elsif pressure > 60 and pressure <= 80
        flange_class = "400"
        pressure_rating = 80
        temperature_rating = 1350
    elsif pressure > 80 and pressure <= 115
        flange_class = "600"
        pressure_rating = 115
        temperature_rating = 1350
    elsif pressure > 115 and pressure <= 175
        flange_class = "900"
        pressure_rating = 175
        temperature_rating = 1350
    end
elsif temperature > 1350 and temperature <= 140
    if pressure > 45 
        flange_class = "300"
        pressure_rating = 45
        temperature_rating = 1400
    elsif pressure > 45 and pressure <= 60
        flange_class = "400"
        pressure_rating = 60
        temperature_rating = 1400
    elsif pressure > 60 and pressure <= 90
        flange_class = "600"
        pressure_rating = 90
        temperature_rating = 1400
    elsif pressure > 90 and pressure <= 135
        flange_class = "900"
        pressure_rating = 135
        temperature_rating = 1400
    end
elsif temperature > 1400 and temperature <= 145
    if pressure > 35 
        flange_class = "300"
        pressure_rating = 35
        temperature_rating = 1450
    elsif pressure > 35 and pressure <= 45
        flange_class = "400"
        pressure_rating = 45
        temperature_rating = 1450
    elsif pressure > 45 and pressure <= 60
        flange_class = "600"
        pressure_rating = 60
        temperature_rating = 1450
    elsif pressure > 60 and pressure <= 100
        flange_class = "900"
        pressure_rating = 100
        temperature_rating = 1450
    end
elsif temperature > 1450 and temperature <= 150
    if pressure > 25 
        flange_class = "300"
        pressure_rating = 25
        temperature_rating = 1500
    elsif pressure > 25 and pressure <= 35
        flange_class = "400"
        pressure_rating = 35
        temperature_rating = 1500
    elsif pressure > 35 and pressure <= 50
        flange_class = "600"
        pressure_rating = 50
        temperature_rating = 1500
    elsif pressure > 50 and pressure <= 75
        flange_class = "900"
        pressure_rating = 75
        temperature_rating = 1500
    end
end
end

  
if material_group == "2.8"
if temperature >= -20 and temperature <= 100 
    if pressure <= 145 
        flange_class = "75"
        pressure_rating = 145
        temperature_rating = 100
    elsif pressure > 145 and pressure <= 290
        flange_class = "150"
        pressure_rating = 290
        temperature_rating = 100
    elsif pressure > 290 and pressure <= 750
        flange_class = "300"
        pressure_rating = 750
        temperature_rating = 100
    elsif pressure > 750 and pressure <= 1000
        flange_class = "400"
        pressure_rating = 1000
        temperature_rating = 100
    elsif pressure > 1000 and pressure <= 1500
        flange_class = "600"
        pressure_rating = 1500
        temperature_rating = 100
    elsif pressure > 1500 and pressure <= 2250
        flange_class = "900"
        pressure_rating = 2250
        temperature_rating = 100
    end
elsif temperature > 100 and temperature <= 200 
    if pressure <= 130 
        flange_class = "75"
        pressure_rating = 130
        temperature_rating = 200
    elsif pressure > 130 and pressure <= 260
        flange_class = "150"
        pressure_rating = 260
        temperature_rating = 200
    elsif pressure > 260 and pressure <= 745
        flange_class = "300"
        pressure_rating = 745
        temperature_rating = 200
    elsif pressure > 745 and pressure <= 990
        flange_class = "400"
        pressure_rating = 990
        temperature_rating = 200
    elsif pressure > 990 and pressure <= 1490
        flange_class = "600"
        pressure_rating = 1490
        temperature_rating = 200
    elsif pressure > 1490 and pressure <= 2230
        flange_class = "900"
        pressure_rating = 2230
        temperature_rating = 200
    end
elsif temperature > 200 and temperature <= 300 
    if pressure <= 115 
        flange_class = "75"
        pressure_rating = 115
        temperature_rating = 300
    elsif pressure > 115 and pressure <= 230
        flange_class = "150"
        pressure_rating = 230
        temperature_rating = 300
    elsif pressure > 230 and pressure <= 665
        flange_class = "300"
        pressure_rating = 665
        temperature_rating = 300
    elsif pressure > 665 and pressure <= 890
        flange_class = "400"
        pressure_rating = 890
        temperature_rating = 300
    elsif pressure > 890 and pressure <= 1335
        flange_class = "600"
        pressure_rating = 1335
        temperature_rating = 300
    elsif pressure > 1335 and pressure <= 2000
        flange_class = "900"
        pressure_rating = 2000
        temperature_rating = 300
    end
elsif temperature > 300 and temperature <= 400 
    if pressure <= 100 
        flange_class = "75"
        pressure_rating = 100
        temperature_rating = 400
    elsif pressure > 100 and pressure <= 200
        flange_class = "150"
        pressure_rating = 200
        temperature_rating = 400
    elsif pressure > 200 and pressure <= 615
        flange_class = "300"
        pressure_rating = 615
        temperature_rating = 400
    elsif pressure > 615 and pressure <= 820
        flange_class = "400"
        pressure_rating = 820
        temperature_rating = 400
    elsif pressure > 820 and pressure <= 1230
        flange_class = "600"
        pressure_rating = 1230
        temperature_rating = 400
    elsif pressure > 1230 and pressure <= 1845
        flange_class = "900"
        pressure_rating = 1845
        temperature_rating = 400
    end
elsif temperature > 400 and temperature <= 500 
    if pressure <= 85 
        flange_class = "75"
        pressure_rating = 85
        temperature_rating = 500
    elsif pressure > 85 and pressure <= 170
        flange_class = "150"
        pressure_rating = 170
        temperature_rating = 500
    elsif pressure > 170 and pressure <= 580
        flange_class = "300"
        pressure_rating = 580
        temperature_rating = 500
    elsif pressure > 580 and pressure <= 775
        flange_class = "400"
        pressure_rating = 775
        temperature_rating = 500
    elsif pressure > 775 and pressure <= 1160
        flange_class = "600"
        pressure_rating = 1160
        temperature_rating = 500
    elsif pressure > 1160 and pressure <= 1740
        flange_class = "900"
        pressure_rating = 1740
        temperature_rating = 500
    end
elsif temperature > 500 and temperature <= 600 
    if pressure <= 70 
        flange_class = "75"
        pressure_rating = 70
        temperature_rating = 600
    elsif pressure > 70 and pressure <= 140
        flange_class = "150"
        pressure_rating = 140
        temperature_rating = 600
    elsif pressure > 140 and pressure <= 555
        flange_class = "300"
        pressure_rating = 555
        temperature_rating = 600
    elsif pressure > 555 and pressure <= 740
        flange_class = "400"
        pressure_rating = 740
        temperature_rating = 600
    elsif pressure > 740 and pressure <= 1115
        flange_class = "600"
        pressure_rating = 1115
        temperature_rating = 600
    elsif pressure > 1115 and pressure <= 1670
        flange_class = "900"
        pressure_rating = 1670
        temperature_rating = 600
    end
elsif temperature > 600 and temperature <= 650 
    if pressure <= 60 
        flange_class = "75"
        pressure_rating = 60
        temperature_rating = 100
    elsif pressure > 60 and pressure <= 125
        flange_class = "150"
        pressure_rating = 125
        temperature_rating = 650
    elsif pressure > 125 and pressure <= 545
        flange_class = "300"
        pressure_rating = 545
        temperature_rating = 650
    elsif pressure > 545 and pressure <= 730
        flange_class = "400"
        pressure_rating = 730
        temperature_rating = 650
    elsif pressure > 730 and pressure <= 1095
        flange_class = "600"
        pressure_rating = 1095
        temperature_rating = 650
    elsif pressure > 1095 and pressure <= 1640
        flange_class = "900"
        pressure_rating = 1640
        temperature_rating = 650
    end
elsif temperature > 650 and temperature <= 700 
    if pressure <= 110 
        flange_class = "150"
        pressure_rating = 110
        temperature_rating = 700
    elsif pressure > 110 and pressure <= 540
        flange_class = "300"
        pressure_rating = 540
        temperature_rating = 700
    elsif pressure > 540 and pressure <= 725
        flange_class = "400"
        pressure_rating = 725
        temperature_rating = 700
    elsif pressure > 725 and pressure <= 1085
        flange_class = "600"
        pressure_rating = 1085
        temperature_rating = 700
    elsif pressure > 1085 and pressure <= 1625
        flange_class = "900"
        pressure_rating = 1625
        temperature_rating = 700
    end
elsif temperature > 700 and temperature <= 750 
    if pressure <= 95 
        flange_class = "150"
        pressure_rating = 95
        temperature_rating = 750
    elsif pressure > 95 and pressure <= 530
        flange_class = "300"
        pressure_rating = 530
        temperature_rating = 750
    elsif pressure > 530 and pressure <= 710
        flange_class = "400"
        pressure_rating = 710
        temperature_rating = 750
    elsif pressure > 710 and pressure <= 1065
        flange_class = "600"
        pressure_rating = 1065
        temperature_rating = 750
    elsif pressure > 1065 and pressure <= 1595
        flange_class = "900"
        pressure_rating = 1595
        temperature_rating = 750
    end
end
end

if material_group == "2.9"
    if temperature >= -20 and temperature <= 100 
        if pressure <= 140 
            flange_class = "75"
            pressure_rating = 140
            temperature_rating = 100
        elsif pressure > 140 and pressure <= 275
            flange_class = "150"
            pressure_rating = 275
            temperature_rating = 100
        elsif pressure > 275 and pressure <= 720
            flange_class = "300"
            pressure_rating = 720
            temperature_rating = 100
        elsif pressure > 720 and pressure <= 960
            flange_class = "400"
            pressure_rating = 960
            temperature_rating = 100
        elsif pressure > 960 and pressure <= 1440
            flange_class = "600"
            pressure_rating = 1440
            temperature_rating = 100
        elsif pressure > 1440 and pressure <= 2160
            flange_class = "900"
            pressure_rating = 2160
            temperature_rating = 100
        end
    elsif temperature > 100 and temperature <= 200 
        if pressure <= 120 
            flange_class = "75"
            pressure_rating = 120
            temperature_rating = 200
        elsif pressure > 120 and pressure <= 240
            flange_class = "150"
            pressure_rating = 240
            temperature_rating = 200
        elsif pressure > 240 and pressure <= 630
            flange_class = "300"
            pressure_rating = 630
            temperature_rating = 200
        elsif pressure > 630 and pressure <= 840
            flange_class = "400"
            pressure_rating = 840
            temperature_rating = 200
        elsif pressure > 840 and pressure <= 1260
            flange_class = "600"
            pressure_rating = 1260
            temperature_rating = 200
        elsif pressure > 1260 and pressure <= 1895
            flange_class = "900"
            pressure_rating = 1895
            temperature_rating = 200
        end
    elsif temperature > 200 and temperature <= 300 
        if pressure <= 110 
            flange_class = "75"
            pressure_rating = 110
            temperature_rating = 300
        elsif pressure > 110 and pressure <= 225
            flange_class = "150"
            pressure_rating = 225
            temperature_rating = 300
        elsif pressure > 225 and pressure <= 580
            flange_class = "300"
            pressure_rating = 580
            temperature_rating = 300
        elsif pressure > 580 and pressure <= 775
            flange_class = "400"
            pressure_rating = 775
            temperature_rating = 300
        elsif pressure > 775 and pressure <= 1160
            flange_class = "600"
            pressure_rating = 1160
            temperature_rating = 300
        elsif pressure > 1160 and pressure <= 1740
            flange_class = "900"
            pressure_rating = 1740
            temperature_rating = 300
        end
    elsif temperature > 300 and temperature <= 400 
        if pressure <= 100 
            flange_class = "75"
            pressure_rating = 100
            temperature_rating = 400
        elsif pressure > 100 and pressure <= 200
            flange_class = "150"
            pressure_rating = 200
            temperature_rating = 400
        elsif pressure > 200 and pressure <= 540
            flange_class = "300"
            pressure_rating = 540
            temperature_rating = 400
        elsif pressure > 540 and pressure <= 725
            flange_class = "400"
            pressure_rating = 725
            temperature_rating = 400
        elsif pressure > 725 and pressure <= 1085
            flange_class = "600"
            pressure_rating = 1085
            temperature_rating = 400
        elsif pressure > 1085 and pressure <= 1625
            flange_class = "900"
            pressure_rating = 1625
            temperature_rating = 400
        end
    elsif temperature > 400 and temperature <= 500 
        if pressure <= 85 
            flange_class = "75"
            pressure_rating = 85
            temperature_rating = 500
        elsif pressure > 85 and pressure <= 170
            flange_class = "150"
            pressure_rating = 170
            temperature_rating = 500
        elsif pressure > 170 and pressure <= 515
            flange_class = "300"
            pressure_rating = 515
            temperature_rating = 500
        elsif pressure > 515 and pressure <= 685
            flange_class = "400"
            pressure_rating = 685
            temperature_rating = 500
        elsif pressure > 685 and pressure <= 1025
            flange_class = "600"
            pressure_rating = 1025
            temperature_rating = 500
        elsif pressure > 1025 and pressure <= 1540
            flange_class = "900"
            pressure_rating = 1540
            temperature_rating = 500
        end
    elsif temperature > 500 and temperature <= 600 
        if pressure <= 70 
            flange_class = "75"
            pressure_rating = 70
            temperature_rating = 600
        elsif pressure > 70 and pressure <= 140
            flange_class = "150"
            pressure_rating = 140
            temperature_rating = 600
        elsif pressure > 140 and pressure <= 495
            flange_class = "300"
            pressure_rating = 495
            temperature_rating = 600
        elsif pressure > 495 and pressure <= 660
            flange_class = "400"
            pressure_rating = 660
            temperature_rating = 600
        elsif pressure > 660 and pressure <= 990
            flange_class = "600"
            pressure_rating = 990
            temperature_rating = 600
        elsif pressure > 990 and pressure <= 1485
            flange_class = "900"
            pressure_rating = 1485
            temperature_rating = 600
        end
    elsif temperature > 600 and temperature <= 650 
        if pressure <= 60 
            flange_class = "75"
            pressure_rating = 60
            temperature_rating = 650
        elsif pressure > 60 and pressure <= 125
            flange_class = "150"
            pressure_rating = 125
            temperature_rating = 650
        elsif pressure > 125 and pressure <= 485
            flange_class = "300"
            pressure_rating = 485
            temperature_rating = 650
        elsif pressure > 485 and pressure <= 645
            flange_class = "400"
            pressure_rating = 645
            temperature_rating = 650
        elsif pressure > 645 and pressure <= 970
            flange_class = "600"
            pressure_rating = 970
            temperature_rating = 650
        elsif pressure > 970 and pressure <= 1455
            flange_class = "900"
            pressure_rating = 1455
            temperature_rating = 650
        end
    elsif temperature > 650 and temperature <= 700 
        if pressure <= 110 
            flange_class = "150"
            pressure_rating = 110
            temperature_rating = 700
        elsif pressure > 110 and pressure <= 480
            flange_class = "300"
            pressure_rating = 480
            temperature_rating = 700
        elsif pressure > 480 and pressure <= 635
            flange_class = "400"
            pressure_rating = 635
            temperature_rating = 700
        elsif pressure > 635 and pressure <= 955
            flange_class = "600"
            pressure_rating = 955
            temperature_rating = 700
        elsif pressure > 955 and pressure <= 1435
            flange_class = "900"
            pressure_rating = 1435
            temperature_rating = 700
        end
    elsif temperature > 700 and temperature <= 750 
        if pressure <= 95 
            flange_class = "150"
            pressure_rating = 95
            temperature_rating = 750
        elsif pressure > 95 and pressure <= 470
            flange_class = "300"
            pressure_rating = 470
            temperature_rating = 750
        elsif pressure > 470 and pressure <= 625
            flange_class = "400"
            pressure_rating = 625
            temperature_rating = 750
        elsif pressure > 625 and pressure <= 940
            flange_class = "600"
            pressure_rating = 940
            temperature_rating = 750
        elsif pressure > 940 and pressure <= 1410
            flange_class = "900"
            pressure_rating = 1410
            temperature_rating = 750
        end
    elsif temperature > 750 and temperature <= 800 
        if pressure <= 80 
            flange_class = "150"
            pressure_rating = 80
            temperature_rating = 800
        elsif pressure > 80 and pressure <= 465
            flange_class = "300"
            pressure_rating = 465
            temperature_rating = 800
        elsif pressure > 465 and pressure <= 620
            flange_class = "400"
            pressure_rating = 620
            temperature_rating = 800
        elsif pressure > 620 and pressure <= 930
            flange_class = "600"
            pressure_rating = 930
            temperature_rating = 800
        elsif pressure > 930 and pressure <= 1395
            flange_class = "900"
            pressure_rating = 1395
            temperature_rating = 800
        end
    elsif temperature > 800 and temperature <= 850 
        if pressure <= 65 
            flange_class = "150"
            pressure_rating = 65
            temperature_rating = 850
        elsif pressure > 65 and pressure <= 460
            flange_class = "300"
            pressure_rating = 460
            temperature_rating = 850
        elsif pressure > 460 and pressure <= 610
            flange_class = "400"
            pressure_rating = 610
            temperature_rating = 850
        elsif pressure > 610 and pressure <= 915
            flange_class = "600"
            pressure_rating = 915
            temperature_rating = 850
        elsif pressure > 915 and pressure <= 1375
            flange_class = "900"
            pressure_rating = 1375
            temperature_rating = 850
        end
    elsif temperature > 850 and temperature <= 900 
        if pressure <= 50 
            flange_class = "150"
            pressure_rating = 50
            temperature_rating = 900
        elsif pressure > 50 and pressure <= 450
            flange_class = "300"
            pressure_rating = 450
            temperature_rating = 900
        elsif pressure > 450 and pressure <= 600
            flange_class = "400"
            pressure_rating = 600
            temperature_rating = 900
        elsif pressure > 600 and pressure <= 900
            flange_class = "600"
            pressure_rating = 900
            temperature_rating = 900
        elsif pressure > 900 and pressure <= 1350
            flange_class = "900"
            pressure_rating = 1350
            temperature_rating = 900
        end
    elsif temperature > 900 and temperature <= 950 
        if pressure <= 35 
            flange_class = "150"
            pressure_rating = 35
            temperature_rating = 950
        elsif pressure > 35 and pressure <= 385
            flange_class = "300"
            pressure_rating = 385
            temperature_rating = 950
        elsif pressure > 385 and pressure <= 515
            flange_class = "400"
            pressure_rating = 515
            temperature_rating = 950
        elsif pressure > 515 and pressure <= 775
            flange_class = "600"
            pressure_rating = 775
            temperature_rating = 950
        elsif pressure > 775 and pressure <= 1160
            flange_class = "900"
            pressure_rating = 1160
            temperature_rating = 950
        end
    elsif temperature > 950 and temperature <= 1000
        if pressure <= 20 
            flange_class = "150"
            pressure_rating = 20
            temperature_rating = 1000
        elsif pressure > 20 and pressure <= 340
            flange_class = "300"
            pressure_rating = 340
            temperature_rating = 1000
        elsif pressure > 340 and pressure <= 455
            flange_class = "400"
            pressure_rating = 455
            temperature_rating = 1000
        elsif pressure > 455 and pressure <= 680
            flange_class = "600"
            pressure_rating = 680
            temperature_rating = 1000
        elsif pressure > 680 and pressure <= 1020
            flange_class = "900"
            pressure_rating = 1020
            temperature_rating = 1000
        end
    elsif temperature > 1000 and temperature <= 105
        if pressure > 245 
            flange_class = "300"
            pressure_rating = 245
            temperature_rating = 1050
        elsif pressure > 245 and pressure <= 325
            flange_class = "400"
            pressure_rating = 325
            temperature_rating = 1050
        elsif pressure > 325 and pressure <= 485
            flange_class = "600"
            pressure_rating = 485
            temperature_rating = 1050
        elsif pressure > 485 and pressure <= 730
            flange_class = "900"
            pressure_rating = 730
            temperature_rating = 1050
        end
    elsif temperature > 1050 and temperature <= 110
        if pressure > 170 
            flange_class = "300"
            pressure_rating = 170
            temperature_rating = 1100
        elsif pressure > 170 and pressure <= 230
            flange_class = "400"
            pressure_rating = 230
            temperature_rating = 1100
        elsif pressure > 230 and pressure <= 345
            flange_class = "600"
            pressure_rating = 345
            temperature_rating = 1100
        elsif pressure > 345 and pressure <= 515
            flange_class = "900"
            pressure_rating = 515
            temperature_rating = 1100
        end
    elsif temperature > 1100 and temperature <= 115
        if pressure > 125 
            flange_class = "300"
            pressure_rating = 125
            temperature_rating = 1150
        elsif pressure > 125 and pressure <= 165
            flange_class = "400"
            pressure_rating = 165
            temperature_rating = 1150
        elsif pressure > 165 and pressure <= 245
            flange_class = "600"
            pressure_rating = 245
            temperature_rating = 1150
        elsif pressure > 245 and pressure <= 370
            flange_class = "900"
            pressure_rating = 370
            temperature_rating = 1150
        end
    elsif temperature > 1150 and temperature <= 120
        if pressure > 85 
            flange_class = "300"
            pressure_rating = 85
            temperature_rating = 1200
        elsif pressure > 85 and pressure <= 115
            flange_class = "400"
            pressure_rating = 115
            temperature_rating = 1200
        elsif pressure > 115 and pressure <= 170
            flange_class = "600"
            pressure_rating = 170
            temperature_rating = 1200
        elsif pressure > 170 and pressure <= 255
            flange_class = "900"
            pressure_rating = 255
            temperature_rating = 1200
        end
    elsif temperature > 1200 and temperature <= 125
        if pressure > 50 
            flange_class = "300"
            pressure_rating = 50
            temperature_rating = 1250
        elsif pressure > 50 and pressure <= 70
            flange_class = "400"
            pressure_rating = 70
            temperature_rating = 1250
        elsif pressure > 70 and pressure <= 105
            flange_class = "600"
            pressure_rating = 105
            temperature_rating = 1250
        elsif pressure > 105 and pressure <= 155
            flange_class = "900"
            pressure_rating = 155
            temperature_rating = 1250
        end
    elsif temperature > 1250 and temperature <= 130
        if pressure > 25 
            flange_class = "300"
            pressure_rating = 25
            temperature_rating = 1300
        elsif pressure > 25 and pressure <= 35
            flange_class = "400"
            pressure_rating = 35
            temperature_rating = 1300
        elsif pressure > 35 and pressure <= 55
            flange_class = "600"
            pressure_rating = 55
            temperature_rating = 1300
        elsif pressure > 55 and pressure <= 80
            flange_class = "900"
            pressure_rating = 80
            temperature_rating = 1300
        end
    elsif temperature > 1300 and temperature <= 135
        if pressure > 15 
            flange_class = "300"
            pressure_rating = 15
            temperature_rating = 1350
        elsif pressure > 15 and pressure <= 25
            flange_class = "400"
            pressure_rating = 25
            temperature_rating = 1350
        elsif pressure > 25 and pressure <= 35
            flange_class = "600"
            pressure_rating = 35
            temperature_rating = 1350
        elsif pressure > 35 and pressure <= 50
            flange_class = "900"
            pressure_rating = 50
            temperature_rating = 1350
        end
    elsif temperature > 1350 and temperature <= 140
        if pressure > 15 
            flange_class = "300"
            pressure_rating = 15
            temperature_rating = 1400
        elsif pressure > 15 and pressure <= 20
            flange_class = "400"
            pressure_rating = 20
            temperature_rating = 1400
        elsif pressure > 20 and pressure <= 25
            flange_class = "600"
            pressure_rating = 25
            temperature_rating = 1400
        elsif pressure > 25 and pressure <= 40
            flange_class = "900"
            pressure_rating = 40
            temperature_rating = 1400
        end
    elsif temperature > 1400 and temperature <= 145
        if pressure > 10 
            flange_class = "300"
            pressure_rating = 10
            temperature_rating = 1450
        elsif pressure > 10 and pressure <= 15
            flange_class = "400"
            pressure_rating = 15
            temperature_rating = 1450
        elsif pressure > 15 and pressure <= 20
            flange_class = "600"
            pressure_rating = 20
            temperature_rating = 1450
        elsif pressure > 20 and pressure <= 30
            flange_class = "900"
            pressure_rating = 30
            temperature_rating = 1450
        end
    elsif temperature > 1450 and temperature <= 150
        if pressure > 5 
            flange_class = "300"
            pressure_rating = 5
            temperature_rating = 1500
        elsif pressure > 5 and pressure <= 10
            flange_class = "400"
            pressure_rating = 10
            temperature_rating = 1500
        elsif pressure > 10 and pressure <= 15
            flange_class = "600"
            pressure_rating = 15
            temperature_rating = 1500
        elsif pressure > 15 and pressure <= 20
            flange_class = "900"
            pressure_rating = 20
            temperature_rating = 1500
        end
    end
end

  
if material_group == "2.10"
if temperature >= -20 and temperature <= 100 
    if pressure <= 130 
        flange_class = "75"
        pressure_rating = 130
        temperature_rating = 100
    elsif pressure > 130 and pressure <= 260
        flange_class = "150"
        pressure_rating = 260
        temperature_rating = 100
    elsif pressure > 260 and pressure <= 670
        flange_class = "300"
        pressure_rating = 670
        temperature_rating = 100
    elsif pressure > 670 and pressure <= 895
        flange_class = "400"
        pressure_rating = 895
        temperature_rating = 100
    elsif pressure > 895 and pressure <= 1345
        flange_class = "600"
        pressure_rating = 1345
        temperature_rating = 100
    elsif pressure > 1345 and pressure <= 2015
        flange_class = "900"
        pressure_rating = 2015
        temperature_rating = 100
    end
elsif temperature > 100 and temperature <= 200 
    if pressure <= 105 
        flange_class = "75"
        pressure_rating = 105
        temperature_rating = 200
    elsif pressure > 105 and pressure <= 210
        flange_class = "150"
        pressure_rating = 210
        temperature_rating = 200
    elsif pressure > 210 and pressure <= 550
        flange_class = "300"
        pressure_rating = 550
        temperature_rating = 200
    elsif pressure > 550 and pressure <= 735
        flange_class = "400"
        pressure_rating = 735
        temperature_rating = 200
    elsif pressure > 735 and pressure <= 1100
        flange_class = "600"
        pressure_rating = 1100
        temperature_rating = 200
    elsif pressure > 1100 and pressure <= 1650
        flange_class = "900"
        pressure_rating = 1650
        temperature_rating = 200
    end
elsif temperature > 200 and temperature <= 300 
    if pressure <= 95 
        flange_class = "75"
        pressure_rating = 95
        temperature_rating = 300
    elsif pressure > 95 and pressure <= 195
        flange_class = "150"
        pressure_rating = 195
        temperature_rating = 300
    elsif pressure > 195 and pressure <= 505
        flange_class = "300"
        pressure_rating = 505
        temperature_rating = 300
    elsif pressure > 505 and pressure <= 675
        flange_class = "400"
        pressure_rating = 675
        temperature_rating = 300
    elsif pressure > 675 and pressure <= 1015
        flange_class = "600"
        pressure_rating = 1015
        temperature_rating = 300
    elsif pressure > 1015 and pressure <= 1520
        flange_class = "900"
        pressure_rating = 1520
        temperature_rating = 300
    end
elsif temperature > 300 and temperature <= 400 
    if pressure <= 95 
        flange_class = "75"
        pressure_rating = 95
        temperature_rating = 400
    elsif pressure > 95 and pressure <= 185
        flange_class = "150"
        pressure_rating = 185
        temperature_rating = 400
    elsif pressure > 185 and pressure <= 485
        flange_class = "300"
        pressure_rating = 485
        temperature_rating = 400
    elsif pressure > 485 and pressure <= 645
        flange_class = "400"
        pressure_rating = 645
        temperature_rating = 400
    elsif pressure > 645 and pressure <= 970
        flange_class = "600"
        pressure_rating = 970
        temperature_rating = 400
    elsif pressure > 970 and pressure <= 1455
        flange_class = "900"
        pressure_rating = 1455
        temperature_rating = 400
    end
elsif temperature > 400 and temperature <= 500 
    if pressure <= 85 
        flange_class = "75"
        pressure_rating = 85
        temperature_rating = 500
    elsif pressure > 85 and pressure <= 170
        flange_class = "150"
        pressure_rating = 170
        temperature_rating = 500
    elsif pressure > 170 and pressure <= 470
        flange_class = "300"
        pressure_rating = 470
        temperature_rating = 500
    elsif pressure > 470 and pressure <= 625
        flange_class = "400"
        pressure_rating = 625
        temperature_rating = 500
    elsif pressure > 625 and pressure <= 940
        flange_class = "600"
        pressure_rating = 940
        temperature_rating = 500
    elsif pressure > 940 and pressure <= 1410
        flange_class = "900"
        pressure_rating = 1410
        temperature_rating = 500
    end
elsif temperature > 500 and temperature <= 600 
    if pressure <= 70 
        flange_class = "75"
        pressure_rating = 70
        temperature_rating = 600
    elsif pressure > 70 and pressure <= 140
        flange_class = "150"
        pressure_rating = 140
        temperature_rating = 600
    elsif pressure > 140 and pressure <= 455
        flange_class = "300"
        pressure_rating = 455
        temperature_rating = 600
    elsif pressure > 455 and pressure <= 610
        flange_class = "400"
        pressure_rating = 610
        temperature_rating = 600
    elsif pressure > 610 and pressure <= 910
        flange_class = "600"
        pressure_rating = 910
        temperature_rating = 600
    elsif pressure > 910 and pressure <= 1370
        flange_class = "900"
        pressure_rating = 1370
        temperature_rating = 600
    end
elsif temperature > 600 and temperature <= 650 
    if pressure <= 60 
        flange_class = "75"
        pressure_rating = 60
        temperature_rating = 650
    elsif pressure > 60 and pressure <= 125
        flange_class = "150"
        pressure_rating = 125
        temperature_rating = 650
    elsif pressure > 125 and pressure <= 445
        flange_class = "300"
        pressure_rating = 445
        temperature_rating = 650
    elsif pressure > 445 and pressure <= 595
        flange_class = "400"
        pressure_rating = 595
        temperature_rating = 650
    elsif pressure > 595 and pressure <= 895
        flange_class = "600"
        pressure_rating = 895
        temperature_rating = 650
    elsif pressure > 895 and pressure <= 1340
        flange_class = "900"
        pressure_rating = 1340
        temperature_rating = 650
    end
elsif temperature > 650 and temperature <= 700 
    if pressure <= 110 
        flange_class = "150"
        pressure_rating = 110
        temperature_rating = 700
    elsif pressure > 110 and pressure <= 435
        flange_class = "300"
        pressure_rating = 435
        temperature_rating = 700
    elsif pressure > 435 and pressure <= 580
        flange_class = "400"
        pressure_rating = 580
        temperature_rating = 700
    elsif pressure > 580 and pressure <= 870
        flange_class = "600"
        pressure_rating = 870
        temperature_rating = 700
    elsif pressure > 870 and pressure <= 1305
        flange_class = "900"
        pressure_rating = 1305
        temperature_rating = 700
    end
elsif temperature > 700 and temperature <= 750 
    if pressure <= 95 
        flange_class = "150"
        pressure_rating = 95
        temperature_rating = 750
    elsif pressure > 95 and pressure <= 420
        flange_class = "300"
        pressure_rating = 420
        temperature_rating = 750
    elsif pressure > 420 and pressure <= 565
        flange_class = "400"
        pressure_rating = 565
        temperature_rating = 750
    elsif pressure > 565 and pressure <= 845
        flange_class = "600"
        pressure_rating = 845
        temperature_rating = 750
    elsif pressure > 845 and pressure <= 1265
        flange_class = "900"
        pressure_rating = 1265
        temperature_rating = 750
    end
elsif temperature > 750 and temperature <= 800 
    if pressure <= 80 
        flange_class = "150"
        pressure_rating = 80
        temperature_rating = 800
    elsif pressure > 80 and pressure <= 410
        flange_class = "300"
        pressure_rating = 410
        temperature_rating = 800
    elsif pressure > 410 and pressure <= 545
        flange_class = "400"
        pressure_rating = 545
        temperature_rating = 800
    elsif pressure > 545 and pressure <= 820
        flange_class = "600"
        pressure_rating = 820
        temperature_rating = 800
    elsif pressure > 820 and pressure <= 1230
        flange_class = "900"
        pressure_rating = 1230
        temperature_rating = 800
    end
elsif temperature > 800 and temperature <= 850 
    if pressure <= 65 
        flange_class = "150"
        pressure_rating = 65
        temperature_rating = 850
    elsif pressure > 65 and pressure <= 400
        flange_class = "300"
        pressure_rating = 400
        temperature_rating = 850
    elsif pressure > 400 and pressure <= 530
        flange_class = "400"
        pressure_rating = 530
        temperature_rating = 850
    elsif pressure > 530 and pressure <= 795
        flange_class = "600"
        pressure_rating = 795
        temperature_rating = 850
    elsif pressure > 795 and pressure <= 1195
        flange_class = "900"
        pressure_rating = 1195
        temperature_rating = 850
    end
elsif temperature > 850 and temperature <= 900 
    if pressure <= 50 
        flange_class = "150"
        pressure_rating = 50
        temperature_rating = 900
    elsif pressure > 50 and pressure <= 385
        flange_class = "300"
        pressure_rating = 385
        temperature_rating = 900
    elsif pressure > 385 and pressure <= 510
        flange_class = "400"
        pressure_rating = 510
        temperature_rating = 900
    elsif pressure > 510 and pressure <= 770
        flange_class = "600"
        pressure_rating = 770
        temperature_rating = 900
    elsif pressure > 770 and pressure <= 1150
        flange_class = "900"
        pressure_rating = 1150
        temperature_rating = 900
    end
elsif temperature > 900 and temperature <= 950 
    if pressure <= 35 
        flange_class = "150"
        pressure_rating = 35
        temperature_rating = 950
    elsif pressure > 35 and pressure <= 370
        flange_class = "300"
        pressure_rating = 370
        temperature_rating = 950
    elsif pressure > 370 and pressure <= 495
        flange_class = "400"
        pressure_rating = 495
        temperature_rating = 950
    elsif pressure > 495 and pressure <= 740
        flange_class = "600"
        pressure_rating = 740
        temperature_rating = 950
    elsif pressure > 740 and pressure <= 1110
        flange_class = "900"
        pressure_rating = 1110
        temperature_rating = 950
    end
elsif temperature > 950 and temperature <= 1000
    if pressure <= 20 
        flange_class = "150"
        pressure_rating = 20
        temperature_rating = 1000
    elsif pressure > 20 and pressure <= 340
        flange_class = "300"
        pressure_rating = 340
        temperature_rating = 1000
    elsif pressure > 340 and pressure <= 450
        flange_class = "400"
        pressure_rating = 450
        temperature_rating = 1000
    elsif pressure > 450 and pressure <= 675
        flange_class = "600"
        pressure_rating = 675
        temperature_rating = 1000
    elsif pressure > 675 and pressure <= 1015
        flange_class = "900"
        pressure_rating = 1015
        temperature_rating = 1000
    end
elsif temperature > 1000 and temperature <= 105
    if pressure > 290 
        flange_class = "300"
        pressure_rating = 290
        temperature_rating = 1050
    elsif pressure > 290 and pressure <= 390
        flange_class = "400"
        pressure_rating = 390
        temperature_rating = 1050
    elsif pressure > 390 and pressure <= 585
        flange_class = "600"
        pressure_rating = 585
        temperature_rating = 1050
    elsif pressure > 585 and pressure <= 875
        flange_class = "900"
        pressure_rating = 875
        temperature_rating = 1050
    end
elsif temperature > 1050 and temperature <= 110
    if pressure > 225 
        flange_class = "300"
        pressure_rating = 225
        temperature_rating = 1100
    elsif pressure > 225 and pressure <= 295
        flange_class = "400"
        pressure_rating = 295
        temperature_rating = 1100
    elsif pressure > 295 and pressure <= 445
        flange_class = "600"
        pressure_rating = 445
        temperature_rating = 1100
    elsif pressure > 445 and pressure <= 670
        flange_class = "900"
        pressure_rating = 670
        temperature_rating = 1100
    end
elsif temperature > 1100 and temperature <= 115
    if pressure > 170 
        flange_class = "300"
        pressure_rating = 170
        temperature_rating = 1150
    elsif pressure > 170 and pressure <= 230
        flange_class = "400"
        pressure_rating = 230
        temperature_rating = 1150
    elsif pressure > 230 and pressure <= 345
        flange_class = "600"
        pressure_rating = 345
        temperature_rating = 1150
    elsif pressure > 345 and pressure <= 515
        flange_class = "900"
        pressure_rating = 515
        temperature_rating = 1150
    end
elsif temperature > 1150 and temperature <= 120
    if pressure > 130 
        flange_class = "300"
        pressure_rating = 130
        temperature_rating = 1200
    elsif pressure > 130 and pressure <= 175
        flange_class = "400"
        pressure_rating = 175
        temperature_rating = 1200
    elsif pressure > 175 and pressure <= 260
        flange_class = "600"
        pressure_rating = 260
        temperature_rating = 1200
    elsif pressure > 260 and pressure <= 390
        flange_class = "900"
        pressure_rating = 390
        temperature_rating = 1200
    end
elsif temperature > 1200 and temperature <= 125
    if pressure > 100 
        flange_class = "300"
        pressure_rating = 100
        temperature_rating = 1250
    elsif pressure > 100 and pressure <= 135
        flange_class = "400"
        pressure_rating = 135
        temperature_rating = 1250
    elsif pressure > 135 and pressure <= 200
        flange_class = "600"
        pressure_rating = 200
        temperature_rating = 1250
    elsif pressure > 200 and pressure <= 300
        flange_class = "900"
        pressure_rating = 300
        temperature_rating = 1250
    end
elsif temperature > 1250 and temperature <= 130
    if pressure > 80 
        flange_class = "300"
        pressure_rating = 80
        temperature_rating = 1300
    elsif pressure > 80 and pressure <= 105
        flange_class = "400"
        pressure_rating = 105
        temperature_rating = 1300
    elsif pressure > 105 and pressure <= 160
        flange_class = "600"
        pressure_rating = 160
        temperature_rating = 1300
    elsif pressure > 160 and pressure <= 235
        flange_class = "900"
        pressure_rating = 235
        temperature_rating = 1300
    end
elsif temperature > 1300 and temperature <= 135
    if pressure > 60 
        flange_class = "300"
        pressure_rating = 60
        temperature_rating = 1350
    elsif pressure > 60 and pressure <= 80
        flange_class = "400"
        pressure_rating = 80
        temperature_rating = 1350
    elsif pressure > 80 and pressure <= 125
        flange_class = "600"
        pressure_rating = 125
        temperature_rating = 1350
    elsif pressure > 125 and pressure <= 165
        flange_class = "900"
        pressure_rating = 165
        temperature_rating = 1350
    end
elsif temperature > 1350 and temperature <= 140
    if pressure > 45 
        flange_class = "300"
        pressure_rating = 45
        temperature_rating = 1400
    elsif pressure > 45 and pressure <= 60
        flange_class = "400"
        pressure_rating = 60
        temperature_rating = 1400
    elsif pressure > 60 and pressure <= 90
        flange_class = "600"
        pressure_rating = 90
        temperature_rating = 1400
    elsif pressure > 90 and pressure <= 135
        flange_class = "900"
        pressure_rating = 135
        temperature_rating = 1400
    end
elsif temperature > 1400 and temperature <= 145
    if pressure > 30 
        flange_class = "300"
        pressure_rating = 30
        temperature_rating = 1450
    elsif pressure > 30 and pressure <= 40
        flange_class = "400"
        pressure_rating = 40
        temperature_rating = 1450
    elsif pressure > 40 and pressure <= 60
        flange_class = "600"
        pressure_rating = 60
        temperature_rating = 1450
    elsif pressure > 60 and pressure <= 95
        flange_class = "900"
        pressure_rating = 95
        temperature_rating = 1450
    end
elsif temperature > 1450 and temperature <= 150
    if pressure > 25 
        flange_class = "300"
        pressure_rating = 25
        temperature_rating = 1500
    elsif pressure > 25 and pressure <= 35
        flange_class = "400"
        pressure_rating = 35
        temperature_rating = 1500
    elsif pressure > 35 and pressure <= 55
        flange_class = "600"
        pressure_rating = 55
        temperature_rating = 1500
    elsif pressure > 55 and pressure <= 80
        flange_class = "900"
        pressure_rating = 80
        temperature_rating = 1500
    end
end
end

  
if material_group == "2.11"
if temperature >= -20 and temperature <= 100 
    if pressure <= 140 
        flange_class = "75"
        pressure_rating = 140
        temperature_rating = 100
    elsif pressure > 140 and pressure <= 275
        flange_class = "150"
        pressure_rating = 275
        temperature_rating = 100
    elsif pressure > 275 and pressure <= 720
        flange_class = "300"
        pressure_rating = 720
        temperature_rating = 100
    elsif pressure > 720 and pressure <= 960
        flange_class = "400"
        pressure_rating = 960
        temperature_rating = 100
    elsif pressure > 960 and pressure <= 1440
        flange_class = "600"
        pressure_rating = 1440
        temperature_rating = 100
    elsif pressure > 1440 and pressure <= 2160
        flange_class = "900"
        pressure_rating = 2160
        temperature_rating = 100
    end
elsif temperature > 100 and temperature <= 200 
    if pressure <= 125 
        flange_class = "75"
        pressure_rating = 125
        temperature_rating = 200
    elsif pressure > 125 and pressure <= 255
        flange_class = "150"
        pressure_rating = 255
        temperature_rating = 200
    elsif pressure > 255 and pressure <= 660
        flange_class = "300"
        pressure_rating = 660
        temperature_rating = 200
    elsif pressure > 660 and pressure <= 885
        flange_class = "400"
        pressure_rating = 885
        temperature_rating = 200
    elsif pressure > 885 and pressure <= 1325
        flange_class = "600"
        pressure_rating = 1325
        temperature_rating = 200
    elsif pressure > 1325 and pressure <= 1985
        flange_class = "900"
        pressure_rating = 1985
        temperature_rating = 200
    end
elsif temperature > 200 and temperature <= 300 
    if pressure <= 115 
        flange_class = "75"
        pressure_rating = 115
        temperature_rating = 300
    elsif pressure > 115 and pressure <= 230
        flange_class = "150"
        pressure_rating = 230
        temperature_rating = 300
    elsif pressure > 230 and pressure <= 615
        flange_class = "300"
        pressure_rating = 615
        temperature_rating = 300
    elsif pressure > 615 and pressure <= 820
        flange_class = "400"
        pressure_rating = 820
        temperature_rating = 300
    elsif pressure > 820 and pressure <= 1235
        flange_class = "600"
        pressure_rating = 1235
        temperature_rating = 300
    elsif pressure > 1235 and pressure <= 1850
        flange_class = "900"
        pressure_rating = 1850
        temperature_rating = 300
    end
elsif temperature > 300 and temperature <= 400 
    if pressure <= 100 
        flange_class = "75"
        pressure_rating = 100
        temperature_rating = 400
    elsif pressure > 100 and pressure <= 200
        flange_class = "150"
        pressure_rating = 200
        temperature_rating = 400
    elsif pressure > 200 and pressure <= 575
        flange_class = "300"
        pressure_rating = 575
        temperature_rating = 400
    elsif pressure > 575 and pressure <= 770
        flange_class = "400"
        pressure_rating = 770
        temperature_rating = 400
    elsif pressure > 770 and pressure <= 1150
        flange_class = "600"
        pressure_rating = 1150
        temperature_rating = 400
    elsif pressure > 1150 and pressure <= 1730
        flange_class = "900"
        pressure_rating = 1730
        temperature_rating = 400
    end
elsif temperature > 400 and temperature <= 500 
    if pressure <= 85 
        flange_class = "75"
        pressure_rating = 85
        temperature_rating = 500
    elsif pressure > 85 and pressure <= 170
        flange_class = "150"
        pressure_rating = 170
        temperature_rating = 500
    elsif pressure > 170 and pressure <= 540
        flange_class = "300"
        pressure_rating = 540
        temperature_rating = 500
    elsif pressure > 540 and pressure <= 725
        flange_class = "400"
        pressure_rating = 725
        temperature_rating = 500
    elsif pressure > 725 and pressure <= 1085
        flange_class = "600"
        pressure_rating = 1085
        temperature_rating = 500
    elsif pressure > 1085 and pressure <= 1625
        flange_class = "900"
        pressure_rating = 1625
        temperature_rating = 500
    end
elsif temperature > 500 and temperature <= 600 
    if pressure <= 70 
        flange_class = "75"
        pressure_rating = 70
        temperature_rating = 600
    elsif pressure > 70 and pressure <= 140
        flange_class = "150"
        pressure_rating = 140
        temperature_rating = 600
    elsif pressure > 140 and pressure <= 515
        flange_class = "300"
        pressure_rating = 515
        temperature_rating = 600
    elsif pressure > 515 and pressure <= 690
        flange_class = "400"
        pressure_rating = 690
        temperature_rating = 600
    elsif pressure > 690 and pressure <= 1030
        flange_class = "600"
        pressure_rating = 1030
        temperature_rating = 600
    elsif pressure > 1030 and pressure <= 1550
        flange_class = "900"
        pressure_rating = 1550
        temperature_rating = 600
    end
elsif temperature > 600 and temperature <= 650 
    if pressure <= 60 
        flange_class = "75"
        pressure_rating = 60
        temperature_rating = 650
    elsif pressure > 60 and pressure <= 125
        flange_class = "150"
        pressure_rating = 125
        temperature_rating = 650
    elsif pressure > 125 and pressure <= 505
        flange_class = "300"
        pressure_rating = 505
        temperature_rating = 650
    elsif pressure > 505 and pressure <= 675
        flange_class = "400"
        pressure_rating = 675
        temperature_rating = 650
    elsif pressure > 675 and pressure <= 1015
        flange_class = "600"
        pressure_rating = 1015
        temperature_rating = 650
    elsif pressure > 1015 and pressure <= 1520
        flange_class = "900"
        pressure_rating = 1520
        temperature_rating = 650
    end
elsif temperature > 650 and temperature <= 700 
    if pressure <= 110 
        flange_class = "150"
        pressure_rating = 110
        temperature_rating = 700
    elsif pressure > 110 and pressure <= 495
        flange_class = "300"
        pressure_rating = 495
        temperature_rating = 700
    elsif pressure > 495 and pressure <= 660
        flange_class = "400"
        pressure_rating = 660
        temperature_rating = 700
    elsif pressure > 660 and pressure <= 995
        flange_class = "600"
        pressure_rating = 995
        temperature_rating = 700
    elsif pressure > 995 and pressure <= 1490
        flange_class = "900"
        pressure_rating = 1490
        temperature_rating = 700
    end
elsif temperature > 700 and temperature <= 750 
    if pressure <= 95 
        flange_class = "150"
        pressure_rating = 95
        temperature_rating = 750
    elsif pressure > 95 and pressure <= 490
        flange_class = "300"
        pressure_rating = 490
        temperature_rating = 750
    elsif pressure > 490 and pressure <= 655
        flange_class = "400"
        pressure_rating = 655
        temperature_rating = 750
    elsif pressure > 655 and pressure <= 985
        flange_class = "600"
        pressure_rating = 985
        temperature_rating = 750
    elsif pressure > 985 and pressure <= 1475
        flange_class = "900"
        pressure_rating = 1475
        temperature_rating = 750
    end
elsif temperature > 750 and temperature <= 800 
    if pressure <= 80 
        flange_class = "150"
        pressure_rating = 80
        temperature_rating = 800
    elsif pressure > 80 and pressure <= 485
        flange_class = "300"
        pressure_rating = 485
        temperature_rating = 800
    elsif pressure > 485 and pressure <= 650
        flange_class = "400"
        pressure_rating = 650
        temperature_rating = 800
    elsif pressure > 650 and pressure <= 975
        flange_class = "600"
        pressure_rating = 975
        temperature_rating = 800
    elsif pressure > 975 and pressure <= 1460
        flange_class = "900"
        pressure_rating = 1460
        temperature_rating = 800
    end
elsif temperature > 800 and temperature <= 850 
    if pressure <= 65 
        flange_class = "150"
        pressure_rating = 65
        temperature_rating = 850
    elsif pressure > 65 and pressure <= 485
        flange_class = "300"
        pressure_rating = 485
        temperature_rating = 850
    elsif pressure > 485 and pressure <= 645
        flange_class = "400"
        pressure_rating = 645
        temperature_rating = 850
    elsif pressure > 645 and pressure <= 970
        flange_class = "600"
        pressure_rating = 970
        temperature_rating = 850
    elsif pressure > 970 and pressure <= 1455
        flange_class = "900"
        pressure_rating = 1455
        temperature_rating = 850
    end
elsif temperature > 850 and temperature <= 900 
    if pressure <= 50 
        flange_class = "150"
        pressure_rating = 50
        temperature_rating = 900
    elsif pressure > 50 and pressure <= 450
        flange_class = "300"
        pressure_rating = 450
        temperature_rating = 900
    elsif pressure > 450 and pressure <= 600
        flange_class = "400"
        pressure_rating = 600
        temperature_rating = 900
    elsif pressure > 600 and pressure <= 900
        flange_class = "600"
        pressure_rating = 900
        temperature_rating = 900
    elsif pressure > 900 and pressure <= 1350
        flange_class = "900"
        pressure_rating = 1350
        temperature_rating = 900
    end
elsif temperature > 900 and temperature <= 950 
    if pressure <= 35 
        flange_class = "150"
        pressure_rating = 35
        temperature_rating = 950
    elsif pressure > 35 and pressure <= 385
        flange_class = "300"
        pressure_rating = 385
        temperature_rating = 950
    elsif pressure > 385 and pressure <= 515
        flange_class = "400"
        pressure_rating = 515
        temperature_rating = 950
    elsif pressure > 515 and pressure <= 775
        flange_class = "600"
        pressure_rating = 775
        temperature_rating = 950
    elsif pressure > 775 and pressure <= 1160
        flange_class = "900"
        pressure_rating = 1160
        temperature_rating = 950
    end
elsif temperature > 950 and temperature <= 1000
    if pressure <= 20 
        flange_class = "150"
        pressure_rating = 20
        temperature_rating = 1000
    elsif pressure > 20 and pressure <= 365
        flange_class = "300"
        pressure_rating = 365
        temperature_rating = 1000
    elsif pressure > 365 and pressure <= 485
        flange_class = "400"
        pressure_rating = 485
        temperature_rating = 1000
    elsif pressure > 485 and pressure <= 725
        flange_class = "600"
        pressure_rating = 725
        temperature_rating = 1000
    elsif pressure > 725 and pressure <= 1090
        flange_class = "900"
        pressure_rating = 1090
        temperature_rating = 1000
    end
elsif temperature > 1000 and temperature <= 105
    if pressure > 360 
        flange_class = "300"
        pressure_rating = 360
        temperature_rating = 1050
    elsif pressure > 360 and pressure <= 480
        flange_class = "400"
        pressure_rating = 480
        temperature_rating = 1050
    elsif pressure > 480 and pressure <= 720
        flange_class = "600"
        pressure_rating = 720
        temperature_rating = 1050
    elsif pressure > 720 and pressure <= 1080
        flange_class = "900"
        pressure_rating = 1080
        temperature_rating = 1050
    end
elsif temperature > 1050 and temperature <= 110
    if pressure > 310 
        flange_class = "300"
        pressure_rating = 310
        temperature_rating = 1100
    elsif pressure > 310 and pressure <= 415
        flange_class = "400"
        pressure_rating = 415
        temperature_rating = 1100
    elsif pressure > 415 and pressure <= 625
        flange_class = "600"
        pressure_rating = 625
        temperature_rating = 1100
    elsif pressure > 625 and pressure <= 935
        flange_class = "900"
        pressure_rating = 935
        temperature_rating = 1100
    end
elsif temperature > 1100 and temperature <= 115
    if pressure > 210 
        flange_class = "300"
        pressure_rating = 210
        temperature_rating = 1150
    elsif pressure > 210 and pressure <= 280
        flange_class = "400"
        pressure_rating = 280
        temperature_rating = 1150
    elsif pressure > 280 and pressure <= 420
        flange_class = "600"
        pressure_rating = 420
        temperature_rating = 1150
    elsif pressure > 420 and pressure <= 625
        flange_class = "900"
        pressure_rating = 625
        temperature_rating = 1150
    end
elsif temperature > 1150 and temperature <= 120
    if pressure > 150 
        flange_class = "300"
        pressure_rating = 150
        temperature_rating = 1200
    elsif pressure > 150 and pressure <= 200
        flange_class = "400"
        pressure_rating = 200
        temperature_rating = 1200
    elsif pressure > 200 and pressure <= 300
        flange_class = "600"
        pressure_rating = 300
        temperature_rating = 1200
    elsif pressure > 300 and pressure <= 455
        flange_class = "900"
        pressure_rating = 455
        temperature_rating = 1200
    end
elsif temperature > 1200 and temperature <= 125
    if pressure > 115 
        flange_class = "300"
        pressure_rating = 115
        temperature_rating = 1250
    elsif pressure > 115 and pressure <= 150
        flange_class = "400"
        pressure_rating = 150
        temperature_rating = 1250
    elsif pressure > 150 and pressure <= 225
        flange_class = "600"
        pressure_rating = 225
        temperature_rating = 1250
    elsif pressure > 225 and pressure <= 340
        flange_class = "900"
        pressure_rating = 340
        temperature_rating = 1250
    end
elsif temperature > 1250 and temperature <= 130
    if pressure > 75 
        flange_class = "300"
        pressure_rating = 75
        temperature_rating = 1300
    elsif pressure > 75 and pressure <= 100
        flange_class = "400"
        pressure_rating = 100
        temperature_rating = 1300
    elsif pressure > 100 and pressure <= 150
        flange_class = "600"
        pressure_rating = 150
        temperature_rating = 1300
    elsif pressure > 150 and pressure <= 225
        flange_class = "900"
        pressure_rating = 225
        temperature_rating = 1300
    end
elsif temperature > 1300 and temperature <= 135
    if pressure > 50 
        flange_class = "300"
        pressure_rating = 50
        temperature_rating = 1350
    elsif pressure > 50 and pressure <= 70
        flange_class = "400"
        pressure_rating = 70
        temperature_rating = 1350
    elsif pressure > 70 and pressure <= 105
        flange_class = "600"
        pressure_rating = 105
        temperature_rating = 1350
    elsif pressure > 105 and pressure <= 155
        flange_class = "900"
        pressure_rating = 155
        temperature_rating = 1350
    end
elsif temperature > 1350 and temperature <= 140
    if pressure > 40 
        flange_class = "300"
        pressure_rating = 40
        temperature_rating = 1400
    elsif pressure > 40 and pressure <= 55
        flange_class = "400"
        pressure_rating = 55
        temperature_rating = 1400
    elsif pressure > 55 and pressure <= 80
        flange_class = "600"
        pressure_rating = 80
        temperature_rating = 1400
    elsif pressure > 80 and pressure <= 125
        flange_class = "900"
        pressure_rating = 125
        temperature_rating = 1400
    end
elsif temperature > 1400 and temperature <= 145
    if pressure > 30 
        flange_class = "300"
        pressure_rating = 30
        temperature_rating = 1450
    elsif pressure > 30 and pressure <= 40
        flange_class = "400"
        pressure_rating = 40
        temperature_rating = 1450
    elsif pressure > 40 and pressure <= 60
        flange_class = "600"
        pressure_rating = 60
        temperature_rating = 1450
    elsif pressure > 60 and pressure <= 95
        flange_class = "900"
        pressure_rating = 95
        temperature_rating = 1450
    end
elsif temperature > 1450 and temperature <= 150
    if pressure > 25 
        flange_class = "300"
        pressure_rating = 25
        temperature_rating = 1500
    elsif pressure > 25 and pressure <= 35
        flange_class = "400"
        pressure_rating = 35
        temperature_rating = 1500
    elsif pressure > 35 and pressure <= 55
        flange_class = "600"
        pressure_rating = 55
        temperature_rating = 1500
    elsif pressure > 55 and pressure <= 80
        flange_class = "900"
        pressure_rating = 80
        temperature_rating = 1500
    end
end
end

  
if material_group == "2.12"
if temperature >= -20 and temperature <= 100 
    if pressure <= 130 
        flange_class = "75"
        pressure_rating = 130
        temperature_rating = 100
    elsif pressure > 130 and pressure <= 260
        flange_class = "150"
        pressure_rating = 260
        temperature_rating = 100
    elsif pressure > 260 and pressure <= 670
        flange_class = "300"
        pressure_rating = 670
        temperature_rating = 100
    elsif pressure > 670 and pressure <= 895
        flange_class = "400"
        pressure_rating = 895
        temperature_rating = 100
    elsif pressure > 895 and pressure <= 1345
        flange_class = "600"
        pressure_rating = 1345
        temperature_rating = 100
    elsif pressure > 1345 and pressure <= 2015
        flange_class = "900"
        pressure_rating = 2015
        temperature_rating = 100
    end
elsif temperature > 100 and temperature <= 200 
    if pressure <= 105 
        flange_class = "75"
        pressure_rating = 105
        temperature_rating = 200
    elsif pressure > 105 and pressure <= 210
        flange_class = "150"
        pressure_rating = 210
        temperature_rating = 200
    elsif pressure > 210 and pressure <= 550
        flange_class = "300"
        pressure_rating = 550
        temperature_rating = 200
    elsif pressure > 550 and pressure <= 735
        flange_class = "400"
        pressure_rating = 735
        temperature_rating = 200
    elsif pressure > 735 and pressure <= 1100
        flange_class = "600"
        pressure_rating = 1100
        temperature_rating = 200
    elsif pressure > 1100 and pressure <= 1650
        flange_class = "900"
        pressure_rating = 1650
        temperature_rating = 200
    end
elsif temperature > 200 and temperature <= 300 
    if pressure <= 95 
        flange_class = "75"
        pressure_rating = 95
        temperature_rating = 300
    elsif pressure > 95 and pressure <= 195
        flange_class = "150"
        pressure_rating = 195
        temperature_rating = 300
    elsif pressure > 195 and pressure <= 505
        flange_class = "300"
        pressure_rating = 505
        temperature_rating = 300
    elsif pressure > 505 and pressure <= 675
        flange_class = "400"
        pressure_rating = 675
        temperature_rating = 300
    elsif pressure > 675 and pressure <= 1015
        flange_class = "600"
        pressure_rating = 1015
        temperature_rating = 300
    elsif pressure > 1015 and pressure <= 1520
        flange_class = "900"
        pressure_rating = 1520
        temperature_rating = 300
    end
elsif temperature > 300 and temperature <= 400 
    if pressure <= 95 
        flange_class = "75"
        pressure_rating = 95
        temperature_rating = 400
    elsif pressure > 95 and pressure <= 185
        flange_class = "150"
        pressure_rating = 185
        temperature_rating = 400
    elsif pressure > 185 and pressure <= 485
        flange_class = "300"
        pressure_rating = 485
        temperature_rating = 400
    elsif pressure > 485 and pressure <= 645
        flange_class = "400"
        pressure_rating = 645
        temperature_rating = 400
    elsif pressure > 645 and pressure <= 970
        flange_class = "600"
        pressure_rating = 970
        temperature_rating = 400
    elsif pressure > 970 and pressure <= 1455
        flange_class = "900"
        pressure_rating = 1455
        temperature_rating = 400
    end
elsif temperature > 400 and temperature <= 500 
    if pressure <= 85 
        flange_class = "75"
        pressure_rating = 85
        temperature_rating = 500
    elsif pressure > 85 and pressure <= 170
        flange_class = "150"
        pressure_rating = 170
        temperature_rating = 500
    elsif pressure > 170 and pressure <= 470
        flange_class = "300"
        pressure_rating = 470
        temperature_rating = 500
    elsif pressure > 470 and pressure <= 625
        flange_class = "400"
        pressure_rating = 625
        temperature_rating = 500
    elsif pressure > 625 and pressure <= 940
        flange_class = "600"
        pressure_rating = 940
        temperature_rating = 500
    elsif pressure > 940 and pressure <= 1410
        flange_class = "900"
        pressure_rating = 1410
        temperature_rating = 500
    end
elsif temperature > 500 and temperature <= 600 
    if pressure <= 70 
        flange_class = "75"
        pressure_rating = 70
        temperature_rating = 600
    elsif pressure > 70 and pressure <= 140
        flange_class = "150"
        pressure_rating = 140
        temperature_rating = 600
    elsif pressure > 140 and pressure <= 455
        flange_class = "300"
        pressure_rating = 455
        temperature_rating = 600
    elsif pressure > 455 and pressure <= 610
        flange_class = "400"
        pressure_rating = 610
        temperature_rating = 600
    elsif pressure > 610 and pressure <= 910
        flange_class = "600"
        pressure_rating = 910
        temperature_rating = 600
    elsif pressure > 910 and pressure <= 1370
        flange_class = "900"
        pressure_rating = 1370
        temperature_rating = 600
    end
elsif temperature > 600 and temperature <= 650 
    if pressure <= 60 
        flange_class = "75"
        pressure_rating = 60
        temperature_rating = 650
    elsif pressure > 60 and pressure <= 125
        flange_class = "150"
        pressure_rating = 125
        temperature_rating = 650
    elsif pressure > 125 and pressure <= 445
        flange_class = "300"
        pressure_rating = 445
        temperature_rating = 650
    elsif pressure > 445 and pressure <= 595
        flange_class = "400"
        pressure_rating = 595
        temperature_rating = 650
    elsif pressure > 595 and pressure <= 895
        flange_class = "600"
        pressure_rating = 895
        temperature_rating = 650
    elsif pressure > 895 and pressure <= 1340
        flange_class = "900"
        pressure_rating = 1340
        temperature_rating = 650
    end
elsif temperature > 650 and temperature <= 700 
    if pressure <= 110 
        flange_class = "150"
        pressure_rating = 110
        temperature_rating = 700
    elsif pressure > 110 and pressure <= 435
        flange_class = "300"
        pressure_rating = 435
        temperature_rating = 700
    elsif pressure > 435 and pressure <= 580
        flange_class = "400"
        pressure_rating = 580
        temperature_rating = 700
    elsif pressure > 580 and pressure <= 870
        flange_class = "600"
        pressure_rating = 870
        temperature_rating = 700
    elsif pressure > 870 and pressure <= 1305
        flange_class = "900"
        pressure_rating = 1305
        temperature_rating = 700
    end
elsif temperature > 700 and temperature <= 750 
    if pressure <= 95 
        flange_class = "150"
        pressure_rating = 95
        temperature_rating = 750
    elsif pressure > 95 and pressure <= 420
        flange_class = "300"
        pressure_rating = 420
        temperature_rating = 750
    elsif pressure > 420 and pressure <= 565
        flange_class = "400"
        pressure_rating = 565
        temperature_rating = 750
    elsif pressure > 565 and pressure <= 845
        flange_class = "600"
        pressure_rating = 845
        temperature_rating = 750
    elsif pressure > 845 and pressure <= 1265
        flange_class = "900"
        pressure_rating = 1265
        temperature_rating = 750
    end
elsif temperature > 750 and temperature <= 800 
    if pressure <= 80 
        flange_class = "150"
        pressure_rating = 80
        temperature_rating = 800
    elsif pressure > 80 and pressure <= 410
        flange_class = "300"
        pressure_rating = 410
        temperature_rating = 800
    elsif pressure > 410 and pressure <= 545
        flange_class = "400"
        pressure_rating = 545
        temperature_rating = 800
    elsif pressure > 545 and pressure <= 820
        flange_class = "600"
        pressure_rating = 820
        temperature_rating = 800
    elsif pressure > 820 and pressure <= 1230
        flange_class = "900"
        pressure_rating = 1230
        temperature_rating = 800
    end
elsif temperature > 800 and temperature <= 850 
    if pressure <= 65 
        flange_class = "150"
        pressure_rating = 65
        temperature_rating = 850
    elsif pressure > 65 and pressure <= 400
        flange_class = "300"
        pressure_rating = 400
        temperature_rating = 850
    elsif pressure > 400 and pressure <= 530
        flange_class = "400"
        pressure_rating = 530
        temperature_rating = 850
    elsif pressure > 530 and pressure <= 795
        flange_class = "600"
        pressure_rating = 795
        temperature_rating = 850
    elsif pressure > 795 and pressure <= 1195
        flange_class = "900"
        pressure_rating = 1195
        temperature_rating = 850
    end
elsif temperature > 850 and temperature <= 900 
    if pressure <= 50 
        flange_class = "150"
        pressure_rating = 50
        temperature_rating = 900
    elsif pressure > 50 and pressure <= 385
        flange_class = "300"
        pressure_rating = 385
        temperature_rating = 900
    elsif pressure > 385 and pressure <= 510
        flange_class = "400"
        pressure_rating = 510
        temperature_rating = 900
    elsif pressure > 510 and pressure <= 770
        flange_class = "600"
        pressure_rating = 770
        temperature_rating = 900
    elsif pressure > 770 and pressure <= 1150
        flange_class = "900"
        pressure_rating = 1150
        temperature_rating = 900
    end
elsif temperature > 900 and temperature <= 950 
    if pressure <= 35 
        flange_class = "150"
        pressure_rating = 35
        temperature_rating = 950
    elsif pressure > 35 and pressure <= 370
        flange_class = "300"
        pressure_rating = 370
        temperature_rating = 950
    elsif pressure > 370 and pressure <= 495
        flange_class = "400"
        pressure_rating = 495
        temperature_rating = 950
    elsif pressure > 495 and pressure <= 740
        flange_class = "600"
        pressure_rating = 740
        temperature_rating = 950
    elsif pressure > 740 and pressure <= 1110
        flange_class = "900"
        pressure_rating = 1110
        temperature_rating = 950
    end
elsif temperature > 950 and temperature <= 1000
    if pressure <= 20 
        flange_class = "150"
        pressure_rating = 20
        temperature_rating = 1000
    elsif pressure > 20 and pressure <= 340
        flange_class = "300"
        pressure_rating = 340
        temperature_rating = 1000
    elsif pressure > 340 and pressure <= 450
        flange_class = "400"
        pressure_rating = 450
        temperature_rating = 1000
    elsif pressure > 450 and pressure <= 675
        flange_class = "600"
        pressure_rating = 675
        temperature_rating = 1000
    elsif pressure > 675 and pressure <= 1015
        flange_class = "900"
        pressure_rating = 1015
        temperature_rating = 1000
    end
elsif temperature > 1000 and temperature <= 105
    if pressure > 325 
        flange_class = "300"
        pressure_rating = 325
        temperature_rating = 1050
    elsif pressure > 325 and pressure <= 435
        flange_class = "400"
        pressure_rating = 435
        temperature_rating = 1050
    elsif pressure > 435 and pressure <= 650
        flange_class = "600"
        pressure_rating = 650
        temperature_rating = 1050
    elsif pressure > 650 and pressure <= 975
        flange_class = "900"
        pressure_rating = 975
        temperature_rating = 1050
    end
elsif temperature > 1050 and temperature <= 110
    if pressure > 290 
        flange_class = "300"
        pressure_rating = 290
        temperature_rating = 1100
    elsif pressure > 290 and pressure <= 390
        flange_class = "400"
        pressure_rating = 390
        temperature_rating = 1100
    elsif pressure > 390 and pressure <= 585
        flange_class = "600"
        pressure_rating = 585
        temperature_rating = 1100
    elsif pressure > 585 and pressure <= 875
        flange_class = "900"
        pressure_rating = 875
        temperature_rating = 1100
    end
elsif temperature > 1100 and temperature <= 115
    if pressure > 250 
        flange_class = "300"
        pressure_rating = 250
        temperature_rating = 1150
    elsif pressure > 250 and pressure <= 335
        flange_class = "400"
        pressure_rating = 335
        temperature_rating = 1150
    elsif pressure > 335 and pressure <= 500
        flange_class = "600"
        pressure_rating = 500
        temperature_rating = 1150
    elsif pressure > 500 and pressure <= 750
        flange_class = "900"
        pressure_rating = 750
        temperature_rating = 1150
    end
elsif temperature > 1150 and temperature <= 120
    if pressure > 205 
        flange_class = "300"
        pressure_rating = 205
        temperature_rating = 1200
    elsif pressure > 205 and pressure <= 275
        flange_class = "400"
        pressure_rating = 275
        temperature_rating = 1200
    elsif pressure > 275 and pressure <= 410
        flange_class = "600"
        pressure_rating = 410
        temperature_rating = 1200
    elsif pressure > 410 and pressure <= 615
        flange_class = "900"
        pressure_rating = 615
        temperature_rating = 1200
    end
elsif temperature > 1200 and temperature <= 125
    if pressure > 165 
        flange_class = "300"
        pressure_rating = 165
        temperature_rating = 1250
    elsif pressure > 165 and pressure <= 220
        flange_class = "400"
        pressure_rating = 220
        temperature_rating = 1250
    elsif pressure > 220 and pressure <= 330
        flange_class = "600"
        pressure_rating = 330
        temperature_rating = 1250
    elsif pressure > 330 and pressure <= 495
        flange_class = "900"
        pressure_rating = 495
        temperature_rating = 1250
    end
elsif temperature > 1250 and temperature <= 130
    if pressure > 120 
        flange_class = "300"
        pressure_rating = 120
        temperature_rating = 1300
    elsif pressure > 120 and pressure <= 160
        flange_class = "400"
        pressure_rating = 160
        temperature_rating = 1300
    elsif pressure > 160 and pressure <= 240
        flange_class = "600"
        pressure_rating = 240
        temperature_rating = 1300
    elsif pressure > 240 and pressure <= 360
        flange_class = "900"
        pressure_rating = 360
        temperature_rating = 1300
    end
elsif temperature > 1300 and temperature <= 135
    if pressure > 60 
        flange_class = "300"
        pressure_rating = 60
        temperature_rating = 1350
    elsif pressure > 60 and pressure <= 110
        flange_class = "400"
        pressure_rating = 110
        temperature_rating = 1350
    elsif pressure > 110 and pressure <= 165
        flange_class = "600"
        pressure_rating = 165
        temperature_rating = 1350
    elsif pressure > 165 and pressure <= 245
        flange_class = "900"
        pressure_rating = 245
        temperature_rating = 1350
    end
elsif temperature > 1350 and temperature <= 140
    if pressure > 55 
        flange_class = "300"
        pressure_rating = 55
        temperature_rating = 1400
    elsif pressure > 55 and pressure <= 75
        flange_class = "400"
        pressure_rating = 75
        temperature_rating = 1400
    elsif pressure > 75 and pressure <= 110
        flange_class = "600"
        pressure_rating = 110
        temperature_rating = 1400
    elsif pressure > 110 and pressure <= 165
        flange_class = "900"
        pressure_rating = 165
        temperature_rating = 1400
    end
elsif temperature > 1400 and temperature <= 145
    if pressure > 40 
        flange_class = "300"
        pressure_rating = 40
        temperature_rating = 1450
    elsif pressure > 40 and pressure <= 50
        flange_class = "400"
        pressure_rating = 50
        temperature_rating = 1450
    elsif pressure > 50 and pressure <= 75
        flange_class = "600"
        pressure_rating = 75
        temperature_rating = 1450
    elsif pressure > 75 and pressure <= 115
        flange_class = "900"
        pressure_rating = 115
        temperature_rating = 1450
    end
elsif temperature > 1450 and temperature <= 150
    if pressure > 25 
        flange_class = "300"
        pressure_rating = 25
        temperature_rating = 1500
    elsif pressure > 25 and pressure <= 35
        flange_class = "400"
        pressure_rating = 35
        temperature_rating = 1500
    elsif pressure > 35 and pressure <= 55
        flange_class = "600"
        pressure_rating = 55
        temperature_rating = 1500
    elsif pressure > 55 and pressure <= 80
        flange_class = "900"
        pressure_rating = 80
        temperature_rating = 1500
    end
end
end

notes = ""

if material_group == 1.1
  if unit_type == 'customary'
    notes = "(1) Upon prolonged exposure to temperatures above 800\B0F, the carbide phase of steel may be converted to graphite. Permissible, but not recommended for prolonged use above 800\B0F. & Chr(13) _
    & (2) Not to be used over 850\B0F. & Chr(13) _
    & (3) Not to be used over 700\B0F. & Chr(13) _
    & (4) Not to be used over 500\B0F."
  elsif unit_type == 'SI'
    notes = "(1) Upon prolonged exposure to temperatures above 425\B0C, the carbide phase of steel may be converted to graphite. Permissible, but not recommended for prolonged use above 425\B0C. & Chr(13) _
    & (2) Not to be used over 455\B0F. & Chr(13) _
    & (3) Not to be used over 370\B0F. & Chr(13) _
    & (4) Not to be used over 260\B0F."
  end
end

if material_group == 1.2
  if unit_type == 'customary'
    notes = "(1) Upon prolonged exposure to temperatures above 800\B0F, the carbide phase of steel may be converted to graphite. Permissible, but not recommended for prolonged use above 800\B0F. & Chr(13) _
    & (2) Not to be used over 650\B0F & Chr(13) _ # & (3) Not to be used over 500\B0F."
  elsif unit_type == 'SI'
   notes = "(1) Upon prolonged exposure to temperatures above 425\B0C, the carbide phase of steel may be converted to graphite. Permissible, but not recommended for prolonged use above 425\B0C. & Chr(13) _
   & (2) Not to be used over 340\B0F & Chr(13) _ & (3) Not to be used over 260\B0F."
  end
end

if material_group == 1.3
  if unit_type == 'customary'
   notes = "(1) Upon prolonged exposure to temperatures above 800\B0F, the carbide phase of steel may be converted to graphite. Permissible, but not recommended for prolonged use above 800\B0F. & Chr(13) _
   & (2) Not to be used over 850\B0F & Chr(13) _ & (3) Not to be used over 650\B0F. & Chr(13) _ & (4) Upon prolonged exposure to temperatures above 875\B0F, the carbide phase of steel may be converted to graphite. 
   Permissible, but not recommended for prolonged use above 875\B0F. & Chr(13) _ & (5) Use normalized and tempered matrial only."
 elsif unit_type == 'SI'
   notes = "(1) Upon prolonged exposure to temperatures above 425\B0C, the carbide phase of steel may be converted to graphite. Permissible, but not recommended for prolonged use above 425\B0C. & Chr(13) _
   & (2) Not to be used over 455\B0C. & Chr(13) _  & (3) Not to be used over 340\B0C. & Chr(13) _
   & (4) Upon prolonged exposure to temperatures above 465\B0C, the carbide phase of steel may be converted to graphite. Permissible, but not recommended for prolonged use above 465\B0C. & Chr(13) _
   & (5) Use normalized and tempered matrial only."
 end
end
  

if material_group == 1.4
  if unit_type == 'customary'
    notes = "(1) Upon prolonged exposure to temperatures above 800\B0F, the carbide phase of steel may be converted to graphite. Permissible, but not recommended for prolonged use above 800\B0F. & Chr(13) _
    & (2) Not to be used over 850\B0F."
  elsif unit_type == 'SI' 
   notes = "(1) Upon prolonged exposure to temperatures above 425\B0F, the carbide phase of steel may be converted to graphite. Permissible, but not recommended for prolonged use above 425\B0F. & Chr(13) _
   & (2) Not to be used over 455\B0F."
 end
end

if material_group == 1.5
  if unit_type == 'customary'
     notes = "(1) Upon prolonged exposure to temperatures above 875\B0F, the carbide phase of carbon\96molybdenum steel may be converted to graphite. Permissible, but not recommended for prolonged use above 875\B0F."
  elsif unit_type == 'SI'
    notes = "(1) Upon prolonged exposure to temperatures above 465\B0C, the carbide phase of carbon\96molybdenum steel may be converted to graphite. Permissible, but not recommended for prolonged use above 465\B0C."
  end
end

if material_group == 1.7
  if unit_type == 'customary'
    notes = "(1) Use normalized and tempered material only. & Chr(13) _  & (2) Not to be used over 1000\B0F."
  elsif  unit_type == 'SI'
    notes = "(1) Use normalized and tempered material only. & Chr(13) _ # & (2) Not to be used over 538\B0C."
  end
end

if material_group == 1.9
  if unit_type == 'customary'
    notes = "(1) Use normalized and tempered material only. & Chr(13) _ & (2) Permissible, but not recommended for prolonged use above 1100\B0F. & Chr(13) _
    & (3) Not to be used over 1100\B0F."
  elsif unit_type == 'SI'
    notes = "(1) Use normalized and tempered material only. & Chr(13) _   & (2) Permissible, but not recommended for prolonged use above 590\B0C. & Chr(13) _
    & (3) Not to be used over 590\B0C."
  end
end

if material_group == 1.10
  if unit_type == 'customary'
    notes = "(1) Use normalized and tempered material only. & Chr(13) _  & (2) Permissible, but not recommended for prolonged use above 1100\B0F.
    & Chr(13) _ & (3) Not to be used over 1100\B0F."
  elsif unit_type == 'SI'
   notes = "(1) Use normalized and tempered material only. & Chr(13) _ & (2) Permissible, but not recommended for prolonged use above 590\B0C. & Chr(13) _
   & (3) Not to be used over 590\B0C."
 end
end

if material_group == 1.11
  if unit_type == 'customary'
    notes = "(1) Upon prolonged exposure to temperatures above 875\B0F, the carbide phase of carbon-molybdenum steel may be converted to graphite. Permissible, but not recommended for prolonged use above 875\B0F."
  elsif unit_type
    notes = "(1) Upon prolonged exposure to temperatures above 465\B0C, the carbide phase of carbon-molybdenum steel may be converted to graphite. Permissible, but not recommended for prolonged use above 465\B0C."
  end
end

if material_group == 1.13
  if unit_type == 'customary'
    notes = "(1) Use normalized and tempered material only."
  elsif  unit_type
    notes = "(1) Use normalized and tempered material only."
  end
end


if material_group == 1.14
  if unit_type == 'customary'
    notes = "(1) Use normalized and tempered material only."
  elsif  unit_type
    notes = "(1) Use normalized and tempered material only."
  end
end

if material_group == 1.15
  if unit_type == 'customary'
    notes = " "
  elsif  unit_type
    notes = " "
  end
end

if material_group == 1.7
  if unit_type == 'customary'
    notes = "(1) Use normalized and tempered material only. & Chr(13) _  & (2) Permissible, but not recommended for prolonged use above 1,100\B0F."
  elsif  unit_type == 'SI'
    notes = "(1) Use normalized and tempered material only. & Chr(13) _  & (2) Permissible, but not recommended for prolonged use above 590\B0C."
  end
end

if material_group == 2.1
  if unit_type == 'customary'
    notes = "(1) At temperatures over 1,000\B0F, use only when the carbon content is 0.04% or higher. & Chr(13) _ & (2) Not to be used over 800\B0F."
  elsif unit_type == 'SI'
    notes = "(1) At temperatures over 538\B0C, use only when the carbon content is 0.04% or higher. & Chr(13) _ & (2) Not to be used over 425\B0C."
  end
end

if material_group == 2.2
  if unit_type == 'customary'
    notes =  "(1) At temperatures over 1,000\B0F, use only when the carbon content is 0.04% or higher. & Chr(13) _
    & (2) Not to be used over 850\B0F. & Chr(13) _  & (3) Not to be used over 1,000\B0F."
  elsif  unit_type
    notes = "(1) At temperatures over 538\B0C, use only when the carbon content is 0.04% or higher. & Chr(13) _
    & (2) Not to be used over 455\B0C. & Chr(13) _ & (3) Not to be used over 538\B0C."
  end
end

if material_group == 2.3
  if unit_type == 'customary'
    notes = "(1) Not to be used over 800\B0F."
  elsif  unit_type == 'SI'
    notes = "(1) Not to be used over 425\B0C."
  end
end

if material_group == 2.4
  if unit_type == 'customary'
    notes = "(1) At temperatures over 1,000\B0F, use only if the material is heat treated by heating to a minimum temperature of 2,000\B0F. & Chr(13) _
 & (2) Not to be used over 1,000\B0F."
  elsif unit_type == 'SI'
    notes = "(1) At temperatures over 538\B0C, use only if the material is heat treated by heating to a minimum temperature of 1,095\B0C. & Chr(13) _
  & (2) Not to be used over 538\B0C."
  end
end

if material_group == 2.5
  if unit_type == 'customary'
    notes = "(1) For temperatures over 1,000\B0F, use only if the material is heat treated by heating to a minimum temperature of 2,000\B0F. & Chr(13) _
    & (2) Not to be used over 1,000\B0F."
  elsif  unit_type == 'SI'
    notes = "(1) For temperatures over 538\B0C, use only if the material is heat treated by heating to a minimum temperature of 1,095\B0C. & Chr(13) _
    & (2) Not to be used over 538\B0C."  
  end
end

if material_group == 2.6
  if unit_type == 'customary'
    notes = ""
  elsif unit_type == 'SI'
    notes = " "
  end
end

if material_group == 2.7
  if unit_type == 'customary'
     notes  = "(1) At temperatures over 1,000\B0F, use only when the carbon content is 0.04% or higher. & Chr(13) _
   & (2) Service temperatures of 1,050\B0F and above should be used only when assurance is provided that grain size is not finer than ASTM 6."
  elsif unit_type == 'SI'
    notes =  "(1) At temperatures over 538\B0C, use only when the carbon content is 0.04% or higher. & Chr(13) _
   & (2) Service temperatures of 565\B0C and above should be used only when assurance is provided that grain size is not finer than ASTM 6."
  end 
end

if material_group == 2.8
  if unit_type == 'customary'
    notes = "(1) This steel may become brittle after service at moderately elevated temperatures. Not to be used over 600\B0F."
  elsif  unit_type == 'SI'
    notes = "(1) This steel may become brittle after service at moderately elevated temperatures. Not to be used over 315\B0F."
  end
end

if material_group == 2.9
  if unit_type == 'customary'
    notes = "(1) At temperatures over 1,000\B0F, use only when the carbon content is 0.04% or higher. & Chr(13) _
    & (2) At temperatures above 1,000\B0F, use only if the material is solution heat treated to the minimum temperature specified in the specification, but not lower than 1,900\B0F, and quenching in water or rapidly cooling by other means. & Chr(13) _
    & (3) This material should be used for service temperatures 1,050\B0F and above only when assurance is provided that grain size is not finer than ASTM 6."
  elsif  unit_type == 'SI'
   notes = "(1) At temperatures over 538\B0C, use only when the carbon content is 0.04% or higher. & Chr(13) _
   & (2) At temperatures above 538\B0C, use only if the material is solution heat treated to the minimum temperature specified in the specification, but not lower than 1,035\B0C, and quenching in water or rapidly cooling by other means. & Chr(13) _
   & (3) This material should be used for service temperatures 565\B0C and above only when assurance is provided that grain size is not finer than ASTM 6."   
 end
end

if material_group == 2.10
  if unit_type == 'customary'
    notes = "(1) At temperatures over 1,000F, use only when the carbon content is 0.04% or higher."
  elsif  unit_type == 'SI'
    notes = "(1) At temperatures over 538C, use only when the carbon content is 0.04% or higher."
  end
end

if material_group == 2.11
  if unit_type == 'customary'
    notes = "(1) At temperatures over 1,000\B0F, use only when the carbon content is 0.04% or higher."
  elsif  unit_type == 'SI'
    notes = "(1) At temperatures over 538\B0C, use only when the carbon content is 0.04% or higher."
  end
end

if material_group == 2.12
  if unit_type == 'customary'
    notes = "(1) At temperatures over 1,000\B0F, use only when the carbon content is 0.04% or higher."
  elsif  unit_type == 'SI'
    notes = "(1) At temperatures over 538\B0C, use only when the carbon content is 0.04% or higher."
  end
end

end

=begin
def flange_pressure_temperature_rating
 if material_group = "1.1"
    if temperature >= -20 and temperature <= 100 
        if pressure <= 285 
        flange_class = "150"
        pressure_rating = 285
        temperature_rating = 100
        elsif  pressure > 285 and pressure <= 740 
        flange_class = "300"
        pressure_rating = 740
        temperature_rating = 100
        elsif  pressure > 740 and pressure <= 985 
        flange_class = "400"
        pressure_rating = 985
        temperature_rating = 100
        elsif  pressure > 985 and pressure <= 1480 
        flange_class = "600"
        pressure_rating = 1480
        temperature_rating = 100
        elsif  pressure > 1480 and pressure <= 2220 
        flange_class = "900"
        pressure_rating = 2220
        temperature_rating = 100
        elsif  pressure > 2220 and pressure <= 3705 
        flange_class = "1500"
        pressure_rating = 3705
        temperature_rating = 100
        elsif  pressure > 3705 and pressure <= 6170 
        flange_class = "2500"
        pressure_rating = 6170
        temperature_rating = 100
        end
    elsif temperature > 100 and temperature <= 200 
        if pressure <= 260 
        flange_class = "150"
        pressure_rating = 260
        temperature_rating = 200
        elsif  pressure > 260 and pressure <= 680 
        flange_class = "300"
        pressure_rating = 680
        temperature_rating = 200
        elsif  pressure > 680 and pressure <= 905 
        flange_class = "400"
        pressure_rating = 905
        temperature_rating = 200
        elsif  pressure > 905 and pressure <= 1360 
        flange_class = "600"
        pressure_rating = 1360
        temperature_rating = 200
        elsif  pressure > 1360 and pressure <= 2035 
        flange_class = "900"
        pressure_rating = 2035
        temperature_rating = 200
        elsif  pressure > 2035 and pressure <= 3395 
        flange_class = "1500"
        pressure_rating = 3395
        temperature_rating = 200
        elsif  pressure > 3395 and pressure <= 5655 
        flange_class = "2500"
        pressure_rating = 5655
        temperature_rating = 200
        end
    elsif temperature > 200 and temperature <= 300 
        if pressure <= 230 
        flange_class = "150"
        pressure_rating = 230
        temperature_rating = 300
        elsif  pressure > 230 and pressure <= 655 
        flange_class = "300"
        pressure_rating = 655
        temperature_rating = 300
        elsif  pressure > 655 and pressure <= 870 
        flange_class = "400"
        pressure_rating = 870
        temperature_rating = 300
        elsif  pressure > 870 and pressure <= 1310 
        flange_class = "600"
        pressure_rating = 1310
        temperature_rating = 300
        elsif  pressure > 1310 and pressure <= 1965 
        flange_class = "900"
        pressure_rating = 1965
        temperature_rating = 300
        elsif  pressure > 1965 and pressure <= 3270 
        flange_class = "1500"
        pressure_rating = 3270
        temperature_rating = 300
        elsif  pressure > 3270 and pressure <= 5450 
        flange_class = "2500"
        pressure_rating = 5450
        temperature_rating = 300
        end
    elsif temperature > 300 and temperature <= 400 
        if pressure <= 200 
        flange_class = "150"
        pressure_rating = 285
        temperature_rating = 400
        elsif  pressure > 200 and pressure <= 635 
        flange_class = "300"
        pressure_rating = 635
        temperature_rating = 400
        elsif  pressure > 635 and pressure <= 845 
        flange_class = "400"
        pressure_rating = 845
        temperature_rating = 400
        elsif  pressure > 845 and pressure <= 1265 
        flange_class = "600"
        pressure_rating = 1265
        temperature_rating = 400
        elsif  pressure > 1265 and pressure <= 1900 
        flange_class = "900"
        pressure_rating = 1900
        temperature_rating = 400
        elsif  pressure > 1900 and pressure <= 3170 
        flange_class = "1500"
        pressure_rating = 3170
        temperature_rating = 400
        elsif  pressure > 3170 and pressure <= 5280 
        flange_class = "2500"
        pressure_rating = 5280
        temperature_rating = 400
        end
    elsif temperature > 400 and temperature <= 500 
        if pressure <= 170 
        flange_class = "150"
        pressure_rating = 170
        temperature_rating = 500
        elsif  pressure > 170 and pressure <= 605 
        flange_class = "300"
        pressure_rating = 605
        temperature_rating = 500
        elsif  pressure > 605 and pressure <= 805 
        flange_class = "400"
        pressure_rating = 805
        temperature_rating = 500
        elsif  pressure > 805 and pressure <= 1205 
        flange_class = "600"
        pressure_rating = 1205
        temperature_rating = 500
        elsif  pressure > 1205 and pressure <= 1810 
        flange_class = "900"
        pressure_rating = 1810
        temperature_rating = 500
        elsif  pressure > 1810 and pressure <= 3015 
        flange_class = "1500"
        pressure_rating = 3015
        temperature_rating = 500
        elsif  pressure > 3015 and pressure <= 5025 
        flange_class = "2500"
        pressure_rating = 5025
        temperature_rating = 500
        end
    elsif temperature > 500 and temperature <= 600 
        if pressure <= 140 
        flange_class = "150"
        pressure_rating = 140
        temperature_rating = 600
        elsif  pressure > 140 and pressure <= 570 
        flange_class = "300"
        pressure_rating = 570
        temperature_rating = 600
        elsif  pressure > 570 and pressure <= 755 
        flange_class = "400"
        pressure_rating = 755
        temperature_rating = 600
        elsif  pressure > 755 and pressure <= 1135 
        flange_class = "600"
        pressure_rating = 1135
        temperature_rating = 600
        elsif  pressure > 1135 and pressure <= 1705 
        flange_class = "900"
        pressure_rating = 1705
        temperature_rating = 600
        elsif  pressure > 2840 and pressure <= 2840 
        flange_class = "1500"
        pressure_rating = 2840
        temperature_rating = 600
        elsif  pressure > 2840 and pressure <= 4730 
        flange_class = "2500"
        pressure_rating = 4730
        temperature_rating = 600
        end
    elsif temperature > 600 and temperature <= 650 
        if pressure <= 125 
        flange_class = "150"
        pressure_rating = 125
        temperature_rating = 650
        elsif  pressure > 125 and pressure <= 550 
        flange_class = "300"
        pressure_rating = 550
        temperature_rating = 650
        elsif  pressure > 550 and pressure <= 730 
        flange_class = "400"
        pressure_rating = 730
        temperature_rating = 650
        elsif  pressure > 730 and pressure <= 1100 
        flange_class = "600"
        pressure_rating = 1100
        temperature_rating = 650
        elsif  pressure > 1100 and pressure <= 1650 
        flange_class = "900"
        pressure_rating = 1650
        temperature_rating = 650
        elsif  pressure > 1650 and pressure <= 2745 
        flange_class = "1500"
        pressure_rating = 2745
        temperature_rating = 650
        elsif  pressure > 2745 and pressure <= 4575 
        flange_class = "2500"
        pressure_rating = 4575
        temperature_rating = 650
        end
    elsif temperature > 650 and temperature <= 700 
        if pressure <= 110 
        flange_class = "150"
        pressure_rating = 110
        temperature_rating = 700
        elsif  pressure > 110 and pressure <= 530 
        flange_class = "300"
        pressure_rating = 530
        temperature_rating = 700
        elsif  pressure > 530 and pressure <= 710 
        flange_class = "400"
        pressure_rating = 710
        temperature_rating = 700
        elsif  pressure > 710 and pressure <= 1060 
        flange_class = "600"
        pressure_rating = 1060
        temperature_rating = 700
        elsif  pressure > 1060 and pressure <= 1590 
        flange_class = "900"
        pressure_rating = 1590
        temperature_rating = 700
        elsif  pressure > 1590 and pressure <= 2655 
        flange_class = "1500"
        pressure_rating = 2655
        temperature_rating = 700
        elsif  pressure > 2655 and pressure <= 4425 
        flange_class = "2500"
        pressure_rating = 4425
        temperature_rating = 700
        end
    elsif temperature > 700 and temperature <= 750 
        if pressure <= 95 
        flange_class = "150"
        pressure_rating = 95
        temperature_rating = 750
        elsif  pressure > 95 and pressure <= 505 
        flange_class = "300"
        pressure_rating = 505
        temperature_rating = 750
        elsif  pressure > 505 and pressure <= 675 
        flange_class = "400"
        pressure_rating = 675
        temperature_rating = 750
        elsif  pressure > 675 and pressure <= 1015 
        flange_class = "600"
        pressure_rating = 1015
        temperature_rating = 750
        elsif  pressure > 1015 and pressure <= 1520 
        flange_class = "900"
        pressure_rating = 1520
        temperature_rating = 750
        elsif  pressure > 1520 and pressure <= 2535 
        flange_class = "1500"
        pressure_rating = 2535
        temperature_rating = 750
        elsif  pressure > 2535 and pressure <= 4230 
        flange_class = "2500"
        pressure_rating = 4230
        temperature_rating = 750
        end
    elsif temperature > 750 and temperature <= 800 
        if pressure <= 80 
        flange_class = "150"
        pressure_rating = 80
        temperature_rating = 800
        elsif  pressure > 80 and pressure <= 410 
        flange_class = "300"
        pressure_rating = 410
        temperature_rating = 800
        elsif  pressure > 740 and pressure <= 550 
        flange_class = "400"
        pressure_rating = 550
        temperature_rating = 800
        elsif  pressure > 985 and pressure <= 825 
        flange_class = "600"
        pressure_rating = 825
        temperature_rating = 800
        elsif  pressure > 1480 and pressure <= 1235 
        flange_class = "900"
        pressure_rating = 1235
        temperature_rating = 800
        elsif  pressure > 2220 and pressure <= 2055 
        flange_class = "1500"
        pressure_rating = 2055
        temperature_rating = 800
        elsif  pressure > 3705 and pressure <= 3430 
        flange_class = "2500"
        pressure_rating = 3430
        temperature_rating = 800
        end
    elsif temperature > 800 and temperature <= 850 
        if pressure <= 65 
        flange_class = "150"
        pressure_rating = 65
        temperature_rating = 850
        elsif  pressure > 65 and pressure <= 320 
        flange_class = "300"
        pressure_rating = 320
        temperature_rating = 850
        elsif  pressure > 320 and pressure <= 425 
        flange_class = "400"
        pressure_rating = 425
        temperature_rating = 850
        elsif  pressure > 425 and pressure <= 640 
        flange_class = "600"
        pressure_rating = 640
        temperature_rating = 850
        elsif  pressure > 640 and pressure <= 955 
        flange_class = "900"
        pressure_rating = 955
        temperature_rating = 850
        elsif  pressure > 955 and pressure <= 1595 
        flange_class = "1500"
        pressure_rating = 1595
        temperature_rating = 850
        elsif  pressure > 1595 and pressure <= 2655 
        flange_class = "2500"
        pressure_rating = 2655
        temperature_rating = 850
        end
    elsif temperature > 850 and temperature <= 900 
        if pressure <= 50 
        flange_class = "150"
        pressure_rating = 50
        temperature_rating = 900
        elsif  pressure > 50 and pressure <= 230 
        flange_class = "300"
        pressure_rating = 230
        temperature_rating = 900
        elsif  pressure > 230 and pressure <= 305 
        flange_class = "400"
        pressure_rating = 305
        temperature_rating = 900
        elsif  pressure > 305 and pressure <= 460 
        flange_class = "600"
        pressure_rating = 460
        temperature_rating = 900
        elsif  pressure > 460 and pressure <= 690 
        flange_class = "900"
        pressure_rating = 690
        temperature_rating = 900
        elsif  pressure > 690 and pressure <= 1150 
        flange_class = "1500"
        pressure_rating = 1150
        temperature_rating = 900
        elsif  pressure > 1150 and pressure <= 1915 
        flange_class = "2500"
        pressure_rating = 1915
        temperature_rating = 900
        end
    elsif temperature > 900 and temperature <= 950 
        if pressure <= 35 
        flange_class = "150"
        pressure_rating = 35
        temperature_rating = 950
        elsif  pressure > 35 and pressure <= 135 
        flange_class = "300"
        pressure_rating = 135
        temperature_rating = 950
        elsif  pressure > 135 and pressure <= 185 
        flange_class = "400"
        pressure_rating = 185
        temperature_rating = 950
        elsif  pressure > 185 and pressure <= 275 
        flange_class = "600"
        pressure_rating = 275
        temperature_rating = 950
        elsif  pressure > 275 and pressure <= 410 
        flange_class = "900"
        pressure_rating = 410
        temperature_rating = 950
        elsif  pressure > 410 and pressure <= 685 
        flange_class = "1500"
        pressure_rating = 685
        temperature_rating = 950
        elsif  pressure > 685 and pressure <= 1145 
        flange_class = "2500"
        pressure_rating = 1145
        temperature_rating = 950
        
        end
    elsif temperature > 950 and temperature <= 1000 
        if pressure <= 20 
        flange_class = "150"
        pressure_rating = 20
        temperature_rating = 1000
        elsif  pressure > 20 and pressure <= 85 
        flange_class = "300"
        pressure_rating = 85
        temperature_rating = 1000
        elsif  pressure > 85 and pressure <= 115 
        flange_class = "400"
        pressure_rating = 115
        temperature_rating = 1000
        elsif  pressure > 115 and pressure <= 170 
        flange_class = "600"
        pressure_rating = 170
        temperature_rating = 1000
        elsif  pressure > 170 and pressure <= 255 
        flange_class = "900"
        pressure_rating = 255
        temperature_rating = 1000
        elsif  pressure > 255 and pressure <= 430 
        flange_class = "1500"
        pressure_rating = 430
        temperature_rating = 1000
        elsif  pressure > 430 and pressure <= 715 
        flange_class = "2500"
        pressure_rating = 715
        temperature_rating = 1000
        end
    end
 end
    
    #if Worksheets("UOM").chkCustomary.Value = True 
    #UserFormLineSegmentDesign.lblNotes = "(1) Upon prolonged exposure to temperatures above 800\B0F, the carbide phase of steel may be converted to graphite. Permissible, but not recommended for prolonged use above 800\B0F." & Chr(13) _
    #& "(2) Not to be used over 850\B0F." & Chr(13) _
    #& "(3) Not to be used over 700\B0F." & Chr(13) _
    #& "(4) Not to be used over 500\B0F."
    #elsif orksheets("UOM").chkSI.Value = True 
    #UserFormLineSegmentDesign.lblNotes = "(1) Upon prolonged exposure to temperatures above 425\B0C, the carbide phase of steel may be converted to graphite. Permissible, but not recommended for prolonged use above 425\B0C." & Chr(13) _
    #& "(2) Not to be used over 455\B0C." & Chr(13) _
    #& "(3) Not to be used over 370\B0C." & Chr(13) _
    #& "(4) Not to be used over 260\B0C."
    #
    #end

 
if material_group = "1.2" 
    if temperature >= -20 and temperature <= 100 
        if pressure <= 290 
        flange_class = "150"
        pressure_rating = 290
        temperature_rating = 100
        elsif  pressure > 290 and pressure <= 750 
        flange_class = "300"
        pressure_rating = 750
        temperature_rating = 100
        elsif  pressure > 750 and pressure <= 1000 
        flange_class = "400"
        pressure_rating = 1000
        temperature_rating = 100
        elsif  pressure > 1000 and pressure <= 1500 
        flange_class = "600"
        pressure_rating = 1500
        temperature_rating = 100
        elsif  pressure > 1500 and pressure <= 2250 
        flange_class = "900"
        pressure_rating = 2250
        temperature_rating = 100
        elsif  pressure > 2250 and pressure <= 3750 
        flange_class = "1500"
        pressure_rating = 3750
        temperature_rating = 100
        elsif  pressure > 3750 and pressure <= 6250 
        flange_class = "2500"
        pressure_rating = 6250
        temperature_rating = 100
        end
  elsif temperature > 100 and temperature <= 200 
        if pressure <= 260 
        flange_class = "150"
        pressure_rating = 260
        temperature_rating = 200
        elsif  pressure > 260 and pressure <= 750 
        flange_class = "300"
        pressure_rating = 750
        temperature_rating = 200
        elsif  pressure > 750 and pressure <= 1000 
        flange_class = "400"
        pressure_rating = 1000
        temperature_rating = 200
        elsif  pressure > 1000 and pressure <= 1500 
        flange_class = "600"
        pressure_rating = 1500
        temperature_rating = 200
        elsif  pressure > 1500 and pressure <= 2250 
        flange_class = "900"
        pressure_rating = 2250
        temperature_rating = 200
        elsif  pressure > 2250 and pressure <= 3750 
        flange_class = "1500"
        pressure_rating = 3750
        temperature_rating = 200
        elsif  pressure > 3750 and pressure <= 6250 
        flange_class = "2500"
        pressure_rating = 6250
        temperature_rating = 200
        
        end
    elsif temperature > 200 and temperature <= 300 
        if pressure <= 230 
        flange_class = "150"
        pressure_rating = 230
        temperature_rating = 300
        elsif  pressure > 230 and pressure <= 730 
        flange_class = "300"
        pressure_rating = 730
        temperature_rating = 300
        elsif  pressure > 730 and pressure <= 970 
        flange_class = "400"
        pressure_rating = 970
        temperature_rating = 300
        elsif  pressure > 970 and pressure <= 1455 
        flange_class = "600"
        pressure_rating = 1455
        temperature_rating = 300
        elsif  pressure > 1455 and pressure <= 2185 
        flange_class = "900"
        pressure_rating = 2185
        temperature_rating = 300
        elsif  pressure > 2185 and pressure <= 3640 
        flange_class = "1500"
        pressure_rating = 3640
        temperature_rating = 300
        elsif  pressure > 3640 and pressure <= 6070 
        flange_class = "2500"
        pressure_rating = 6070
        temperature_rating = 300
        
        end
    elsif temperature > 300 and temperature <= 400 
        if pressure <= 200 
        flange_class = "150"
        pressure_rating = 200
        temperature_rating = 400
        elsif  pressure > 200 and pressure <= 705 
        flange_class = "300"
        pressure_rating = 705
        temperature_rating = 400
        elsif  pressure > 705 and pressure <= 940 
        flange_class = "400"
        pressure_rating = 940
        temperature_rating = 400
        elsif  pressure > 940 and pressure <= 1405 
        flange_class = "600"
        pressure_rating = 1405
        temperature_rating = 400
        elsif  pressure > 1405 and pressure <= 2110 
        flange_class = "900"
        pressure_rating = 2110
        temperature_rating = 400
        elsif  pressure > 2110 and pressure <= 3520 
        flange_class = "1500"
        pressure_rating = 3520
        temperature_rating = 400
        elsif  pressure > 3520 and pressure <= 5865 
        flange_class = "2500"
        pressure_rating = 5865
        temperature_rating = 400
        
        end
    elsif temperature > 400 and temperature <= 500 
        if pressure <= 170 
        flange_class = "150"
        pressure_rating = 170
        temperature_rating = 500
        elsif  pressure > 170 and pressure <= 665 
        flange_class = "300"
        pressure_rating = 665
        temperature_rating = 500
        elsif  pressure > 665 and pressure <= 885 
        flange_class = "400"
        pressure_rating = 885
        temperature_rating = 500
        elsif  pressure > 855 and pressure <= 1330 
        flange_class = "600"
        pressure_rating = 1330
        temperature_rating = 500
        elsif  pressure > 1330 and pressure <= 1995 
        flange_class = "900"
        pressure_rating = 1995
        temperature_rating = 500
        elsif  pressure > 1995 and pressure <= 3325 
        flange_class = "1500"
        pressure_rating = 3325
        temperature_rating = 500
        elsif  pressure > 3325 and pressure <= 5540 
        flange_class = "2500"
        pressure_rating = 5540
        temperature_rating = 500
        
        end
    elsif temperature > 500 and temperature <= 600 
        if pressure <= 140 
        flange_class = "150"
        pressure_rating = 140
        temperature_rating = 600
        elsif  pressure > 140 and pressure <= 605 
        flange_class = "300"
        pressure_rating = 605
        temperature_rating = 600
        elsif  pressure > 605 and pressure <= 805 
        flange_class = "400"
        pressure_rating = 805
        temperature_rating = 600
        elsif  pressure > 805 and pressure <= 1210 
        flange_class = "600"
        pressure_rating = 1210
        temperature_rating = 600
        elsif  pressure > 1210 and pressure <= 1815 
        flange_class = "900"
        pressure_rating = 1815
        temperature_rating = 600
        elsif  pressure > 1815 and pressure <= 3025 
        flange_class = "1500"
        pressure_rating = 3025
        temperature_rating = 600
        elsif  pressure > 3025 and pressure <= 5040 
        flange_class = "2500"
        pressure_rating = 5040
        temperature_rating = 600
        
        end
    elsif temperature > 600 and temperature <= 650 
        if pressure <= 125 
        flange_class = "150"
        pressure_rating = 125
        temperature_rating = 650
        elsif  pressure > 125 and pressure <= 590 
        flange_class = "300"
        pressure_rating = 590
        temperature_rating = 650
        elsif  pressure > 590 and pressure <= 785 
        flange_class = "400"
        pressure_rating = 785
        temperature_rating = 650
        elsif  pressure > 785 and pressure <= 1175 
        flange_class = "600"
        pressure_rating = 1175
        temperature_rating = 650
        elsif  pressure > 1175 and pressure <= 1765 
        flange_class = "900"
        pressure_rating = 1765
        temperature_rating = 650
        elsif  pressure > 1765 and pressure <= 2940 
        flange_class = "1500"
        pressure_rating = 2940
        temperature_rating = 650
        elsif  pressure > 2940 and pressure <= 4905 
        flange_class = "2500"
        pressure_rating = 4905
        temperature_rating = 650
        
        end
    elsif temperature > 650 and temperature <= 700 
        if pressure <= 110 
        flange_class = "150"
        pressure_rating = 110
        temperature_rating = 700
        elsif  pressure > 110 and pressure <= 555 
        flange_class = "300"
        pressure_rating = 555
        temperature_rating = 700
        elsif  pressure > 555 and pressure <= 740 
        flange_class = "400"
        pressure_rating = 740
        temperature_rating = 700
        elsif  pressure > 740 and pressure <= 1110 
        flange_class = "600"
        pressure_rating = 1110
        temperature_rating = 700
        elsif  pressure > 1110 and pressure <= 1665 
        flange_class = "900"
        pressure_rating = 1665
        temperature_rating = 700
        elsif  pressure > 1665 and pressure <= 2775 
        flange_class = "1500"
        pressure_rating = 2775
        temperature_rating = 700
        elsif  pressure > 2775 and pressure <= 4630 
        flange_class = "2500"
        pressure_rating = 4630
        temperature_rating = 700
        
        end
    elsif temperature > 700 and temperature <= 750 
        if pressure <= 95 
        flange_class = "150"
        pressure_rating = 95
        temperature_rating = 750
        elsif  pressure > 95 and pressure <= 505 
        flange_class = "300"
        pressure_rating = 505
        temperature_rating = 750
        elsif  pressure > 505 and pressure <= 675 
        flange_class = "400"
        pressure_rating = 675
        temperature_rating = 750
        elsif  pressure > 675 and pressure <= 1015 
        flange_class = "600"
        pressure_rating = 1015
        temperature_rating = 750
        elsif  pressure > 1015 and pressure <= 1520 
        flange_class = "900"
        pressure_rating = 1520
        temperature_rating = 750
        elsif  pressure > 1520 and pressure <= 2535 
        flange_class = "1500"
        pressure_rating = 2535
        temperature_rating = 750
        elsif  pressure > 2535 and pressure <= 4230 
        flange_class = "2500"
        pressure_rating = 4230
        temperature_rating = 750
        
        end
    elsif temperature > 750 and temperature <= 800 
        if pressure <= 80 
        flange_class = "150"
        pressure_rating = 80
        temperature_rating = 800
        elsif  pressure > 80 and pressure <= 410 
        flange_class = "300"
        pressure_rating = 410
        temperature_rating = 800
        elsif  pressure > 410 and pressure <= 550 
        flange_class = "400"
        pressure_rating = 550
        temperature_rating = 800
        elsif  pressure > 550 and pressure <= 825 
        flange_class = "600"
        pressure_rating = 825
        temperature_rating = 800
        elsif  pressure > 825 and pressure <= 1235 
        flange_class = "900"
        pressure_rating = 1235
        temperature_rating = 800
        elsif  pressure > 1235 and pressure <= 2055 
        flange_class = "1500"
        pressure_rating = 2055
        temperature_rating = 800
        elsif  pressure > 2055 and pressure <= 3430 
        flange_class = "2500"
        pressure_rating = 3430
        temperature_rating = 800
        end
    elsif temperature > 800 and temperature <= 850 
        if pressure <= 65 
        flange_class = "150"
        pressure_rating = 65
        temperature_rating = 850
        elsif  pressure > 65 and pressure <= 320 
        flange_class = "300"
        pressure_rating = 320
        temperature_rating = 850
        elsif  pressure > 320 and pressure <= 425 
        flange_class = "400"
        pressure_rating = 425
        temperature_rating = 850
        elsif  pressure > 425 and pressure <= 640 
        flange_class = "600"
        pressure_rating = 640
        temperature_rating = 850
        elsif  pressure > 640 and pressure <= 955 
        flange_class = "900"
        pressure_rating = 955
        temperature_rating = 850
        elsif  pressure > 955 and pressure <= 1595 
        flange_class = "1500"
        pressure_rating = 1595
        temperature_rating = 850
        elsif  pressure > 1595 and pressure <= 2655 
        flange_class = "2500"
        pressure_rating = 2655
        temperature_rating = 850
        
        end
    elsif temperature > 850 and temperature <= 900 
        if pressure <= 50 
        flange_class = "150"
        pressure_rating = 50
        temperature_rating = 900
        elsif  pressure > 50 and pressure <= 225 
        flange_class = "300"
        pressure_rating = 225
        temperature_rating = 900
        elsif  pressure > 225 and pressure <= 295 
        flange_class = "400"
        pressure_rating = 295
        temperature_rating = 900
        elsif  pressure > 295 and pressure <= 445 
        flange_class = "600"
        pressure_rating = 445
        temperature_rating = 900
        elsif  pressure > 445 and pressure <= 670 
        flange_class = "900"
        pressure_rating = 670
        temperature_rating = 900
        elsif  pressure > 670 and pressure <= 1115 
        flange_class = "1500"
        pressure_rating = 1115
        temperature_rating = 900
        elsif  pressure > 1115 and pressure <= 1855 
        flange_class = "2500"
        pressure_rating = 1855
        temperature_rating = 900
        
        end
    elsif temperature > 900 and temperature <= 950 
        if pressure <= 35 
        flange_class = "150"
        pressure_rating = 35
        temperature_rating = 950
        elsif  pressure > 35 and pressure <= 135 
        flange_class = "300"
        pressure_rating = 135
        temperature_rating = 950
        elsif  pressure > 135 and pressure <= 185 
        flange_class = "400"
        pressure_rating = 185
        temperature_rating = 950
        elsif  pressure > 185 and pressure <= 275 
        flange_class = "600"
        pressure_rating = 275
        temperature_rating = 950
        elsif  pressure > 275 and pressure <= 410 
        flange_class = "900"
        pressure_rating = 410
        temperature_rating = 950
        elsif  pressure > 410 and pressure <= 685 
        flange_class = "1500"
        pressure_rating = 685
        temperature_rating = 950
        elsif  pressure > 685 and pressure <= 1145 
        flange_class = "2500"
        pressure_rating = 1145
        temperature_rating = 950
        
        end
    elsif temperature > 950 and temperature <= 1000 
        if pressure <= 20 
        flange_class = "150"
        pressure_rating = 20
        temperature_rating = 1000
        elsif  pressure > 20 and pressure <= 85 
        flange_class = "300"
        pressure_rating = 85
        temperature_rating = 1000
        elsif  pressure > 85 and pressure <= 115 
        flange_class = "400"
        pressure_rating = 115
        temperature_rating = 1000
        elsif  pressure > 115 and pressure <= 170 
        flange_class = "600"
        pressure_rating = 170
        temperature_rating = 1000
        elsif  pressure > 170 and pressure <= 255 
        flange_class = "900"
        pressure_rating = 255
        temperature_rating = 1000
        elsif  pressure > 255 and pressure <= 430 
        flange_class = "1500"
        pressure_rating = 430
        temperature_rating = 1000
        elsif  pressure > 430 and pressure <= 715 
        flange_class = "2500"
        pressure_rating = 715
        temperature_rating = 1000
        end
    end
  end
    
    #if Worksheets("UOM").chkCustomary.Value = True 
    #UserFormLineSegmentDesign.lblNotes = "(1) Upon prolonged exposure to temperatures above 800\B0F, the carbide phase of steel may be converted to graphite. Permissible, but not recommended for prolonged use above 800\B0F." & Chr(13) _
    #& "(2) Not to be used over 650\B0F" & Chr(13) _
    #& "(3) Not to be used over 500\B0F."
    #elsif orksheets("UOM").chkSI.Value = True 
    #UserFormLineSegmentDesign.lblNotes = "(1) Upon prolonged exposure to temperatures above 425\B0C, the carbide phase of steel may be converted to graphite. Permissible, but not recommended for prolonged use above 425\B0C." & Chr(13) _
    #& "(2) Not to be used over 340\B0C" & Chr(13) _
    #& "(3) Not to be used over 260\B0C."
    #end

    if pressure <= 290 
     pressure_rating_100F = 290
   elsif  pressure > 290 and pressure <= 750 
     pressure_rating_100F = 750
   elsif  pressure > 750 and pressure <= 1000 
     pressure_rating_100F = 1000
   elsif  pressure > 1000 and pressure <= 1500 
     pressure_rating_100F = 1500
   elsif  pressure > 1500 and pressure <= 2250 
     pressure_rating_100F = 2250
   elsif  pressure > 2250 and pressure <= 3750 
     pressure_rating_100F = 3750
   elsif  pressure > 3750 and pressure <= 6250 
     pressure_rating_100F = 6250
   end

if material_group = "1.3" 
    if temperature >= -20 and temperature <= 100 
        if pressure <= 265 
        flange_class = "150"
        pressure_rating = 265
        temperature_rating = 100
        elsif  pressure > 265 and pressure <= 695 
        flange_class = "300"
        pressure_rating = 695
        temperature_rating = 100
        elsif  pressure > 695 and pressure <= 930 
        flange_class = "400"
        pressure_rating = 930
        temperature_rating = 100
        elsif  pressure > 930 and pressure <= 1395 
        flange_class = "600"
        pressure_rating = 1395
        temperature_rating = 100
        elsif  pressure > 1395 and pressure <= 2090 
        flange_class = "900"
        pressure_rating = 2090
        temperature_rating = 100
        elsif  pressure > 2090 and pressure <= 3480 
        flange_class = "1500"
        pressure_rating = 3480
        temperature_rating = 100
        elsif  pressure > 3480 and pressure <= 5805 
        flange_class = "2500"
        pressure_rating = 5805
        temperature_rating = 100
        end
    elsif temperature > 100 and temperature <= 200 
        if pressure <= 255 
        flange_class = "150"
        pressure_rating = 255
        temperature_rating = 200
        elsif  pressure > 255 and pressure <= 660 
        flange_class = "300"
        pressure_rating = 660
        temperature_rating = 200
        elsif  pressure > 660 and pressure <= 880 
        flange_class = "400"
        pressure_rating = 880
        temperature_rating = 200
        elsif  pressure > 880 and pressure <= 1320 
        flange_class = "600"
        pressure_rating = 1320
        temperature_rating = 200
        elsif  pressure > 1320 and pressure <= 1980 
        flange_class = "900"
        pressure_rating = 1980
        temperature_rating = 200
        elsif  pressure > 1980 and pressure <= 3300 
        flange_class = "1500"
        pressure_rating = 3300
        temperature_rating = 200
        elsif  pressure > 3300 and pressure <= 5505 
        flange_class = "2500"
        pressure_rating = 5505
        temperature_rating = 200
        end
    elsif temperature > 200 and temperature <= 300 
        if pressure <= 230 
        flange_class = "150"
        pressure_rating = 230
        temperature_rating = 300
        elsif  pressure > 230 and pressure <= 640 
        flange_class = "300"
        pressure_rating = 640
        temperature_rating = 300
        elsif  pressure > 640 and pressure <= 850 
        flange_class = "400"
        pressure_rating = 850
        temperature_rating = 300
        elsif  pressure > 850 and pressure <= 1275 
        flange_class = "600"
        pressure_rating = 1275
        temperature_rating = 300
        elsif  pressure > 1275 and pressure <= 1915 
        flange_class = "900"
        pressure_rating = 1915
        temperature_rating = 300
        elsif  pressure > 1915 and pressure <= 3190 
        flange_class = "1500"
        pressure_rating = 3190
        temperature_rating = 300
        elsif  pressure > 3190 and pressure <= 5315 
        flange_class = "2500"
        pressure_rating = 5315
        temperature_rating = 300
        
        end
    elsif temperature > 300 and temperature <= 400 
        if pressure <= 200 
        flange_class = "150"
        pressure_rating = 200
        temperature_rating = 400
        elsif  pressure > 200 and pressure <= 615 
        flange_class = "300"
        pressure_rating = 615
        temperature_rating = 400
        elsif  pressure > 615 and pressure <= 820 
        flange_class = "400"
        pressure_rating = 820
        temperature_rating = 400
        elsif  pressure > 820 and pressure <= 1230 
        flange_class = "600"
        pressure_rating = 1230
        temperature_rating = 400
        elsif  pressure > 1230 and pressure <= 1845 
        flange_class = "900"
        pressure_rating = 1845
        temperature_rating = 400
        elsif  pressure > 1845 and pressure <= 3075 
        flange_class = "1500"
        pressure_rating = 3075
        temperature_rating = 400
        elsif  pressure > 3075 and pressure <= 5125 
        flange_class = "2500"
        pressure_rating = 5125
        temperature_rating = 400
        
        end
    elsif temperature > 400 and temperature <= 500 
        if pressure <= 170 
        flange_class = "150"
        pressure_rating = 170
        temperature_rating = 500
        elsif  pressure > 170 and pressure <= 585 
        flange_class = "300"
        pressure_rating = 585
        temperature_rating = 500
        elsif  pressure > 585 and pressure <= 780 
        flange_class = "400"
        pressure_rating = 780
        temperature_rating = 500
        elsif  pressure > 780 and pressure <= 1175 
        flange_class = "600"
        pressure_rating = 1175
        temperature_rating = 500
        elsif  pressure > 1175 and pressure <= 1760 
        flange_class = "900"
        pressure_rating = 1760
        temperature_rating = 500
        elsif  pressure > 1760 and pressure <= 2930 
        flange_class = "1500"
        pressure_rating = 2930
        temperature_rating = 500
        elsif  pressure > 2930 and pressure <= 4885 
        flange_class = "2500"
        pressure_rating = 4885
        temperature_rating = 500
        
        end
    elsif temperature > 500 and temperature <= 600 
        if pressure <= 140 
        flange_class = "150"
        pressure_rating = 140
        temperature_rating = 600
        elsif  pressure > 140 and pressure <= 550 
        flange_class = "300"
        pressure_rating = 550
        temperature_rating = 600
        elsif  pressure > 550 and pressure <= 735 
        flange_class = "400"
        pressure_rating = 735
        temperature_rating = 600
        elsif  pressure > 735 and pressure <= 1105 
        flange_class = "600"
        pressure_rating = 1105
        temperature_rating = 600
        elsif  pressure > 1105 and pressure <= 1655 
        flange_class = "900"
        pressure_rating = 1655
        temperature_rating = 600
        elsif  pressure > 1655 and pressure <= 2755 
        flange_class = "1500"
        pressure_rating = 2755
        temperature_rating = 600
        elsif  pressure > 2755 and pressure <= 4595 
        flange_class = "2500"
        pressure_rating = 4595
        temperature_rating = 600
        
        end
    elsif temperature > 600 and temperature <= 650 
        if pressure <= 125 
        flange_class = "150"
        pressure_rating = 125
        temperature_rating = 650
        elsif  pressure > 125 and pressure <= 535 
        flange_class = "300"
        pressure_rating = 535
        temperature_rating = 650
        elsif  pressure > 535 and pressure <= 710 
        flange_class = "400"
        pressure_rating = 710
        temperature_rating = 650
        elsif  pressure > 710 and pressure <= 1065 
        flange_class = "600"
        pressure_rating = 1065
        temperature_rating = 650
        elsif  pressure > 1065 and pressure <= 1600 
        flange_class = "900"
        pressure_rating = 1600
        temperature_rating = 650
        elsif  pressure > 1600 and pressure <= 2665 
        flange_class = "1500"
        pressure_rating = 2665
        temperature_rating = 650
        elsif  pressure > 2665 and pressure <= 4440 
        flange_class = "2500"
        pressure_rating = 4440
        temperature_rating = 650
        
        end
    elsif temperature > 650 and temperature <= 700 
        if pressure <= 110 
        flange_class = "150"
        pressure_rating = 110
        temperature_rating = 700
        elsif  pressure > 110 and pressure <= 510 
        flange_class = "300"
        pressure_rating = 510
        temperature_rating = 700
        elsif  pressure > 510 and pressure <= 685 
        flange_class = "400"
        pressure_rating = 685
        temperature_rating = 700
        elsif  pressure > 685 and pressure <= 1025 
        flange_class = "600"
        pressure_rating = 1025
        temperature_rating = 700
        elsif  pressure > 1025 and pressure <= 1535 
        flange_class = "900"
        pressure_rating = 1535
        temperature_rating = 700
        elsif  pressure > 1535 and pressure <= 2560 
        flange_class = "1500"
        pressure_rating = 2560
        temperature_rating = 700
        elsif  pressure > 2560 and pressure <= 4270 
        flange_class = "2500"
        pressure_rating = 4270
        temperature_rating = 700
        
        end
    elsif temperature > 700 and temperature <= 750 
        if pressure <= 95 
        flange_class = "150"
        pressure_rating = 95
        temperature_rating = 750
        elsif  pressure > 95 and pressure <= 475 
        flange_class = "300"
        pressure_rating = 475
        temperature_rating = 750
        elsif  pressure > 475 and pressure <= 635 
        flange_class = "400"
        pressure_rating = 635
        temperature_rating = 750
        elsif  pressure > 635 and pressure <= 955 
        flange_class = "600"
        pressure_rating = 955
        temperature_rating = 750
        elsif  pressure > 955 and pressure <= 1430 
        flange_class = "900"
        pressure_rating = 1430
        temperature_rating = 750
        elsif  pressure > 1430 and pressure <= 2385 
        flange_class = "1500"
        pressure_rating = 2385
        temperature_rating = 750
        elsif  pressure > 2385 and pressure <= 3970 
        flange_class = "2500"
        pressure_rating = 3970
        temperature_rating = 750
        
        end
    elsif temperature > 750 and temperature <= 800 
        if pressure <= 80 
        flange_class = "150"
        pressure_rating = 80
        temperature_rating = 800
        elsif  pressure > 80 and pressure <= 390 
        flange_class = "300"
        pressure_rating = 390
        temperature_rating = 800
        elsif  pressure > 390 and pressure <= 520 
        flange_class = "400"
        pressure_rating = 520
        temperature_rating = 800
        elsif  pressure > 520 and pressure <= 780 
        flange_class = "600"
        pressure_rating = 780
        temperature_rating = 800
        elsif  pressure > 780 and pressure <= 1175 
        flange_class = "900"
        pressure_rating = 1175
        temperature_rating = 800
        elsif  pressure > 1175 and pressure <= 1955 
        flange_class = "1500"
        pressure_rating = 1955
        temperature_rating = 800
        elsif  pressure > 1955 and pressure <= 3255 
        flange_class = "2500"
        pressure_rating = 3255
        temperature_rating = 800
        
        end
    elsif temperature > 800 and temperature <= 850 
        if pressure <= 65 
        flange_class = "150"
        pressure_rating = 65
        temperature_rating = 850
        elsif  pressure > 65 and pressure <= 300 
        flange_class = "300"
        pressure_rating = 300
        temperature_rating = 850
        elsif  pressure > 300 and pressure <= 400 
        flange_class = "400"
        pressure_rating = 400
        temperature_rating = 850
        elsif  pressure > 400 and pressure <= 595 
        flange_class = "600"
        pressure_rating = 595
        temperature_rating = 850
        elsif  pressure > 595 and pressure <= 895 
        flange_class = "900"
        pressure_rating = 895
        temperature_rating = 850
        elsif  pressure > 895 and pressure <= 1490 
        flange_class = "1500"
        pressure_rating = 1490
        temperature_rating = 850
        elsif  pressure > 1490 and pressure <= 2485 
        flange_class = "2500"
        pressure_rating = 2485
        temperature_rating = 850
        
        end
    elsif temperature > 850 and temperature <= 900 
        if pressure <= 50 
        flange_class = "150"
        pressure_rating = 50
        temperature_rating = 900
        elsif  pressure > 50 and pressure <= 200 
        flange_class = "300"
        pressure_rating = 200
        temperature_rating = 900
        elsif  pressure > 200 and pressure <= 270 
        flange_class = "400"
        pressure_rating = 270
        temperature_rating = 900
        elsif  pressure > 270 and pressure <= 405 
        flange_class = "600"
        pressure_rating = 405
        temperature_rating = 900
        elsif  pressure > 405 and pressure <= 605 
        flange_class = "900"
        pressure_rating = 605
        temperature_rating = 900
        elsif  pressure > 605 and pressure <= 1010 
        flange_class = "1500"
        pressure_rating = 1010
        temperature_rating = 900
        elsif  pressure > 1010 and pressure <= 1685 
        flange_class = "2500"
        pressure_rating = 1685
        temperature_rating = 900
        
        end
    elsif temperature > 900 and temperature <= 950 
        if pressure <= 35 
        flange_class = "150"
        pressure_rating = 35
        temperature_rating = 950
        elsif  pressure > 35 and pressure <= 135 
        flange_class = "300"
        pressure_rating = 135
        temperature_rating = 950
        elsif  pressure > 135 and pressure <= 185 
        flange_class = "400"
        pressure_rating = 185
        temperature_rating = 950
        elsif  pressure > 185 and pressure <= 275 
        flange_class = "600"
        pressure_rating = 275
        temperature_rating = 950
        elsif  pressure > 275 and pressure <= 410 
        flange_class = "900"
        pressure_rating = 410
        temperature_rating = 950
        elsif  pressure > 410 and pressure <= 685 
        flange_class = "1500"
        pressure_rating = 685
        temperature_rating = 950
        elsif  pressure > 685 and pressure <= 1145 
        flange_class = "2500"
        pressure_rating = 1145
        temperature_rating = 950
        
        end
    elsif temperature > 950 and temperature <= 1000 
        if pressure <= 20 
        flange_class = "150"
        pressure_rating = 20
        temperature_rating = 1000
        elsif  pressure > 20 and pressure <= 85 
        flange_class = "300"
        pressure_rating = 85
        temperature_rating = 1000
        elsif  pressure > 85 and pressure <= 115 
        flange_class = "400"
        pressure_rating = 115
        temperature_rating = 1000
        elsif  pressure > 115 and pressure <= 170 
        flange_class = "600"
        pressure_rating = 170
        temperature_rating = 1000
        elsif  pressure > 170 and pressure <= 255 
        flange_class = "900"
        pressure_rating = 255
        temperature_rating = 1000
        elsif  pressure > 255 and pressure <= 430 
        flange_class = "1500"
        pressure_rating = 430
        temperature_rating = 1000
        elsif  pressure > 430 and pressure <= 715 
        flange_class = "2500"
        pressure_rating = 715
        temperature_rating = 1000
        end
    end
  end
    
    #if Worksheets("UOM").chkCustomary.Value = True 
    #UserFormLineSegmentDesign.lblNotes = "(1) Upon prolonged exposure to temperatures above 800\B0F, the carbide phase of steel may be converted to graphite. Permissible, but not recommended for prolonged use above 800\B0F." & Chr(13) _
    #& "(2) Not to be used over 850\B0F" & Chr(13) _
    #& "(3) Not to be used over 650\B0F." & Chr(13) _
    #& "(4) Upon prolonged exposure to temperatures above 875\B0F, the carbide phase of steel may be converted to graphite. Permissible, but not recommended for prolonged use above 875\B0F." & Chr(13) _
    #& "(5) Use normalized and tempered material only."
    #elsif orksheets("UOM").chkSI.Value = True 
    #UserFormLineSegmentDesign.lblNotes = "(1) Upon prolonged exposure to temperatures above 425\B0C, the carbide phase of steel may be converted to graphite. Permissible, but not recommended for prolonged use above 425\B0C." & Chr(13) _
    #& "(2) Not to be used over 455\B0C" & Chr(13) _
    #& "(3) Not to be used over 340\B0C." & Chr(13) _
    #& "(4) Upon prolonged exposure to temperatures above 465\B0C, the carbide phase of steel may be converted to graphite. Permissible, but not recommended for prolonged use above 465\B0C." & Chr(13) _
    #& "(5) Use normalized and tempered material only."
    #
    #end
    
if material_group = "1.4" 
    if temperature >= -20 and temperature <= 100 
        if pressure <= 235 
        flange_class = "150"
        pressure_rating = 235
        temperature_rating = 100
        elsif  pressure > 235 and pressure <= 615 
        flange_class = "300"
        pressure_rating = 615
        temperature_rating = 100
        elsif  pressure > 615 and pressure <= 825 
        flange_class = "400"
        pressure_rating = 825
        temperature_rating = 100
        elsif  pressure > 825 and pressure <= 1235 
        flange_class = "600"
        pressure_rating = 1235
        temperature_rating = 100
        elsif  pressure > 1235 and pressure <= 1850 
        flange_class = "900"
        pressure_rating = 1850
        temperature_rating = 100
        elsif  pressure > 1850 and pressure <= 3085 
        flange_class = "1500"
        pressure_rating = 3085
        temperature_rating = 100
        elsif  pressure > 3085 and pressure <= 5145 
        flange_class = "2500"
        pressure_rating = 5145
        temperature_rating = 100
        
        end
    elsif temperature > 100 and temperature <= 200 
        if pressure <= 215 
        flange_class = "150"
        pressure_rating = 215
        temperature_rating = 200
        elsif  pressure > 215 and pressure <= 565 
        flange_class = "300"
        pressure_rating = 565
        temperature_rating = 200
        elsif  pressure > 565 and pressure <= 755 
        flange_class = "400"
        pressure_rating = 755
        temperature_rating = 200
        elsif  pressure > 755 and pressure <= 1130 
        flange_class = "600"
        pressure_rating = 1130
        temperature_rating = 200
        elsif  pressure > 1130 and pressure <= 1695 
        flange_class = "900"
        pressure_rating = 1695
        temperature_rating = 200
        elsif  pressure > 1695 and pressure <= 2830 
        flange_class = "1500"
        pressure_rating = 2830
        temperature_rating = 200
        elsif  pressure > 2830 and pressure <= 4715 
        flange_class = "2500"
        pressure_rating = 4715
        temperature_rating = 200
        
        end
    elsif temperature > 200 and temperature <= 300 
        if pressure <= 210 
        flange_class = "150"
        pressure_rating = 210
        temperature_rating = 300
        elsif  pressure > 210 and pressure <= 545 
        flange_class = "300"
        pressure_rating = 545
        temperature_rating = 300
        elsif  pressure > 545 and pressure <= 725 
        flange_class = "400"
        pressure_rating = 725
        temperature_rating = 300
        elsif  pressure > 725 and pressure <= 1090 
        flange_class = "600"
        pressure_rating = 1090
        temperature_rating = 300
        elsif  pressure > 1090 and pressure <= 1635 
        flange_class = "900"
        pressure_rating = 1635
        temperature_rating = 300
        elsif  pressure > 1635 and pressure <= 2725 
        flange_class = "1500"
        pressure_rating = 2725
        temperature_rating = 300
        elsif  pressure > 2725 and pressure <= 4545 
        flange_class = "2500"
        pressure_rating = 4545
        temperature_rating = 300
        
        end
    elsif temperature > 300 and temperature <= 400 
        if pressure <= 200 
        flange_class = "150"
        pressure_rating = 200
        temperature_rating = 400
        elsif  pressure > 200 and pressure <= 525 
        flange_class = "300"
        pressure_rating = 525
        temperature_rating = 400
        elsif  pressure > 525 and pressure <= 700 
        flange_class = "400"
        pressure_rating = 700
        temperature_rating = 400
        elsif  pressure > 700 and pressure <= 1055 
        flange_class = "600"
        pressure_rating = 1055
        temperature_rating = 400
        elsif  pressure > 1055 and pressure <= 1580 
        flange_class = "900"
        pressure_rating = 1580
        temperature_rating = 400
        elsif  pressure > 1580 and pressure <= 2635 
        flange_class = "1500"
        pressure_rating = 2635
        temperature_rating = 400
        elsif  pressure > 2635 and pressure <= 4390 
        flange_class = "2500"
        pressure_rating = 4390
        temperature_rating = 400
        
        end
    elsif temperature > 400 and temperature <= 500 
        if pressure <= 170 
        flange_class = "150"
        pressure_rating = 170
        temperature_rating = 500
        elsif  pressure > 170 and pressure <= 500 
        flange_class = "300"
        pressure_rating = 500
        temperature_rating = 500
        elsif  pressure > 500 and pressure <= 670 
        flange_class = "400"
        pressure_rating = 670
        temperature_rating = 500
        elsif  pressure > 670 and pressure <= 1005 
        flange_class = "600"
        pressure_rating = 1005
        temperature_rating = 500
        elsif  pressure > 1005 and pressure <= 1505 
        flange_class = "900"
        pressure_rating = 1505
        temperature_rating = 500
        elsif  pressure > 1505 and pressure <= 2510 
        flange_class = "1500"
        pressure_rating = 2510
        temperature_rating = 500
        elsif  pressure > 2510 and pressure <= 4185 
        flange_class = "2500"
        pressure_rating = 4185
        temperature_rating = 500
        
        end
    elsif temperature > 500 and temperature <= 600 
        if pressure <= 140 
        flange_class = "150"
        pressure_rating = 140
        temperature_rating = 600
        elsif  pressure > 140 and pressure <= 475 
        flange_class = "300"
        pressure_rating = 475
        temperature_rating = 600
        elsif  pressure > 475 and pressure <= 630 
        flange_class = "400"
        pressure_rating = 630
        temperature_rating = 600
        elsif  pressure > 630 and pressure <= 945 
        flange_class = "600"
        pressure_rating = 945
        temperature_rating = 600
        elsif  pressure > 945 and pressure <= 1420 
        flange_class = "900"
        pressure_rating = 1420
        temperature_rating = 600
        elsif  pressure > 1420 and pressure <= 2365 
        flange_class = "1500"
        pressure_rating = 2365
        temperature_rating = 600
        elsif  pressure > 2365 and pressure <= 3945 
        flange_class = "2500"
        pressure_rating = 3945
        temperature_rating = 600
        
        end
    elsif temperature > 600 and temperature <= 650 
        if pressure <= 125 
        flange_class = "150"
        pressure_rating = 125
        temperature_rating = 650
        elsif  pressure > 125 and pressure <= 455 
        flange_class = "300"
        pressure_rating = 455
        temperature_rating = 650
        elsif  pressure > 455 and pressure <= 610 
        flange_class = "400"
        pressure_rating = 610
        temperature_rating = 650
        elsif  pressure > 610 and pressure <= 915 
        flange_class = "600"
        pressure_rating = 915
        temperature_rating = 650
        elsif  pressure > 915 and pressure <= 1370 
        flange_class = "900"
        pressure_rating = 1370
        temperature_rating = 650
        elsif  pressure > 1370 and pressure <= 2285 
        flange_class = "1500"
        pressure_rating = 2285
        temperature_rating = 650
        elsif  pressure > 2285 and pressure <= 3805 
        flange_class = "2500"
        pressure_rating = 3805
        temperature_rating = 650
        
        end
    elsif temperature > 650 and temperature <= 700 
        if pressure <= 110 
        flange_class = "150"
        pressure_rating = 110
        temperature_rating = 700
        elsif  pressure > 110 and pressure <= 440 
        flange_class = "300"
        pressure_rating = 440
        temperature_rating = 700
        elsif  pressure > 440 and pressure <= 590 
        flange_class = "400"
        pressure_rating = 590
        temperature_rating = 700
        elsif  pressure > 590 and pressure <= 885 
        flange_class = "600"
        pressure_rating = 885
        temperature_rating = 700
        elsif  pressure > 885 and pressure <= 1325 
        flange_class = "900"
        pressure_rating = 1325
        temperature_rating = 700
        elsif  pressure > 1325 and pressure <= 2210 
        flange_class = "1500"
        pressure_rating = 2210
        temperature_rating = 700
        elsif  pressure > 2210 and pressure <= 3685 
        flange_class = "2500"
        pressure_rating = 3685
        temperature_rating = 700
        
        end
    elsif temperature > 700 and temperature <= 750 
        if pressure <= 95 
        flange_class = "150"
        pressure_rating = 95
        temperature_rating = 750
        elsif  pressure > 95 and pressure <= 430 
        flange_class = "300"
        pressure_rating = 430
        temperature_rating = 750
        elsif  pressure > 430 and pressure <= 570 
        flange_class = "400"
        pressure_rating = 570
        temperature_rating = 750
        elsif  pressure > 570 and pressure <= 855 
        flange_class = "600"
        pressure_rating = 855
        temperature_rating = 750
        elsif  pressure > 855 and pressure <= 1285 
        flange_class = "900"
        pressure_rating = 1285
        temperature_rating = 750
        elsif  pressure > 1285 and pressure <= 2140 
        flange_class = "1500"
        pressure_rating = 2140
        temperature_rating = 750
        elsif  pressure > 2140 and pressure <= 3565 
        flange_class = "2500"
        pressure_rating = 3565
        temperature_rating = 750
        
        end
    elsif temperature > 750 and temperature <= 800 
        if pressure <= 80 
        flange_class = "150"
        pressure_rating = 80
        temperature_rating = 800
        elsif  pressure > 80 and pressure <= 370 
        flange_class = "300"
        pressure_rating = 370
        temperature_rating = 800
        elsif  pressure > 370 and pressure <= 495 
        flange_class = "400"
        pressure_rating = 495
        temperature_rating = 800
        elsif  pressure > 495 and pressure <= 740 
        flange_class = "600"
        pressure_rating = 740
        temperature_rating = 800
        elsif  pressure > 740 and pressure <= 1110 
        flange_class = "900"
        pressure_rating = 1110
        temperature_rating = 800
        elsif  pressure > 1110 and pressure <= 1850 
        flange_class = "1500"
        pressure_rating = 1850
        temperature_rating = 800
        elsif  pressure > 1850 and pressure <= 3085 
        flange_class = "2500"
        pressure_rating = 3085
        temperature_rating = 800
        
        end
    elsif temperature > 800 and temperature <= 850 
        if pressure <= 65 
        flange_class = "150"
        pressure_rating = 65
        temperature_rating = 850
        elsif  pressure > 65 and pressure <= 300 
        flange_class = "300"
        pressure_rating = 300
        temperature_rating = 850
        elsif  pressure > 300 and pressure <= 400 
        flange_class = "400"
        pressure_rating = 400
        temperature_rating = 850
        elsif  pressure > 400 and pressure <= 595 
        flange_class = "600"
        pressure_rating = 595
        temperature_rating = 850
        elsif  pressure > 595 and pressure <= 895 
        flange_class = "900"
        pressure_rating = 895
        temperature_rating = 850
        elsif  pressure > 895 and pressure <= 1490 
        flange_class = "1500"
        pressure_rating = 1490
        temperature_rating = 850
        elsif  pressure > 1490 and pressure <= 2485 
        flange_class = "2500"
        pressure_rating = 2485
        temperature_rating = 850
        
        end
    elsif temperature > 850 and temperature <= 900 
        if pressure <= 50 
        flange_class = "150"
        pressure_rating = 50
        temperature_rating = 900
        elsif  pressure > 50 and pressure <= 170 
        flange_class = "300"
        pressure_rating = 170
        temperature_rating = 900
        elsif  pressure > 170 and pressure <= 230 
        flange_class = "400"
        pressure_rating = 230
        temperature_rating = 900
        elsif  pressure > 230 and pressure <= 345 
        flange_class = "600"
        pressure_rating = 345
        temperature_rating = 900
        elsif  pressure > 345 and pressure <= 515 
        flange_class = "900"
        pressure_rating = 515
        temperature_rating = 900
        elsif  pressure > 515 and pressure <= 855 
        flange_class = "1500"
        pressure_rating = 855
        temperature_rating = 900
        elsif  pressure > 855 and pressure <= 1430 
        flange_class = "2500"
        pressure_rating = 1430
        temperature_rating = 900
        
        end
    elsif temperature > 900 and temperature <= 950 
        if pressure <= 35 
        flange_class = "150"
        pressure_rating = 35
        temperature_rating = 950
        elsif  pressure > 35 and pressure <= 135 
        flange_class = "300"
        pressure_rating = 135
        temperature_rating = 950
        elsif  pressure > 135 and pressure <= 185 
        flange_class = "400"
        pressure_rating = 185
        temperature_rating = 950
        elsif  pressure > 185 and pressure <= 275 
        flange_class = "600"
        pressure_rating = 275
        temperature_rating = 950
        elsif  pressure > 275 and pressure <= 410 
        flange_class = "900"
        pressure_rating = 410
        temperature_rating = 950
        elsif  pressure > 410 and pressure <= 685 
        flange_class = "1500"
        pressure_rating = 685
        temperature_rating = 950
        elsif  pressure > 685 and pressure <= 1145 
        flange_class = "2500"
        pressure_rating = 1145
        temperature_rating = 950
        
        end
    elsif temperature > 950 and temperature <= 1000 
        if pressure <= 20 
        flange_class = "150"
        pressure_rating = 20
        temperature_rating = 1000
        elsif  pressure > 20 and pressure <= 85 
        flange_class = "300"
        pressure_rating = 85
        temperature_rating = 1000
        elsif  pressure > 85 and pressure <= 115 
        flange_class = "400"
        pressure_rating = 115
        temperature_rating = 1000
        elsif  pressure > 115 and pressure <= 170 
        flange_class = "600"
        pressure_rating = 170
        temperature_rating = 1000
        elsif  pressure > 170 and pressure <= 255 
        flange_class = "900"
        pressure_rating = 255
        temperature_rating = 1000
        elsif  pressure > 255 and pressure <= 430 
        flange_class = "1500"
        pressure_rating = 430
        temperature_rating = 1000
        elsif  pressure > 430 and pressure <= 715 
        flange_class = "2500"
        pressure_rating = 715
        temperature_rating = 1000
        
        end
    
    end
    if Worksheets("UOM").chkCustomary.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) Upon prolonged exposure to temperatures above 800\B0F, the carbide phase of steel may be converted to graphite. Permissible, but not recommended for prolonged use above 800\B0F." & Chr(13) _
    & "(2) Not to be used over 850\B0F."
    elsif orksheets("UOM").chkSI.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) Upon prolonged exposure to temperatures above 425\B0C, the carbide phase of steel may be converted to graphite. Permissible, but not recommended for prolonged use above 425\B0C." & Chr(13) _
    & "(2) Not to be used over 455\B0C."
    
    flange_classd if
    pressure_ratingElse
Call FlangePressuretemperature_rating1(pressure, temperature, MaterialGroup, FlangeClass, PressureRating, temperature_rating)
flange_class if

pressure_ratingSub

Sub FlangePressuretemperature_rating1(pressure, temperature, MaterialGroup, FlangeClass, PressureRating, temperature_rating)

if material_group = "1.5" 
    if temperature >= -20 and temperature <= 100 
        if pressure <= 265 
        flange_class = "150"
        pressure_rating = 265
        temperature_rating = 100
        elsif  pressure > 265 and pressure <= 695 
        flange_class = "300"
        pressure_rating = 695
        temperature_rating = 100
        elsif  pressure > 695 and pressure <= 930 
        flange_class = "400"
        pressure_rating = 930
        temperature_rating = 100
        elsif  pressure > 930 and pressure <= 1395 
        flange_class = "600"
        pressure_rating = 1395
        temperature_rating = 100
        elsif  pressure > 1395 and pressure <= 2090 
        flange_class = "900"
        pressure_rating = 2090
        temperature_rating = 100
        elsif  pressure > 2090 and pressure <= 3480 
        flange_class = "1500"
        pressure_rating = 3480
        temperature_rating = 100
        elsif  pressure > 3480 and pressure <= 5805 
        flange_class = "2500"
        pressure_rating = 5805
        temperature_rating = 100
        
        end
    elsif temperature > 100 and temperature <= 200 
        if pressure <= 260 
        flange_class = "150"
        pressure_rating = 260
        temperature_rating = 200
        elsif  pressure > 260 and pressure <= 695 
        flange_class = "300"
        pressure_rating = 695
        temperature_rating = 200
        elsif  pressure > 695 and pressure <= 930 
        flange_class = "400"
        pressure_rating = 930
        temperature_rating = 200
        elsif  pressure > 930 and pressure <= 1395 
        flange_class = "600"
        pressure_rating = 1395
        temperature_rating = 200
        elsif  pressure > 1395 and pressure <= 2090 
        flange_class = "900"
        pressure_rating = 2090
        temperature_rating = 200
        elsif  pressure > 2090 and pressure <= 3480 
        flange_class = "1500"
        pressure_rating = 3480
        temperature_rating = 200
        elsif  pressure > 3480 and pressure <= 5805 
        flange_class = "2500"
        pressure_rating = 5805
        temperature_rating = 200
        
        end
    elsif temperature > 200 and temperature <= 300 
        if pressure <= 230 
        flange_class = "150"
        pressure_rating = 230
        temperature_rating = 300
        elsif  pressure > 230 and pressure <= 685 
        flange_class = "300"
        pressure_rating = 685
        temperature_rating = 300
        elsif  pressure > 685 and pressure <= 915 
        flange_class = "400"
        pressure_rating = 915
        temperature_rating = 300
        elsif  pressure > 915 and pressure <= 1375 
        flange_class = "600"
        pressure_rating = 1375
        temperature_rating = 300
        elsif  pressure > 1375 and pressure <= 2060 
        flange_class = "900"
        pressure_rating = 2060
        temperature_rating = 300
        elsif  pressure > 2060 and pressure <= 3435 
        flange_class = "1500"
        pressure_rating = 3435
        temperature_rating = 300
        elsif  pressure > 3435 and pressure <= 5725 
        flange_class = "2500"
        pressure_rating = 5725
        temperature_rating = 300
        
        end
    elsif temperature > 300 and temperature <= 400 
        if pressure <= 200 
        flange_class = "150"
        pressure_rating = 200
        temperature_rating = 400
        elsif  pressure > 200 and pressure <= 660 
        flange_class = "300"
        pressure_rating = 660
        temperature_rating = 400
        elsif  pressure > 660 and pressure <= 885 
        flange_class = "400"
        pressure_rating = 885
        temperature_rating = 400
        elsif  pressure > 885 and pressure <= 1325 
        flange_class = "600"
        pressure_rating = 1325
        temperature_rating = 400
        elsif  pressure > 1325 and pressure <= 1985 
        flange_class = "900"
        pressure_rating = 1985
        temperature_rating = 400
        elsif  pressure > 1985 and pressure <= 3310 
        flange_class = "1500"
        pressure_rating = 3310
        temperature_rating = 400
        elsif  pressure > 3310 and pressure <= 5520 
        flange_class = "2500"
        pressure_rating = 5520
        temperature_rating = 400
        
        end
    elsif temperature > 400 and temperature <= 500 
        if pressure <= 170 
        flange_class = "150"
        pressure_rating = 170
        temperature_rating = 500
        elsif  pressure > 170 and pressure <= 640 
        flange_class = "300"
        pressure_rating = 640
        temperature_rating = 500
        elsif  pressure > 640 and pressure <= 855 
        flange_class = "400"
        pressure_rating = 855
        temperature_rating = 500
        elsif  pressure > 855 and pressure <= 1285 
        flange_class = "600"
        pressure_rating = 1285
        temperature_rating = 500
        elsif  pressure > 1285 and pressure <= 1925 
        flange_class = "900"
        pressure_rating = 1925
        temperature_rating = 500
        elsif  pressure > 1925 and pressure <= 3210 
        flange_class = "1500"
        pressure_rating = 3210
        temperature_rating = 500
        elsif  pressure > 3210 and pressure <= 5350 
        flange_class = "2500"
        pressure_rating = 5350
        temperature_rating = 500
        
        end
    elsif temperature > 500 and temperature <= 600 
        if pressure <= 140 
        flange_class = "150"
        pressure_rating = 150
        temperature_rating = 600
        elsif  pressure > 140 and pressure <= 605 
        flange_class = "300"
        pressure_rating = 605
        temperature_rating = 600
        elsif  pressure > 605 and pressure <= 805 
        flange_class = "400"
        pressure_rating = 805
        temperature_rating = 600
        elsif  pressure > 805 and pressure <= 1210 
        flange_class = "600"
        pressure_rating = 1210
        temperature_rating = 600
        elsif  pressure > 1210 and pressure <= 1815 
        flange_class = "900"
        pressure_rating = 1815
        temperature_rating = 600
        elsif  pressure > 1815 and pressure <= 3025 
        flange_class = "1500"
        pressure_rating = 3025
        temperature_rating = 600
        elsif  pressure > 3025 and pressure <= 5040 
        flange_class = "2500"
        pressure_rating = 5040
        temperature_rating = 600
        
        end
    elsif temperature > 600 and temperature <= 650 
        if pressure <= 125 
        flange_class = "150"
        pressure_rating = 125
        temperature_rating = 650
        elsif  pressure > 125 and pressure <= 590 
        flange_class = "300"
        pressure_rating = 590
        temperature_rating = 650
        elsif  pressure > 590 and pressure <= 785 
        flange_class = "400"
        pressure_rating = 785
        temperature_rating = 650
        elsif  pressure > 785 and pressure <= 1175 
        flange_class = "600"
        pressure_rating = 1175
        temperature_rating = 650
        elsif  pressure > 1175 and pressure <= 1765 
        flange_class = "900"
        pressure_rating = 1765
        temperature_rating = 650
        elsif  pressure > 1765 and pressure <= 2940 
        flange_class = "1500"
        pressure_rating = 2940
        temperature_rating = 650
        elsif  pressure > 2940 and pressure <= 4905 
        flange_class = "2500"
        pressure_rating = 4905
        temperature_rating = 650
        
        end
    elsif temperature > 650 and temperature <= 700 
        if pressure <= 110 
        flange_class = "150"
        pressure_rating = 110
        temperature_rating = 700
        elsif  pressure > 110 and pressure <= 570 
        flange_class = "300"
        pressure_rating = 570
        temperature_rating = 700
        elsif  pressure > 570 and pressure <= 755 
        flange_class = "400"
        pressure_rating = 755
        temperature_rating = 700
        elsif  pressure > 755 and pressure <= 1135 
        flange_class = "600"
        pressure_rating = 1135
        temperature_rating = 700
        elsif  pressure > 1135 and pressure <= 1705 
        flange_class = "900"
        pressure_rating = 1705
        temperature_rating = 700
        elsif  pressure > 1705 and pressure <= 2840 
        flange_class = "1500"
        pressure_rating = 2840
        temperature_rating = 700
        elsif  pressure > 2840 and pressure <= 4730 
        flange_class = "2500"
        pressure_rating = 4730
        temperature_rating = 700
        
        end
    elsif temperature > 700 and temperature <= 750 
        if pressure <= 95 
        flange_class = "150"
        pressure_rating = 95
        temperature_rating = 750
        elsif  pressure > 95 and pressure <= 530 
        flange_class = "300"
        pressure_rating = 530
        temperature_rating = 750
        elsif  pressure > 530 and pressure <= 710 
        flange_class = "400"
        pressure_rating = 710
        temperature_rating = 750
        elsif  pressure > 710 and pressure <= 1065 
        flange_class = "600"
        pressure_rating = 1065
        temperature_rating = 750
        elsif  pressure > 1065 and pressure <= 1595 
        flange_class = "900"
        pressure_rating = 1595
        temperature_rating = 750
        elsif  pressure > 1595 and pressure <= 2660 
        flange_class = "1500"
        pressure_rating = 2660
        temperature_rating = 750
        elsif  pressure > 2660 and pressure <= 4430 
        flange_class = "2500"
        pressure_rating = 4430
        temperature_rating = 750
        
        end
    elsif temperature > 750 and temperature <= 800 
        if pressure <= 80 
        flange_class = "150"
        pressure_rating = 80
        temperature_rating = 800
        elsif  pressure > 80 and pressure <= 510 
        flange_class = "300"
        pressure_rating = 510
        temperature_rating = 800
        elsif  pressure > 510 and pressure <= 675 
        flange_class = "400"
        pressure_rating = 675
        temperature_rating = 800
        elsif  pressure > 675 and pressure <= 1015 
        flange_class = "600"
        pressure_rating = 1015
        temperature_rating = 800
        elsif  pressure > 1015 and pressure <= 1525 
        flange_class = "900"
        pressure_rating = 1525
        temperature_rating = 800
        elsif  pressure > 1525 and pressure <= 2540 
        flange_class = "1500"
        pressure_rating = 2540
        temperature_rating = 800
        elsif  pressure > 2540 and pressure <= 4230 
        flange_class = "2500"
        pressure_rating = 4230
        temperature_rating = 800
        
        end
    elsif temperature > 800 and temperature <= 850 
        if pressure <= 65 
        flange_class = "150"
        pressure_rating = 65
        temperature_rating = 850
        elsif  pressure > 65 and pressure <= 485 
        flange_class = "300"
        pressure_rating = 485
        temperature_rating = 850
        elsif  pressure > 485 and pressure <= 650 
        flange_class = "400"
        pressure_rating = 650
        temperature_rating = 850
        elsif  pressure > 650 and pressure <= 975 
        flange_class = "600"
        pressure_rating = 975
        temperature_rating = 850
        elsif  pressure > 975 and pressure <= 1460 
        flange_class = "900"
        pressure_rating = 1460
        temperature_rating = 850
        elsif  pressure > 1460 and pressure <= 2435 
        flange_class = "1500"
        pressure_rating = 2435
        temperature_rating = 850
        elsif  pressure > 2435 and pressure <= 4060 
        flange_class = "2500"
        pressure_rating = 4060
        temperature_rating = 850
        
        end
    elsif temperature > 850 and temperature <= 900 
        if pressure <= 50 
        flange_class = "150"
        pressure_rating = 50
        temperature_rating = 900
        elsif  pressure > 50 and pressure <= 450 
        flange_class = "300"
        pressure_rating = 450
        temperature_rating = 900
        elsif  pressure > 450 and pressure <= 600 
        flange_class = "400"
        pressure_rating = 600
        temperature_rating = 900
        elsif  pressure > 600 and pressure <= 900 
        flange_class = "600"
        pressure_rating = 900
        temperature_rating = 900
        elsif  pressure > 900 and pressure <= 1350 
        flange_class = "900"
        pressure_rating = 1350
        temperature_rating = 900
        elsif  pressure > 1350 and pressure <= 2245 
        flange_class = "1500"
        pressure_rating = 2245
        temperature_rating = 900
        elsif  pressure > 2245 and pressure <= 3745 
        flange_class = "2500"
        pressure_rating = 3745
        temperature_rating = 900
        
        end
    elsif temperature > 900 and temperature <= 950 
        if pressure <= 35 
        flange_class = "150"
        pressure_rating = 35
        temperature_rating = 950
        elsif  pressure > 35 and pressure <= 280 
        flange_class = "300"
        pressure_rating = 280
        temperature_rating = 950
        elsif  pressure > 280 and pressure <= 375 
        flange_class = "400"
        pressure_rating = 375
        temperature_rating = 950
        elsif  pressure > 375 and pressure <= 560 
        flange_class = "600"
        pressure_rating = 560
        temperature_rating = 950
        elsif  pressure > 560 and pressure <= 845 
        flange_class = "900"
        pressure_rating = 845
        temperature_rating = 950
        elsif  pressure > 845 and pressure <= 1405 
        flange_class = "1500"
        pressure_rating = 1405
        temperature_rating = 950
        elsif  pressure > 1405 and pressure <= 2345 
        flange_class = "2500"
        pressure_rating = 2345
        temperature_rating = 950
        
        end
    elsif temperature > 950 and temperature <= 1000 
        if pressure <= 20 
        flange_class = "150"
        pressure_rating = 20
        temperature_rating = 1000
        elsif  pressure > 20 and pressure <= 165 
        flange_class = "300"
        pressure_rating = 165
        temperature_rating = 1000
        elsif  pressure > 165 and pressure <= 220 
        flange_class = "400"
        pressure_rating = 220
        temperature_rating = 1000
        elsif  pressure > 220 and pressure <= 330 
        flange_class = "600"
        pressure_rating = 330
        temperature_rating = 1000
        elsif  pressure > 330 and pressure <= 495 
        flange_class = "900"
        pressure_rating = 495
        temperature_rating = 1000
        elsif  pressure > 495 and pressure <= 825 
        flange_class = "1500"
        pressure_rating = 825
        temperature_rating = 1000
        elsif  pressure > 825 and pressure <= 1370 
        flange_class = "2500"
        pressure_rating = 1370
        temperature_rating = 1000
        
        end
    
    end
    
    if Worksheets("UOM").chkCustomary.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) Upon prolonged exposure to temperatures above 875\B0F, the carbide phase of carbon\96molybdenum steel may be converted to graphite. Permissible, but not recommended for prolonged use above 875\B0F."
    elsif orksheets("UOM").chkSI.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) Upon prolonged exposure to temperatures above 465\B0C, the carbide phase of carbon\96molybdenum steel may be converted to graphite. Permissible, but not recommended for prolonged use above 465\B0C."
    
    end
    
elsif material_group = "1.7" 
    if temperature >= -20 and temperature <= 100 
        if pressure <= 290 
        flange_class = "150"
        pressure_rating = 290
        temperature_rating = 100
        elsif  pressure > 290 and pressure <= 750 
        flange_class = "300"
        pressure_rating = 750
        temperature_rating = 100
        elsif  pressure > 750 and pressure <= 1000 
        flange_class = "400"
        pressure_rating = 1000
        temperature_rating = 100
        elsif  pressure > 1000 and pressure <= 1500 
        flange_class = "600"
        pressure_rating = 1500
        temperature_rating = 100
        elsif  pressure > 1500 and pressure <= 2250 
        flange_class = "900"
        pressure_rating = 2250
        temperature_rating = 100
        elsif  pressure > 2250 and pressure <= 3750 
        flange_class = "1500"
        pressure_rating = 3750
        temperature_rating = 100
        elsif  pressure > 3750 and pressure <= 6250 
        flange_class = "2500"
        pressure_rating = 6250
        temperature_rating = 100
        
        end
    elsif temperature > 100 and temperature <= 200 
        if pressure <= 260 
        flange_class = "150"
        pressure_rating = 260
        temperature_rating = 200
        elsif  pressure > 260 and pressure <= 750 
        flange_class = "300"
        pressure_rating = 750
        temperature_rating = 200
        elsif  pressure > 750 and pressure <= 1000 
        flange_class = "400"
        pressure_rating = 1000
        temperature_rating = 200
        elsif  pressure > 1000 and pressure <= 1500 
        flange_class = "600"
        pressure_rating = 1500
        temperature_rating = 200
        elsif  pressure > 1500 and pressure <= 2250 
        flange_class = "900"
        pressure_rating = 2250
        temperature_rating = 200
        elsif  pressure > 2250 and pressure <= 3750 
        flange_class = "1500"
        pressure_rating = 3750
        temperature_rating = 200
        elsif  pressure > 3750 and pressure <= 6250 
        flange_class = "2500"
        pressure_rating = 6250
        temperature_rating = 200
        
        end
    elsif temperature > 200 and temperature <= 300 
        if pressure <= 230 
        flange_class = "150"
        pressure_rating = 230
        temperature_rating = 300
        elsif  pressure > 230 and pressure <= 730 
        flange_class = "300"
        pressure_rating = 730
        temperature_rating = 300
        elsif  pressure > 730 and pressure <= 970 
        flange_class = "400"
        pressure_rating = 970
        temperature_rating = 300
        elsif  pressure > 970 and pressure <= 1455 
        flange_class = "600"
        pressure_rating = 1455
        temperature_rating = 300
        elsif  pressure > 1455 and pressure <= 2185 
        flange_class = "900"
        pressure_rating = 2185
        temperature_rating = 300
        elsif  pressure > 2185 and pressure <= 3640 
        flange_class = "1500"
        pressure_rating = 3640
        temperature_rating = 300
        elsif  pressure > 3640 and pressure <= 6070 
        flange_class = "2500"
        pressure_rating = 6070
        temperature_rating = 300
        
        end
    elsif temperature > 300 and temperature <= 400 
        if pressure <= 200 
        flange_class = "150"
        pressure_rating = 200
        temperature_rating = 400
        elsif  pressure > 200 and pressure <= 705 
        flange_class = "300"
        pressure_rating = 705
        temperature_rating = 400
        elsif  pressure > 705 and pressure <= 940 
        flange_class = "400"
        pressure_rating = 940
        temperature_rating = 400
        elsif  pressure > 940 and pressure <= 1410 
        flange_class = "600"
        pressure_rating = 1410
        temperature_rating = 400
        elsif  pressure > 1410 and pressure <= 2115 
        flange_class = "900"
        pressure_rating = 2115
        temperature_rating = 400
        elsif  pressure > 2115 and pressure <= 3530 
        flange_class = "1500"
        pressure_rating = 3530
        temperature_rating = 400
        elsif  pressure > 3530 and pressure <= 5880 
        flange_class = "2500"
        pressure_rating = 5880
        temperature_rating = 400
        
        end
    elsif temperature > 400 and temperature <= 500 
        if pressure <= 170 
        flange_class = "150"
        pressure_rating = 170
        temperature_rating = 500
        elsif  pressure > 170 and pressure <= 665 
        flange_class = "300"
        pressure_rating = 665
        temperature_rating = 500
        elsif  pressure > 665 and pressure <= 885 
        flange_class = "400"
        pressure_rating = 885
        temperature_rating = 500
        elsif  pressure > 885 and pressure <= 1330 
        flange_class = "600"
        pressure_rating = 1330
        temperature_rating = 500
        elsif  pressure > 1330 and pressure <= 1995 
        flange_class = "900"
        pressure_rating = 1995
        temperature_rating = 500
        elsif  pressure > 1995 and pressure <= 3325 
        flange_class = "1500"
        pressure_rating = 3325
        temperature_rating = 500
        elsif  pressure > 3325 and pressure <= 5540 
        flange_class = "2500"
        pressure_rating = 5540
        temperature_rating = 500
        
        end
    elsif temperature > 500 and temperature <= 600 
        if pressure <= 140 
        flange_class = "150"
        pressure_rating = 150
        temperature_rating = 600
        elsif  pressure > 140 and pressure <= 605 
        flange_class = "300"
        pressure_rating = 605
        temperature_rating = 600
        elsif  pressure > 605 and pressure <= 805 
        flange_class = "400"
        pressure_rating = 805
        temperature_rating = 600
        elsif  pressure > 805 and pressure <= 1210 
        flange_class = "600"
        pressure_rating = 1210
        temperature_rating = 600
        elsif  pressure > 1210 and pressure <= 1815 
        flange_class = "900"
        pressure_rating = 1815
        temperature_rating = 600
        elsif  pressure > 1815 and pressure <= 3025 
        flange_class = "1500"
        pressure_rating = 3025
        temperature_rating = 600
        elsif  pressure > 3025 and pressure <= 5040 
        flange_class = "2500"
        pressure_rating = 5040
        temperature_rating = 600
        
        end
    elsif temperature > 600 and temperature <= 650 
        if pressure <= 125 
        flange_class = "150"
        pressure_rating = 125
        temperature_rating = 650
        elsif  pressure > 125 and pressure <= 590 
        flange_class = "300"
        pressure_rating = 590
        temperature_rating = 650
        elsif  pressure > 590 and pressure <= 785 
        flange_class = "400"
        pressure_rating = 785
        temperature_rating = 650
        elsif  pressure > 785 and pressure <= 1175 
        flange_class = "600"
        pressure_rating = 1175
        temperature_rating = 650
        elsif  pressure > 1175 and pressure <= 1765 
        flange_class = "900"
        pressure_rating = 1765
        temperature_rating = 650
        elsif  pressure > 1765 and pressure <= 2940 
        flange_class = "1500"
        pressure_rating = 2940
        temperature_rating = 650
        elsif  pressure > 2940 and pressure <= 4905 
        flange_class = "2500"
        pressure_rating = 4905
        temperature_rating = 650
        
        end
    elsif temperature > 650 and temperature <= 700 
        if pressure <= 110 
        flange_class = "150"
        pressure_rating = 110
        temperature_rating = 700
        elsif  pressure > 110 and pressure <= 570 
        flange_class = "300"
        pressure_rating = 570
        temperature_rating = 700
        elsif  pressure > 570 and pressure <= 755 
        flange_class = "400"
        pressure_rating = 755
        temperature_rating = 700
        elsif  pressure > 755 and pressure <= 1135 
        flange_class = "600"
        pressure_rating = 1135
        temperature_rating = 700
        elsif  pressure > 1135 and pressure <= 1705 
        flange_class = "900"
        pressure_rating = 1705
        temperature_rating = 700
        elsif  pressure > 1705 and pressure <= 2840 
        flange_class = "1500"
        pressure_rating = 2840
        temperature_rating = 700
        elsif  pressure > 2840 and pressure <= 4730 
        flange_class = "2500"
        pressure_rating = 4730
        temperature_rating = 700
        
        end
    elsif temperature > 700 and temperature <= 750 
        if pressure <= 95 
        flange_class = "150"
        pressure_rating = 95
        temperature_rating = 750
        elsif  pressure > 95 and pressure <= 530 
        flange_class = "300"
        pressure_rating = 530
        temperature_rating = 750
        elsif  pressure > 530 and pressure <= 710 
        flange_class = "400"
        pressure_rating = 710
        temperature_rating = 750
        elsif  pressure > 710 and pressure <= 1065 
        flange_class = "600"
        pressure_rating = 1065
        temperature_rating = 750
        elsif  pressure > 1065 and pressure <= 1595 
        flange_class = "900"
        pressure_rating = 1595
        temperature_rating = 750
        elsif  pressure > 1595 and pressure <= 2660 
        flange_class = "1500"
        pressure_rating = 2660
        temperature_rating = 750
        elsif  pressure > 2660 and pressure <= 4430 
        flange_class = "2500"
        pressure_rating = 4430
        temperature_rating = 750
        
        end
    elsif temperature > 750 and temperature <= 800 
        if pressure <= 80 
        flange_class = "150"
        pressure_rating = 80
        temperature_rating = 800
        elsif  pressure > 80 and pressure <= 510 
        flange_class = "300"
        pressure_rating = 510
        temperature_rating = 800
        elsif  pressure > 510 and pressure <= 675 
        flange_class = "400"
        pressure_rating = 675
        temperature_rating = 800
        elsif  pressure > 675 and pressure <= 1015 
        flange_class = "600"
        pressure_rating = 1015
        temperature_rating = 800
        elsif  pressure > 1015 and pressure <= 1525 
        flange_class = "900"
        pressure_rating = 1525
        temperature_rating = 800
        elsif  pressure > 1525 and pressure <= 2540 
        flange_class = "1500"
        pressure_rating = 2540
        temperature_rating = 800
        elsif  pressure > 2540 and pressure <= 4230 
        flange_class = "2500"
        pressure_rating = 4230
        temperature_rating = 800
        
        end
    elsif temperature > 800 and temperature <= 850 
        if pressure <= 65 
        flange_class = "150"
        pressure_rating = 65
        temperature_rating = 850
        elsif  pressure > 65 and pressure <= 485 
        flange_class = "300"
        pressure_rating = 485
        temperature_rating = 850
        elsif  pressure > 485 and pressure <= 650 
        flange_class = "400"
        pressure_rating = 650
        temperature_rating = 850
        elsif  pressure > 650 and pressure <= 975 
        flange_class = "600"
        pressure_rating = 975
        temperature_rating = 850
        elsif  pressure > 975 and pressure <= 1460 
        flange_class = "900"
        pressure_rating = 1460
        temperature_rating = 850
        elsif  pressure > 1460 and pressure <= 2435 
        flange_class = "1500"
        pressure_rating = 2435
        temperature_rating = 850
        elsif  pressure > 2435 and pressure <= 4060 
        flange_class = "2500"
        pressure_rating = 4060
        temperature_rating = 850
        
        end
    elsif temperature > 850 and temperature <= 900 
        if pressure <= 50 
        flange_class = "150"
        pressure_rating = 50
        temperature_rating = 900
        elsif  pressure > 50 and pressure <= 450 
        flange_class = "300"
        pressure_rating = 450
        temperature_rating = 900
        elsif  pressure > 450 and pressure <= 600 
        flange_class = "400"
        pressure_rating = 600
        temperature_rating = 900
        elsif  pressure > 600 and pressure <= 900 
        flange_class = "600"
        pressure_rating = 900
        temperature_rating = 900
        elsif  pressure > 900 and pressure <= 1350 
        flange_class = "900"
        pressure_rating = 1350
        temperature_rating = 900
        elsif  pressure > 1350 and pressure <= 2245 
        flange_class = "1500"
        pressure_rating = 2245
        temperature_rating = 900
        elsif  pressure > 2245 and pressure <= 3745 
        flange_class = "2500"
        pressure_rating = 3745
        temperature_rating = 900
        
        end
    elsif temperature > 900 and temperature <= 950 
        if pressure <= 35 
        flange_class = "150"
        pressure_rating = 35
        temperature_rating = 950
        elsif  pressure > 35 and pressure <= 315 
        flange_class = "300"
        pressure_rating = 315
        temperature_rating = 950
        elsif  pressure > 315 and pressure <= 420 
        flange_class = "400"
        pressure_rating = 420
        temperature_rating = 950
        elsif  pressure > 420 and pressure <= 630 
        flange_class = "600"
        pressure_rating = 630
        temperature_rating = 950
        elsif  pressure > 630 and pressure <= 945 
        flange_class = "900"
        pressure_rating = 945
        temperature_rating = 950
        elsif  pressure > 945 and pressure <= 1575 
        flange_class = "1500"
        pressure_rating = 1575
        temperature_rating = 950
        elsif  pressure > 1575 and pressure <= 2630 
        flange_class = "2500"
        pressure_rating = 2630
        temperature_rating = 950
        
        end
    elsif temperature > 950 and temperature <= 1000 
        if pressure <= 20 
        flange_class = "150"
        pressure_rating = 20
        temperature_rating = 1000
        elsif  pressure > 20 and pressure <= 200 
        flange_class = "300"
        pressure_rating = 200
        temperature_rating = 1000
        elsif  pressure > 200 and pressure <= 270 
        flange_class = "400"
        pressure_rating = 270
        temperature_rating = 1000
        elsif  pressure > 270 and pressure <= 405 
        flange_class = "600"
        pressure_rating = 405
        temperature_rating = 1000
        elsif  pressure > 405 and pressure <= 605 
        flange_class = "900"
        pressure_rating = 605
        temperature_rating = 1000
        elsif  pressure > 605 and pressure <= 1010 
        flange_class = "1500"
        pressure_rating = 1010
        temperature_rating = 1000
        elsif  pressure > 1010 and pressure <= 1685 
        flange_class = "2500"
        pressure_rating = 1685
        temperature_rating = 1000
        
        end
    elsif temperature > 1000 and temperature <= 1050 
        if pressure > 160 
        flange_class = "300"
        pressure_rating = 160
        temperature_rating = 1200
        elsif  pressure > 160 and pressure <= 210 
        flange_class = "400"
        pressure_rating = 210
        temperature_rating = 1200
        elsif  pressure > 210 and pressure <= 315 
        flange_class = "600"
        pressure_rating = 315
        temperature_rating = 1200
        elsif  pressure > 315 and pressure <= 475 
        flange_class = "900"
        pressure_rating = 475
        temperature_rating = 1200
        elsif  pressure > 475 and pressure <= 790 
        flange_class = "1500"
        pressure_rating = 790
        temperature_rating = 1200
        elsif  pressure > 790 and pressure <= 1315 
        flange_class = "2500"
        pressure_rating = 1315
        temperature_rating = 1200
        
        end
    
    end
    
    if Worksheets("UOM").chkCustomary.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) Not to be used over 1000\B0F." & Chr(13) _
    & "(2) Use normalized and tempered material only."
    elsif orksheets("UOM").chkSI.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) Not to be used over 538\B0C." & Chr(13) _
    & "(2) Use normalized and tempered material only."
    
    end
    
elsif material_group = "1.9" 
UserFormLineSegmentDesign.cmbMaterialDesignation.RowSource = "MaterialGroup1.9"
    if temperature >= -20 and temperature <= 100 
        if pressure <= 290 
        flange_class = "150"
        pressure_rating = 290
        temperature_rating = 100
        elsif  pressure > 290 and pressure <= 750 
        flange_class = "300"
        pressure_rating = 750
        temperature_rating = 100
        elsif  pressure > 750 and pressure <= 1000 
        flange_class = "400"
        pressure_rating = 1000
        temperature_rating = 100
        elsif  pressure > 1000 and pressure <= 1500 
        flange_class = "600"
        pressure_rating = 1500
        temperature_rating = 100
        elsif  pressure > 1500 and pressure <= 2250 
        flange_class = "900"
        pressure_rating = 2250
        temperature_rating = 100
        elsif  pressure > 2250 and pressure <= 3750 
        flange_class = "1500"
        pressure_rating = 3750
        temperature_rating = 100
        elsif  pressure > 3750 and pressure <= 6250 
        flange_class = "2500"
        pressure_rating = 6250
        temperature_rating = 100
        
        end
    elsif temperature > 100 and temperature <= 200 
        if pressure <= 260 
        flange_class = "150"
        pressure_rating = 260
        temperature_rating = 200
        elsif  pressure > 260 and pressure <= 750 
        flange_class = "300"
        pressure_rating = 750
        temperature_rating = 200
        elsif  pressure > 750 and pressure <= 1000 
        flange_class = "400"
        pressure_rating = 1000
        temperature_rating = 200
        elsif  pressure > 1000 and pressure <= 1500 
        flange_class = "600"
        pressure_rating = 1500
        temperature_rating = 200
        elsif  pressure > 1500 and pressure <= 2250 
        flange_class = "900"
        pressure_rating = 2250
        temperature_rating = 200
        elsif  pressure > 2250 and pressure <= 3750 
        flange_class = "1500"
        pressure_rating = 3750
        temperature_rating = 200
        elsif  pressure > 3750 and pressure <= 6250 
        flange_class = "2500"
        pressure_rating = 6250
        temperature_rating = 200
        
        end
    elsif temperature > 200 and temperature <= 300 
        if pressure <= 230 
        flange_class = "150"
        pressure_rating = 230
        temperature_rating = 300
        elsif  pressure > 230 and pressure <= 720 
        flange_class = "300"
        pressure_rating = 720
        temperature_rating = 300
        elsif  pressure > 720 and pressure <= 965 
        flange_class = "400"
        pressure_rating = 965
        temperature_rating = 300
        elsif  pressure > 965 and pressure <= 1445 
        flange_class = "600"
        pressure_rating = 1445
        temperature_rating = 300
        elsif  pressure > 1445 and pressure <= 2165 
        flange_class = "900"
        pressure_rating = 2165
        temperature_rating = 300
        elsif  pressure > 2165 and pressure <= 3610 
        flange_class = "1500"
        pressure_rating = 3610
        temperature_rating = 300
        elsif  pressure > 3610 and pressure <= 6015 
        flange_class = "2500"
        pressure_rating = 6015
        temperature_rating = 300
        
        end
    elsif temperature > 300 and temperature <= 400 
        if pressure <= 200 
        flange_class = "150"
        pressure_rating = 200
        temperature_rating = 400
        elsif  pressure > 200 and pressure <= 695 
        flange_class = "300"
        pressure_rating = 695
        temperature_rating = 400
        elsif  pressure > 695 and pressure <= 925 
        flange_class = "400"
        pressure_rating = 925
        temperature_rating = 400
        elsif  pressure > 925 and pressure <= 1385 
        flange_class = "600"
        pressure_rating = 1385
        temperature_rating = 400
        elsif  pressure > 1385 and pressure <= 2080 
        flange_class = "900"
        pressure_rating = 2080
        temperature_rating = 400
        elsif  pressure > 2080 and pressure <= 3465 
        flange_class = "1500"
        pressure_rating = 3465
        temperature_rating = 400
        elsif  pressure > 3465 and pressure <= 5775 
        flange_class = "2500"
        pressure_rating = 5775
        temperature_rating = 400
        
        end
    elsif temperature > 400 and temperature <= 500 
        if pressure <= 170 
        flange_class = "150"
        pressure_rating = 170
        temperature_rating = 500
        elsif  pressure > 170 and pressure <= 665 
        flange_class = "300"
        pressure_rating = 665
        temperature_rating = 500
        elsif  pressure > 665 and pressure <= 885 
        flange_class = "400"
        pressure_rating = 885
        temperature_rating = 500
        elsif  pressure > 885 and pressure <= 1330 
        flange_class = "600"
        pressure_rating = 1330
        temperature_rating = 500
        elsif  pressure > 1330 and pressure <= 1995 
        flange_class = "900"
        pressure_rating = 1995
        temperature_rating = 500
        elsif  pressure > 1995 and pressure <= 3325 
        flange_class = "1500"
        pressure_rating = 3325
        temperature_rating = 500
        elsif  pressure > 3325 and pressure <= 5540 
        flange_class = "2500"
        pressure_rating = 5540
        temperature_rating = 500
        
        end
    elsif temperature > 500 and temperature <= 600 
        if pressure <= 140 
        flange_class = "150"
        pressure_rating = 140
        temperature_rating = 600
        elsif  pressure > 140 and pressure <= 605 
        flange_class = "300"
        pressure_rating = 605
        temperature_rating = 600
        elsif  pressure > 605 and pressure <= 805 
        flange_class = "400"
        pressure_rating = 805
        temperature_rating = 600
        elsif  pressure > 805 and pressure <= 1210 
        flange_class = "600"
        pressure_rating = 1210
        temperature_rating = 600
        elsif  pressure > 1210 and pressure <= 1815 
        flange_class = "900"
        pressure_rating = 1815
        temperature_rating = 600
        elsif  pressure > 1815 and pressure <= 3025 
        flange_class = "1500"
        pressure_rating = 3025
        temperature_rating = 600
        elsif  pressure > 3025 and pressure <= 5040 
        flange_class = "2500"
        pressure_rating = 5040
        temperature_rating = 600
        
        end
    elsif temperature > 600 and temperature <= 650 
        if pressure <= 125 
        flange_class = "150"
        pressure_rating = 125
        temperature_rating = 650
        elsif  pressure > 125 and pressure <= 590 
        flange_class = "300"
        pressure_rating = 590
        temperature_rating = 650
        elsif  pressure > 590 and pressure <= 785 
        flange_class = "400"
        pressure_rating = 785
        temperature_rating = 650
        elsif  pressure > 785 and pressure <= 1175 
        flange_class = "600"
        pressure_rating = 1175
        temperature_rating = 650
        elsif  pressure > 1175 and pressure <= 1765 
        flange_class = "900"
        pressure_rating = 1765
        temperature_rating = 650
        elsif  pressure > 1765 and pressure <= 2940 
        flange_class = "1500"
        pressure_rating = 2940
        temperature_rating = 650
        elsif  pressure > 2940 and pressure <= 4905 
        flange_class = "2500"
        pressure_rating = 4905
        temperature_rating = 650
        
        end
    elsif temperature > 650 and temperature <= 700 
        if pressure <= 110 
        flange_class = "150"
        pressure_rating = 110
        temperature_rating = 700
        elsif  pressure > 110 and pressure <= 570 
        flange_class = "300"
        pressure_rating = 570
        temperature_rating = 700
        elsif  pressure > 570 and pressure <= 755 
        flange_class = "400"
        pressure_rating = 755
        temperature_rating = 700
        elsif  pressure > 755 and pressure <= 1135 
        flange_class = "600"
        pressure_rating = 1135
        temperature_rating = 700
        elsif  pressure > 1135 and pressure <= 1705 
        flange_class = "900"
        pressure_rating = 1705
        temperature_rating = 700
        elsif  pressure > 1705 and pressure <= 2840 
        flange_class = "1500"
        pressure_rating = 2840
        temperature_rating = 700
        elsif  pressure > 2840 and pressure <= 4730 
        flange_class = "2500"
        pressure_rating = 4730
        temperature_rating = 700
        
        end
    elsif temperature > 700 and temperature <= 750 
        if pressure <= 95 
        flange_class = "150"
        pressure_rating = 95
        temperature_rating = 750
        elsif  pressure > 95 and pressure <= 530 
        flange_class = "300"
        pressure_rating = 530
        temperature_rating = 750
        elsif  pressure > 530 and pressure <= 710 
        flange_class = "400"
        pressure_rating = 710
        temperature_rating = 750
        elsif  pressure > 710 and pressure <= 1065 
        flange_class = "600"
        pressure_rating = 1065
        temperature_rating = 750
        elsif  pressure > 1065 and pressure <= 1595 
        flange_class = "900"
        pressure_rating = 1595
        temperature_rating = 750
        elsif  pressure > 1595 and pressure <= 2660 
        flange_class = "1500"
        pressure_rating = 2660
        temperature_rating = 750
        elsif  pressure > 2660 and pressure <= 4430 
        flange_class = "2500"
        pressure_rating = 4430
        temperature_rating = 750
        
        end
    elsif temperature > 750 and temperature <= 800 
        if pressure <= 80 
        flange_class = "150"
        pressure_rating = 80
        temperature_rating = 800
        elsif  pressure > 80 and pressure <= 510 
        flange_class = "300"
        pressure_rating = 510
        temperature_rating = 800
        elsif  pressure > 510 and pressure <= 675 
        flange_class = "400"
        pressure_rating = 675
        temperature_rating = 800
        elsif  pressure > 675 and pressure <= 1015 
        flange_class = "600"
        pressure_rating = 1015
        temperature_rating = 800
        elsif  pressure > 1015 and pressure <= 1525 
        flange_class = "900"
        pressure_rating = 1525
        temperature_rating = 800
        elsif  pressure > 1525 and pressure <= 2540 
        flange_class = "1500"
        pressure_rating = 2540
        temperature_rating = 800
        elsif  pressure > 2540 and pressure <= 4230 
        flange_class = "2500"
        pressure_rating = 4230
        temperature_rating = 800
        
        end
    elsif temperature > 800 and temperature <= 850 
        if pressure <= 65 
        flange_class = "150"
        pressure_rating = 65
        temperature_rating = 850
        elsif  pressure > 65 and pressure <= 485 
        flange_class = "300"
        pressure_rating = 485
        temperature_rating = 850
        elsif  pressure > 485 and pressure <= 650 
        flange_class = "400"
        pressure_rating = 650
        temperature_rating = 850
        elsif  pressure > 650 and pressure <= 975 
        flange_class = "600"
        pressure_rating = 975
        temperature_rating = 850
        elsif  pressure > 975 and pressure <= 1460 
        flange_class = "900"
        pressure_rating = 1460
        temperature_rating = 850
        elsif  pressure > 1460 and pressure <= 2435 
        flange_class = "1500"
        pressure_rating = 2435
        temperature_rating = 850
        elsif  pressure > 2435 and pressure <= 4060 
        flange_class = "2500"
        pressure_rating = 4060
        temperature_rating = 850
        
        end
    elsif temperature > 850 and temperature <= 900 
        if pressure <= 50 
        flange_class = "150"
        pressure_rating = 50
        temperature_rating = 900
        elsif  pressure > 50 and pressure <= 450 
        flange_class = "300"
        pressure_rating = 450
        temperature_rating = 900
        elsif  pressure > 450 and pressure <= 600 
        flange_class = "400"
        pressure_rating = 600
        temperature_rating = 900
        elsif  pressure > 600 and pressure <= 900 
        flange_class = "600"
        pressure_rating = 900
        temperature_rating = 900
        elsif  pressure > 900 and pressure <= 1350 
        flange_class = "900"
        pressure_rating = 1350
        temperature_rating = 900
        elsif  pressure > 1350 and pressure <= 2245 
        flange_class = "1500"
        pressure_rating = 2245
        temperature_rating = 900
        elsif  pressure > 2245 and pressure <= 3745 
        flange_class = "2500"
        pressure_rating = 3745
        temperature_rating = 900
        
        end
    elsif temperature > 900 and temperature <= 950 
        if pressure <= 35 
        flange_class = "150"
        pressure_rating = 35
        temperature_rating = 950
        elsif  pressure > 35 and pressure <= 320 
        flange_class = "300"
        pressure_rating = 320
        temperature_rating = 950
        elsif  pressure > 320 and pressure <= 425 
        flange_class = "400"
        pressure_rating = 425
        temperature_rating = 950
        elsif  pressure > 425 and pressure <= 640 
        flange_class = "600"
        pressure_rating = 640
        temperature_rating = 950
        elsif  pressure > 640 and pressure <= 955 
        flange_class = "900"
        pressure_rating = 955
        temperature_rating = 950
        elsif  pressure > 955 and pressure <= 1595 
        flange_class = "1500"
        pressure_rating = 1595
        temperature_rating = 950
        elsif  pressure > 1595 and pressure <= 2655 
        flange_class = "2500"
        pressure_rating = 2655
        temperature_rating = 950
        
        end
    elsif temperature > 950 and temperature <= 1000 
        if pressure <= 20 
        flange_class = "150"
        pressure_rating = 20
        temperature_rating = 1000
        elsif  pressure > 20 and pressure <= 215 
        flange_class = "300"
        pressure_rating = 215
        temperature_rating = 1000
        elsif  pressure > 215 and pressure <= 290 
        flange_class = "400"
        pressure_rating = 290
        temperature_rating = 1000
        elsif  pressure > 290 and pressure <= 430 
        flange_class = "600"
        pressure_rating = 430
        temperature_rating = 1000
        elsif  pressure > 430 and pressure <= 650 
        flange_class = "900"
        pressure_rating = 650
        temperature_rating = 1000
        elsif  pressure > 650 and pressure <= 1080 
        flange_class = "1500"
        pressure_rating = 1080
        temperature_rating = 1000
        elsif  pressure > 1080 and pressure <= 1800 
        flange_class = "2500"
        pressure_rating = 1800
        temperature_rating = 1000
        
        end
    elsif temperature > 1000 and temperature <= 1050 
        if pressure > 145 
        flange_class = "300"
        pressure_rating = 145
        temperature_rating = 1050
        elsif  pressure > 145 and pressure <= 190 
        flange_class = "400"
        pressure_rating = 190
        temperature_rating = 1050
        elsif  pressure > 190 and pressure <= 290 
        flange_class = "600"
        pressure_rating = 290
        temperature_rating = 1050
        elsif  pressure > 290 and pressure <= 430 
        flange_class = "900"
        pressure_rating = 430
        temperature_rating = 1050
        elsif  pressure > 430 and pressure <= 720 
        flange_class = "1500"
        pressure_rating = 720
        temperature_rating = 1050
        elsif  pressure > 720 and pressure <= 1200 
        flange_class = "2500"
        pressure_rating = 1200
        temperature_rating = 1050
        
        end
    elsif temperature > 1050 and temperature <= 1100 
        if pressure > 95 
        flange_class = "300"
        pressure_rating = 95
        temperature_rating = 1050
        elsif  pressure > 95 and pressure <= 130 
        flange_class = "400"
        pressure_rating = 130
        temperature_rating = 1050
        elsif  pressure > 130 and pressure <= 190 
        flange_class = "600"
        pressure_rating = 190
        temperature_rating = 1050
        elsif  pressure > 190 and pressure <= 290 
        flange_class = "900"
        pressure_rating = 290
        temperature_rating = 1050
        elsif  pressure > 290 and pressure <= 480 
        flange_class = "1500"
        pressure_rating = 480
        temperature_rating = 1050
        elsif  pressure > 480 and pressure <= 800 
        flange_class = "2500"
        pressure_rating = 800
        temperature_rating = 1050
        
        end
    elsif temperature > 1100 and temperature <= 1150 
        if pressure > 65 
        flange_class = "300"
        pressure_rating = 65
        temperature_rating = 1050
        elsif  pressure > 65 and pressure <= 85 
        flange_class = "400"
        pressure_rating = 85
        temperature_rating = 1050
        elsif  pressure > 85 and pressure <= 130 
        flange_class = "600"
        pressure_rating = 130
        temperature_rating = 1050
        elsif  pressure > 130 and pressure <= 195 
        flange_class = "900"
        pressure_rating = 195
        temperature_rating = 1050
        elsif  pressure > 195 and pressure <= 325 
        flange_class = "1500"
        pressure_rating = 325
        temperature_rating = 1050
        elsif  pressure > 325 and pressure <= 545 
        flange_class = "2500"
        pressure_rating = 545
        temperature_rating = 1050
        
        end
    elsif temperature > 1150 and temperature <= 1200 
        if pressure > 40 
        flange_class = "300"
        pressure_rating = 40
        temperature_rating = 1200
        elsif  pressure > 40 and pressure <= 55 
        flange_class = "400"
        pressure_rating = 55
        temperature_rating = 1200
        elsif  pressure > 55 and pressure <= 80 
        flange_class = "600"
        pressure_rating = 80
        temperature_rating = 1200
        elsif  pressure > 80 and pressure <= 125 
        flange_class = "900"
        pressure_rating = 125
        temperature_rating = 1200
        elsif  pressure > 125 and pressure <= 205 
        flange_class = "1500"
        pressure_rating = 205
        temperature_rating = 1200
        elsif  pressure > 205 and pressure <= 345 
        flange_class = "2500"
        pressure_rating = 345
        temperature_rating = 1200
        
        end
    
    end

    if Worksheets("UOM").chkCustomary.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) Use normalized and tempered material only." & Chr(13) _
    & "(2) Permissible, but not recommended for prolonged use above 1100\B0F." & Chr(13) _
    & "(3) Not to be used over 1100\B0F."
    elsif orksheets("UOM").chkSI.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) Use normalized and tempered material only." & Chr(13) _
    & "(2) Permissible, but not recommended for prolonged use above 590\B0C." & Chr(13) _
    & "(3) Not to be used over 590\B0C."
    
    end
    
elsif material_group = "1.10" 
UserFormLineSegmentDesign.cmbMaterialDesignation.RowSource = "MaterialGroup1.10"
    if temperature >= -20 and temperature <= 100 
        if pressure <= 290 
        flange_class = "150"
        pressure_rating = 290
        temperature_rating = 100
        elsif  pressure > 290 and pressure <= 750 
        flange_class = "300"
        pressure_rating = 750
        temperature_rating = 100
        elsif  pressure > 750 and pressure <= 1000 
        flange_class = "400"
        pressure_rating = 1000
        temperature_rating = 100
        elsif  pressure > 1000 and pressure <= 1500 
        flange_class = "600"
        pressure_rating = 1500
        temperature_rating = 100
        elsif  pressure > 1500 and pressure <= 2250 
        flange_class = "900"
        pressure_rating = 2250
        temperature_rating = 100
        elsif  pressure > 2250 and pressure <= 3750 
        flange_class = "1500"
        pressure_rating = 3750
        temperature_rating = 100
        elsif  pressure > 3750 and pressure <= 6250 
        flange_class = "2500"
        pressure_rating = 6250
        temperature_rating = 100
        
        end
    elsif temperature > 100 and temperature <= 200 
        if pressure <= 260 
        flange_class = "150"
        pressure_rating = 260
        temperature_rating = 200
        elsif  pressure > 260 and pressure <= 750 
        flange_class = "300"
        pressure_rating = 750
        temperature_rating = 200
        elsif  pressure > 750 and pressure <= 1000 
        flange_class = "400"
        pressure_rating = 1000
        temperature_rating = 200
        elsif  pressure > 1000 and pressure <= 1500 
        flange_class = "600"
        pressure_rating = 1500
        temperature_rating = 200
        elsif  pressure > 1500 and pressure <= 2250 
        flange_class = "900"
        pressure_rating = 2250
        temperature_rating = 200
        elsif  pressure > 2250 and pressure <= 3750 
        flange_class = "1500"
        pressure_rating = 3750
        temperature_rating = 200
        elsif  pressure > 3750 and pressure <= 6250 
        flange_class = "2500"
        pressure_rating = 6250
        temperature_rating = 200
        
        end
    elsif temperature > 200 and temperature <= 300 
        if pressure <= 230 
        flange_class = "150"
        pressure_rating = 230
        temperature_rating = 300
        elsif  pressure > 230 and pressure <= 730 
        flange_class = "300"
        pressure_rating = 730
        temperature_rating = 300
        elsif  pressure > 730 and pressure <= 970 
        flange_class = "400"
        pressure_rating = 970
        temperature_rating = 300
        elsif  pressure > 970 and pressure <= 1455 
        flange_class = "600"
        pressure_rating = 1455
        temperature_rating = 300
        elsif  pressure > 1455 and pressure <= 2185 
        flange_class = "900"
        pressure_rating = 2185
        temperature_rating = 300
        elsif  pressure > 2185 and pressure <= 3640 
        flange_class = "1500"
        pressure_rating = 3640
        temperature_rating = 300
        elsif  pressure > 3640 and pressure <= 6070 
        flange_class = "2500"
        pressure_rating = 6070
        temperature_rating = 300
        
        end
    elsif temperature > 300 and temperature <= 400 
        if pressure <= 200 
        flange_class = "150"
        pressure_rating = 200
        temperature_rating = 400
        elsif  pressure > 200 and pressure <= 705 
        flange_class = "300"
        pressure_rating = 705
        temperature_rating = 400
        elsif  pressure > 705 and pressure <= 940 
        flange_class = "400"
        pressure_rating = 940
        temperature_rating = 400
        elsif  pressure > 940 and pressure <= 1410 
        flange_class = "600"
        pressure_rating = 1410
        temperature_rating = 400
        elsif  pressure > 1410 and pressure <= 2151 
        flange_class = "900"
        pressure_rating = 2151
        temperature_rating = 400
        elsif  pressure > 2151 and pressure <= 3530 
        flange_class = "1500"
        pressure_rating = 3530
        temperature_rating = 400
        elsif  pressure > 3530 and pressure <= 5880 
        flange_class = "2500"
        pressure_rating = 5880
        temperature_rating = 400
        
        end
    elsif temperature > 400 and temperature <= 500 
        if pressure <= 170 
        flange_class = "150"
        pressure_rating = 170
        temperature_rating = 500
        elsif  pressure > 170 and pressure <= 665 
        flange_class = "300"
        pressure_rating = 665
        temperature_rating = 500
        elsif  pressure > 665 and pressure <= 885 
        flange_class = "400"
        pressure_rating = 885
        temperature_rating = 500
        elsif  pressure > 885 and pressure <= 1330 
        flange_class = "600"
        pressure_rating = 1330
        temperature_rating = 500
        elsif  pressure > 1330 and pressure <= 1995 
        flange_class = "900"
        pressure_rating = 1995
        temperature_rating = 500
        elsif  pressure > 1995 and pressure <= 3325 
        flange_class = "1500"
        pressure_rating = 3325
        temperature_rating = 500
        elsif  pressure > 3325 and pressure <= 5540 
        flange_class = "2500"
        pressure_rating = 5540
        temperature_rating = 500
        
        end
    elsif temperature > 500 and temperature <= 600 
        if pressure <= 140 
        flange_class = "150"
        pressure_rating = 140
        temperature_rating = 600
        elsif  pressure > 140 and pressure <= 605 
        flange_class = "300"
        pressure_rating = 605
        temperature_rating = 600
        elsif  pressure > 605 and pressure <= 805 
        flange_class = "400"
        pressure_rating = 805
        temperature_rating = 600
        elsif  pressure > 805 and pressure <= 1210 
        flange_class = "600"
        pressure_rating = 1210
        temperature_rating = 600
        elsif  pressure > 1210 and pressure <= 1815 
        flange_class = "900"
        pressure_rating = 1815
        temperature_rating = 600
        elsif  pressure > 1815 and pressure <= 3025 
        flange_class = "1500"
        pressure_rating = 3025
        temperature_rating = 600
        elsif  pressure > 3025 and pressure <= 5040 
        flange_class = "2500"
        pressure_rating = 5040
        temperature_rating = 600
        
        end
    elsif temperature > 600 and temperature <= 650 
        if pressure <= 125 
        flange_class = "150"
        pressure_rating = 125
        temperature_rating = 650
        elsif  pressure > 125 and pressure <= 590 
        flange_class = "300"
        pressure_rating = 590
        temperature_rating = 650
        elsif  pressure > 590 and pressure <= 785 
        flange_class = "400"
        pressure_rating = 785
        temperature_rating = 650
        elsif  pressure > 785 and pressure <= 1175 
        flange_class = "600"
        pressure_rating = 1175
        temperature_rating = 650
        elsif  pressure > 1175 and pressure <= 1765 
        flange_class = "900"
        pressure_rating = 1765
        temperature_rating = 650
        elsif  pressure > 1765 and pressure <= 2940 
        flange_class = "1500"
        pressure_rating = 2940
        temperature_rating = 650
        elsif  pressure > 2940 and pressure <= 4905 
        flange_class = "2500"
        pressure_rating = 4905
        temperature_rating = 650
        
        end
    elsif temperature > 650 and temperature <= 700 
        if pressure <= 110 
        flange_class = "150"
        pressure_rating = 110
        temperature_rating = 700
        elsif  pressure > 110 and pressure <= 570 
        flange_class = "300"
        pressure_rating = 570
        temperature_rating = 700
        elsif  pressure > 570 and pressure <= 755 
        flange_class = "400"
        pressure_rating = 755
        temperature_rating = 700
        elsif  pressure > 755 and pressure <= 1135 
        flange_class = "600"
        pressure_rating = 1135
        temperature_rating = 700
        elsif  pressure > 1135 and pressure <= 1705 
        flange_class = "900"
        pressure_rating = 1705
        temperature_rating = 700
        elsif  pressure > 1705 and pressure <= 2840 
        flange_class = "1500"
        pressure_rating = 2840
        temperature_rating = 700
        elsif  pressure > 2840 and pressure <= 4730 
        flange_class = "2500"
        pressure_rating = 4730
        temperature_rating = 700
        
        end
    elsif temperature > 700 and temperature <= 750 
        if pressure <= 95 
        flange_class = "150"
        pressure_rating = 95
        temperature_rating = 750
        elsif  pressure > 95 and pressure <= 530 
        flange_class = "300"
        pressure_rating = 530
        temperature_rating = 750
        elsif  pressure > 530 and pressure <= 710 
        flange_class = "400"
        pressure_rating = 710
        temperature_rating = 750
        elsif  pressure > 710 and pressure <= 1065 
        flange_class = "600"
        pressure_rating = 1065
        temperature_rating = 750
        elsif  pressure > 1065 and pressure <= 1595 
        flange_class = "900"
        pressure_rating = 1595
        temperature_rating = 750
        elsif  pressure > 1595 and pressure <= 2660 
        flange_class = "1500"
        pressure_rating = 2660
        temperature_rating = 750
        elsif  pressure > 2660 and pressure <= 4430 
        flange_class = "2500"
        pressure_rating = 4430
        temperature_rating = 750
        
        end
    elsif temperature > 750 and temperature <= 800 
        if pressure <= 80 
        flange_class = "150"
        pressure_rating = 80
        temperature_rating = 800
        elsif  pressure > 80 and pressure <= 510 
        flange_class = "300"
        pressure_rating = 510
        temperature_rating = 800
        elsif  pressure > 510 and pressure <= 675 
        flange_class = "400"
        pressure_rating = 675
        temperature_rating = 800
        elsif  pressure > 675 and pressure <= 1015 
        flange_class = "600"
        pressure_rating = 1015
        temperature_rating = 800
        elsif  pressure > 1015 and pressure <= 1525 
        flange_class = "900"
        pressure_rating = 1525
        temperature_rating = 800
        elsif  pressure > 1525 and pressure <= 2540 
        flange_class = "1500"
        pressure_rating = 2540
        temperature_rating = 800
        elsif  pressure > 2540 and pressure <= 4230 
        flange_class = "2500"
        pressure_rating = 4230
        temperature_rating = 800
        
        end
    elsif temperature > 800 and temperature <= 850 
        if pressure <= 65 
        flange_class = "150"
        pressure_rating = 65
        temperature_rating = 850
        elsif  pressure > 65 and pressure <= 485 
        flange_class = "300"
        pressure_rating = 485
        temperature_rating = 850
        elsif  pressure > 485 and pressure <= 650 
        flange_class = "400"
        pressure_rating = 650
        temperature_rating = 850
        elsif  pressure > 650 and pressure <= 975 
        flange_class = "600"
        pressure_rating = 975
        temperature_rating = 850
        elsif  pressure > 975 and pressure <= 1460 
        flange_class = "900"
        pressure_rating = 1460
        temperature_rating = 850
        elsif  pressure > 1460 and pressure <= 2435 
        flange_class = "1500"
        pressure_rating = 2435
        temperature_rating = 850
        elsif  pressure > 2435 and pressure <= 4060 
        flange_class = "2500"
        pressure_rating = 4060
        temperature_rating = 850
        
        end
    elsif temperature > 850 and temperature <= 900 
        if pressure <= 50 
        flange_class = "150"
        pressure_rating = 50
        temperature_rating = 900
        elsif  pressure > 50 and pressure <= 450 
        flange_class = "300"
        pressure_rating = 450
        temperature_rating = 900
        elsif  pressure > 450 and pressure <= 600 
        flange_class = "400"
        pressure_rating = 600
        temperature_rating = 900
        elsif  pressure > 600 and pressure <= 900 
        flange_class = "600"
        pressure_rating = 900
        temperature_rating = 900
        elsif  pressure > 900 and pressure <= 1350 
        flange_class = "900"
        pressure_rating = 1350
        temperature_rating = 900
        elsif  pressure > 1350 and pressure <= 2245 
        flange_class = "1500"
        pressure_rating = 2245
        temperature_rating = 900
        elsif  pressure > 2245 and pressure <= 3745 
        flange_class = "2500"
        pressure_rating = 3745
        temperature_rating = 900
        
        end
    elsif temperature > 900 and temperature <= 950 
        if pressure <= 35 
        flange_class = "150"
        pressure_rating = 35
        temperature_rating = 950
        elsif  pressure > 35 and pressure <= 385 
        flange_class = "300"
        pressure_rating = 385
        temperature_rating = 950
        elsif  pressure > 385 and pressure <= 515 
        flange_class = "400"
        pressure_rating = 515
        temperature_rating = 950
        elsif  pressure > 515 and pressure <= 775 
        flange_class = "600"
        pressure_rating = 775
        temperature_rating = 950
        elsif  pressure > 775 and pressure <= 1160 
        flange_class = "900"
        pressure_rating = 1160
        temperature_rating = 950
        elsif  pressure > 1160 and pressure <= 1930 
        flange_class = "1500"
        pressure_rating = 1930
        temperature_rating = 950
        elsif  pressure > 1930 and pressure <= 3220 
        flange_class = "2500"
        pressure_rating = 3320
        temperature_rating = 950
        
        end
    elsif temperature > 950 and temperature <= 1000 
        if pressure <= 20 
        flange_class = "150"
        pressure_rating = 20
        temperature_rating = 1000
        elsif  pressure > 20 and pressure <= 265 
        flange_class = "300"
        pressure_rating = 265
        temperature_rating = 1000
        elsif  pressure > 265 and pressure <= 355 
        flange_class = "400"
        pressure_rating = 355
        temperature_rating = 1000
        elsif  pressure > 355 and pressure <= 535 
        flange_class = "600"
        pressure_rating = 535
        temperature_rating = 1000
        elsif  pressure > 535 and pressure <= 800 
        flange_class = "900"
        pressure_rating = 800
        temperature_rating = 1000
        elsif  pressure > 800 and pressure <= 1335 
        flange_class = "1500"
        pressure_rating = 1335
        temperature_rating = 1000
        elsif  pressure > 1335 and pressure <= 2230 
        flange_class = "2500"
        pressure_rating = 2230
        temperature_rating = 1000
        
        end
    elsif temperature > 1000 and temperature <= 1050 
        if pressure > 175 
        flange_class = "300"
        pressure_rating = 175
        temperature_rating = 1050
        elsif  pressure > 175 and pressure <= 235 
        flange_class = "400"
        pressure_rating = 235
        temperature_rating = 1050
        elsif  pressure > 235 and pressure <= 350 
        flange_class = "600"
        pressure_rating = 350
        temperature_rating = 1050
        elsif  pressure > 350 and pressure <= 525 
        flange_class = "900"
        pressure_rating = 525
        temperature_rating = 1050
        elsif  pressure > 525 and pressure <= 875 
        flange_class = "1500"
        pressure_rating = 875
        temperature_rating = 1050
        elsif  pressure > 875 and pressure <= 1455 
        flange_class = "2500"
        pressure_rating = 1455
        temperature_rating = 1050
        
        end
    elsif temperature > 1050 and temperature <= 1100 
        if pressure > 110 
        flange_class = "300"
        pressure_rating = 110
        temperature_rating = 1100
        elsif  pressure > 110 and pressure <= 145 
        flange_class = "400"
        pressure_rating = 145
        temperature_rating = 1100
        elsif  pressure > 145 and pressure <= 220 
        flange_class = "600"
        pressure_rating = 220
        temperature_rating = 1100
        elsif  pressure > 220 and pressure <= 330 
        flange_class = "900"
        pressure_rating = 330
        temperature_rating = 1100
        elsif  pressure > 330 and pressure <= 550 
        flange_class = "1500"
        pressure_rating = 550
        temperature_rating = 1100
        elsif  pressure > 550 and pressure <= 915 
        flange_class = "2500"
        pressure_rating = 915
        temperature_rating = 1100
        
        end
    elsif temperature > 1100 and temperature <= 1150 
        if pressure > 70 
        flange_class = "300"
        pressure_rating = 70
        temperature_rating = 1150
        elsif  pressure > 70 and pressure <= 90 
        flange_class = "400"
        pressure_rating = 90
        temperature_rating = 1150
        elsif  pressure > 90 and pressure <= 135 
        flange_class = "600"
        pressure_rating = 135
        temperature_rating = 1150
        elsif  pressure > 135 and pressure <= 205 
        flange_class = "900"
        pressure_rating = 205
        temperature_rating = 1150
        elsif  pressure > 205 and pressure <= 345 
        flange_class = "1500"
        pressure_rating = 345
        temperature_rating = 1150
        elsif  pressure > 345 and pressure <= 570 
        flange_class = "2500"
        pressure_rating = 570
        temperature_rating = 1150
        
        end
    elsif temperature > 1150 and temperature <= 1200 
        if pressure > 40 
        flange_class = "300"
        pressure_rating = 40
        temperature_rating = 1200
        elsif  pressure > 40 and pressure <= 55 
        flange_class = "400"
        pressure_rating = 55
        temperature_rating = 1200
        elsif  pressure > 55 and pressure <= 80 
        flange_class = "600"
        pressure_rating = 80
        temperature_rating = 1200
        elsif  pressure > 80 and pressure <= 125 
        flange_class = "900"
        pressure_rating = 125
        temperature_rating = 1200
        elsif  pressure > 125 and pressure <= 205 
        flange_class = "1500"
        pressure_rating = 205
        temperature_rating = 1200
        elsif  pressure > 205 and pressure <= 345 
        flange_class = "2500"
        pressure_rating = 345
        temperature_rating = 1200
        
        end
    
    end
    
    if Worksheets("UOM").chkCustomary.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) Permissible, but not recommended for prolonged use above 1100\B0F." & Chr(13) _
    & "(2) Use normalized and tempered material only." & Chr(13) _
    & "(3) Not to be used over 1100\B0F."
    elsif orksheets("UOM").chkSI.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) Permissible, but not recommended for prolonged use above 590\B0C." & Chr(13) _
    & "(2) Use normalized and tempered material only." & Chr(13) _
    & "(3) Not to be used over 590\B0C."
    
    flange_classd if
    pressure_ratingElse
Call FlangePressuretemperature_rating2(pressure, temperature, MaterialGroup, FlangeClass, PressureRating, temperature_rating)
flange_class if

pressure_ratingSub

Sub FlangePressuretemperature_rating2(pressure, temperature, MaterialGroup, FlangeClass, PressureRating, temperature_rating)

if MaterialGroup = "1.11" 
UserFormLineSegmentDesign.cmbMaterialDesignation.RowSource = "MaterialGroup1.11"
    if temperature >= -20 and temperature <= 100 
        if pressure <= 290 
        flange_class = "150"
        pressure_rating = 290
        temperature_rating = 100
        elsif  pressure > 290 and pressure <= 750 
        flange_class = "300"
        pressure_rating = 750
        temperature_rating = 100
        elsif  pressure > 750 and pressure <= 1000 
        flange_class = "400"
        pressure_rating = 1000
        temperature_rating = 100
        elsif  pressure > 1000 and pressure <= 1500 
        flange_class = "600"
        pressure_rating = 1500
        temperature_rating = 100
        elsif  pressure > 1500 and pressure <= 2250 
        flange_class = "900"
        pressure_rating = 2250
        temperature_rating = 100
        elsif  pressure > 2250 and pressure <= 3750 
        flange_class = "1500"
        pressure_rating = 3750
        temperature_rating = 100
        elsif  pressure > 3750 and pressure <= 6250 
        flange_class = "2500"
        pressure_rating = 6250
        temperature_rating = 100
        
        end
    elsif temperature > 100 and temperature <= 200 
        if pressure <= 260 
        flange_class = "150"
        pressure_rating = 260
        temperature_rating = 200
        elsif  pressure > 260 and pressure <= 750 
        flange_class = "300"
        pressure_rating = 750
        temperature_rating = 200
        elsif  pressure > 750 and pressure <= 1000 
        flange_class = "400"
        pressure_rating = 1000
        temperature_rating = 200
        elsif  pressure > 1000 and pressure <= 1500 
        flange_class = "600"
        pressure_rating = 1500
        temperature_rating = 200
        elsif  pressure > 1500 and pressure <= 2250 
        flange_class = "900"
        pressure_rating = 2250
        temperature_rating = 200
        elsif  pressure > 2250 and pressure <= 3750 
        flange_class = "1500"
        pressure_rating = 3750
        temperature_rating = 200
        elsif  pressure > 3750 and pressure <= 6250 
        flange_class = "2500"
        pressure_rating = 6250
        temperature_rating = 200
        
        end
    elsif temperature > 200 and temperature <= 300 
        if pressure <= 230 
        flange_class = "150"
        pressure_rating = 230
        temperature_rating = 300
        elsif  pressure > 230 and pressure <= 730 
        flange_class = "300"
        pressure_rating = 730
        temperature_rating = 300
        elsif  pressure > 730 and pressure <= 970 
        flange_class = "400"
        pressure_rating = 970
        temperature_rating = 300
        elsif  pressure > 970 and pressure <= 1455 
        flange_class = "600"
        pressure_rating = 1455
        temperature_rating = 300
        elsif  pressure > 1455 and pressure <= 2185 
        flange_class = "900"
        pressure_rating = 2185
        temperature_rating = 300
        elsif  pressure > 2185 and pressure <= 3640 
        flange_class = "1500"
        pressure_rating = 3640
        temperature_rating = 300
        elsif  pressure > 3640 and pressure <= 6070 
        flange_class = "2500"
        pressure_rating = 6070
        temperature_rating = 300
        
        end
    elsif temperature > 300 and temperature <= 400 
        if pressure <= 200 
        flange_class = "150"
        pressure_rating = 200
        temperature_rating = 400
        elsif  pressure > 200 and pressure <= 705 
        flange_class = "300"
        pressure_rating = 705
        temperature_rating = 400
        elsif  pressure > 705 and pressure <= 940 
        flange_class = "400"
        pressure_rating = 940
        temperature_rating = 400
        elsif  pressure > 940 and pressure <= 1410 
        flange_class = "600"
        pressure_rating = 1410
        temperature_rating = 400
        elsif  pressure > 1410 and pressure <= 2115 
        flange_class = "900"
        pressure_rating = 2115
        temperature_rating = 400
        elsif  pressure > 2115 and pressure <= 3530 
        flange_class = "1500"
        pressure_rating = 3530
        temperature_rating = 400
        elsif  pressure > 3530 and pressure <= 5880 
        flange_class = "2500"
        pressure_rating = 5880
        temperature_rating = 400
        
        end
    elsif temperature > 400 and temperature <= 500 
        if pressure <= 170 
        flange_class = "150"
        pressure_rating = 170
        temperature_rating = 500
        elsif  pressure > 170 and pressure <= 665 
        flange_class = "300"
        pressure_rating = 665
        temperature_rating = 500
        elsif  pressure > 665 and pressure <= 885 
        flange_class = "400"
        pressure_rating = 885
        temperature_rating = 500
        elsif  pressure > 885 and pressure <= 1330 
        flange_class = "600"
        pressure_rating = 1330
        temperature_rating = 500
        elsif  pressure > 1330 and pressure <= 1995 
        flange_class = "900"
        pressure_rating = 1995
        temperature_rating = 500
        elsif  pressure > 1995 and pressure <= 3325 
        flange_class = "1500"
        pressure_rating = 3325
        temperature_rating = 500
        elsif  pressure > 3325 and pressure <= 5540 
        flange_class = "2500"
        pressure_rating = 5540
        temperature_rating = 500
        
        end
    elsif temperature > 500 and temperature <= 600 
        if pressure <= 140 
        flange_class = "150"
        pressure_rating = 140
        temperature_rating = 600
        elsif  pressure > 140 and pressure <= 605 
        flange_class = "300"
        pressure_rating = 605
        temperature_rating = 600
        elsif  pressure > 605 and pressure <= 805 
        flange_class = "400"
        pressure_rating = 805
        temperature_rating = 600
        elsif  pressure > 805 and pressure <= 1210 
        flange_class = "600"
        pressure_rating = 1210
        temperature_rating = 600
        elsif  pressure > 1210 and pressure <= 1815 
        flange_class = "900"
        pressure_rating = 1815
        temperature_rating = 600
        elsif  pressure > 1815 and pressure <= 3025 
        flange_class = "1500"
        pressure_rating = 3025
        temperature_rating = 600
        elsif  pressure > 3025 and pressure <= 5040 
        flange_class = "2500"
        pressure_rating = 5040
        temperature_rating = 600
        
        end
    elsif temperature > 600 and temperature <= 650 
        if pressure <= 125 
        flange_class = "150"
        pressure_rating = 125
        temperature_rating = 650
        elsif  pressure > 125 and pressure <= 590 
        flange_class = "300"
        pressure_rating = 590
        temperature_rating = 650
        elsif  pressure > 590 and pressure <= 785 
        flange_class = "400"
        pressure_rating = 785
        temperature_rating = 650
        elsif  pressure > 785 and pressure <= 1175 
        flange_class = "600"
        pressure_rating = 1175
        temperature_rating = 650
        elsif  pressure > 1175 and pressure <= 1765 
        flange_class = "900"
        pressure_rating = 1765
        temperature_rating = 650
        elsif  pressure > 1765 and pressure <= 2940 
        flange_class = "1500"
        pressure_rating = 2940
        temperature_rating = 650
        elsif  pressure > 2940 and pressure <= 4905 
        flange_class = "2500"
        pressure_rating = 4905
        temperature_rating = 650
        
        end
    elsif temperature > 650 and temperature <= 700 
        if pressure <= 110 
        flange_class = "150"
        pressure_rating = 110
        temperature_rating = 700
        elsif  pressure > 110 and pressure <= 570 
        flange_class = "300"
        pressure_rating = 570
        temperature_rating = 700
        elsif  pressure > 570 and pressure <= 755 
        flange_class = "400"
        pressure_rating = 755
        temperature_rating = 700
        elsif  pressure > 755 and pressure <= 1135 
        flange_class = "600"
        pressure_rating = 1135
        temperature_rating = 700
        elsif  pressure > 1135 and pressure <= 1705 
        flange_class = "900"
        pressure_rating = 1705
        temperature_rating = 700
        elsif  pressure > 1705 and pressure <= 2840 
        flange_class = "1500"
        pressure_rating = 2840
        temperature_rating = 700
        elsif  pressure > 2840 and pressure <= 4730 
        flange_class = "2500"
        pressure_rating = 4730
        temperature_rating = 700
        
        end
    elsif temperature > 700 and temperature <= 750 
        if pressure <= 95 
        flange_class = "150"
        pressure_rating = 95
        temperature_rating = 750
        elsif  pressure > 95 and pressure <= 530 
        flange_class = "300"
        pressure_rating = 530
        temperature_rating = 750
        elsif  pressure > 530 and pressure <= 710 
        flange_class = "400"
        pressure_rating = 710
        temperature_rating = 750
        elsif  pressure > 710 and pressure <= 1065 
        flange_class = "600"
        pressure_rating = 1065
        temperature_rating = 750
        elsif  pressure > 1065 and pressure <= 1595 
        flange_class = "900"
        pressure_rating = 1595
        temperature_rating = 750
        elsif  pressure > 1595 and pressure <= 2660 
        flange_class = "1500"
        pressure_rating = 2660
        temperature_rating = 750
        elsif  pressure > 2660 and pressure <= 4430 
        flange_class = "2500"
        pressure_rating = 4430
        temperature_rating = 750
        
        end
    elsif temperature > 750 and temperature <= 800 
        if pressure <= 80 
        flange_class = "150"
        pressure_rating = 80
        temperature_rating = 800
        elsif  pressure > 80 and pressure <= 510 
        flange_class = "300"
        pressure_rating = 510
        temperature_rating = 800
        elsif  pressure > 510 and pressure <= 675 
        flange_class = "400"
        pressure_rating = 675
        temperature_rating = 800
        elsif  pressure > 675 and pressure <= 1015 
        flange_class = "600"
        pressure_rating = 1015
        temperature_rating = 800
        elsif  pressure > 1015 and pressure <= 1525 
        flange_class = "900"
        pressure_rating = 1525
        temperature_rating = 800
        elsif  pressure > 1525 and pressure <= 2540 
        flange_class = "1500"
        pressure_rating = 2540
        temperature_rating = 800
        elsif  pressure > 2540 and pressure <= 4230 
        flange_class = "2500"
        pressure_rating = 4230
        temperature_rating = 800
        
        end
    elsif temperature > 800 and temperature <= 850 
        if pressure <= 65 
        flange_class = "150"
        pressure_rating = 65
        temperature_rating = 850
        elsif  pressure > 65 and pressure <= 485 
        flange_class = "300"
        pressure_rating = 485
        temperature_rating = 850
        elsif  pressure > 485 and pressure <= 650 
        flange_class = "400"
        pressure_rating = 650
        temperature_rating = 850
        elsif  pressure > 650 and pressure <= 975 
        flange_class = "600"
        pressure_rating = 975
        temperature_rating = 850
        elsif  pressure > 975 and pressure <= 1460 
        flange_class = "900"
        pressure_rating = 1460
        temperature_rating = 850
        elsif  pressure > 1460 and pressure <= 2435 
        flange_class = "1500"
        pressure_rating = 2435
        temperature_rating = 850
        elsif  pressure > 2435 and pressure <= 4060 
        flange_class = "2500"
        pressure_rating = 4060
        temperature_rating = 850
        
        end
    elsif temperature > 850 and temperature <= 900 
        if pressure <= 50 
        flange_class = "150"
        pressure_rating = 50
        temperature_rating = 900
        elsif  pressure > 50 and pressure <= 450 
        flange_class = "300"
        pressure_rating = 450
        temperature_rating = 900
        elsif  pressure > 450 and pressure <= 600 
        flange_class = "400"
        pressure_rating = 600
        temperature_rating = 900
        elsif  pressure > 600 and pressure <= 900 
        flange_class = "600"
        pressure_rating = 900
        temperature_rating = 900
        elsif  pressure > 900 and pressure <= 1345 
        flange_class = "900"
        pressure_rating = 1345
        temperature_rating = 900
        elsif  pressure > 1345 and pressure <= 2245 
        flange_class = "1500"
        pressure_rating = 2245
        temperature_rating = 900
        elsif  pressure > 2245 and pressure <= 3745 
        flange_class = "2500"
        pressure_rating = 3745
        temperature_rating = 900
        
        end
    elsif temperature > 900 and temperature <= 950 
        if pressure <= 35 
        flange_class = "150"
        pressure_rating = 35
        temperature_rating = 950
        elsif  pressure > 35 and pressure <= 280 
        flange_class = "300"
        pressure_rating = 280
        temperature_rating = 950
        elsif  pressure > 280 and pressure <= 375 
        flange_class = "400"
        pressure_rating = 375
        temperature_rating = 950
        elsif  pressure > 375 and pressure <= 560 
        flange_class = "600"
        pressure_rating = 560
        temperature_rating = 950
        elsif  pressure > 560 and pressure <= 845 
        flange_class = "900"
        pressure_rating = 845
        temperature_rating = 950
        elsif  pressure > 845 and pressure <= 1405 
        flange_class = "1500"
        pressure_rating = 1405
        temperature_rating = 950
        elsif  pressure > 1405 and pressure <= 2345 
        flange_class = "2500"
        pressure_rating = 2345
        temperature_rating = 950
        
        end
    elsif temperature > 950 and temperature <= 1000 
        if pressure <= 20 
        flange_class = "150"
        pressure_rating = 20
        temperature_rating = 1000
        elsif  pressure > 20 and pressure <= 165 
        flange_class = "300"
        pressure_rating = 165
        temperature_rating = 1000
        elsif  pressure > 165 and pressure <= 220 
        flange_class = "400"
        pressure_rating = 220
        temperature_rating = 1000
        elsif  pressure > 220 and pressure <= 330 
        flange_class = "600"
        pressure_rating = 330
        temperature_rating = 1000
        elsif  pressure > 330 and pressure <= 495 
        flange_class = "900"
        pressure_rating = 495
        temperature_rating = 1000
        elsif  pressure > 495 and pressure <= 825 
        flange_class = "1500"
        pressure_rating = 825
        temperature_rating = 1000
        elsif  pressure > 825 and pressure <= 1370 
        flange_class = "2500"
        pressure_rating = 1370
        temperature_rating = 1000
        
        end
    elsif temperature > 1000 and temperature <= 1050 
        if pressure > 165 
        flange_class = "300"
        pressure_rating = 165
        temperature_rating = 1050
        elsif  pressure > 165 and pressure <= 220 
        flange_class = "400"
        pressure_rating = 220
        temperature_rating = 1050
        elsif  pressure > 220 and pressure <= 330 
        flange_class = "600"
        pressure_rating = 330
        temperature_rating = 1050
        elsif  pressure > 330 and pressure <= 495 
        flange_class = "900"
        pressure_rating = 495
        temperature_rating = 1050
        elsif  pressure > 495 and pressure <= 825 
        flange_class = "1500"
        pressure_rating = 825
        temperature_rating = 1050
        elsif  pressure > 825 and pressure <= 1370 
        flange_class = "2500"
        pressure_rating = 1370
        temperature_rating = 1050
        
        end
    elsif temperature > 1050 and temperature <= 1100 
        if pressure > 110 
        flange_class = "300"
        pressure_rating = 110
        temperature_rating = 1100
        elsif  pressure > 110 and pressure <= 145 
        flange_class = "400"
        pressure_rating = 145
        temperature_rating = 1100
        elsif  pressure > 145 and pressure <= 220 
        flange_class = "600"
        pressure_rating = 220
        temperature_rating = 1100
        elsif  pressure > 220 and pressure <= 330 
        flange_class = "900"
        pressure_rating = 330
        temperature_rating = 1100
        elsif  pressure > 330 and pressure <= 550 
        flange_class = "1500"
        pressure_rating = 550
        temperature_rating = 1100
        elsif  pressure > 550 and pressure <= 915 
        flange_class = "2500"
        pressure_rating = 915
        temperature_rating = 1100
        
        end
    elsif temperature > 1100 and temperature <= 1150 
        if pressure > 80 
        flange_class = "300"
        pressure_rating = 80
        temperature_rating = 1150
        elsif  pressure > 80 and pressure <= 110 
        flange_class = "400"
        pressure_rating = 110
        temperature_rating = 1150
        elsif  pressure > 110 and pressure <= 165 
        flange_class = "600"
        pressure_rating = 165
        temperature_rating = 1150
        elsif  pressure > 165 and pressure <= 245 
        flange_class = "900"
        pressure_rating = 245
        temperature_rating = 1150
        elsif  pressure > 245 and pressure <= 410 
        flange_class = "1500"
        pressure_rating = 410
        temperature_rating = 1150
        elsif  pressure > 410 and pressure <= 685 
        flange_class = "2500"
        pressure_rating = 685
        temperature_rating = 1150
        
        end
    elsif temperature > 1150 and temperature <= 1200 
        if pressure > 45 
        flange_class = "300"
        pressure_rating = 45
        temperature_rating = 1200
        elsif  pressure > 45 and pressure <= 60 
        flange_class = "400"
        pressure_rating = 60
        temperature_rating = 1200
        elsif  pressure > 60 and pressure <= 90 
        flange_class = "600"
        pressure_rating = 90
        temperature_rating = 1200
        elsif  pressure > 90 and pressure <= 135 
        flange_class = "900"
        pressure_rating = 135
        temperature_rating = 1200
        elsif  pressure > 135 and pressure <= 225 
        flange_class = "1500"
        pressure_rating = 225
        temperature_rating = 1200
        elsif  pressure > 225 and pressure <= 370 
        flange_class = "2500"
        pressure_rating = 370
        temperature_rating = 1200
        
        end
    
    end
    
    if Worksheets("UOM").chkCustomary.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) Upon prolonged exposure to temperatures above 875\B0F, the carbide phase of carbon-molybdenum steel may be converted to graphite. Permissible, but not recommended for prolonged use above 875\B0F."
    elsif orksheets("UOM").chkSI.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) Upon prolonged exposure to temperatures above 465\B0C, the carbide phase of carbon-molybdenum steel may be converted to graphite. Permissible, but not recommended for prolonged use above 465\B0C."
    
    end
    
elsif material_group = "1.13" 
UserFormLineSegmentDesign.cmbMaterialDesignation.RowSource = "MaterialGroup1.13"
    if temperature >= -20 and temperature <= 100 
        if pressure <= 290 
        flange_class = "150"
        pressure_rating = 290
        temperature_rating = 100
        elsif  pressure > 290 and pressure <= 750 
        flange_class = "300"
        pressure_rating = 750
        temperature_rating = 100
        elsif  pressure > 750 and pressure <= 1000 
        flange_class = "400"
        pressure_rating = 1000
        temperature_rating = 100
        elsif  pressure > 1000 and pressure <= 1500 
        flange_class = "600"
        pressure_rating = 1500
        temperature_rating = 100
        elsif  pressure > 1500 and pressure <= 2250 
        flange_class = "900"
        pressure_rating = 2250
        temperature_rating = 100
        elsif  pressure > 2250 and pressure <= 3750 
        flange_class = "1500"
        pressure_rating = 3750
        temperature_rating = 100
        elsif  pressure > 3750 and pressure <= 6250 
        flange_class = "2500"
        pressure_rating = 6250
        temperature_rating = 100
        
        end
    elsif temperature > 100 and temperature <= 200 
        if pressure <= 260 
        flange_class = "150"
        pressure_rating = 260
        temperature_rating = 200
        elsif  pressure > 260 and pressure <= 750 
        flange_class = "300"
        pressure_rating = 750
        temperature_rating = 200
        elsif  pressure > 750 and pressure <= 1000 
        flange_class = "400"
        pressure_rating = 1000
        temperature_rating = 200
        elsif  pressure > 1000 and pressure <= 1500 
        flange_class = "600"
        pressure_rating = 1500
        temperature_rating = 200
        elsif  pressure > 1500 and pressure <= 2250 
        flange_class = "900"
        pressure_rating = 2250
        temperature_rating = 200
        elsif  pressure > 2250 and pressure <= 3750 
        flange_class = "1500"
        pressure_rating = 3750
        temperature_rating = 200
        elsif  pressure > 3750 and pressure <= 6250 
        flange_class = "2500"
        pressure_rating = 6250
        temperature_rating = 200
        
        end
    elsif temperature > 200 and temperature <= 300 
        if pressure <= 230 
        flange_class = "150"
        pressure_rating = 230
        temperature_rating = 300
        elsif  pressure > 230 and pressure <= 730 
        flange_class = "300"
        pressure_rating = 730
        temperature_rating = 300
        elsif  pressure > 730 and pressure <= 970 
        flange_class = "400"
        pressure_rating = 970
        temperature_rating = 300
        elsif  pressure > 970 and pressure <= 1455 
        flange_class = "600"
        pressure_rating = 1455
        temperature_rating = 300
        elsif  pressure > 1455 and pressure <= 2185 
        flange_class = "900"
        pressure_rating = 2185
        temperature_rating = 300
        elsif  pressure > 2185 and pressure <= 3640 
        flange_class = "1500"
        pressure_rating = 3640
        temperature_rating = 300
        elsif  pressure > 3640 and pressure <= 6070 
        flange_class = "2500"
        pressure_rating = 6070
        temperature_rating = 300
        
        end
    elsif temperature > 300 and temperature <= 400 
        if pressure <= 200 
        flange_class = "150"
        pressure_rating = 200
        temperature_rating = 400
        elsif  pressure > 200 and pressure <= 705 
        flange_class = "300"
        pressure_rating = 705
        temperature_rating = 400
        elsif  pressure > 705 and pressure <= 940 
        flange_class = "400"
        pressure_rating = 940
        temperature_rating = 400
        elsif  pressure > 940 and pressure <= 1410 
        flange_class = "600"
        pressure_rating = 1410
        temperature_rating = 400
        elsif  pressure > 1410 and pressure <= 2115 
        flange_class = "900"
        pressure_rating = 2115
        temperature_rating = 400
        elsif  pressure > 2115 and pressure <= 3530 
        flange_class = "1500"
        pressure_rating = 3530
        temperature_rating = 400
        elsif  pressure > 3530 and pressure <= 5880 
        flange_class = "2500"
        pressure_rating = 5880
        temperature_rating = 400
        
        end
    elsif temperature > 400 and temperature <= 500 
        if pressure <= 170 
        flange_class = "150"
        pressure_rating = 170
        temperature_rating = 500
        elsif  pressure > 170 and pressure <= 665 
        flange_class = "300"
        pressure_rating = 665
        temperature_rating = 500
        elsif  pressure > 665 and pressure <= 885 
        flange_class = "400"
        pressure_rating = 885
        temperature_rating = 500
        elsif  pressure > 885 and pressure <= 1330 
        flange_class = "600"
        pressure_rating = 1330
        temperature_rating = 500
        elsif  pressure > 1330 and pressure <= 1995 
        flange_class = "900"
        pressure_rating = 1995
        temperature_rating = 500
        elsif  pressure > 1995 and pressure <= 3325 
        flange_class = "1500"
        pressure_rating = 3325
        temperature_rating = 500
        elsif  pressure > 3325 and pressure <= 5540 
        flange_class = "2500"
        pressure_rating = 5540
        temperature_rating = 500
        
        end
    elsif temperature > 500 and temperature <= 600 
        if pressure <= 140 
        flange_class = "150"
        pressure_rating = 140
        temperature_rating = 600
        elsif  pressure > 140 and pressure <= 605 
        flange_class = "300"
        pressure_rating = 605
        temperature_rating = 600
        elsif  pressure > 605 and pressure <= 805 
        flange_class = "400"
        pressure_rating = 805
        temperature_rating = 600
        elsif  pressure > 805 and pressure <= 1210 
        flange_class = "600"
        pressure_rating = 1210
        temperature_rating = 600
        elsif  pressure > 1210 and pressure <= 1815 
        flange_class = "900"
        pressure_rating = 1815
        temperature_rating = 600
        elsif  pressure > 1815 and pressure <= 3025 
        flange_class = "1500"
        pressure_rating = 3025
        temperature_rating = 600
        elsif  pressure > 3025 and pressure <= 5040 
        flange_class = "2500"
        pressure_rating = 5040
        temperature_rating = 600
        
        end
    elsif temperature > 600 and temperature <= 650 
        if pressure <= 125 
        flange_class = "150"
        pressure_rating = 125
        temperature_rating = 650
        elsif  pressure > 125 and pressure <= 590 
        flange_class = "300"
        pressure_rating = 590
        temperature_rating = 650
        elsif  pressure > 590 and pressure <= 785 
        flange_class = "400"
        pressure_rating = 785
        temperature_rating = 650
        elsif  pressure > 785 and pressure <= 1175 
        flange_class = "600"
        pressure_rating = 1175
        temperature_rating = 650
        elsif  pressure > 1175 and pressure <= 1765 
        flange_class = "900"
        pressure_rating = 1765
        temperature_rating = 650
        elsif  pressure > 1765 and pressure <= 2940 
        flange_class = "1500"
        pressure_rating = 2940
        temperature_rating = 650
        elsif  pressure > 2940 and pressure <= 4905 
        flange_class = "2500"
        pressure_rating = 4905
        temperature_rating = 650
        
        end
    elsif temperature > 650 and temperature <= 700 
        if pressure <= 110 
        flange_class = "150"
        pressure_rating = 110
        temperature_rating = 700
        elsif  pressure > 110 and pressure <= 570 
        flange_class = "300"
        pressure_rating = 570
        temperature_rating = 700
        elsif  pressure > 570 and pressure <= 755 
        flange_class = "400"
        pressure_rating = 755
        temperature_rating = 700
        elsif  pressure > 755 and pressure <= 1135 
        flange_class = "600"
        pressure_rating = 1135
        temperature_rating = 700
        elsif  pressure > 1135 and pressure <= 1705 
        flange_class = "900"
        pressure_rating = 1705
        temperature_rating = 700
        elsif  pressure > 1705 and pressure <= 2840 
        flange_class = "1500"
        pressure_rating = 2840
        temperature_rating = 700
        elsif  pressure > 2840 and pressure <= 4730 
        flange_class = "2500"
        pressure_rating = 4730
        temperature_rating = 700
        
        end
    elsif temperature > 700 and temperature <= 750 
        if pressure <= 95 
        flange_class = "150"
        pressure_rating = 95
        temperature_rating = 750
        elsif  pressure > 95 and pressure <= 530 
        flange_class = "300"
        pressure_rating = 530
        temperature_rating = 750
        elsif  pressure > 530 and pressure <= 710 
        flange_class = "400"
        pressure_rating = 710
        temperature_rating = 750
        elsif  pressure > 710 and pressure <= 1065 
        flange_class = "600"
        pressure_rating = 1065
        temperature_rating = 750
        elsif  pressure > 1065 and pressure <= 1595 
        flange_class = "900"
        pressure_rating = 1595
        temperature_rating = 750
        elsif  pressure > 1595 and pressure <= 2660 
        flange_class = "1500"
        pressure_rating = 2660
        temperature_rating = 750
        elsif  pressure > 2660 and pressure <= 4430 
        flange_class = "2500"
        pressure_rating = 4430
        temperature_rating = 750
        
        end
    elsif temperature > 750 and temperature <= 800 
        if pressure <= 80 
        flange_class = "150"
        pressure_rating = 80
        temperature_rating = 800
        elsif  pressure > 80 and pressure <= 510 
        flange_class = "300"
        pressure_rating = 510
        temperature_rating = 800
        elsif  pressure > 510 and pressure <= 675 
        flange_class = "400"
        pressure_rating = 675
        temperature_rating = 800
        elsif  pressure > 675 and pressure <= 1015 
        flange_class = "600"
        pressure_rating = 1015
        temperature_rating = 800
        elsif  pressure > 1015 and pressure <= 1525 
        flange_class = "900"
        pressure_rating = 1525
        temperature_rating = 800
        elsif  pressure > 1525 and pressure <= 2540 
        flange_class = "1500"
        pressure_rating = 2540
        temperature_rating = 800
        elsif  pressure > 2540 and pressure <= 4230 
        flange_class = "2500"
        pressure_rating = 4230
        temperature_rating = 800
        
        end
    elsif temperature > 800 and temperature <= 850 
        if pressure <= 65 
        flange_class = "150"
        pressure_rating = 65
        temperature_rating = 850
        elsif  pressure > 65 and pressure <= 485 
        flange_class = "300"
        pressure_rating = 485
        temperature_rating = 850
        elsif  pressure > 485 and pressure <= 650 
        flange_class = "400"
        pressure_rating = 650
        temperature_rating = 850
        elsif  pressure > 650 and pressure <= 975 
        flange_class = "600"
        pressure_rating = 975
        temperature_rating = 850
        elsif  pressure > 975 and pressure <= 1460 
        flange_class = "900"
        pressure_rating = 1460
        temperature_rating = 850
        elsif  pressure > 1460 and pressure <= 2435 
        flange_class = "1500"
        pressure_rating = 2435
        temperature_rating = 850
        elsif  pressure > 2435 and pressure <= 4060 
        flange_class = "2500"
        pressure_rating = 4060
        temperature_rating = 850
        
        end
    elsif temperature > 850 and temperature <= 900 
        if pressure <= 50 
        flange_class = "150"
        pressure_rating = 50
        temperature_rating = 900
        elsif  pressure > 50 and pressure <= 375 
        flange_class = "300"
        pressure_rating = 375
        temperature_rating = 900
        elsif  pressure > 375 and pressure <= 500 
        flange_class = "400"
        pressure_rating = 500
        temperature_rating = 900
        elsif  pressure > 500 and pressure <= 745 
        flange_class = "600"
        pressure_rating = 745
        temperature_rating = 900
        elsif  pressure > 745 and pressure <= 1120 
        flange_class = "900"
        pressure_rating = 1120
        temperature_rating = 900
        elsif  pressure > 1120 and pressure <= 1870 
        flange_class = "1500"
        pressure_rating = 1870
        temperature_rating = 900
        elsif  pressure > 1870 and pressure <= 3115 
        flange_class = "2500"
        pressure_rating = 3115
        temperature_rating = 900
        
        end
    elsif temperature > 900 and temperature <= 950 
        if pressure <= 35 
        flange_class = "150"
        pressure_rating = 35
        temperature_rating = 950
        elsif  pressure > 35 and pressure <= 275 
        flange_class = "300"
        pressure_rating = 275
        temperature_rating = 950
        elsif  pressure > 275 and pressure <= 365 
        flange_class = "400"
        pressure_rating = 365
        temperature_rating = 950
        elsif  pressure > 365 and pressure <= 550 
        flange_class = "600"
        pressure_rating = 550
        temperature_rating = 950
        elsif  pressure > 550 and pressure <= 825 
        flange_class = "900"
        pressure_rating = 825
        temperature_rating = 950
        elsif  pressure > 825 and pressure <= 1370 
        flange_class = "1500"
        pressure_rating = 1370
        temperature_rating = 950
        elsif  pressure > 1370 and pressure <= 2285 
        flange_class = "2500"
        pressure_rating = 2285
        temperature_rating = 950
        
        end
    elsif temperature > 950 and temperature <= 1000 
        if pressure <= 20 
        flange_class = "150"
        pressure_rating = 20
        temperature_rating = 1000
        elsif  pressure > 20 and pressure <= 200 
        flange_class = "300"
        pressure_rating = 200
        temperature_rating = 1000
        elsif  pressure > 200 and pressure <= 265 
        flange_class = "400"
        pressure_rating = 265
        temperature_rating = 1000
        elsif  pressure > 265 and pressure <= 400 
        flange_class = "600"
        pressure_rating = 400
        temperature_rating = 1000
        elsif  pressure > 400 and pressure <= 595 
        flange_class = "900"
        pressure_rating = 595
        temperature_rating = 1000
        elsif  pressure > 595 and pressure <= 995 
        flange_class = "1500"
        pressure_rating = 995
        temperature_rating = 1000
        elsif  pressure > 995 and pressure <= 1655 
        flange_class = "2500"
        pressure_rating = 1655
        temperature_rating = 1000
        
        end
    elsif temperature > 1000 and temperature <= 1050 
        if pressure > 145 
        flange_class = "300"
        pressure_rating = 145
        temperature_rating = 1050
        elsif  pressure > 145 and pressure <= 190 
        flange_class = "400"
        pressure_rating = 190
        temperature_rating = 1050
        elsif  pressure > 190 and pressure <= 290 
        flange_class = "600"
        pressure_rating = 290
        temperature_rating = 1050
        elsif  pressure > 290 and pressure <= 430 
        flange_class = "900"
        pressure_rating = 430
        temperature_rating = 1050
        elsif  pressure > 430 and pressure <= 720 
        flange_class = "1500"
        pressure_rating = 720
        temperature_rating = 1050
        elsif  pressure > 720 and pressure <= 1200 
        flange_class = "2500"
        pressure_rating = 1200
        temperature_rating = 1050
        
        end
    elsif temperature > 1050 and temperature <= 1100 
        if pressure > 100 
        flange_class = "300"
        pressure_rating = 100
        temperature_rating = 1100
        elsif  pressure > 100 and pressure <= 135 
        flange_class = "400"
        pressure_rating = 135
        temperature_rating = 1100
        elsif  pressure > 135 and pressure <= 200 
        flange_class = "600"
        pressure_rating = 200
        temperature_rating = 1100
        elsif  pressure > 200 and pressure <= 300 
        flange_class = "900"
        pressure_rating = 300
        temperature_rating = 1100
        elsif  pressure > 300 and pressure <= 495 
        flange_class = "1500"
        pressure_rating = 495
        temperature_rating = 1100
        elsif  pressure > 495 and pressure <= 830 
        flange_class = "2500"
        pressure_rating = 830
        temperature_rating = 1100
        
        end
    elsif temperature > 1100 and temperature <= 1150 
        if pressure > 60 
        flange_class = "300"
        pressure_rating = 60
        temperature_rating = 1150
        elsif  pressure > 60 and pressure <= 80 
        flange_class = "400"
        pressure_rating = 80
        temperature_rating = 1150
        elsif  pressure > 80 and pressure <= 125 
        flange_class = "600"
        pressure_rating = 125
        temperature_rating = 1150
        elsif  pressure > 125 and pressure <= 185 
        flange_class = "900"
        pressure_rating = 185
        temperature_rating = 1150
        elsif  pressure > 185 and pressure <= 310 
        flange_class = "1500"
        pressure_rating = 310
        temperature_rating = 1150
        elsif  pressure > 310 and pressure <= 515 
        flange_class = "2500"
        pressure_rating = 515
        temperature_rating = 1150
        
        end
    elsif temperature > 1150 and temperature <= 1200 
        if pressure > 35 
        flange_class = "300"
        pressure_rating = 35
        temperature_rating = 1200
        elsif  pressure > 35 and pressure <= 45 
        flange_class = "400"
        pressure_rating = 45
        temperature_rating = 1200
        elsif  pressure > 45 and pressure <= 70 
        flange_class = "600"
        pressure_rating = 70
        temperature_rating = 1200
        elsif  pressure > 70 and pressure <= 105 
        flange_class = "900"
        pressure_rating = 105
        temperature_rating = 1200
        elsif  pressure > 105 and pressure <= 170 
        flange_class = "1500"
        pressure_rating = 170
        temperature_rating = 1200
        elsif  pressure > 170 and pressure <= 285 
        flange_class = "2500"
        pressure_rating = 285
        temperature_rating = 1200
        
        end
    
    end
    
    if Worksheets("UOM").chkCustomary.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) Use normalized and tempered material only."
    elsif orksheets("UOM").chkSI.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) Use normalized and tempered material only."
    
    end
    
elsif material_group = "1.14" 
UserFormLineSegmentDesign.cmbMaterialDesignation.RowSource = "MaterialGroup1.14"
    if temperature >= -20 and temperature <= 100 
        if pressure <= 290 
        flange_class = "150"
        pressure_rating = 290
        temperature_rating = 100
        elsif  pressure > 290 and pressure <= 750 
        flange_class = "300"
        pressure_rating = 750
        temperature_rating = 100
        elsif  pressure > 750 and pressure <= 1000 
        flange_class = "400"
        pressure_rating = 1000
        temperature_rating = 100
        elsif  pressure > 1000 and pressure <= 1500 
        flange_class = "600"
        pressure_rating = 1500
        temperature_rating = 100
        elsif  pressure > 1500 and pressure <= 2250 
        flange_class = "900"
        pressure_rating = 2250
        temperature_rating = 100
        elsif  pressure > 2250 and pressure <= 3750 
        flange_class = "1500"
        pressure_rating = 3750
        temperature_rating = 100
        elsif  pressure > 3750 and pressure <= 6250 
        flange_class = "2500"
        pressure_rating = 6250
        temperature_rating = 100
        
        end
    elsif temperature > 100 and temperature <= 200 
        if pressure <= 260 
        flange_class = "150"
        pressure_rating = 260
        temperature_rating = 200
        elsif  pressure > 260 and pressure <= 750 
        flange_class = "300"
        pressure_rating = 750
        temperature_rating = 200
        elsif  pressure > 750 and pressure <= 1000 
        flange_class = "400"
        pressure_rating = 1000
        temperature_rating = 200
        elsif  pressure > 1000 and pressure <= 1500 
        flange_class = "600"
        pressure_rating = 1500
        temperature_rating = 200
        elsif  pressure > 1500 and pressure <= 2250 
        flange_class = "900"
        pressure_rating = 2250
        temperature_rating = 200
        elsif  pressure > 2250 and pressure <= 3750 
        flange_class = "1500"
        pressure_rating = 3750
        temperature_rating = 200
        elsif  pressure > 3750 and pressure <= 6250 
        flange_class = "2500"
        pressure_rating = 6250
        temperature_rating = 200
        
        end
    elsif temperature > 200 and temperature <= 300 
        if pressure <= 230 
        flange_class = "150"
        pressure_rating = 230
        temperature_rating = 300
        elsif  pressure > 230 and pressure <= 730 
        flange_class = "300"
        pressure_rating = 730
        temperature_rating = 300
        elsif  pressure > 730 and pressure <= 970 
        flange_class = "400"
        pressure_rating = 970
        temperature_rating = 300
        elsif  pressure > 970 and pressure <= 1455 
        flange_class = "600"
        pressure_rating = 1455
        temperature_rating = 300
        elsif  pressure > 1455 and pressure <= 2185 
        flange_class = "900"
        pressure_rating = 2185
        temperature_rating = 300
        elsif  pressure > 2185 and pressure <= 3640 
        flange_class = "1500"
        pressure_rating = 3640
        temperature_rating = 300
        elsif  pressure > 3640 and pressure <= 6070 
        flange_class = "2500"
        pressure_rating = 6070
        temperature_rating = 300
        
        end
    elsif temperature > 300 and temperature <= 400 
        if pressure <= 200 
        flange_class = "150"
        pressure_rating = 200
        temperature_rating = 400
        elsif  pressure > 200 and pressure <= 705 
        flange_class = "300"
        pressure_rating = 705
        temperature_rating = 400
        elsif  pressure > 705 and pressure <= 940 
        flange_class = "400"
        pressure_rating = 940
        temperature_rating = 400
        elsif  pressure > 940 and pressure <= 1410 
        flange_class = "600"
        pressure_rating = 1410
        temperature_rating = 400
        elsif  pressure > 1410 and pressure <= 2115 
        flange_class = "900"
        pressure_rating = 2115
        temperature_rating = 400
        elsif  pressure > 2115 and pressure <= 3530 
        flange_class = "1500"
        pressure_rating = 3530
        temperature_rating = 400
        elsif  pressure > 3530 and pressure <= 5880 
        flange_class = "2500"
        pressure_rating = 5880
        temperature_rating = 400
        
        end
    elsif temperature > 400 and temperature <= 500 
        if pressure <= 170 
        flange_class = "150"
        pressure_rating = 170
        temperature_rating = 500
        elsif  pressure > 170 and pressure <= 665 
        flange_class = "300"
        pressure_rating = 665
        temperature_rating = 500
        elsif  pressure > 665 and pressure <= 885 
        flange_class = "400"
        pressure_rating = 885
        temperature_rating = 500
        elsif  pressure > 885 and pressure <= 1330 
        flange_class = "600"
        pressure_rating = 1330
        temperature_rating = 500
        elsif  pressure > 1330 and pressure <= 1995 
        flange_class = "900"
        pressure_rating = 1995
        temperature_rating = 500
        elsif  pressure > 1995 and pressure <= 3325 
        flange_class = "1500"
        pressure_rating = 3325
        temperature_rating = 500
        elsif  pressure > 3325 and pressure <= 5540 
        flange_class = "2500"
        pressure_rating = 5540
        temperature_rating = 500
        
        end
    elsif temperature > 500 and temperature <= 600 
        if pressure <= 140 
        flange_class = "150"
        pressure_rating = 140
        temperature_rating = 600
        elsif  pressure > 140 and pressure <= 605 
        flange_class = "300"
        pressure_rating = 605
        temperature_rating = 600
        elsif  pressure > 605 and pressure <= 805 
        flange_class = "400"
        pressure_rating = 805
        temperature_rating = 600
        elsif  pressure > 805 and pressure <= 1210 
        flange_class = "600"
        pressure_rating = 1210
        temperature_rating = 600
        elsif  pressure > 1210 and pressure <= 1815 
        flange_class = "900"
        pressure_rating = 1815
        temperature_rating = 600
        elsif  pressure > 1815 and pressure <= 3025 
        flange_class = "1500"
        pressure_rating = 3025
        temperature_rating = 600
        elsif  pressure > 3025 and pressure <= 5040 
        flange_class = "2500"
        pressure_rating = 5040
        temperature_rating = 600
        
        end
    elsif temperature > 600 and temperature <= 650 
        if pressure <= 125 
        flange_class = "150"
        pressure_rating = 125
        temperature_rating = 650
        elsif  pressure > 125 and pressure <= 590 
        flange_class = "300"
        pressure_rating = 590
        temperature_rating = 650
        elsif  pressure > 590 and pressure <= 785 
        flange_class = "400"
        pressure_rating = 785
        temperature_rating = 650
        elsif  pressure > 785 and pressure <= 1175 
        flange_class = "600"
        pressure_rating = 1175
        temperature_rating = 650
        elsif  pressure > 1175 and pressure <= 1765 
        flange_class = "900"
        pressure_rating = 1765
        temperature_rating = 650
        elsif  pressure > 1765 and pressure <= 2940 
        flange_class = "1500"
        pressure_rating = 2940
        temperature_rating = 650
        elsif  pressure > 2940 and pressure <= 4905 
        flange_class = "2500"
        pressure_rating = 4905
        temperature_rating = 650
        
        end
    elsif temperature > 650 and temperature <= 700 
        if pressure <= 110 
        flange_class = "150"
        pressure_rating = 110
        temperature_rating = 700
        elsif  pressure > 110 and pressure <= 570 
        flange_class = "300"
        pressure_rating = 570
        temperature_rating = 700
        elsif  pressure > 570 and pressure <= 755 
        flange_class = "400"
        pressure_rating = 755
        temperature_rating = 700
        elsif  pressure > 755 and pressure <= 1135 
        flange_class = "600"
        pressure_rating = 1135
        temperature_rating = 700
        elsif  pressure > 1135 and pressure <= 1705 
        flange_class = "900"
        pressure_rating = 1705
        temperature_rating = 700
        elsif  pressure > 1705 and pressure <= 2840 
        flange_class = "1500"
        pressure_rating = 2840
        temperature_rating = 700
        elsif  pressure > 2840 and pressure <= 4730 
        flange_class = "2500"
        pressure_rating = 4730
        temperature_rating = 700
        
        end
    elsif temperature > 700 and temperature <= 750 
        if pressure <= 95 
        flange_class = "150"
        pressure_rating = 95
        temperature_rating = 750
        elsif  pressure > 95 and pressure <= 530 
        flange_class = "300"
        pressure_rating = 530
        temperature_rating = 750
        elsif  pressure > 530 and pressure <= 710 
        flange_class = "400"
        pressure_rating = 710
        temperature_rating = 750
        elsif  pressure > 710 and pressure <= 1065 
        flange_class = "600"
        pressure_rating = 1065
        temperature_rating = 750
        elsif  pressure > 1065 and pressure <= 1595 
        flange_class = "900"
        pressure_rating = 1595
        temperature_rating = 750
        elsif  pressure > 1595 and pressure <= 2660 
        flange_class = "1500"
        pressure_rating = 2660
        temperature_rating = 750
        elsif  pressure > 2660 and pressure <= 4430 
        flange_class = "2500"
        pressure_rating = 4430
        temperature_rating = 750
        
        end
    elsif temperature > 750 and temperature <= 800 
        if pressure <= 80 
        flange_class = "150"
        pressure_rating = 80
        temperature_rating = 800
        elsif  pressure > 80 and pressure <= 510 
        flange_class = "300"
        pressure_rating = 510
        temperature_rating = 800
        elsif  pressure > 510 and pressure <= 675 
        flange_class = "400"
        pressure_rating = 675
        temperature_rating = 800
        elsif  pressure > 675 and pressure <= 1015 
        flange_class = "600"
        pressure_rating = 1015
        temperature_rating = 800
        elsif  pressure > 1015 and pressure <= 1525 
        flange_class = "900"
        pressure_rating = 1525
        temperature_rating = 800
        elsif  pressure > 1525 and pressure <= 2540 
        flange_class = "1500"
        pressure_rating = 2540
        temperature_rating = 800
        elsif  pressure > 2540 and pressure <= 4230 
        flange_class = "2500"
        pressure_rating = 4230
        temperature_rating = 800
        
        end
    elsif temperature > 800 and temperature <= 850 
        if pressure <= 65 
        flange_class = "150"
        pressure_rating = 65
        temperature_rating = 850
        elsif  pressure > 65 and pressure <= 485 
        flange_class = "300"
        pressure_rating = 485
        temperature_rating = 850
        elsif  pressure > 485 and pressure <= 650 
        flange_class = "400"
        pressure_rating = 650
        temperature_rating = 850
        elsif  pressure > 650 and pressure <= 975 
        flange_class = "600"
        pressure_rating = 975
        temperature_rating = 850
        elsif  pressure > 975 and pressure <= 1460 
        flange_class = "900"
        pressure_rating = 1460
        temperature_rating = 850
        elsif  pressure > 1460 and pressure <= 2435 
        flange_class = "1500"
        pressure_rating = 2435
        temperature_rating = 850
        elsif  pressure > 2435 and pressure <= 4060 
        flange_class = "2500"
        pressure_rating = 4060
        temperature_rating = 850
        
        end
    elsif temperature > 850 and temperature <= 900 
        if pressure <= 50 
        flange_class = "150"
        pressure_rating = 50
        temperature_rating = 900
        elsif  pressure > 50 and pressure <= 450 
        flange_class = "300"
        pressure_rating = 450
        temperature_rating = 900
        elsif  pressure > 450 and pressure <= 600 
        flange_class = "400"
        pressure_rating = 600
        temperature_rating = 900
        elsif  pressure > 600 and pressure <= 900 
        flange_class = "600"
        pressure_rating = 900
        temperature_rating = 900
        elsif  pressure > 900 and pressure <= 1350 
        flange_class = "900"
        pressure_rating = 1350
        temperature_rating = 900
        elsif  pressure > 1350 and pressure <= 2245 
        flange_class = "1500"
        pressure_rating = 2245
        temperature_rating = 900
        elsif  pressure > 2245 and pressure <= 3745 
        flange_class = "2500"
        pressure_rating = 3745
        temperature_rating = 900
        
        end
    elsif temperature > 900 and temperature <= 950 
        if pressure <= 35 
        flange_class = "150"
        pressure_rating = 35
        temperature_rating = 950
        elsif  pressure > 35 and pressure <= 375 
        flange_class = "300"
        pressure_rating = 375
        temperature_rating = 950
        elsif  pressure > 375 and pressure <= 505 
        flange_class = "400"
        pressure_rating = 505
        temperature_rating = 950
        elsif  pressure > 505 and pressure <= 755 
        flange_class = "600"
        pressure_rating = 755
        temperature_rating = 950
        elsif  pressure > 755 and pressure <= 1130 
        flange_class = "900"
        pressure_rating = 1130
        temperature_rating = 950
        elsif  pressure > 1130 and pressure <= 1885 
        flange_class = "1500"
        pressure_rating = 1885
        temperature_rating = 950
        elsif  pressure > 1885 and pressure <= 3145 
        flange_class = "2500"
        pressure_rating = 3145
        temperature_rating = 950
        
        end
    elsif temperature > 950 and temperature <= 1000 
        if pressure <= 20 
        flange_class = "150"
        pressure_rating = 20
        temperature_rating = 1000
        elsif  pressure > 20 and pressure <= 255 
        flange_class = "300"
        pressure_rating = 255
        temperature_rating = 1000
        elsif  pressure > 255 and pressure <= 340 
        flange_class = "400"
        pressure_rating = 340
        temperature_rating = 1000
        elsif  pressure > 340 and pressure <= 505 
        flange_class = "600"
        pressure_rating = 505
        temperature_rating = 1000
        elsif  pressure > 505 and pressure <= 760 
        flange_class = "900"
        pressure_rating = 760
        temperature_rating = 1000
        elsif  pressure > 760 and pressure <= 1270 
        flange_class = "1500"
        pressure_rating = 1270
        temperature_rating = 1000
        elsif  pressure > 1270 and pressure <= 2115 
        flange_class = "2500"
        pressure_rating = 2115
        temperature_rating = 1000
        
        end
    elsif temperature > 1000 and temperature <= 1050 
        if pressure > 170 
        flange_class = "300"
        pressure_rating = 170
        temperature_rating = 1050
        elsif  pressure > 170 and pressure <= 230 
        flange_class = "400"
        pressure_rating = 230
        temperature_rating = 1050
        elsif  pressure > 230 and pressure <= 345 
        flange_class = "600"
        pressure_rating = 345
        temperature_rating = 1050
        elsif  pressure > 345 and pressure <= 515 
        flange_class = "900"
        pressure_rating = 515
        temperature_rating = 1050
        elsif  pressure > 515 and pressure <= 855 
        flange_class = "1500"
        pressure_rating = 855
        temperature_rating = 1050
        elsif  pressure > 855 and pressure <= 1430 
        flange_class = "2500"
        pressure_rating = 1430
        temperature_rating = 1050
        
        end
    elsif temperature > 1050 and temperature <= 1100 
        if pressure > 115 
        flange_class = "300"
        pressure_rating = 115
        temperature_rating = 1100
        elsif  pressure > 115 and pressure <= 150 
        flange_class = "400"
        pressure_rating = 150
        temperature_rating = 1100
        elsif  pressure > 150 and pressure <= 225 
        flange_class = "600"
        pressure_rating = 225
        temperature_rating = 1100
        elsif  pressure > 225 and pressure <= 340 
        flange_class = "900"
        pressure_rating = 340
        temperature_rating = 1100
        elsif  pressure > 340 and pressure <= 565 
        flange_class = "1500"
        pressure_rating = 565
        temperature_rating = 1100
        elsif  pressure > 565 and pressure <= 945 
        flange_class = "2500"
        pressure_rating = 945
        temperature_rating = 1100
        
        end
    elsif temperature > 1100 and temperature <= 1150 
        if pressure > 75 
        flange_class = "300"
        pressure_rating = 75
        temperature_rating = 1150
        elsif  pressure > 75 and pressure <= 100 
        flange_class = "400"
        pressure_rating = 100
        temperature_rating = 1150
        elsif  pressure > 100 and pressure <= 150 
        flange_class = "600"
        pressure_rating = 150
        temperature_rating = 1150
        elsif  pressure > 150 and pressure <= 225 
        flange_class = "900"
        pressure_rating = 225
        temperature_rating = 1150
        elsif  pressure > 225 and pressure <= 375 
        flange_class = "1500"
        pressure_rating = 375
        temperature_rating = 1150
        elsif  pressure > 375 and pressure <= 630 
        flange_class = "2500"
        pressure_rating = 630
        temperature_rating = 1150
        
        end
    elsif temperature > 1150 and temperature <= 1200 
        if pressure > 50 
        flange_class = "300"
        pressure_rating = 50
        temperature_rating = 1200
        elsif  pressure > 50 and pressure <= 70 
        flange_class = "400"
        pressure_rating = 70
        temperature_rating = 1200
        elsif  pressure > 70 and pressure <= 105 
        flange_class = "600"
        pressure_rating = 105
        temperature_rating = 1200
        elsif  pressure > 105 and pressure <= 155 
        flange_class = "900"
        pressure_rating = 155
        temperature_rating = 1200
        elsif  pressure > 155 and pressure <= 255 
        flange_class = "1500"
        pressure_rating = 255
        temperature_rating = 1200
        elsif  pressure > 225 and pressure <= 430 
        flange_class = "2500"
        pressure_rating = 430
        temperature_rating = 1050
        
        end
    
    end
    
    if Worksheets("UOM").chkCustomary.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) Use normalized and tempered material only."
    elsif orksheets("UOM").chkSI.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) Use normalized and tempered material only."
    
    end
    
elsif material_group = "1.15" 
UserFormLineSegmentDesign.cmbMaterialDesignation.RowSource = "MaterialGroup1.15"
    if temperature >= -20 and temperature <= 100 
        if pressure <= 290 
        flange_class = "150"
        pressure_rating = 290
        temperature_rating = 100
        elsif  pressure > 290 and pressure <= 750 
        flange_class = "300"
        pressure_rating = 750
        temperature_rating = 100
        elsif  pressure > 750 and pressure <= 1000 
        flange_class = "400"
        pressure_rating = 1000
        temperature_rating = 100
        elsif  pressure > 1000 and pressure <= 1500 
        flange_class = "600"
        pressure_rating = 1500
        temperature_rating = 100
        elsif  pressure > 1500 and pressure <= 2250 
        flange_class = "900"
        pressure_rating = 2250
        temperature_rating = 100
        elsif  pressure > 2250 and pressure <= 3750 
        flange_class = "1500"
        pressure_rating = 3750
        temperature_rating = 100
        elsif  pressure > 3750 and pressure <= 6250 
        flange_class = "2500"
        pressure_rating = 6250
        temperature_rating = 100
        
        end
    elsif temperature > 100 and temperature <= 200 
        if pressure <= 260 
        flange_class = "150"
        pressure_rating = 260
        temperature_rating = 200
        elsif  pressure > 260 and pressure <= 750 
        flange_class = "300"
        pressure_rating = 750
        temperature_rating = 200
        elsif  pressure > 750 and pressure <= 1000 
        flange_class = "400"
        pressure_rating = 1000
        temperature_rating = 200
        elsif  pressure > 1000 and pressure <= 1500 
        flange_class = "600"
        pressure_rating = 1500
        temperature_rating = 200
        elsif  pressure > 1500 and pressure <= 2250 
        flange_class = "900"
        pressure_rating = 2250
        temperature_rating = 200
        elsif  pressure > 2250 and pressure <= 3750 
        flange_class = "1500"
        pressure_rating = 3750
        temperature_rating = 200
        elsif  pressure > 3750 and pressure <= 6250 
        flange_class = "2500"
        pressure_rating = 6250
        temperature_rating = 200
        
        end
    elsif temperature > 200 and temperature <= 300 
        if pressure <= 230 
        flange_class = "150"
        pressure_rating = 230
        temperature_rating = 300
        elsif  pressure > 230 and pressure <= 730 
        flange_class = "300"
        pressure_rating = 730
        temperature_rating = 300
        elsif  pressure > 730 and pressure <= 970 
        flange_class = "400"
        pressure_rating = 970
        temperature_rating = 300
        elsif  pressure > 970 and pressure <= 1455 
        flange_class = "600"
        pressure_rating = 1455
        temperature_rating = 300
        elsif  pressure > 1455 and pressure <= 2185 
        flange_class = "900"
        pressure_rating = 2185
        temperature_rating = 300
        elsif  pressure > 2185 and pressure <= 3640 
        flange_class = "1500"
        pressure_rating = 3640
        temperature_rating = 300
        elsif  pressure > 3640 and pressure <= 6070 
        flange_class = "2500"
        pressure_rating = 6070
        temperature_rating = 300
        
        end
    elsif temperature > 300 and temperature <= 400 
        if pressure <= 200 
        flange_class = "150"
        pressure_rating = 200
        temperature_rating = 400
        elsif  pressure > 200 and pressure <= 705 
        flange_class = "300"
        pressure_rating = 705
        temperature_rating = 400
        elsif  pressure > 705 and pressure <= 940 
        flange_class = "400"
        pressure_rating = 940
        temperature_rating = 400
        elsif  pressure > 940 and pressure <= 1410 
        flange_class = "600"
        pressure_rating = 1410
        temperature_rating = 400
        elsif  pressure > 1410 and pressure <= 2115 
        flange_class = "900"
        pressure_rating = 2115
        temperature_rating = 400
        elsif  pressure > 2115 and pressure <= 3530 
        flange_class = "1500"
        pressure_rating = 3530
        temperature_rating = 400
        elsif  pressure > 3530 and pressure <= 5880 
        flange_class = "2500"
        pressure_rating = 5880
        temperature_rating = 400
        
        end
    elsif temperature > 400 and temperature <= 500 
        if pressure <= 170 
        flange_class = "150"
        pressure_rating = 170
        temperature_rating = 500
        elsif  pressure > 170 and pressure <= 665 
        flange_class = "300"
        pressure_rating = 665
        temperature_rating = 500
        elsif  pressure > 665 and pressure <= 885 
        flange_class = "400"
        pressure_rating = 885
        temperature_rating = 500
        elsif  pressure > 885 and pressure <= 1330 
        flange_class = "600"
        pressure_rating = 1330
        temperature_rating = 500
        elsif  pressure > 1330 and pressure <= 1995 
        flange_class = "900"
        pressure_rating = 1995
        temperature_rating = 500
        elsif  pressure > 1995 and pressure <= 3325 
        flange_class = "1500"
        pressure_rating = 3325
        temperature_rating = 500
        elsif  pressure > 3325 and pressure <= 5540 
        flange_class = "2500"
        pressure_rating = 5540
        temperature_rating = 500
        
        end
    elsif temperature > 500 and temperature <= 600 
        if pressure <= 140 
        flange_class = "150"
        pressure_rating = 140
        temperature_rating = 600
        elsif  pressure > 140 and pressure <= 605 
        flange_class = "300"
        pressure_rating = 605
        temperature_rating = 600
        elsif  pressure > 605 and pressure <= 805 
        flange_class = "400"
        pressure_rating = 805
        temperature_rating = 600
        elsif  pressure > 805 and pressure <= 1210 
        flange_class = "600"
        pressure_rating = 1210
        temperature_rating = 600
        elsif  pressure > 1210 and pressure <= 1815 
        flange_class = "900"
        pressure_rating = 1815
        temperature_rating = 600
        elsif  pressure > 1815 and pressure <= 3025 
        flange_class = "1500"
        pressure_rating = 3025
        temperature_rating = 600
        elsif  pressure > 3025 and pressure <= 5040 
        flange_class = "2500"
        pressure_rating = 5040
        temperature_rating = 600
        
        end
    elsif temperature > 600 and temperature <= 650 
        if pressure <= 125 
        flange_class = "150"
        pressure_rating = 125
        temperature_rating = 650
        elsif  pressure > 125 and pressure <= 590 
        flange_class = "300"
        pressure_rating = 590
        temperature_rating = 650
        elsif  pressure > 590 and pressure <= 785 
        flange_class = "400"
        pressure_rating = 785
        temperature_rating = 650
        elsif  pressure > 785 and pressure <= 1175 
        flange_class = "600"
        pressure_rating = 1175
        temperature_rating = 650
        elsif  pressure > 1175 and pressure <= 1765 
        flange_class = "900"
        pressure_rating = 1765
        temperature_rating = 650
        elsif  pressure > 1765 and pressure <= 2940 
        flange_class = "1500"
        pressure_rating = 2940
        temperature_rating = 650
        elsif  pressure > 2940 and pressure <= 4905 
        flange_class = "2500"
        pressure_rating = 4905
        temperature_rating = 650
        
        end
    elsif temperature > 650 and temperature <= 700 
        if pressure <= 110 
        flange_class = "150"
        pressure_rating = 110
        temperature_rating = 700
        elsif  pressure > 110 and pressure <= 570 
        flange_class = "300"
        pressure_rating = 570
        temperature_rating = 700
        elsif  pressure > 570 and pressure <= 755 
        flange_class = "400"
        pressure_rating = 755
        temperature_rating = 700
        elsif  pressure > 755 and pressure <= 1135 
        flange_class = "600"
        pressure_rating = 1135
        temperature_rating = 700
        elsif  pressure > 1135 and pressure <= 1705 
        flange_class = "900"
        pressure_rating = 1705
        temperature_rating = 700
        elsif  pressure > 1705 and pressure <= 2840 
        flange_class = "1500"
        pressure_rating = 2840
        temperature_rating = 700
        elsif  pressure > 2840 and pressure <= 4730 
        flange_class = "2500"
        pressure_rating = 4730
        temperature_rating = 700
        
        end
    elsif temperature > 700 and temperature <= 750 
        if pressure <= 95 
        flange_class = "150"
        pressure_rating = 95
        temperature_rating = 750
        elsif  pressure > 95 and pressure <= 530 
        flange_class = "300"
        pressure_rating = 530
        temperature_rating = 750
        elsif  pressure > 530 and pressure <= 710 
        flange_class = "400"
        pressure_rating = 710
        temperature_rating = 750
        elsif  pressure > 710 and pressure <= 1065 
        flange_class = "600"
        pressure_rating = 1065
        temperature_rating = 750
        elsif  pressure > 1065 and pressure <= 1595 
        flange_class = "900"
        pressure_rating = 1595
        temperature_rating = 750
        elsif  pressure > 1595 and pressure <= 2660 
        flange_class = "1500"
        pressure_rating = 2660
        temperature_rating = 750
        elsif  pressure > 2660 and pressure <= 4430 
        flange_class = "2500"
        pressure_rating = 4430
        temperature_rating = 750
        
        end
    elsif temperature > 750 and temperature <= 800 
        if pressure <= 80 
        flange_class = "150"
        pressure_rating = 80
        temperature_rating = 800
        elsif  pressure > 80 and pressure <= 510 
        flange_class = "300"
        pressure_rating = 510
        temperature_rating = 800
        elsif  pressure > 510 and pressure <= 675 
        flange_class = "400"
        pressure_rating = 675
        temperature_rating = 800
        elsif  pressure > 675 and pressure <= 1015 
        flange_class = "600"
        pressure_rating = 1015
        temperature_rating = 800
        elsif  pressure > 1015 and pressure <= 1525 
        flange_class = "900"
        pressure_rating = 1525
        temperature_rating = 800
        elsif  pressure > 1525 and pressure <= 2540 
        flange_class = "1500"
        pressure_rating = 2540
        temperature_rating = 800
        elsif  pressure > 2540 and pressure <= 4230 
        flange_class = "2500"
        pressure_rating = 4230
        temperature_rating = 800
        
        end
    elsif temperature > 800 and temperature <= 850 
        if pressure <= 65 
        flange_class = "150"
        pressure_rating = 65
        temperature_rating = 850
        elsif  pressure > 65 and pressure <= 485 
        flange_class = "300"
        pressure_rating = 485
        temperature_rating = 850
        elsif  pressure > 485 and pressure <= 650 
        flange_class = "400"
        pressure_rating = 650
        temperature_rating = 850
        elsif  pressure > 650 and pressure <= 975 
        flange_class = "600"
        pressure_rating = 975
        temperature_rating = 850
        elsif  pressure > 975 and pressure <= 1460 
        flange_class = "900"
        pressure_rating = 1460
        temperature_rating = 850
        elsif  pressure > 1460 and pressure <= 2435 
        flange_class = "1500"
        pressure_rating = 2435
        temperature_rating = 850
        elsif  pressure > 2435 and pressure <= 4060 
        flange_class = "2500"
        pressure_rating = 4060
        temperature_rating = 850
        
        end
    elsif temperature > 850 and temperature <= 900 
        if pressure <= 50 
        flange_class = "150"
        pressure_rating = 50
        temperature_rating = 900
        elsif  pressure > 50 and pressure <= 450 
        flange_class = "300"
        pressure_rating = 450
        temperature_rating = 900
        elsif  pressure > 450 and pressure <= 600 
        flange_class = "400"
        pressure_rating = 600
        temperature_rating = 900
        elsif  pressure > 600 and pressure <= 900 
        flange_class = "600"
        pressure_rating = 900
        temperature_rating = 900
        elsif  pressure > 900 and pressure <= 1350 
        flange_class = "900"
        pressure_rating = 1350
        temperature_rating = 900
        elsif  pressure > 1350 and pressure <= 2245 
        flange_class = "1500"
        pressure_rating = 2245
        temperature_rating = 900
        elsif  pressure > 2245 and pressure <= 3745 
        flange_class = "2500"
        pressure_rating = 3745
        temperature_rating = 900
        
        end
    elsif temperature > 900 and temperature <= 950 
        if pressure <= 35 
        flange_class = "150"
        pressure_rating = 35
        temperature_rating = 950
        elsif  pressure > 35 and pressure <= 385 
        flange_class = "300"
        pressure_rating = 385
        temperature_rating = 950
        elsif  pressure > 385 and pressure <= 515 
        flange_class = "400"
        pressure_rating = 515
        temperature_rating = 950
        elsif  pressure > 515 and pressure <= 775 
        flange_class = "600"
        pressure_rating = 775
        temperature_rating = 950
        elsif  pressure > 775 and pressure <= 1160 
        flange_class = "900"
        pressure_rating = 1160
        temperature_rating = 950
        elsif  pressure > 1160 and pressure <= 1930 
        flange_class = "1500"
        pressure_rating = 1930
        temperature_rating = 950
        elsif  pressure > 1930 and pressure <= 3220 
        flange_class = "2500"
        pressure_rating = 3220
        temperature_rating = 950
        
        end
    elsif temperature > 950 and temperature <= 1000 
        if pressure <= 20 
        flange_class = "150"
        pressure_rating = 20
        temperature_rating = 1000
        elsif  pressure > 20 and pressure <= 365 
        flange_class = "300"
        pressure_rating = 365
        temperature_rating = 1000
        elsif  pressure > 365 and pressure <= 485 
        flange_class = "400"
        pressure_rating = 485
        temperature_rating = 1000
        elsif  pressure > 485 and pressure <= 725 
        flange_class = "600"
        pressure_rating = 725
        temperature_rating = 1000
        elsif  pressure > 725 and pressure <= 1090 
        flange_class = "900"
        pressure_rating = 1090
        temperature_rating = 1000
        elsif  pressure > 1090 and pressure <= 1820 
        flange_class = "1500"
        pressure_rating = 1820
        temperature_rating = 1000
        elsif  pressure > 1820 and pressure <= 3030 
        flange_class = "2500"
        pressure_rating = 3030
        temperature_rating = 1000
        
        end
    elsif temperature > 1000 and temperature <= 1050 
        if pressure > 360 
        flange_class = "300"
        pressure_rating = 360
        temperature_rating = 1050
        elsif  pressure > 360 and pressure <= 480 
        flange_class = "400"
        pressure_rating = 480
        temperature_rating = 1050
        elsif  pressure > 480 and pressure <= 720 
        flange_class = "600"
        pressure_rating = 720
        temperature_rating = 1050
        elsif  pressure > 720 and pressure <= 1080 
        flange_class = "900"
        pressure_rating = 1080
        temperature_rating = 1050
        elsif  pressure > 1080 and pressure <= 1800 
        flange_class = "1500"
        pressure_rating = 1800
        temperature_rating = 1050
        elsif  pressure > 1800 and pressure <= 3000 
        flange_class = "2500"
        pressure_rating = 3000
        temperature_rating = 1050
        
        end
    elsif temperature > 1050 and temperature <= 1100 
        if pressure > 300 
        flange_class = "300"
        pressure_rating = 300
        temperature_rating = 1100
        elsif  pressure > 300 and pressure <= 400 
        flange_class = "400"
        pressure_rating = 400
        temperature_rating = 1100
        elsif  pressure > 400 and pressure <= 605 
        flange_class = "600"
        pressure_rating = 605
        temperature_rating = 1100
        elsif  pressure > 605 and pressure <= 905 
        flange_class = "900"
        pressure_rating = 905
        temperature_rating = 1100
        elsif  pressure > 905 and pressure <= 1510 
        flange_class = "1500"
        pressure_rating = 1510
        temperature_rating = 1100
        elsif  pressure > 1510 and pressure <= 2515 
        flange_class = "2500"
        pressure_rating = 2515
        temperature_rating = 1100
        
        end
    elsif temperature > 1100 and temperature <= 1150 
        if pressure > 225 
        flange_class = "300"
        pressure_rating = 225
        temperature_rating = 1150
        elsif  pressure > 225 and pressure <= 295 
        flange_class = "400"
        pressure_rating = 295
        temperature_rating = 1150
        elsif  pressure > 295 and pressure <= 445 
        flange_class = "600"
        pressure_rating = 445
        temperature_rating = 1150
        elsif  pressure > 445 and pressure <= 670 
        flange_class = "900"
        pressure_rating = 670
        temperature_rating = 1150
        elsif  pressure > 670 and pressure <= 1115 
        flange_class = "1500"
        pressure_rating = 1115
        temperature_rating = 1150
        elsif  pressure > 1115 and pressure <= 1855 
        flange_class = "2500"
        pressure_rating = 1855
        temperature_rating = 1150
        
        end
    elsif temperature > 1150 and temperature <= 1200 
        if pressure > 145 
        flange_class = "300"
        pressure_rating = 145
        temperature_rating = 1200
        elsif  pressure > 145 and pressure <= 190 
        flange_class = "400"
        pressure_rating = 190
        temperature_rating = 1200
        elsif  pressure > 190 and pressure <= 290 
        flange_class = "600"
        pressure_rating = 290
        temperature_rating = 1200
        elsif  pressure > 290 and pressure <= 430 
        flange_class = "900"
        pressure_rating = 430
        temperature_rating = 1200
        elsif  pressure > 430 and pressure <= 720 
        flange_class = "1500"
        pressure_rating = 720
        temperature_rating = 1200
        elsif  pressure > 720 and pressure <= 1200 
        flange_class = "2500"
        pressure_rating = 1200
        temperature_rating = 1200
        
        end
    
    end
    
    if Worksheets("UOM").chkCustomary.Value = True 
    UserFormLineSegmentDesign.lblNotes = ""
    elsif orksheets("UOM").chkSI.Value = True 
    UserFormLineSegmentDesign.lblNotes = ""
    
    flange_classd if
    pressure_ratingElse
Call FlangePressuretemperature_rating3(pressure, temperature, MaterialGroup, FlangeClass, PressureRating, temperature_rating)
flange_class if

pressure_ratingSub

Sub FlangePressuretemperature_rating3(pressure, temperature, MaterialGroup, FlangeClass, PressureRating, temperature_rating)

if MaterialGroup = "1.17" 
UserFormLineSegmentDesign.cmbMaterialDesignation.RowSource = "MaterialGroup1.17"
    if temperature >= -20 and temperature <= 100 
        if pressure <= 290 
        flange_class = "150"
        pressure_rating = 290
        temperature_rating = 100
        elsif  pressure > 290 and pressure <= 750 
        flange_class = "300"
        pressure_rating = 750
        temperature_rating = 100
        elsif  pressure > 750 and pressure <= 1000 
        flange_class = "400"
        pressure_rating = 1000
        temperature_rating = 100
        elsif  pressure > 1000 and pressure <= 1500 
        flange_class = "600"
        pressure_rating = 1500
        temperature_rating = 100
        elsif  pressure > 1500 and pressure <= 2250 
        flange_class = "900"
        pressure_rating = 2250
        temperature_rating = 100
        elsif  pressure > 2250 and pressure <= 3750 
        flange_class = "1500"
        pressure_rating = 3750
        temperature_rating = 100
        elsif  pressure > 3750 and pressure <= 6250 
        flange_class = "2500"
        pressure_rating = 6250
        temperature_rating = 100
        
        end
    elsif temperature > 100 and temperature <= 200 
        if pressure <= 260 
        flange_class = "150"
        pressure_rating = 260
        temperature_rating = 200
        elsif  pressure > 260 and pressure <= 735 
        flange_class = "300"
        pressure_rating = 735
        temperature_rating = 200
        elsif  pressure > 735 and pressure <= 980 
        flange_class = "400"
        pressure_rating = 980
        temperature_rating = 200
        elsif  pressure > 980 and pressure <= 1470 
        flange_class = "600"
        pressure_rating = 1470
        temperature_rating = 200
        elsif  pressure > 1470 and pressure <= 2210 
        flange_class = "900"
        pressure_rating = 2210
        temperature_rating = 200
        elsif  pressure > 2210 and pressure <= 3680 
        flange_class = "1500"
        pressure_rating = 3380
        temperature_rating = 200
        elsif  pressure > 3680 and pressure <= 6135 
        flange_class = "2500"
        pressure_rating = 6135
        temperature_rating = 200
        
        end
    elsif temperature > 200 and temperature <= 300 
        if pressure <= 230 
        flange_class = "150"
        pressure_rating = 230
        temperature_rating = 300
        elsif  pressure > 230 and pressure <= 700 
        flange_class = "300"
        pressure_rating = 700
        temperature_rating = 300
        elsif  pressure > 700 and pressure <= 935 
        flange_class = "400"
        pressure_rating = 935
        temperature_rating = 300
        elsif  pressure > 935 and pressure <= 1400 
        flange_class = "600"
        pressure_rating = 1400
        temperature_rating = 300
        elsif  pressure > 1400 and pressure <= 2100 
        flange_class = "900"
        pressure_rating = 2100
        temperature_rating = 300
        elsif  pressure > 2100 and pressure <= 3495 
        flange_class = "1500"
        pressure_rating = 3495
        temperature_rating = 300
        elsif  pressure > 3495 and pressure <= 5830 
        flange_class = "2500"
        pressure_rating = 5830
        temperature_rating = 300
        
        end
    elsif temperature > 300 and temperature <= 400 
        if pressure <= 200 
        flange_class = "150"
        pressure_rating = 200
        temperature_rating = 400
        elsif  pressure > 200 and pressure <= 670 
        flange_class = "300"
        pressure_rating = 670
        temperature_rating = 400
        elsif  pressure > 670 and pressure <= 890 
        flange_class = "400"
        pressure_rating = 890
        temperature_rating = 400
        elsif  pressure > 890 and pressure <= 1335 
        flange_class = "600"
        pressure_rating = 1335
        temperature_rating = 400
        elsif  pressure > 1335 and pressure <= 2005 
        flange_class = "900"
        pressure_rating = 2005
        temperature_rating = 400
        elsif  pressure > 2005 and pressure <= 3345 
        flange_class = "1500"
        pressure_rating = 3345
        temperature_rating = 400
        elsif  pressure > 3345 and pressure <= 5570 
        flange_class = "2500"
        pressure_rating = 5570
        temperature_rating = 400
        
        end
    elsif temperature > 400 and temperature <= 500 
        if pressure <= 170 
        flange_class = "150"
        pressure_rating = 170
        temperature_rating = 500
        elsif  pressure > 170 and pressure <= 645 
        flange_class = "300"
        pressure_rating = 645
        temperature_rating = 500
        elsif  pressure > 645 and pressure <= 860 
        flange_class = "400"
        pressure_rating = 860
        temperature_rating = 500
        elsif  pressure > 860 and pressure <= 1290 
        flange_class = "600"
        pressure_rating = 1290
        temperature_rating = 500
        elsif  pressure > 1290 and pressure <= 1940 
        flange_class = "900"
        pressure_rating = 1940
        temperature_rating = 500
        elsif  pressure > 1940 and pressure <= 3230 
        flange_class = "1500"
        pressure_rating = 3230
        temperature_rating = 500
        elsif  pressure > 3230 and pressure <= 5385 
        flange_class = "2500"
        pressure_rating = 5385
        temperature_rating = 500
        
        end
    elsif temperature > 500 and temperature <= 600 
        if pressure <= 140 
        flange_class = "150"
        pressure_rating = 140
        temperature_rating = 600
        elsif  pressure > 140 and pressure <= 605 
        flange_class = "300"
        pressure_rating = 605
        temperature_rating = 600
        elsif  pressure > 605 and pressure <= 805 
        flange_class = "400"
        pressure_rating = 805
        temperature_rating = 600
        elsif  pressure > 805 and pressure <= 1210 
        flange_class = "600"
        pressure_rating = 1210
        temperature_rating = 600
        elsif  pressure > 1210 and pressure <= 1815 
        flange_class = "900"
        pressure_rating = 1815
        temperature_rating = 600
        elsif  pressure > 1815 and pressure <= 3025 
        flange_class = "1500"
        pressure_rating = 3025
        temperature_rating = 600
        elsif  pressure > 3025 and pressure <= 5040 
        flange_class = "2500"
        pressure_rating = 5040
        temperature_rating = 600
        
        end
    elsif temperature > 600 and temperature <= 650 
        if pressure <= 125 
        flange_class = "150"
        pressure_rating = 125
        temperature_rating = 650
        elsif  pressure > 125 and pressure <= 590 
        flange_class = "300"
        pressure_rating = 590
        temperature_rating = 650
        elsif  pressure > 590 and pressure <= 785 
        flange_class = "400"
        pressure_rating = 785
        temperature_rating = 650
        elsif  pressure > 785 and pressure <= 1175 
        flange_class = "600"
        pressure_rating = 1175
        temperature_rating = 650
        elsif  pressure > 1175 and pressure <= 1765 
        flange_class = "900"
        pressure_rating = 1765
        temperature_rating = 650
        elsif  pressure > 1765 and pressure <= 2940 
        flange_class = "1500"
        pressure_rating = 2940
        temperature_rating = 650
        elsif  pressure > 2940 and pressure <= 4905 
        flange_class = "2500"
        pressure_rating = 4905
        temperature_rating = 650
        
        end
    elsif temperature > 650 and temperature <= 700 
        if pressure <= 110 
        flange_class = "150"
        pressure_rating = 110
        temperature_rating = 700
        elsif  pressure > 110 and pressure <= 570 
        flange_class = "300"
        pressure_rating = 570
        temperature_rating = 700
        elsif  pressure > 570 and pressure <= 755 
        flange_class = "400"
        pressure_rating = 755
        temperature_rating = 700
        elsif  pressure > 755 and pressure <= 1135 
        flange_class = "600"
        pressure_rating = 1135
        temperature_rating = 700
        elsif  pressure > 1135 and pressure <= 1705 
        flange_class = "900"
        pressure_rating = 1705
        temperature_rating = 700
        elsif  pressure > 1705 and pressure <= 2840 
        flange_class = "1500"
        pressure_rating = 2840
        temperature_rating = 700
        elsif  pressure > 2840 and pressure <= 4730 
        flange_class = "2500"
        pressure_rating = 4730
        temperature_rating = 700
        
        end
    elsif temperature > 700 and temperature <= 750 
        if pressure <= 95 
        flange_class = "150"
        pressure_rating = 95
        temperature_rating = 750
        elsif  pressure > 95 and pressure <= 530 
        flange_class = "300"
        pressure_rating = 530
        temperature_rating = 750
        elsif  pressure > 530 and pressure <= 710 
        flange_class = "400"
        pressure_rating = 710
        temperature_rating = 750
        elsif  pressure > 710 and pressure <= 1065 
        flange_class = "600"
        pressure_rating = 1065
        temperature_rating = 750
        elsif  pressure > 1065 and pressure <= 1595 
        flange_class = "900"
        pressure_rating = 1595
        temperature_rating = 750
        elsif  pressure > 1595 and pressure <= 2660 
        flange_class = "1500"
        pressure_rating = 2660
        temperature_rating = 750
        elsif  pressure > 2660 and pressure <= 4430 
        flange_class = "2500"
        pressure_rating = 4430
        temperature_rating = 750
        
        end
    elsif temperature > 750 and temperature <= 800 
        if pressure <= 80 
        flange_class = "150"
        pressure_rating = 80
        temperature_rating = 800
        elsif  pressure > 80 and pressure <= 510 
        flange_class = "300"
        pressure_rating = 510
        temperature_rating = 800
        elsif  pressure > 510 and pressure <= 675 
        flange_class = "400"
        pressure_rating = 675
        temperature_rating = 800
        elsif  pressure > 675 and pressure <= 1015 
        flange_class = "600"
        pressure_rating = 1015
        temperature_rating = 800
        elsif  pressure > 1015 and pressure <= 1525 
        flange_class = "900"
        pressure_rating = 1525
        temperature_rating = 800
        elsif  pressure > 1525 and pressure <= 2540 
        flange_class = "1500"
        pressure_rating = 2540
        temperature_rating = 800
        elsif  pressure > 2540 and pressure <= 4230 
        flange_class = "2500"
        pressure_rating = 4230
        temperature_rating = 800
        
        end
    elsif temperature > 800 and temperature <= 850 
        if pressure <= 65 
        flange_class = "150"
        pressure_rating = 65
        temperature_rating = 850
        elsif  pressure > 65 and pressure <= 485 
        flange_class = "300"
        pressure_rating = 485
        temperature_rating = 850
        elsif  pressure > 485 and pressure <= 650 
        flange_class = "400"
        pressure_rating = 650
        temperature_rating = 850
        elsif  pressure > 650 and pressure <= 975 
        flange_class = "600"
        pressure_rating = 975
        temperature_rating = 850
        elsif  pressure > 975 and pressure <= 1460 
        flange_class = "900"
        pressure_rating = 1460
        temperature_rating = 850
        elsif  pressure > 1460 and pressure <= 2435 
        flange_class = "1500"
        pressure_rating = 2435
        temperature_rating = 850
        elsif  pressure > 2435 and pressure <= 4060 
        flange_class = "2500"
        pressure_rating = 4060
        temperature_rating = 850
        
        end
    elsif temperature > 850 and temperature <= 900 
        if pressure <= 50 
        flange_class = "150"
        pressure_rating = 50
        temperature_rating = 900
        elsif  pressure > 50 and pressure <= 375 
        flange_class = "300"
        pressure_rating = 375
        temperature_rating = 900
        elsif  pressure > 375 and pressure <= 500 
        flange_class = "400"
        pressure_rating = 500
        temperature_rating = 900
        elsif  pressure > 500 and pressure <= 745 
        flange_class = "600"
        pressure_rating = 745
        temperature_rating = 900
        elsif  pressure > 745 and pressure <= 1120 
        flange_class = "900"
        pressure_rating = 1120
        temperature_rating = 900
        elsif  pressure > 1120 and pressure <= 1870 
        flange_class = "1500"
        pressure_rating = 1870
        temperature_rating = 900
        elsif  pressure > 1870 and pressure <= 3115 
        flange_class = "2500"
        pressure_rating = 3115
        temperature_rating = 900
        
        end
    elsif temperature > 900 and temperature <= 950 
        if pressure <= 35 
        flange_class = "150"
        pressure_rating = 35
        temperature_rating = 950
        elsif  pressure > 35 and pressure <= 275 
        flange_class = "300"
        pressure_rating = 275
        temperature_rating = 950
        elsif  pressure > 275 and pressure <= 365 
        flange_class = "400"
        pressure_rating = 365
        temperature_rating = 950
        elsif  pressure > 365 and pressure <= 550 
        flange_class = "600"
        pressure_rating = 550
        temperature_rating = 950
        elsif  pressure > 550 and pressure <= 825 
        flange_class = "900"
        pressure_rating = 825
        temperature_rating = 950
        elsif  pressure > 825 and pressure <= 1370 
        flange_class = "1500"
        pressure_rating = 1370
        temperature_rating = 950
        elsif  pressure > 1370 and pressure <= 2285 
        flange_class = "2500"
        pressure_rating = 2285
        temperature_rating = 950
        
        end
    elsif temperature > 950 and temperature <= 1000 
        if pressure <= 20 
        flange_class = "150"
        pressure_rating = 20
        temperature_rating = 1000
        elsif  pressure > 20 and pressure <= 200 
        flange_class = "300"
        pressure_rating = 200
        temperature_rating = 1000
        elsif  pressure > 200 and pressure <= 265 
        flange_class = "400"
        pressure_rating = 265
        temperature_rating = 1000
        elsif  pressure > 265 and pressure <= 400 
        flange_class = "600"
        pressure_rating = 400
        temperature_rating = 1000
        elsif  pressure > 400 and pressure <= 595 
        flange_class = "900"
        pressure_rating = 595
        temperature_rating = 1000
        elsif  pressure > 595 and pressure <= 995 
        flange_class = "1500"
        pressure_rating = 995
        temperature_rating = 1000
        elsif  pressure > 995 and pressure <= 1655 
        flange_class = "2500"
        pressure_rating = 1655
        temperature_rating = 1000
        
        end
    elsif temperature > 1000 and temperature <= 1050 
        if pressure > 145 
        flange_class = "300"
        pressure_rating = 145
        temperature_rating = 1050
        elsif  pressure > 145 and pressure <= 190 
        flange_class = "400"
        pressure_rating = 190
        temperature_rating = 1050
        elsif  pressure > 190 and pressure <= 290 
        flange_class = "600"
        pressure_rating = 290
        temperature_rating = 1050
        elsif  pressure > 290 and pressure <= 430 
        flange_class = "900"
        pressure_rating = 430
        temperature_rating = 1050
        elsif  pressure > 430 and pressure <= 720 
        flange_class = "1500"
        pressure_rating = 720
        temperature_rating = 1050
        elsif  pressure > 720 and pressure <= 1200 
        flange_class = "2500"
        pressure_rating = 1200
        temperature_rating = 1050
        
        end
    elsif temperature > 1050 and temperature <= 1100 
        if pressure > 95 
        flange_class = "300"
        pressure_rating = 95
        temperature_rating = 1100
        elsif  pressure > 95 and pressure <= 130 
        flange_class = "400"
        pressure_rating = 130
        temperature_rating = 1100
        elsif  pressure > 130 and pressure <= 190 
        flange_class = "600"
        pressure_rating = 190
        temperature_rating = 1100
        elsif  pressure > 190 and pressure <= 290 
        flange_class = "900"
        pressure_rating = 290
        temperature_rating = 1100
        elsif  pressure > 290 and pressure <= 480 
        flange_class = "1500"
        pressure_rating = 480
        temperature_rating = 1100
        elsif  pressure > 480 and pressure <= 800 
        flange_class = "2500"
        pressure_rating = 800
        temperature_rating = 1100
        
        end
    elsif temperature > 1100 and temperature <= 1150 
        if pressure > 60 
        flange_class = "300"
        pressure_rating = 60
        temperature_rating = 1150
        elsif  pressure > 60 and pressure <= 80 
        flange_class = "400"
        pressure_rating = 80
        temperature_rating = 1150
        elsif  pressure > 80 and pressure <= 125 
        flange_class = "600"
        pressure_rating = 125
        temperature_rating = 1150
        elsif  pressure > 125 and pressure <= 185 
        flange_class = "900"
        pressure_rating = 185
        temperature_rating = 1150
        elsif  pressure > 185 and pressure <= 310 
        flange_class = "1500"
        pressure_rating = 310
        temperature_rating = 1150
        elsif  pressure > 310 and pressure <= 515 
        flange_class = "2500"
        pressure_rating = 515
        temperature_rating = 1150
        
        end
    elsif temperature > 1150 and temperature <= 1200 
        if pressure > 35 
        flange_class = "300"
        pressure_rating = 35
        temperature_rating = 1200
        elsif  pressure > 35 and pressure <= 45 
        flange_class = "400"
        pressure_rating = 45
        temperature_rating = 1200
        elsif  pressure > 45 and pressure <= 70 
        flange_class = "600"
        pressure_rating = 70
        temperature_rating = 1200
        elsif  pressure > 70 and pressure <= 105 
        flange_class = "900"
        pressure_rating = 105
        temperature_rating = 1200
        elsif  pressure > 105 and pressure <= 170 
        flange_class = "1500"
        pressure_rating = 170
        temperature_rating = 1200
        elsif  pressure > 170 and pressure <= 285 
        flange_class = "2500"
        pressure_rating = 285
        temperature_rating = 1200
        
        end
    
    end
    
    if Worksheets("UOM").chkCustomary.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) Use normalized and tempered material only." & Chr(13) _
    & "(2) Permissible, but not recommended for prolonged use above 1100\B0F."
    elsif orksheets("UOM").chkSI.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) Use normalized and tempered material only." & Chr(13) _
    & "(2) Permissible, but not recommended for prolonged use above 590\B0C."
    
    end
    
elsif material_group = "2.1" 
UserFormLineSegmentDesign.cmbMaterialDesignation.RowSource = "MaterialGroup2.1"
    if temperature >= -20 and temperature <= 100 
        if pressure <= 275 
        flange_class = "150"
        pressure_rating = 275
        temperature_rating = 100
        elsif  pressure > 275 and pressure <= 720 
        flange_class = "300"
        pressure_rating = 720
        temperature_rating = 100
        elsif  pressure > 720 and pressure <= 960 
        flange_class = "400"
        pressure_rating = 960
        temperature_rating = 100
        elsif  pressure > 960 and pressure <= 1440 
        flange_class = "600"
        pressure_rating = 1440
        temperature_rating = 100
        elsif  pressure > 1440 and pressure <= 2160 
        flange_class = "900"
        pressure_rating = 2160
        temperature_rating = 100
        elsif  pressure > 2160 and pressure <= 3600 
        flange_class = "1500"
        pressure_rating = 3600
        temperature_rating = 100
        elsif  pressure > 3600 and pressure <= 6000 
        flange_class = "2500"
        pressure_rating = 6000
        temperature_rating = 100
        
        end
    elsif temperature > 100 and temperature <= 200 
        if pressure <= 230 
        flange_class = "150"
        pressure_rating = 230
        temperature_rating = 200
        elsif  pressure > 230 and pressure <= 600 
        flange_class = "300"
        pressure_rating = 600
        temperature_rating = 200
        elsif  pressure > 600 and pressure <= 800 
        flange_class = "400"
        pressure_rating = 800
        temperature_rating = 200
        elsif  pressure > 800 and pressure <= 1200 
        flange_class = "600"
        pressure_rating = 1200
        temperature_rating = 200
        elsif  pressure > 1200 and pressure <= 1800 
        flange_class = "900"
        pressure_rating = 1800
        temperature_rating = 200
        elsif  pressure > 1800 and pressure <= 3000 
        flange_class = "1500"
        pressure_rating = 3000
        temperature_rating = 200
        elsif  pressure > 3000 and pressure <= 5000 
        flange_class = "2500"
        pressure_rating = 5000
        temperature_rating = 200
        
        end
    elsif temperature > 200 and temperature <= 300 
        if pressure <= 205 
        flange_class = "150"
        pressure_rating = 205
        temperature_rating = 300
        elsif  pressure > 205 and pressure <= 540 
        flange_class = "300"
        pressure_rating = 540
        temperature_rating = 300
        elsif  pressure > 540 and pressure <= 715 
        flange_class = "400"
        pressure_rating = 715
        temperature_rating = 300
        elsif  pressure > 715 and pressure <= 1075 
        flange_class = "600"
        pressure_rating = 1075
        temperature_rating = 300
        elsif  pressure > 1075 and pressure <= 1615 
        flange_class = "900"
        pressure_rating = 1615
        temperature_rating = 300
        elsif  pressure > 1615 and pressure <= 2690 
        flange_class = "1500"
        pressure_rating = 2690
        temperature_rating = 300
        elsif  pressure > 2690 and pressure <= 4480 
        flange_class = "2500"
        pressure_rating = 4480
        temperature_rating = 300
        
        end
    elsif temperature > 300 and temperature <= 400 
        if pressure <= 190 
        flange_class = "150"
        pressure_rating = 190
        temperature_rating = 400
        elsif  pressure > 190 and pressure <= 495 
        flange_class = "300"
        pressure_rating = 495
        temperature_rating = 400
        elsif  pressure > 495 and pressure <= 660 
        flange_class = "400"
        pressure_rating = 660
        temperature_rating = 400
        elsif  pressure > 660 and pressure <= 995 
        flange_class = "600"
        pressure_rating = 995
        temperature_rating = 400
        elsif  pressure > 995 and pressure <= 1490 
        flange_class = "900"
        pressure_rating = 1490
        temperature_rating = 400
        elsif  pressure > 1490 and pressure <= 2485 
        flange_class = "1500"
        pressure_rating = 2485
        temperature_rating = 400
        elsif  pressure > 2485 and pressure <= 4140 
        flange_class = "2500"
        pressure_rating = 4140
        temperature_rating = 400
        
        end
    elsif temperature > 400 and temperature <= 500 
        if pressure <= 170 
        flange_class = "150"
        pressure_rating = 170
        temperature_rating = 500
        elsif  pressure > 170 and pressure <= 465 
        flange_class = "300"
        pressure_rating = 465
        temperature_rating = 500
        elsif  pressure > 465 and pressure <= 620 
        flange_class = "400"
        pressure_rating = 620
        temperature_rating = 500
        elsif  pressure > 620 and pressure <= 930 
        flange_class = "600"
        pressure_rating = 930
        temperature_rating = 500
        elsif  pressure > 930 and pressure <= 1395 
        flange_class = "900"
        pressure_rating = 1395
        temperature_rating = 500
        elsif  pressure > 1395 and pressure <= 2330 
        flange_class = "1500"
        pressure_rating = 2330
        temperature_rating = 500
        elsif  pressure > 2330 and pressure <= 3880 
        flange_class = "2500"
        pressure_rating = 3880
        temperature_rating = 500
        
        end
    elsif temperature > 500 and temperature <= 600 
        if pressure <= 140 
        flange_class = "150"
        pressure_rating = 140
        temperature_rating = 600
        elsif  pressure > 140 and pressure <= 440 
        flange_class = "300"
        pressure_rating = 440
        temperature_rating = 600
        elsif  pressure > 440 and pressure <= 590 
        flange_class = "400"
        pressure_rating = 590
        temperature_rating = 600
        elsif  pressure > 590 and pressure <= 885 
        flange_class = "600"
        pressure_rating = 885
        temperature_rating = 600
        elsif  pressure > 885 and pressure <= 1325 
        flange_class = "900"
        pressure_rating = 1325
        temperature_rating = 600
        elsif  pressure > 1325 and pressure <= 2210 
        flange_class = "1500"
        pressure_rating = 2210
        temperature_rating = 600
        elsif  pressure > 2210 and pressure <= 3680 
        flange_class = "2500"
        pressure_rating = 3680
        temperature_rating = 600
        
        end
    elsif temperature > 600 and temperature <= 650 
        if pressure <= 125 
        flange_class = "150"
        pressure_rating = 125
        temperature_rating = 650
        elsif  pressure > 125 and pressure <= 430 
        flange_class = "300"
        pressure_rating = 430
        temperature_rating = 650
        elsif  pressure > 430 and pressure <= 575 
        flange_class = "400"
        pressure_rating = 575
        temperature_rating = 650
        elsif  pressure > 575 and pressure <= 865 
        flange_class = "600"
        pressure_rating = 865
        temperature_rating = 650
        elsif  pressure > 865 and pressure <= 1295 
        flange_class = "900"
        pressure_rating = 1295
        temperature_rating = 650
        elsif  pressure > 1295 and pressure <= 2160 
        flange_class = "1500"
        pressure_rating = 2160
        temperature_rating = 650
        elsif  pressure > 2160 and pressure <= 3600 
        flange_class = "2500"
        pressure_rating = 3600
        temperature_rating = 650
        
        end
    elsif temperature > 650 and temperature <= 700 
        if pressure <= 110 
        flange_class = "150"
        pressure_rating = 110
        temperature_rating = 700
        elsif  pressure > 110 and pressure <= 420 
        flange_class = "300"
        pressure_rating = 420
        temperature_rating = 700
        elsif  pressure > 420 and pressure <= 565 
        flange_class = "400"
        pressure_rating = 565
        temperature_rating = 700
        elsif  pressure > 565 and pressure <= 845 
        flange_class = "600"
        pressure_rating = 845
        temperature_rating = 700
        elsif  pressure > 845 and pressure <= 1265 
        flange_class = "900"
        pressure_rating = 1265
        temperature_rating = 700
        elsif  pressure > 1265 and pressure <= 2110 
        flange_class = "1500"
        pressure_rating = 2110
        temperature_rating = 700
        elsif  pressure > 2110 and pressure <= 3520 
        flange_class = "2500"
        pressure_rating = 3520
        temperature_rating = 700
        
        end
    elsif temperature > 700 and temperature <= 750 
        if pressure <= 95 
        flange_class = "150"
        pressure_rating = 95
        temperature_rating = 750
        elsif  pressure > 95 and pressure <= 415 
        flange_class = "300"
        pressure_rating = 415
        temperature_rating = 750
        elsif  pressure > 415 and pressure <= 550 
        flange_class = "400"
        pressure_rating = 550
        temperature_rating = 750
        elsif  pressure > 550 and pressure <= 825 
        flange_class = "600"
        pressure_rating = 825
        temperature_rating = 750
        elsif  pressure > 825 and pressure <= 1240 
        flange_class = "900"
        pressure_rating = 1240
        temperature_rating = 750
        elsif  pressure > 1240 and pressure <= 2065 
        flange_class = "1500"
        pressure_rating = 2065
        temperature_rating = 750
        elsif  pressure > 2065 and pressure <= 3440 
        flange_class = "2500"
        pressure_rating = 3440
        temperature_rating = 750
        
        end
    elsif temperature > 750 and temperature <= 800 
        if pressure <= 80 
        flange_class = "150"
        pressure_rating = 80
        temperature_rating = 800
        elsif  pressure > 80 and pressure <= 405 
        flange_class = "300"
        pressure_rating = 405
        temperature_rating = 800
        elsif  pressure > 405 and pressure <= 540 
        flange_class = "400"
        pressure_rating = 540
        temperature_rating = 800
        elsif  pressure > 540 and pressure <= 810 
        flange_class = "600"
        pressure_rating = 810
        temperature_rating = 800
        elsif  pressure > 810 and pressure <= 1215 
        flange_class = "900"
        pressure_rating = 1215
        temperature_rating = 800
        elsif  pressure > 1215 and pressure <= 2030 
        flange_class = "1500"
        pressure_rating = 2030
        temperature_rating = 800
        elsif  pressure > 2030 and pressure <= 3380 
        flange_class = "2500"
        pressure_rating = 3380
        temperature_rating = 800
        
        end
    elsif temperature > 800 and temperature <= 850 
        if pressure <= 65 
        flange_class = "150"
        pressure_rating = 65
        temperature_rating = 850
        elsif  pressure > 65 and pressure <= 395 
        flange_class = "300"
        pressure_rating = 395
        temperature_rating = 850
        elsif  pressure > 395 and pressure <= 530 
        flange_class = "400"
        pressure_rating = 530
        temperature_rating = 850
        elsif  pressure > 530 and pressure <= 790 
        flange_class = "600"
        pressure_rating = 790
        temperature_rating = 850
        elsif  pressure > 790 and pressure <= 1190 
        flange_class = "900"
        pressure_rating = 1190
        temperature_rating = 850
        elsif  pressure > 1190 and pressure <= 1980 
        flange_class = "1500"
        pressure_rating = 1980
        temperature_rating = 850
        elsif  pressure > 1980 and pressure <= 3300 
        flange_class = "2500"
        pressure_rating = 3300
        temperature_rating = 850
        
        end
    elsif temperature > 850 and temperature <= 900 
        if pressure <= 50 
        flange_class = "150"
        pressure_rating = 50
        temperature_rating = 900
        elsif  pressure > 50 and pressure <= 390 
        flange_class = "300"
        pressure_rating = 390
        temperature_rating = 900
        elsif  pressure > 390 and pressure <= 520 
        flange_class = "400"
        pressure_rating = 520
        temperature_rating = 900
        elsif  pressure > 520 and pressure <= 780 
        flange_class = "600"
        pressure_rating = 780
        temperature_rating = 900
        elsif  pressure > 780 and pressure <= 1165 
        flange_class = "900"
        pressure_rating = 1165
        temperature_rating = 900
        elsif  pressure > 1165 and pressure <= 1945 
        flange_class = "1500"
        pressure_rating = 1945
        temperature_rating = 900
        elsif  pressure > 1945 and pressure <= 3240 
        flange_class = "2500"
        pressure_rating = 3240
        temperature_rating = 900
        
        end
    elsif temperature > 900 and temperature <= 950 
        if pressure <= 35 
        flange_class = "150"
        pressure_rating = 35
        temperature_rating = 950
        elsif  pressure > 35 and pressure <= 380 
        flange_class = "300"
        pressure_rating = 380
        temperature_rating = 950
        elsif  pressure > 380 and pressure <= 510 
        flange_class = "400"
        pressure_rating = 510
        temperature_rating = 950
        elsif  pressure > 510 and pressure <= 765 
        flange_class = "600"
        pressure_rating = 765
        temperature_rating = 950
        elsif  pressure > 765 and pressure <= 1145 
        flange_class = "900"
        pressure_rating = 1145
        temperature_rating = 950
        elsif  pressure > 1145 and pressure <= 1910 
        flange_class = "1500"
        pressure_rating = 1910
        temperature_rating = 950
        elsif  pressure > 1910 and pressure <= 3180 
        flange_class = "2500"
        pressure_rating = 3180
        temperature_rating = 950
        
        end
    elsif temperature > 950 and temperature <= 1000 
        if pressure <= 20 
        flange_class = "150"
        pressure_rating = 20
        temperature_rating = 1000
        elsif  pressure > 20 and pressure <= 355 
        flange_class = "300"
        pressure_rating = 355
        temperature_rating = 1000
        elsif  pressure > 335 and pressure <= 470 
        flange_class = "400"
        pressure_rating = 470
        temperature_rating = 1000
        elsif  pressure > 470 and pressure <= 710 
        flange_class = "600"
        pressure_rating = 710
        temperature_rating = 1000
        elsif  pressure > 710 and pressure <= 1065 
        flange_class = "900"
        pressure_rating = 1065
        temperature_rating = 1000
        elsif  pressure > 1065 and pressure <= 1770 
        flange_class = "1500"
        pressure_rating = 1770
        temperature_rating = 1000
        elsif  pressure > 1770 and pressure <= 2950 
        flange_class = "2500"
        pressure_rating = 2950
        temperature_rating = 1000
        
        end
    elsif temperature > 1000 and temperature <= 1050 
        if pressure > 325 
        flange_class = "300"
        pressure_rating = 325
        temperature_rating = 1050
        elsif  pressure > 325 and pressure <= 435 
        flange_class = "400"
        pressure_rating = 435
        temperature_rating = 1050
        elsif  pressure > 435 and pressure <= 650 
        flange_class = "600"
        pressure_rating = 650
        temperature_rating = 1050
        elsif  pressure > 650 and pressure <= 975 
        flange_class = "900"
        pressure_rating = 975
        temperature_rating = 1050
        elsif  pressure > 975 and pressure <= 1630 
        flange_class = "1500"
        pressure_rating = 1630
        temperature_rating = 1050
        elsif  pressure > 1630 and pressure <= 2715 
        flange_class = "2500"
        pressure_rating = 2715
        temperature_rating = 1050
        
        end
    elsif temperature > 1050 and temperature <= 1100 
        if pressure > 255 
        flange_class = "300"
        pressure_rating = 255
        temperature_rating = 1100
        elsif  pressure > 255 and pressure <= 345 
        flange_class = "400"
        pressure_rating = 345
        temperature_rating = 1100
        elsif  pressure > 345 and pressure <= 515 
        flange_class = "600"
        pressure_rating = 515
        temperature_rating = 1100
        elsif  pressure > 515 and pressure <= 770 
        flange_class = "900"
        pressure_rating = 770
        temperature_rating = 1100
        elsif  pressure > 770 and pressure <= 1285 
        flange_class = "1500"
        pressure_rating = 1285
        temperature_rating = 1100
        elsif  pressure > 1285 and pressure <= 2145 
        flange_class = "2500"
        pressure_rating = 2145
        temperature_rating = 1100
        
        end
    elsif temperature > 1100 and temperature <= 1150 
        if pressure > 205 
        flange_class = "300"
        pressure_rating = 205
        temperature_rating = 1150
        elsif  pressure > 205 and pressure <= 275 
        flange_class = "400"
        pressure_rating = 275
        temperature_rating = 1150
        elsif  pressure > 275 and pressure <= 410 
        flange_class = "600"
        pressure_rating = 410
        temperature_rating = 1150
        elsif  pressure > 410 and pressure <= 615 
        flange_class = "900"
        pressure_rating = 615
        temperature_rating = 1150
        elsif  pressure > 615 and pressure <= 1030 
        flange_class = "1500"
        pressure_rating = 1030
        temperature_rating = 1150
        elsif  pressure > 1030 and pressure <= 1715 
        flange_class = "2500"
        pressure_rating = 1715
        temperature_rating = 1150
        
        end
    elsif temperature > 1150 and temperature <= 1200 
        if pressure > 165 
        flange_class = "300"
        pressure_rating = 165
        temperature_rating = 1200
        elsif  pressure > 165 and pressure <= 220 
        flange_class = "400"
        pressure_rating = 220
        temperature_rating = 1200
        elsif  pressure > 220 and pressure <= 330 
        flange_class = "600"
        pressure_rating = 330
        temperature_rating = 1200
        elsif  pressure > 330 and pressure <= 495 
        flange_class = "900"
        pressure_rating = 495
        temperature_rating = 1200
        elsif  pressure > 495 and pressure <= 825 
        flange_class = "1500"
        pressure_rating = 825
        temperature_rating = 1200
        elsif  pressure > 825 and pressure <= 1370 
        flange_class = "2500"
        pressure_rating = 1370
        temperature_rating = 1200
        
        end
    elsif temperature > 1200 and temperature <= 1250 
        if pressure > 135 
        flange_class = "300"
        pressure_rating = 135
        temperature_rating = 1250
        elsif  pressure > 135 and pressure <= 180 
        flange_class = "400"
        pressure_rating = 180
        temperature_rating = 1250
        elsif  pressure > 180 and pressure <= 265 
        flange_class = "600"
        pressure_rating = 265
        temperature_rating = 1250
        elsif  pressure > 265 and pressure <= 400 
        flange_class = "900"
        pressure_rating = 400
        temperature_rating = 1250
        elsif  pressure > 400 and pressure <= 670 
        flange_class = "1500"
        pressure_rating = 670
        temperature_rating = 1250
        elsif  pressure > 670 and pressure <= 1115 
        flange_class = "2500"
        pressure_rating = 1115
        temperature_rating = 1250
        
        end
    elsif temperature > 1250 and temperature <= 1300 
        if pressure > 115 
        flange_class = "300"
        pressure_rating = 115
        temperature_rating = 1300
        elsif  pressure > 115 and pressure <= 150 
        flange_class = "400"
        pressure_rating = 150
        temperature_rating = 1300
        elsif  pressure > 150 and pressure <= 225 
        flange_class = "600"
        pressure_rating = 225
        temperature_rating = 1300
        elsif  pressure > 225 and pressure <= 340 
        flange_class = "900"
        pressure_rating = 340
        temperature_rating = 1300
        elsif  pressure > 340 and pressure <= 565 
        flange_class = "1500"
        pressure_rating = 565
        temperature_rating = 1300
        elsif  pressure > 565 and pressure <= 945 
        flange_class = "2500"
        pressure_rating = 945
        temperature_rating = 1300
        
        end
    elsif temperature > 1300 and temperature <= 1350 
        if pressure > 95 
        flange_class = "300"
        pressure_rating = 95
        temperature_rating = 1350
        elsif  pressure > 95 and pressure <= 125 
        flange_class = "400"
        pressure_rating = 125
        temperature_rating = 1350
        elsif  pressure > 125 and pressure <= 185 
        flange_class = "600"
        pressure_rating = 185
        temperature_rating = 1350
        elsif  pressure > 185 and pressure <= 280 
        flange_class = "900"
        pressure_rating = 280
        temperature_rating = 1350
        elsif  pressure > 280 and pressure <= 465 
        flange_class = "1500"
        pressure_rating = 465
        temperature_rating = 1350
        elsif  pressure > 465 and pressure <= 770 
        flange_class = "2500"
        pressure_rating = 770
        temperature_rating = 1350
        
        end
    elsif temperature > 1350 and temperature <= 1400 
        if pressure > 75 
        flange_class = "300"
        pressure_rating = 75
        temperature_rating = 1400
        elsif  pressure > 75 and pressure <= 100 
        flange_class = "400"
        pressure_rating = 100
        temperature_rating = 1400
        elsif  pressure > 100 and pressure <= 150 
        flange_class = "600"
        pressure_rating = 150
        temperature_rating = 1400
        elsif  pressure > 150 and pressure <= 225 
        flange_class = "900"
        pressure_rating = 225
        temperature_rating = 1400
        elsif  pressure > 225 and pressure <= 380 
        flange_class = "1500"
        pressure_rating = 380
        temperature_rating = 1150
        elsif  pressure > 380 and pressure <= 630 
        flange_class = "2500"
        pressure_rating = 630
        temperature_rating = 1400
        
        end
    elsif temperature > 1400 and temperature <= 1450 
        if pressure > 60 
        flange_class = "300"
        pressure_rating = 60
        temperature_rating = 1450
        elsif  pressure > 60 and pressure <= 80 
        flange_class = "400"
        pressure_rating = 80
        temperature_rating = 1450
        elsif  pressure > 80 and pressure <= 115 
        flange_class = "600"
        pressure_rating = 115
        temperature_rating = 1450
        elsif  pressure > 115 and pressure <= 175 
        flange_class = "900"
        pressure_rating = 175
        temperature_rating = 1450
        elsif  pressure > 175 and pressure <= 290 
        flange_class = "1500"
        pressure_rating = 290
        temperature_rating = 1450
        elsif  pressure > 290 and pressure <= 485 
        flange_class = "2500"
        pressure_rating = 485
        temperature_rating = 1450
        
        end
    elsif temperature > 1450 and temperature <= 1500 
        if pressure > 40 
        flange_class = "300"
        pressure_rating = 40
        temperature_rating = 1500
        elsif  pressure > 40 and pressure <= 55 
        flange_class = "400"
        pressure_rating = 55
        temperature_rating = 1500
        elsif  pressure > 55 and pressure <= 85 
        flange_class = "600"
        pressure_rating = 85
        temperature_rating = 1500
        elsif  pressure > 85 and pressure <= 125 
        flange_class = "900"
        pressure_rating = 125
        temperature_rating = 1500
        elsif  pressure > 125 and pressure <= 205 
        flange_class = "1500"
        pressure_rating = 205
        temperature_rating = 1500
        elsif  pressure > 205 and pressure <= 345 
        flange_class = "2500"
        pressure_rating = 345
        temperature_rating = 1500
        
        end
    
    end
    
    if Worksheets("UOM").chkCustomary.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) At temperatures over 1000\B0F, use only when the carbon content is 0.04% or higher." & Chr(13) _
    & "(2) Not to be used over 800\B0F."
    elsif orksheets("UOM").chkSI.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) At temperatures over 538\B0C, use only when the carbon content is 0.04% or higher." & Chr(13) _
    & "(2) Not to be used over 425\B0C."
    
    end
    
elsif material_group = "2.2" 
UserFormLineSegmentDesign.cmbMaterialDesignation.RowSource = "MaterialGroup2.2"
    if temperature >= -20 and temperature <= 100 
        if pressure <= 275 
        flange_class = "150"
        pressure_rating = 275
        temperature_rating = 100
        elsif  pressure > 275 and pressure <= 720 
        flange_class = "300"
        pressure_rating = 720
        temperature_rating = 100
        elsif  pressure > 720 and pressure <= 960 
        flange_class = "400"
        pressure_rating = 960
        temperature_rating = 100
        elsif  pressure > 960 and pressure <= 1440 
        flange_class = "600"
        pressure_rating = 1440
        temperature_rating = 100
        elsif  pressure > 1440 and pressure <= 2160 
        flange_class = "900"
        pressure_rating = 2160
        temperature_rating = 100
        elsif  pressure > 2160 and pressure <= 3600 
        flange_class = "1500"
        pressure_rating = 3600
        temperature_rating = 100
        elsif  pressure > 3600 and pressure <= 6000 
        flange_class = "2500"
        pressure_rating = 6000
        temperature_rating = 100
        
        end
    elsif temperature > 100 and temperature <= 200 
        if pressure <= 235 
        flange_class = "150"
        pressure_rating = 235
        temperature_rating = 200
        elsif  pressure > 235 and pressure <= 620 
        flange_class = "300"
        pressure_rating = 620
        temperature_rating = 200
        elsif  pressure > 620 and pressure <= 825 
        flange_class = "400"
        pressure_rating = 825
        temperature_rating = 200
        elsif  pressure > 825 and pressure <= 1240 
        flange_class = "600"
        pressure_rating = 1240
        temperature_rating = 200
        elsif  pressure > 1240 and pressure <= 1860 
        flange_class = "900"
        pressure_rating = 1860
        temperature_rating = 200
        elsif  pressure > 1860 and pressure <= 3095 
        flange_class = "1500"
        pressure_rating = 3095
        temperature_rating = 200
        elsif  pressure > 3095 and pressure <= 5160 
        flange_class = "2500"
        pressure_rating = 5160
        temperature_rating = 200
        
        end
    elsif temperature > 200 and temperature <= 300 
        if pressure <= 215 
        flange_class = "150"
        pressure_rating = 215
        temperature_rating = 300
        elsif  pressure > 215 and pressure <= 560 
        flange_class = "300"
        pressure_rating = 560
        temperature_rating = 300
        elsif  pressure > 560 and pressure <= 745 
        flange_class = "400"
        pressure_rating = 745
        temperature_rating = 300
        elsif  pressure > 745 and pressure <= 1120 
        flange_class = "600"
        pressure_rating = 1120
        temperature_rating = 300
        elsif  pressure > 1120 and pressure <= 1680 
        flange_class = "900"
        pressure_rating = 1680
        temperature_rating = 300
        elsif  pressure > 1680 and pressure <= 2795 
        flange_class = "1500"
        pressure_rating = 2795
        temperature_rating = 300
        elsif  pressure > 2795 and pressure <= 4660 
        flange_class = "2500"
        pressure_rating = 4660
        temperature_rating = 300
        
        end
    elsif temperature > 300 and temperature <= 400 
        if pressure <= 195 
        flange_class = "150"
        pressure_rating = 195
        temperature_rating = 400
        elsif  pressure > 195 and pressure <= 515 
        flange_class = "300"
        pressure_rating = 515
        temperature_rating = 400
        elsif  pressure > 515 and pressure <= 685 
        flange_class = "400"
        pressure_rating = 685
        temperature_rating = 400
        elsif  pressure > 685 and pressure <= 1025 
        flange_class = "600"
        pressure_rating = 1025
        temperature_rating = 400
        elsif  pressure > 1025 and pressure <= 1540 
        flange_class = "900"
        pressure_rating = 1540
        temperature_rating = 400
        elsif  pressure > 1540 and pressure <= 2570 
        flange_class = "1500"
        pressure_rating = 2570
        temperature_rating = 400
        elsif  pressure > 2570 and pressure <= 4280 
        flange_class = "2500"
        pressure_rating = 4280
        temperature_rating = 400
        
        end
    elsif temperature > 400 and temperature <= 500 
        if pressure <= 170 
        flange_class = "150"
        pressure_rating = 170
        temperature_rating = 500
        elsif  pressure > 170 and pressure <= 480 
        flange_class = "300"
        pressure_rating = 480
        temperature_rating = 500
        elsif  pressure > 480 and pressure <= 635 
        flange_class = "400"
        pressure_rating = 635
        temperature_rating = 500
        elsif  pressure > 635 and pressure <= 955 
        flange_class = "600"
        pressure_rating = 955
        temperature_rating = 500
        elsif  pressure > 955 and pressure <= 1435 
        flange_class = "900"
        pressure_rating = 1435
        temperature_rating = 500
        elsif  pressure > 1435 and pressure <= 2390 
        flange_class = "1500"
        pressure_rating = 2390
        temperature_rating = 500
        elsif  pressure > 2390 and pressure <= 3980 
        flange_class = "2500"
        pressure_rating = 3980
        temperature_rating = 500
        
        end
    elsif temperature > 500 and temperature <= 600 
        if pressure <= 140 
        flange_class = "150"
        pressure_rating = 140
        temperature_rating = 600
        elsif  pressure > 140 and pressure <= 450 
        flange_class = "300"
        pressure_rating = 450
        temperature_rating = 600
        elsif  pressure > 450 and pressure <= 600 
        flange_class = "400"
        pressure_rating = 600
        temperature_rating = 600
        elsif  pressure > 600 and pressure <= 900 
        flange_class = "600"
        pressure_rating = 900
        temperature_rating = 600
        elsif  pressure > 900 and pressure <= 1355 
        flange_class = "900"
        pressure_rating = 1335
        temperature_rating = 600
        elsif  pressure > 1335 and pressure <= 2255 
        flange_class = "1500"
        pressure_rating = 2255
        temperature_rating = 600
        elsif  pressure > 2255 and pressure <= 3760 
        flange_class = "2500"
        pressure_rating = 3760
        temperature_rating = 600
        
        end
    elsif temperature > 600 and temperature <= 650 
        if pressure <= 125 
        flange_class = "150"
        pressure_rating = 125
        temperature_rating = 650
        elsif  pressure > 125 and pressure <= 440 
        flange_class = "300"
        pressure_rating = 440
        temperature_rating = 650
        elsif  pressure > 440 and pressure <= 590 
        flange_class = "400"
        pressure_rating = 590
        temperature_rating = 650
        elsif  pressure > 590 and pressure <= 885 
        flange_class = "600"
        pressure_rating = 885
        temperature_rating = 650
        elsif  pressure > 885 and pressure <= 1325 
        flange_class = "900"
        pressure_rating = 1325
        temperature_rating = 650
        elsif  pressure > 1325 and pressure <= 2210 
        flange_class = "1500"
        pressure_rating = 2210
        temperature_rating = 650
        elsif  pressure > 2160 and pressure <= 3680 
        flange_class = "2500"
        pressure_rating = 3680
        temperature_rating = 650
        
        end
    elsif temperature > 650 and temperature <= 700 
        if pressure <= 110 
        flange_class = "150"
        pressure_rating = 110
        temperature_rating = 700
        elsif  pressure > 110 and pressure <= 435 
        flange_class = "300"
        pressure_rating = 435
        temperature_rating = 700
        elsif  pressure > 435 and pressure <= 580 
        flange_class = "400"
        pressure_rating = 580
        temperature_rating = 700
        elsif  pressure > 580 and pressure <= 870 
        flange_class = "600"
        pressure_rating = 870
        temperature_rating = 700
        elsif  pressure > 870 and pressure <= 1305 
        flange_class = "900"
        pressure_rating = 1305
        temperature_rating = 700
        elsif  pressure > 1305 and pressure <= 2170 
        flange_class = "1500"
        pressure_rating = 2170
        temperature_rating = 700
        elsif  pressure > 2170 and pressure <= 3620 
        flange_class = "2500"
        pressure_rating = 3620
        temperature_rating = 700
        
        end
    elsif temperature > 700 and temperature <= 750 
        if pressure <= 95 
        flange_class = "150"
        pressure_rating = 95
        temperature_rating = 750
        elsif  pressure > 95 and pressure <= 425 
        flange_class = "300"
        pressure_rating = 425
        temperature_rating = 750
        elsif  pressure > 425 and pressure <= 570 
        flange_class = "400"
        pressure_rating = 570
        temperature_rating = 750
        elsif  pressure > 570 and pressure <= 855 
        flange_class = "600"
        pressure_rating = 855
        temperature_rating = 750
        elsif  pressure > 855 and pressure <= 1280 
        flange_class = "900"
        pressure_rating = 1280
        temperature_rating = 750
        elsif  pressure > 1280 and pressure <= 2135 
        flange_class = "1500"
        pressure_rating = 2135
        temperature_rating = 750
        elsif  pressure > 2135 and pressure <= 3560 
        flange_class = "2500"
        pressure_rating = 3560
        temperature_rating = 750
        
        end
    elsif temperature > 750 and temperature <= 800 
        if pressure <= 80 
        flange_class = "150"
        pressure_rating = 80
        temperature_rating = 800
        elsif  pressure > 80 and pressure <= 420 
        flange_class = "300"
        pressure_rating = 420
        temperature_rating = 800
        elsif  pressure > 420 and pressure <= 565 
        flange_class = "400"
        pressure_rating = 565
        temperature_rating = 800
        elsif  pressure > 565 and pressure <= 845 
        flange_class = "600"
        pressure_rating = 845
        temperature_rating = 800
        elsif  pressure > 845 and pressure <= 1265 
        flange_class = "900"
        pressure_rating = 1265
        temperature_rating = 800
        elsif  pressure > 1265 and pressure <= 2110 
        flange_class = "1500"
        pressure_rating = 2110
        temperature_rating = 800
        elsif  pressure > 2110 and pressure <= 3520 
        flange_class = "2500"
        pressure_rating = 3520
        temperature_rating = 800
        
        end
    elsif temperature > 800 and temperature <= 850 
        if pressure <= 65 
        flange_class = "150"
        pressure_rating = 65
        temperature_rating = 850
        elsif  pressure > 65 and pressure <= 420 
        flange_class = "300"
        pressure_rating = 420
        temperature_rating = 850
        elsif  pressure > 420 and pressure <= 555 
        flange_class = "400"
        pressure_rating = 555
        temperature_rating = 850
        elsif  pressure > 555 and pressure <= 835 
        flange_class = "600"
        pressure_rating = 835
        temperature_rating = 850
        elsif  pressure > 835 and pressure <= 1255 
        flange_class = "900"
        pressure_rating = 1255
        temperature_rating = 850
        elsif  pressure > 1255 and pressure <= 2090 
        flange_class = "1500"
        pressure_rating = 2090
        temperature_rating = 850
        elsif  pressure > 2090 and pressure <= 3480 
        flange_class = "2500"
        pressure_rating = 3480
        temperature_rating = 850
        
        end
    elsif temperature > 850 and temperature <= 900 
        if pressure <= 50 
        flange_class = "150"
        pressure_rating = 50
        temperature_rating = 900
        elsif  pressure > 50 and pressure <= 415 
        flange_class = "300"
        pressure_rating = 415
        temperature_rating = 900
        elsif  pressure > 415 and pressure <= 555 
        flange_class = "400"
        pressure_rating = 555
        temperature_rating = 900
        elsif  pressure > 555 and pressure <= 830 
        flange_class = "600"
        pressure_rating = 830
        temperature_rating = 900
        elsif  pressure > 830 and pressure <= 1245 
        flange_class = "900"
        pressure_rating = 1245
        temperature_rating = 900
        elsif  pressure > 1245 and pressure <= 2075 
        flange_class = "1500"
        pressure_rating = 2075
        temperature_rating = 900
        elsif  pressure > 2075 and pressure <= 3460 
        flange_class = "2500"
        pressure_rating = 3460
        temperature_rating = 900
        
        end
    elsif temperature > 900 and temperature <= 950 
        if pressure <= 35 
        flange_class = "150"
        pressure_rating = 35
        temperature_rating = 950
        elsif  pressure > 35 and pressure <= 385 
        flange_class = "300"
        pressure_rating = 385
        temperature_rating = 950
        elsif  pressure > 385 and pressure <= 515 
        flange_class = "400"
        pressure_rating = 515
        temperature_rating = 950
        elsif  pressure > 515 and pressure <= 775 
        flange_class = "600"
        pressure_rating = 775
        temperature_rating = 950
        elsif  pressure > 775 and pressure <= 1160 
        flange_class = "900"
        pressure_rating = 1160
        temperature_rating = 950
        elsif  pressure > 1160 and pressure <= 1930 
        flange_class = "1500"
        pressure_rating = 1930
        temperature_rating = 950
        elsif  pressure > 1930 and pressure <= 3220 
        flange_class = "2500"
        pressure_rating = 3220
        temperature_rating = 950
        
        end
    elsif temperature > 950 and temperature <= 1000 
        if pressure <= 20 
        flange_class = "150"
        pressure_rating = 20
        temperature_rating = 1000
        elsif  pressure > 20 and pressure <= 365 
        flange_class = "300"
        pressure_rating = 365
        temperature_rating = 1000
        elsif  pressure > 365 and pressure <= 485 
        flange_class = "400"
        pressure_rating = 485
        temperature_rating = 1000
        elsif  pressure > 485 and pressure <= 725 
        flange_class = "600"
        pressure_rating = 725
        temperature_rating = 1000
        elsif  pressure > 725 and pressure <= 1090 
        flange_class = "900"
        pressure_rating = 1090
        temperature_rating = 1000
        elsif  pressure > 1090 and pressure <= 1820 
        flange_class = "1500"
        pressure_rating = 1820
        temperature_rating = 1000
        elsif  pressure > 1820 and pressure <= 3030 
        flange_class = "2500"
        pressure_rating = 3030
        temperature_rating = 1000
        
        end
    elsif temperature > 1000 and temperature <= 1050 
        if pressure > 360 
        flange_class = "300"
        pressure_rating = 360
        temperature_rating = 1050
        elsif  pressure > 360 and pressure <= 480 
        flange_class = "400"
        pressure_rating = 480
        temperature_rating = 1050
        elsif  pressure > 480 and pressure <= 720 
        flange_class = "600"
        pressure_rating = 720
        temperature_rating = 1050
        elsif  pressure > 720 and pressure <= 1080 
        flange_class = "900"
        pressure_rating = 1080
        temperature_rating = 1050
        elsif  pressure > 1080 and pressure <= 1800 
        flange_class = "1500"
        pressure_rating = 1800
        temperature_rating = 1050
        elsif  pressure > 1800 and pressure <= 3000 
        flange_class = "2500"
        pressure_rating = 3000
        temperature_rating = 1050
        
        end
    elsif temperature > 1050 and temperature <= 1100 
        if pressure > 305 
        flange_class = "300"
        pressure_rating = 305
        temperature_rating = 1100
        elsif  pressure > 305 and pressure <= 405 
        flange_class = "400"
        pressure_rating = 405
        temperature_rating = 1100
        elsif  pressure > 405 and pressure <= 610 
        flange_class = "600"
        pressure_rating = 610
        temperature_rating = 1100
        elsif  pressure > 610 and pressure <= 915 
        flange_class = "900"
        pressure_rating = 915
        temperature_rating = 1100
        elsif  pressure > 915 and pressure <= 1525 
        flange_class = "1500"
        pressure_rating = 1525
        temperature_rating = 1100
        elsif  pressure > 1525 and pressure <= 2545 
        flange_class = "2500"
        pressure_rating = 2545
        temperature_rating = 1100
        
        end
    elsif temperature > 1100 and temperature <= 1150 
        if pressure > 235 
        flange_class = "300"
        pressure_rating = 235
        temperature_rating = 1150
        elsif  pressure > 235 and pressure <= 315 
        flange_class = "400"
        pressure_rating = 315
        temperature_rating = 1150
        elsif  pressure > 315 and pressure <= 475 
        flange_class = "600"
        pressure_rating = 475
        temperature_rating = 1150
        elsif  pressure > 475 and pressure <= 710 
        flange_class = "900"
        pressure_rating = 710
        temperature_rating = 1150
        elsif  pressure > 710 and pressure <= 1185 
        flange_class = "1500"
        pressure_rating = 1185
        temperature_rating = 1150
        elsif  pressure > 1185 and pressure <= 1970 
        flange_class = "2500"
        pressure_rating = 1970
        temperature_rating = 1150
        
        end
    elsif temperature > 1150 and temperature <= 1200 
        if pressure > 185 
        flange_class = "300"
        pressure_rating = 185
        temperature_rating = 1200
        elsif  pressure > 185 and pressure <= 245 
        flange_class = "400"
        pressure_rating = 245
        temperature_rating = 1200
        elsif  pressure > 245 and pressure <= 370 
        flange_class = "600"
        pressure_rating = 370
        temperature_rating = 1200
        elsif  pressure > 370 and pressure <= 555 
        flange_class = "900"
        pressure_rating = 555
        temperature_rating = 1200
        elsif  pressure > 555 and pressure <= 925 
        flange_class = "1500"
        pressure_rating = 925
        temperature_rating = 1200
        elsif  pressure > 925 and pressure <= 1545 
        flange_class = "2500"
        pressure_rating = 1545
        temperature_rating = 1200
        
        end
    elsif temperature > 1200 and temperature <= 1250 
        if pressure > 145 
        flange_class = "300"
        pressure_rating = 145
        temperature_rating = 1250
        elsif  pressure > 145 and pressure <= 195 
        flange_class = "400"
        pressure_rating = 195
        temperature_rating = 1250
        elsif  pressure > 195 and pressure <= 295 
        flange_class = "600"
        pressure_rating = 295
        temperature_rating = 1250
        elsif  pressure > 295 and pressure <= 440 
        flange_class = "900"
        pressure_rating = 440
        temperature_rating = 1250
        elsif  pressure > 440 and pressure <= 735 
        flange_class = "1500"
        pressure_rating = 735
        temperature_rating = 1250
        elsif  pressure > 735 and pressure <= 1230 
        flange_class = "2500"
        pressure_rating = 1230
        temperature_rating = 1250
        
        end
    elsif temperature > 1250 and temperature <= 1300 
        if pressure > 115 
        flange_class = "300"
        pressure_rating = 115
        temperature_rating = 1300
        elsif  pressure > 115 and pressure <= 155 
        flange_class = "400"
        pressure_rating = 155
        temperature_rating = 1300
        elsif  pressure > 155 and pressure <= 235 
        flange_class = "600"
        pressure_rating = 235
        temperature_rating = 1300
        elsif  pressure > 235 and pressure <= 350 
        flange_class = "900"
        pressure_rating = 350
        temperature_rating = 1300
        elsif  pressure > 350 and pressure <= 585 
        flange_class = "1500"
        pressure_rating = 585
        temperature_rating = 1300
        elsif  pressure > 585 and pressure <= 970 
        flange_class = "2500"
        pressure_rating = 970
        temperature_rating = 1300
        
        end
    elsif temperature > 1300 and temperature <= 1350 
        if pressure > 95 
        flange_class = "300"
        pressure_rating = 95
        temperature_rating = 1350
        elsif  pressure > 95 and pressure <= 130 
        flange_class = "400"
        pressure_rating = 130
        temperature_rating = 1350
        elsif  pressure > 130 and pressure <= 190 
        flange_class = "600"
        pressure_rating = 190
        temperature_rating = 1350
        elsif  pressure > 190 and pressure <= 290 
        flange_class = "900"
        pressure_rating = 290
        temperature_rating = 1350
        elsif  pressure > 290 and pressure <= 480 
        flange_class = "1500"
        pressure_rating = 480
        temperature_rating = 1350
        elsif  pressure > 480 and pressure <= 800 
        flange_class = "2500"
        pressure_rating = 800
        temperature_rating = 1350
        
        end
    elsif temperature > 1350 and temperature <= 1400 
        if pressure > 75 
        flange_class = "300"
        pressure_rating = 75
        temperature_rating = 1400
        elsif  pressure > 75 and pressure <= 100 
        flange_class = "400"
        pressure_rating = 100
        temperature_rating = 1400
        elsif  pressure > 100 and pressure <= 150 
        flange_class = "600"
        pressure_rating = 150
        temperature_rating = 1400
        elsif  pressure > 150 and pressure <= 225 
        flange_class = "900"
        pressure_rating = 225
        temperature_rating = 1400
        elsif  pressure > 225 and pressure <= 380 
        flange_class = "1500"
        pressure_rating = 380
        temperature_rating = 1150
        elsif  pressure > 380 and pressure <= 630 
        flange_class = "2500"
        pressure_rating = 630
        temperature_rating = 1400
        
        end
    elsif temperature > 1400 and temperature <= 1450 
        if pressure > 60 
        flange_class = "300"
        pressure_rating = 60
        temperature_rating = 1450
        elsif  pressure > 60 and pressure <= 80 
        flange_class = "400"
        pressure_rating = 80
        temperature_rating = 1450
        elsif  pressure > 80 and pressure <= 115 
        flange_class = "600"
        pressure_rating = 115
        temperature_rating = 1450
        elsif  pressure > 115 and pressure <= 175 
        flange_class = "900"
        pressure_rating = 175
        temperature_rating = 1450
        elsif  pressure > 175 and pressure <= 290 
        flange_class = "1500"
        pressure_rating = 290
        temperature_rating = 1450
        elsif  pressure > 290 and pressure <= 485 
        flange_class = "2500"
        pressure_rating = 485
        temperature_rating = 1450
        
        end
    elsif temperature > 1450 and temperature <= 1500 
        if pressure > 40 
        flange_class = "300"
        pressure_rating = 40
        temperature_rating = 1500
        elsif  pressure > 40 and pressure <= 55 
        flange_class = "400"
        pressure_rating = 55
        temperature_rating = 1500
        elsif  pressure > 55 and pressure <= 85 
        flange_class = "600"
        pressure_rating = 85
        temperature_rating = 1500
        elsif  pressure > 85 and pressure <= 125 
        flange_class = "900"
        pressure_rating = 125
        temperature_rating = 1500
        elsif  pressure > 125 and pressure <= 205 
        flange_class = "1500"
        pressure_rating = 205
        temperature_rating = 1500
        elsif  pressure > 205 and pressure <= 345 
        flange_class = "2500"
        pressure_rating = 345
        temperature_rating = 1500
        
        end
    
    end
    
    if Worksheets("UOM").chkCustomary.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) At temperatures over 1000\B0F, use only when the carbon content is 0.04% or higher." & Chr(13) _
    & "(2) Not to be used over 850\B0F." & Chr(13) _
    & "(3) Not to be used over 1000\B0F."
    elsif orksheets("UOM").chkSI.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) At temperatures over 538\B0C, use only when the carbon content is 0.04% or higher." & Chr(13) _
    & "(2) Not to be used over 455\B0C." & Chr(13) _
    & "(3) Not to be used over 538\B0C."
    
    end
    
elsif material_group = "2.3" 
UserFormLineSegmentDesign.cmbMaterialDesignation.RowSource = "MaterialGroup2.3"
    if temperature >= -20 and temperature <= 100 
        if pressure <= 230 
        flange_class = "150"
        pressure_rating = 230
        temperature_rating = 100
        elsif  pressure > 230 and pressure <= 600 
        flange_class = "300"
        pressure_rating = 600
        temperature_rating = 100
        elsif  pressure > 600 and pressure <= 800 
        flange_class = "400"
        pressure_rating = 800
        temperature_rating = 100
        elsif  pressure > 800 and pressure <= 1200 
        flange_class = "600"
        pressure_rating = 1200
        temperature_rating = 100
        elsif  pressure > 1200 and pressure <= 1800 
        flange_class = "900"
        pressure_rating = 1800
        temperature_rating = 100
        elsif  pressure > 1800 and pressure <= 3000 
        flange_class = "1500"
        pressure_rating = 3000
        temperature_rating = 100
        elsif  pressure > 3000 and pressure <= 5000 
        flange_class = "2500"
        pressure_rating = 5000
        temperature_rating = 100
        
        end
    elsif temperature > 100 and temperature <= 200 
        if pressure <= 195 
        flange_class = "150"
        pressure_rating = 195
        temperature_rating = 200
        elsif  pressure > 195 and pressure <= 510 
        flange_class = "300"
        pressure_rating = 510
        temperature_rating = 200
        elsif  pressure > 510 and pressure <= 680 
        flange_class = "400"
        pressure_rating = 680
        temperature_rating = 200
        elsif  pressure > 680 and pressure <= 1020 
        flange_class = "600"
        pressure_rating = 1020
        temperature_rating = 200
        elsif  pressure > 1020 and pressure <= 1535 
        flange_class = "900"
        pressure_rating = 1535
        temperature_rating = 200
        elsif  pressure > 1535 and pressure <= 2555 
        flange_class = "1500"
        pressure_rating = 2555
        temperature_rating = 200
        elsif  pressure > 2555 and pressure <= 4260 
        flange_class = "2500"
        pressure_rating = 4260
        temperature_rating = 200
        
        end
    elsif temperature > 200 and temperature <= 300 
        if pressure <= 175 
        flange_class = "150"
        pressure_rating = 175
        temperature_rating = 300
        elsif  pressure > 175 and pressure <= 455 
        flange_class = "300"
        pressure_rating = 455
        temperature_rating = 300
        elsif  pressure > 455 and pressure <= 610 
        flange_class = "400"
        pressure_rating = 610
        temperature_rating = 300
        elsif  pressure > 610 and pressure <= 910 
        flange_class = "600"
        pressure_rating = 910
        temperature_rating = 300
        elsif  pressure > 910 and pressure <= 1370 
        flange_class = "900"
        pressure_rating = 1370
        temperature_rating = 300
        elsif  pressure > 1370 and pressure <= 2280 
        flange_class = "1500"
        pressure_rating = 2280
        temperature_rating = 300
        elsif  pressure > 2280 and pressure <= 3800 
        flange_class = "2500"
        pressure_rating = 3800
        temperature_rating = 300
        
        end
    elsif temperature > 300 and temperature <= 400 
        if pressure <= 160 
        flange_class = "150"
        pressure_rating = 160
        temperature_rating = 400
        elsif  pressure > 160 and pressure <= 420 
        flange_class = "300"
        pressure_rating = 420
        temperature_rating = 400
        elsif  pressure > 420 and pressure <= 560 
        flange_class = "400"
        pressure_rating = 560
        temperature_rating = 400
        elsif  pressure > 560 and pressure <= 840 
        flange_class = "600"
        pressure_rating = 840
        temperature_rating = 400
        elsif  pressure > 840 and pressure <= 1260 
        flange_class = "900"
        pressure_rating = 1260
        temperature_rating = 400
        elsif  pressure > 1260 and pressure <= 2100 
        flange_class = "1500"
        pressure_rating = 2100
        temperature_rating = 400
        elsif  pressure > 2100 and pressure <= 3500 
        flange_class = "2500"
        pressure_rating = 3500
        temperature_rating = 400
        
        end
    elsif temperature > 400 and temperature <= 500 
        if pressure <= 150 
        flange_class = "150"
        pressure_rating = 150
        temperature_rating = 500
        elsif  pressure > 150 and pressure <= 395 
        flange_class = "300"
        pressure_rating = 395
        temperature_rating = 500
        elsif  pressure > 395 and pressure <= 525 
        flange_class = "400"
        pressure_rating = 525
        temperature_rating = 500
        elsif  pressure > 525 and pressure <= 785 
        flange_class = "600"
        pressure_rating = 785
        temperature_rating = 500
        elsif  pressure > 785 and pressure <= 1180 
        flange_class = "900"
        pressure_rating = 1180
        temperature_rating = 500
        elsif  pressure > 1180 and pressure <= 1970 
        flange_class = "1500"
        pressure_rating = 1970
        temperature_rating = 500
        elsif  pressure > 1970 and pressure <= 3280 
        flange_class = "2500"
        pressure_rating = 3280
        temperature_rating = 500
        
        end
    elsif temperature > 500 and temperature <= 600 
        if pressure <= 140 
        flange_class = "150"
        pressure_rating = 140
        temperature_rating = 600
        elsif  pressure > 140 and pressure <= 370 
        flange_class = "300"
        pressure_rating = 370
        temperature_rating = 600
        elsif  pressure > 370 and pressure <= 495 
        flange_class = "400"
        pressure_rating = 495
        temperature_rating = 600
        elsif  pressure > 495 and pressure <= 745 
        flange_class = "600"
        pressure_rating = 745
        temperature_rating = 600
        elsif  pressure > 745 and pressure <= 1115 
        flange_class = "900"
        pressure_rating = 1115
        temperature_rating = 600
        elsif  pressure > 1115 and pressure <= 1860 
        flange_class = "1500"
        pressure_rating = 1860
        temperature_rating = 600
        elsif  pressure > 1860 and pressure <= 3100 
        flange_class = "2500"
        pressure_rating = 3100
        temperature_rating = 600
        
        end
    elsif temperature > 600 and temperature <= 650 
        if pressure <= 125 
        flange_class = "150"
        pressure_rating = 125
        temperature_rating = 650
        elsif  pressure > 125 and pressure <= 365 
        flange_class = "300"
        pressure_rating = 365
        temperature_rating = 650
        elsif  pressure > 365 and pressure <= 485 
        flange_class = "400"
        pressure_rating = 485
        temperature_rating = 650
        elsif  pressure > 485 and pressure <= 730 
        flange_class = "600"
        pressure_rating = 730
        temperature_rating = 650
        elsif  pressure > 730 and pressure <= 1095 
        flange_class = "900"
        pressure_rating = 1095
        temperature_rating = 650
        elsif  pressure > 1095 and pressure <= 1825 
        flange_class = "1500"
        pressure_rating = 1825
        temperature_rating = 650
        elsif  pressure > 1825 and pressure <= 3040 
        flange_class = "2500"
        pressure_rating = 3040
        temperature_rating = 650
        
        end
    elsif temperature > 650 and temperature <= 700 
        if pressure <= 110 
        flange_class = "150"
        pressure_rating = 110
        temperature_rating = 700
        elsif  pressure > 110 and pressure <= 360 
        flange_class = "300"
        pressure_rating = 360
        temperature_rating = 700
        elsif  pressure > 360 and pressure <= 480 
        flange_class = "400"
        pressure_rating = 480
        temperature_rating = 700
        elsif  pressure > 480 and pressure <= 720 
        flange_class = "600"
        pressure_rating = 720
        temperature_rating = 700
        elsif  pressure > 720 and pressure <= 1080 
        flange_class = "900"
        pressure_rating = 1080
        temperature_rating = 700
        elsif  pressure > 1080 and pressure <= 1800 
        flange_class = "1500"
        pressure_rating = 1800
        temperature_rating = 700
        elsif  pressure > 1800 and pressure <= 3000 
        flange_class = "2500"
        pressure_rating = 3000
        temperature_rating = 700
        
        end
    elsif temperature > 700 and temperature <= 750 
        if pressure <= 95 
        flange_class = "150"
        pressure_rating = 95
        temperature_rating = 750
        elsif  pressure > 95 and pressure <= 355 
        flange_class = "300"
        pressure_rating = 355
        temperature_rating = 750
        elsif  pressure > 355 and pressure <= 470 
        flange_class = "400"
        pressure_rating = 470
        temperature_rating = 750
        elsif  pressure > 470 and pressure <= 705 
        flange_class = "600"
        pressure_rating = 705
        temperature_rating = 750
        elsif  pressure > 705 and pressure <= 1060 
        flange_class = "900"
        pressure_rating = 1060
        temperature_rating = 750
        elsif  pressure > 1060 and pressure <= 1765 
        flange_class = "1500"
        pressure_rating = 1765
        temperature_rating = 750
        elsif  pressure > 1765 and pressure <= 2940 
        flange_class = "2500"
        pressure_rating = 2940
        temperature_rating = 750
        
        end
    elsif temperature > 750 and temperature <= 800 
        if pressure <= 80 
        flange_class = "150"
        pressure_rating = 80
        temperature_rating = 800
        elsif  pressure > 80 and pressure <= 345 
        flange_class = "300"
        pressure_rating = 345
        temperature_rating = 800
        elsif  pressure > 345 and pressure <= 460 
        flange_class = "400"
        pressure_rating = 460
        temperature_rating = 800
        elsif  pressure > 460 and pressure <= 690 
        flange_class = "600"
        pressure_rating = 690
        temperature_rating = 800
        elsif  pressure > 690 and pressure <= 1035 
        flange_class = "900"
        pressure_rating = 1035
        temperature_rating = 800
        elsif  pressure > 1035 and pressure <= 1730 
        flange_class = "1500"
        pressure_rating = 1730
        temperature_rating = 800
        elsif  pressure > 1730 and pressure <= 2880 
        flange_class = "2500"
        pressure_rating = 2880
        temperature_rating = 800
        
        end
    elsif temperature > 800 and temperature <= 850 
        if pressure <= 65 
        flange_class = "150"
        pressure_rating = 65
        temperature_rating = 850
        elsif  pressure > 65 and pressure <= 340 
        flange_class = "300"
        pressure_rating = 340
        temperature_rating = 850
        elsif  pressure > 340 and pressure <= 450 
        flange_class = "400"
        pressure_rating = 450
        temperature_rating = 850
        elsif  pressure > 450 and pressure <= 675 
        flange_class = "600"
        pressure_rating = 675
        temperature_rating = 850
        elsif  pressure > 675 and pressure <= 1015 
        flange_class = "900"
        pressure_rating = 1015
        temperature_rating = 850
        elsif  pressure > 1015 and pressure <= 1690 
        flange_class = "1500"
        pressure_rating = 1690
        temperature_rating = 850
        elsif  pressure > 1690 and pressure <= 2820 
        flange_class = "2500"
        pressure_rating = 2820
        temperature_rating = 850
        
        end
    
    end
    
    if Worksheets("UOM").chkCustomary.Value = True 
    UserFormLineSegmentDesign.lblNotes = "((1) Not to be used over 800\B0F."
    elsif orksheets("UOM").chkSI.Value = True 
    UserFormLineSegmentDesign.lblNotes = "((1) Not to be used over 425\B0C."
    
    end
    
elsif material_group = "2.4" 
UserFormLineSegmentDesign.cmbMaterialDesignation.RowSource = "MaterialGroup2.4"
    if temperature >= -20 and temperature <= 100 
        if pressure <= 275 
        flange_class = "150"
        pressure_rating = 275
        temperature_rating = 100
        elsif  pressure > 275 and pressure <= 720 
        flange_class = "300"
        pressure_rating = 720
        temperature_rating = 100
        elsif  pressure > 720 and pressure <= 960 
        flange_class = "400"
        pressure_rating = 960
        temperature_rating = 100
        elsif  pressure > 960 and pressure <= 1440 
        flange_class = "600"
        pressure_rating = 1440
        temperature_rating = 100
        elsif  pressure > 1440 and pressure <= 2160 
        flange_class = "900"
        pressure_rating = 2160
        temperature_rating = 100
        elsif  pressure > 2160 and pressure <= 3600 
        flange_class = "1500"
        pressure_rating = 3600
        temperature_rating = 100
        elsif  pressure > 3600 and pressure <= 6000 
        flange_class = "2500"
        pressure_rating = 6000
        temperature_rating = 100
        
        end
    elsif temperature > 100 and temperature <= 200 
        if pressure <= 250 
        flange_class = "150"
        pressure_rating = 250
        temperature_rating = 200
        elsif  pressure > 250 and pressure <= 650 
        flange_class = "300"
        pressure_rating = 650
        temperature_rating = 200
        elsif  pressure > 650 and pressure <= 865 
        flange_class = "400"
        pressure_rating = 865
        temperature_rating = 200
        elsif  pressure > 865 and pressure <= 1295 
        flange_class = "600"
        pressure_rating = 1295
        temperature_rating = 200
        elsif  pressure > 1295 and pressure <= 1945 
        flange_class = "900"
        pressure_rating = 1945
        temperature_rating = 200
        elsif  pressure > 1945 and pressure <= 3240 
        flange_class = "1500"
        pressure_rating = 3240
        temperature_rating = 200
        elsif  pressure > 3240 and pressure <= 5400 
        flange_class = "2500"
        pressure_rating = 5400
        temperature_rating = 200
        
        end
    elsif temperature > 200 and temperature <= 300 
        if pressure <= 230 
        flange_class = "150"
        pressure_rating = 230
        temperature_rating = 300
        elsif  pressure > 230 and pressure <= 595 
        flange_class = "300"
        pressure_rating = 595
        temperature_rating = 300
        elsif  pressure > 595 and pressure <= 795 
        flange_class = "400"
        pressure_rating = 795
        temperature_rating = 300
        elsif  pressure > 795 and pressure <= 1190 
        flange_class = "600"
        pressure_rating = 1190
        temperature_rating = 300
        elsif  pressure > 1190 and pressure <= 1785 
        flange_class = "900"
        pressure_rating = 1785
        temperature_rating = 300
        elsif  pressure > 1785 and pressure <= 2975 
        flange_class = "1500"
        pressure_rating = 2975
        temperature_rating = 300
        elsif  pressure > 2975 and pressure <= 4960 
        flange_class = "2500"
        pressure_rating = 4960
        temperature_rating = 300
        
        end
    elsif temperature > 300 and temperature <= 400 
        if pressure <= 200 
        flange_class = "150"
        pressure_rating = 200
        temperature_rating = 400
        elsif  pressure > 200 and pressure <= 550 
        flange_class = "300"
        pressure_rating = 550
        temperature_rating = 400
        elsif  pressure > 550 and pressure <= 735 
        flange_class = "400"
        pressure_rating = 735
        temperature_rating = 400
        elsif  pressure > 735 and pressure <= 1105 
        flange_class = "600"
        pressure_rating = 1105
        temperature_rating = 400
        elsif  pressure > 1105 and pressure <= 1655 
        flange_class = "900"
        pressure_rating = 1655
        temperature_rating = 400
        elsif  pressure > 1655 and pressure <= 2760 
        flange_class = "1500"
        pressure_rating = 2760
        temperature_rating = 400
        elsif  pressure > 2760 and pressure <= 4600 
        flange_class = "2500"
        pressure_rating = 4600
        temperature_rating = 400
        
        end
    elsif temperature > 400 and temperature <= 500 
        if pressure <= 170 
        flange_class = "150"
        pressure_rating = 170
        temperature_rating = 500
        elsif  pressure > 170 and pressure <= 515 
        flange_class = "300"
        pressure_rating = 515
        temperature_rating = 500
        elsif  pressure > 515 and pressure <= 690 
        flange_class = "400"
        pressure_rating = 690
        temperature_rating = 500
        elsif  pressure > 690 and pressure <= 1030 
        flange_class = "600"
        pressure_rating = 1030
        temperature_rating = 500
        elsif  pressure > 1030 and pressure <= 1550 
        flange_class = "900"
        pressure_rating = 1550
        temperature_rating = 500
        elsif  pressure > 1550 and pressure <= 2580 
        flange_class = "1500"
        pressure_rating = 2580
        temperature_rating = 500
        elsif  pressure > 2580 and pressure <= 4300 
        flange_class = "2500"
        pressure_rating = 4300
        temperature_rating = 500
        
        end
    elsif temperature > 500 and temperature <= 600 
        if pressure <= 140 
        flange_class = "150"
        pressure_rating = 140
        temperature_rating = 600
        elsif  pressure > 140 and pressure <= 485 
        flange_class = "300"
        pressure_rating = 485
        temperature_rating = 600
        elsif  pressure > 485 and pressure <= 650 
        flange_class = "400"
        pressure_rating = 650
        temperature_rating = 600
        elsif  pressure > 650 and pressure <= 975 
        flange_class = "600"
        pressure_rating = 975
        temperature_rating = 600
        elsif  pressure > 975 and pressure <= 1460 
        flange_class = "900"
        pressure_rating = 1460
        temperature_rating = 600
        elsif  pressure > 1460 and pressure <= 2435 
        flange_class = "1500"
        pressure_rating = 2435
        temperature_rating = 600
        elsif  pressure > 2435 and pressure <= 4060 
        flange_class = "2500"
        pressure_rating = 4060
        temperature_rating = 600
        
        end
    elsif temperature > 600 and temperature <= 650 
        if pressure <= 125 
        flange_class = "150"
        pressure_rating = 125
        temperature_rating = 650
        elsif  pressure > 125 and pressure <= 475 
        flange_class = "300"
        pressure_rating = 475
        temperature_rating = 650
        elsif  pressure > 475 and pressure <= 635 
        flange_class = "400"
        pressure_rating = 635
        temperature_rating = 650
        elsif  pressure > 635 and pressure <= 950 
        flange_class = "600"
        pressure_rating = 950
        temperature_rating = 650
        elsif  pressure > 950 and pressure <= 1425 
        flange_class = "900"
        pressure_rating = 1425
        temperature_rating = 650
        elsif  pressure > 1425 and pressure <= 2375 
        flange_class = "1500"
        pressure_rating = 2375
        temperature_rating = 650
        elsif  pressure > 2375 and pressure <= 3960 
        flange_class = "2500"
        pressure_rating = 3960
        temperature_rating = 650
        
        end
    elsif temperature > 650 and temperature <= 700 
        if pressure <= 110 
        flange_class = "150"
        pressure_rating = 110
        temperature_rating = 700
        elsif  pressure > 110 and pressure <= 465 
        flange_class = "300"
        pressure_rating = 465
        temperature_rating = 700
        elsif  pressure > 465 and pressure <= 620 
        flange_class = "400"
        pressure_rating = 620
        temperature_rating = 700
        elsif  pressure > 620 and pressure <= 930 
        flange_class = "600"
        pressure_rating = 930
        temperature_rating = 700
        elsif  pressure > 930 and pressure <= 1395 
        flange_class = "900"
        pressure_rating = 1395
        temperature_rating = 700
        elsif  pressure > 1395 and pressure <= 2330 
        flange_class = "1500"
        pressure_rating = 2330
        temperature_rating = 700
        elsif  pressure > 2330 and pressure <= 3880 
        flange_class = "2500"
        pressure_rating = 3880
        temperature_rating = 700
        
        end
    elsif temperature > 700 and temperature <= 750 
        if pressure <= 95 
        flange_class = "150"
        pressure_rating = 95
        temperature_rating = 750
        elsif  pressure > 95 and pressure <= 460 
        flange_class = "300"
        pressure_rating = 460
        temperature_rating = 750
        elsif  pressure > 460 and pressure <= 610 
        flange_class = "400"
        pressure_rating = 610
        temperature_rating = 750
        elsif  pressure > 610 and pressure <= 915 
        flange_class = "600"
        pressure_rating = 915
        temperature_rating = 750
        elsif  pressure > 915 and pressure <= 1375 
        flange_class = "900"
        pressure_rating = 1375
        temperature_rating = 750
        elsif  pressure > 1375 and pressure <= 2290 
        flange_class = "1500"
        pressure_rating = 2290
        temperature_rating = 750
        elsif  pressure > 2290 and pressure <= 3880 
        flange_class = "2500"
        pressure_rating = 3880
        temperature_rating = 750
        
        end
    elsif temperature > 750 and temperature <= 800 
        if pressure <= 80 
        flange_class = "150"
        pressure_rating = 80
        temperature_rating = 800
        elsif  pressure > 80 and pressure <= 450 
        flange_class = "300"
        pressure_rating = 450
        temperature_rating = 800
        elsif  pressure > 450 and pressure <= 600 
        flange_class = "400"
        pressure_rating = 600
        temperature_rating = 800
        elsif  pressure > 600 and pressure <= 900 
        flange_class = "600"
        pressure_rating = 900
        temperature_rating = 800
        elsif  pressure > 900 and pressure <= 1355 
        flange_class = "900"
        pressure_rating = 1355
        temperature_rating = 800
        elsif  pressure > 1355 and pressure <= 2255 
        flange_class = "1500"
        pressure_rating = 2255
        temperature_rating = 800
        elsif  pressure > 2255 and pressure <= 3760 
        flange_class = "2500"
        pressure_rating = 3760
        temperature_rating = 800
        
        end
    elsif temperature > 800 and temperature <= 850 
        if pressure <= 65 
        flange_class = "150"
        pressure_rating = 65
        temperature_rating = 850
        elsif  pressure > 65 and pressure <= 445 
        flange_class = "300"
        pressure_rating = 445
        temperature_rating = 850
        elsif  pressure > 445 and pressure <= 595 
        flange_class = "400"
        pressure_rating = 595
        temperature_rating = 850
        elsif  pressure > 595 and pressure <= 895 
        flange_class = "600"
        pressure_rating = 895
        temperature_rating = 850
        elsif  pressure > 895 and pressure <= 1340 
        flange_class = "900"
        pressure_rating = 1340
        temperature_rating = 850
        elsif  pressure > 1340 and pressure <= 2230 
        flange_class = "1500"
        pressure_rating = 2230
        temperature_rating = 850
        elsif  pressure > 2230 and pressure <= 3720 
        flange_class = "2500"
        pressure_rating = 3720
        temperature_rating = 850
        
        end
    elsif temperature > 850 and temperature <= 900 
        if pressure <= 50 
        flange_class = "150"
        pressure_rating = 50
        temperature_rating = 900
        elsif  pressure > 50 and pressure <= 440 
        flange_class = "300"
        pressure_rating = 440
        temperature_rating = 900
        elsif  pressure > 440 and pressure <= 590 
        flange_class = "400"
        pressure_rating = 590
        temperature_rating = 900
        elsif  pressure > 590 and pressure <= 885 
        flange_class = "600"
        pressure_rating = 885
        temperature_rating = 900
        elsif  pressure > 885 and pressure <= 1325 
        flange_class = "900"
        pressure_rating = 1325
        temperature_rating = 900
        elsif  pressure > 1325 and pressure <= 2210 
        flange_class = "1500"
        pressure_rating = 2210
        temperature_rating = 900
        elsif  pressure > 2210 and pressure <= 3680 
        flange_class = "2500"
        pressure_rating = 3680
        temperature_rating = 900
        
        end
    elsif temperature > 900 and temperature <= 950 
        if pressure <= 35 
        flange_class = "150"
        pressure_rating = 35
        temperature_rating = 950
        elsif  pressure > 35 and pressure <= 385 
        flange_class = "300"
        pressure_rating = 385
        temperature_rating = 950
        elsif  pressure > 385 and pressure <= 515 
        flange_class = "400"
        pressure_rating = 515
        temperature_rating = 950
        elsif  pressure > 515 and pressure <= 775 
        flange_class = "600"
        pressure_rating = 775
        temperature_rating = 950
        elsif  pressure > 775 and pressure <= 1160 
        flange_class = "900"
        pressure_rating = 1160
        temperature_rating = 950
        elsif  pressure > 1160 and pressure <= 1930 
        flange_class = "1500"
        pressure_rating = 1930
        temperature_rating = 950
        elsif  pressure > 1930 and pressure <= 3220 
        flange_class = "2500"
        pressure_rating = 3220
        temperature_rating = 950
        
        end
    elsif temperature > 950 and temperature <= 1000 
        if pressure <= 20 
        flange_class = "150"
        pressure_rating = 20
        temperature_rating = 1000
        elsif  pressure > 20 and pressure <= 365 
        flange_class = "300"
        pressure_rating = 365
        temperature_rating = 1000
        elsif  pressure > 365 and pressure <= 485 
        flange_class = "400"
        pressure_rating = 485
        temperature_rating = 1000
        elsif  pressure > 485 and pressure <= 725 
        flange_class = "600"
        pressure_rating = 725
        temperature_rating = 1000
        elsif  pressure > 725 and pressure <= 1090 
        flange_class = "900"
        pressure_rating = 1090
        temperature_rating = 1000
        elsif  pressure > 1090 and pressure <= 1820 
        flange_class = "1500"
        pressure_rating = 1820
        temperature_rating = 1000
        elsif  pressure > 1820 and pressure <= 3030 
        flange_class = "2500"
        pressure_rating = 3030
        temperature_rating = 1000
        
        end
    elsif temperature > 1000 and temperature <= 1050 
        if pressure > 360 
        flange_class = "300"
        pressure_rating = 360
        temperature_rating = 1050
        elsif  pressure > 360 and pressure <= 480 
        flange_class = "400"
        pressure_rating = 480
        temperature_rating = 1050
        elsif  pressure > 480 and pressure <= 720 
        flange_class = "600"
        pressure_rating = 720
        temperature_rating = 1050
        elsif  pressure > 720 and pressure <= 1080 
        flange_class = "900"
        pressure_rating = 1080
        temperature_rating = 1050
        elsif  pressure > 1080 and pressure <= 1800 
        flange_class = "1500"
        pressure_rating = 1800
        temperature_rating = 1050
        elsif  pressure > 1800 and pressure <= 3000 
        flange_class = "2500"
        pressure_rating = 3000
        temperature_rating = 1050
        
        end
    elsif temperature > 1050 and temperature <= 1100 
        if pressure > 310 
        flange_class = "300"
        pressure_rating = 310
        temperature_rating = 1100
        elsif  pressure > 310 and pressure <= 415 
        flange_class = "400"
        pressure_rating = 415
        temperature_rating = 1100
        elsif  pressure > 415 and pressure <= 625 
        flange_class = "600"
        pressure_rating = 625
        temperature_rating = 1100
        elsif  pressure > 625 and pressure <= 935 
        flange_class = "900"
        pressure_rating = 935
        temperature_rating = 1100
        elsif  pressure > 935 and pressure <= 1560 
        flange_class = "1500"
        pressure_rating = 1560
        temperature_rating = 1100
        elsif  pressure > 1560 and pressure <= 2600 
        flange_class = "2500"
        pressure_rating = 2600
        temperature_rating = 1100
        
        end
    elsif temperature > 1100 and temperature <= 1150 
        if pressure > 235 
        flange_class = "300"
        pressure_rating = 235
        temperature_rating = 1150
        elsif  pressure > 235 and pressure <= 315 
        flange_class = "400"
        pressure_rating = 315
        temperature_rating = 1150
        elsif  pressure > 315 and pressure <= 475 
        flange_class = "600"
        pressure_rating = 475
        temperature_rating = 1150
        elsif  pressure > 475 and pressure <= 710 
        flange_class = "900"
        pressure_rating = 710
        temperature_rating = 1150
        elsif  pressure > 710 and pressure <= 1185 
        flange_class = "1500"
        pressure_rating = 1185
        temperature_rating = 1150
        elsif  pressure > 1185 and pressure <= 1970 
        flange_class = "2500"
        pressure_rating = 1970
        temperature_rating = 1150
        
        end
    elsif temperature > 1150 and temperature <= 1200 
        if pressure > 185 
        flange_class = "300"
        pressure_rating = 185
        temperature_rating = 1200
        elsif  pressure > 185 and pressure <= 245 
        flange_class = "400"
        pressure_rating = 245
        temperature_rating = 1200
        elsif  pressure > 245 and pressure <= 370 
        flange_class = "600"
        pressure_rating = 370
        temperature_rating = 1200
        elsif  pressure > 370 and pressure <= 555 
        flange_class = "900"
        pressure_rating = 555
        temperature_rating = 1200
        elsif  pressure > 555 and pressure <= 925 
        flange_class = "1500"
        pressure_rating = 925
        temperature_rating = 1200
        elsif  pressure > 925 and pressure <= 1545 
        flange_class = "2500"
        pressure_rating = 1545
        temperature_rating = 1200
        
        end
    elsif temperature > 1200 and temperature <= 1250 
        if pressure > 140 
        flange_class = "300"
        pressure_rating = 140
        temperature_rating = 1250
        elsif  pressure > 140 and pressure <= 185 
        flange_class = "400"
        pressure_rating = 185
        temperature_rating = 1250
        elsif  pressure > 185 and pressure <= 280 
        flange_class = "600"
        pressure_rating = 280
        temperature_rating = 1250
        elsif  pressure > 280 and pressure <= 420 
        flange_class = "900"
        pressure_rating = 420
        temperature_rating = 1250
        elsif  pressure > 420 and pressure <= 705 
        flange_class = "1500"
        pressure_rating = 705
        temperature_rating = 1250
        elsif  pressure > 705 and pressure <= 1170 
        flange_class = "2500"
        pressure_rating = 1170
        temperature_rating = 1250
        
        end
    elsif temperature > 1250 and temperature <= 1300 
        if pressure > 110 
        flange_class = "300"
        pressure_rating = 110
        temperature_rating = 1300
        elsif  pressure > 110 and pressure <= 145 
        flange_class = "400"
        pressure_rating = 145
        temperature_rating = 1300
        elsif  pressure > 145 and pressure <= 220 
        flange_class = "600"
        pressure_rating = 220
        temperature_rating = 1300
        elsif  pressure > 220 and pressure <= 330 
        flange_class = "900"
        pressure_rating = 330
        temperature_rating = 1300
        elsif  pressure > 330 and pressure <= 550 
        flange_class = "1500"
        pressure_rating = 550
        temperature_rating = 1300
        elsif  pressure > 550 and pressure <= 915 
        flange_class = "2500"
        pressure_rating = 915
        temperature_rating = 1300
        
        end
    elsif temperature > 1300 and temperature <= 1350 
        if pressure > 85 
        flange_class = "300"
        pressure_rating = 85
        temperature_rating = 1350
        elsif  pressure > 85 and pressure <= 115 
        flange_class = "400"
        pressure_rating = 115
        temperature_rating = 1350
        elsif  pressure > 115 and pressure <= 170 
        flange_class = "600"
        pressure_rating = 170
        temperature_rating = 1350
        elsif  pressure > 170 and pressure <= 255 
        flange_class = "900"
        pressure_rating = 255
        temperature_rating = 1350
        elsif  pressure > 255 and pressure <= 430 
        flange_class = "1500"
        pressure_rating = 430
        temperature_rating = 1350
        elsif  pressure > 430 and pressure <= 715 
        flange_class = "2500"
        pressure_rating = 715
        temperature_rating = 1350
        
        end
    elsif temperature > 1350 and temperature <= 1400 
        if pressure > 65 
        flange_class = "300"
        pressure_rating = 65
        temperature_rating = 1400
        elsif  pressure > 65 and pressure <= 85 
        flange_class = "400"
        pressure_rating = 85
        temperature_rating = 1400
        elsif  pressure > 85 and pressure <= 130 
        flange_class = "600"
        pressure_rating = 130
        temperature_rating = 1400
        elsif  pressure > 130 and pressure <= 195 
        flange_class = "900"
        pressure_rating = 195
        temperature_rating = 1400
        elsif  pressure > 195 and pressure <= 325 
        flange_class = "1500"
        pressure_rating = 325
        temperature_rating = 1150
        elsif  pressure > 325 and pressure <= 545 
        flange_class = "2500"
        pressure_rating = 545
        temperature_rating = 1400
        
        end
    elsif temperature > 1400 and temperature <= 1450 
        if pressure > 50 
        flange_class = "300"
        pressure_rating = 50
        temperature_rating = 1450
        elsif  pressure > 50 and pressure <= 70 
        flange_class = "400"
        pressure_rating = 70
        temperature_rating = 1450
        elsif  pressure > 70 and pressure <= 105 
        flange_class = "600"
        pressure_rating = 105
        temperature_rating = 1450
        elsif  pressure > 105 and pressure <= 155 
        flange_class = "900"
        pressure_rating = 155
        temperature_rating = 1450
        elsif  pressure > 155 and pressure <= 255 
        flange_class = "1500"
        pressure_rating = 255
        temperature_rating = 1450
        elsif  pressure > 255 and pressure <= 430 
        flange_class = "2500"
        pressure_rating = 430
        temperature_rating = 1450
        
        end
    elsif temperature > 1450 and temperature <= 1500 
        if pressure > 40 
        flange_class = "300"
        pressure_rating = 40
        temperature_rating = 1500
        elsif  pressure > 40 and pressure <= 50 
        flange_class = "400"
        pressure_rating = 50
        temperature_rating = 1500
        elsif  pressure > 50 and pressure <= 75 
        flange_class = "600"
        pressure_rating = 75
        temperature_rating = 1500
        elsif  pressure > 75 and pressure <= 115 
        flange_class = "900"
        pressure_rating = 115
        temperature_rating = 1500
        elsif  pressure > 115 and pressure <= 190 
        flange_class = "1500"
        pressure_rating = 190
        temperature_rating = 1500
        elsif  pressure > 190 and pressure <= 315 
        flange_class = "2500"
        pressure_rating = 315
        temperature_rating = 1500
        
        end
    
    end
    
    if Worksheets("UOM").chkCustomary.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) Not to be used over 1000\B0F." & Chr(13) _
    & "(2) At temperatures over 1000\B0F, use only if the material is heat treated by heating to a minimum temperature of 2000\B0F."
    elsif orksheets("UOM").chkSI.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) Not to be used over 538\B0C." & Chr(13) _
    & "(2) At temperatures over 538\B0C, use only if the material is heat treated by heating to a minimum temperature of 1095\B0C."
    
    flange_classd if
    pressure_ratingElse
Call FlangePressuretemperature_rating4(pressure, temperature, MaterialGroup, FlangeClass, PressureRating, temperature_rating)
flange_class if

pressure_ratingSub

Sub FlangePressuretemperature_rating4(pressure, temperature, MaterialGroup, FlangeClass, PressureRating, temperature_rating)

if MaterialGroup = "2.5" 
UserFormLineSegmentDesign.cmbMaterialDesignation.RowSource = "MaterialGroup2.5"
    if temperature >= -20 and temperature <= 100 
        if pressure <= 275 
        flange_class = "150"
        pressure_rating = 275
        temperature_rating = 100
        elsif  pressure > 275 and pressure <= 720 
        flange_class = "300"
        pressure_rating = 720
        temperature_rating = 100
        elsif  pressure > 720 and pressure <= 960 
        flange_class = "400"
        pressure_rating = 960
        temperature_rating = 100
        elsif  pressure > 960 and pressure <= 1440 
        flange_class = "600"
        pressure_rating = 1440
        temperature_rating = 100
        elsif  pressure > 1440 and pressure <= 2160 
        flange_class = "900"
        pressure_rating = 2160
        temperature_rating = 100
        elsif  pressure > 2160 and pressure <= 3600 
        flange_class = "1500"
        pressure_rating = 3600
        temperature_rating = 100
        elsif  pressure > 3600 and pressure <= 6000 
        flange_class = "2500"
        pressure_rating = 6000
        temperature_rating = 100
        
        end
    elsif temperature > 100 and temperature <= 200 
        if pressure <= 255 
        flange_class = "150"
        pressure_rating = 255
        temperature_rating = 200
        elsif  pressure > 255 and pressure <= 660 
        flange_class = "300"
        pressure_rating = 660
        temperature_rating = 200
        elsif  pressure > 660 and pressure <= 885 
        flange_class = "400"
        pressure_rating = 885
        temperature_rating = 200
        elsif  pressure > 885 and pressure <= 1325 
        flange_class = "600"
        pressure_rating = 1325
        temperature_rating = 200
        elsif  pressure > 1325 and pressure <= 1985 
        flange_class = "900"
        pressure_rating = 1985
        temperature_rating = 200
        elsif  pressure > 1985 and pressure <= 3310 
        flange_class = "1500"
        pressure_rating = 3310
        temperature_rating = 200
        elsif  pressure > 3310 and pressure <= 5520 
        flange_class = "2500"
        pressure_rating = 5520
        temperature_rating = 200
        
        end
    elsif temperature > 200 and temperature <= 300 
        if pressure <= 230 
        flange_class = "150"
        pressure_rating = 230
        temperature_rating = 300
        elsif  pressure > 230 and pressure <= 615 
        flange_class = "300"
        pressure_rating = 615
        temperature_rating = 300
        elsif  pressure > 615 and pressure <= 820 
        flange_class = "400"
        pressure_rating = 820
        temperature_rating = 300
        elsif  pressure > 820 and pressure <= 1235 
        flange_class = "600"
        pressure_rating = 1235
        temperature_rating = 300
        elsif  pressure > 1235 and pressure <= 1850 
        flange_class = "900"
        pressure_rating = 1850
        temperature_rating = 300
        elsif  pressure > 1850 and pressure <= 3085 
        flange_class = "1500"
        pressure_rating = 3085
        temperature_rating = 300
        elsif  pressure > 3085 and pressure <= 5140 
        flange_class = "2500"
        pressure_rating = 5140
        temperature_rating = 300
        
        end
    elsif temperature > 300 and temperature <= 400 
        if pressure <= 200 
        flange_class = "150"
        pressure_rating = 200
        temperature_rating = 400
        elsif  pressure > 200 and pressure <= 575 
        flange_class = "300"
        pressure_rating = 575
        temperature_rating = 400
        elsif  pressure > 575 and pressure <= 770 
        flange_class = "400"
        pressure_rating = 770
        temperature_rating = 400
        elsif  pressure > 770 and pressure <= 1150 
        flange_class = "600"
        pressure_rating = 1150
        temperature_rating = 400
        elsif  pressure > 1150 and pressure <= 1730 
        flange_class = "900"
        pressure_rating = 1730
        temperature_rating = 400
        elsif  pressure > 1730 and pressure <= 2880 
        flange_class = "1500"
        pressure_rating = 2880
        temperature_rating = 400
        elsif  pressure > 2880 and pressure <= 4800 
        flange_class = "2500"
        pressure_rating = 4800
        temperature_rating = 400
        
        end
    elsif temperature > 400 and temperature <= 500 
        if pressure <= 170 
        flange_class = "150"
        pressure_rating = 170
        temperature_rating = 500
        elsif  pressure > 170 and pressure <= 540 
        flange_class = "300"
        pressure_rating = 540
        temperature_rating = 500
        elsif  pressure > 540 and pressure <= 725 
        flange_class = "400"
        pressure_rating = 725
        temperature_rating = 500
        elsif  pressure > 725 and pressure <= 1085 
        flange_class = "600"
        pressure_rating = 1085
        temperature_rating = 500
        elsif  pressure > 1085 and pressure <= 1625 
        flange_class = "900"
        pressure_rating = 1625
        temperature_rating = 500
        elsif  pressure > 1625 and pressure <= 2710 
        flange_class = "1500"
        pressure_rating = 2710
        temperature_rating = 500
        elsif  pressure > 2710 and pressure <= 4520 
        flange_class = "2500"
        pressure_rating = 4520
        temperature_rating = 500
        
        end
    elsif temperature > 500 and temperature <= 600 
        if pressure <= 140 
        flange_class = "150"
        pressure_rating = 140
        temperature_rating = 600
        elsif  pressure > 140 and pressure <= 515 
        flange_class = "300"
        pressure_rating = 515
        temperature_rating = 600
        elsif  pressure > 515 and pressure <= 690 
        flange_class = "400"
        pressure_rating = 690
        temperature_rating = 600
        elsif  pressure > 690 and pressure <= 1030 
        flange_class = "600"
        pressure_rating = 1030
        temperature_rating = 600
        elsif  pressure > 1030 and pressure <= 1550 
        flange_class = "900"
        pressure_rating = 1550
        temperature_rating = 600
        elsif  pressure > 1550 and pressure <= 2580 
        flange_class = "1500"
        pressure_rating = 2580
        temperature_rating = 600
        elsif  pressure > 2580 and pressure <= 4300 
        flange_class = "2500"
        pressure_rating = 4300
        temperature_rating = 600
        
        end
    elsif temperature > 600 and temperature <= 650 
        if pressure <= 125 
        flange_class = "150"
        pressure_rating = 125
        temperature_rating = 650
        elsif  pressure > 125 and pressure <= 505 
        flange_class = "300"
        pressure_rating = 505
        temperature_rating = 650
        elsif  pressure > 505 and pressure <= 675 
        flange_class = "400"
        pressure_rating = 675
        temperature_rating = 650
        elsif  pressure > 675 and pressure <= 1015 
        flange_class = "600"
        pressure_rating = 1015
        temperature_rating = 650
        elsif  pressure > 1015 and pressure <= 1520 
        flange_class = "900"
        pressure_rating = 1520
        temperature_rating = 650
        elsif  pressure > 1520 and pressure <= 2530 
        flange_class = "1500"
        pressure_rating = 2530
        temperature_rating = 650
        elsif  pressure > 2530 and pressure <= 4220 
        flange_class = "2500"
        pressure_rating = 4220
        temperature_rating = 650
        
        end
    elsif temperature > 650 and temperature <= 700 
        if pressure <= 110 
        flange_class = "150"
        pressure_rating = 110
        temperature_rating = 700
        elsif  pressure > 110 and pressure <= 495 
        flange_class = "300"
        pressure_rating = 495
        temperature_rating = 700
        elsif  pressure > 495 and pressure <= 660 
        flange_class = "400"
        pressure_rating = 660
        temperature_rating = 700
        elsif  pressure > 660 and pressure <= 995 
        flange_class = "600"
        pressure_rating = 995
        temperature_rating = 700
        elsif  pressure > 995 and pressure <= 1490 
        flange_class = "900"
        pressure_rating = 1490
        temperature_rating = 700
        elsif  pressure > 1490 and pressure <= 2485 
        flange_class = "1500"
        pressure_rating = 2485
        temperature_rating = 700
        elsif  pressure > 2485 and pressure <= 4140 
        flange_class = "2500"
        pressure_rating = 4140
        temperature_rating = 700
        
        end
    elsif temperature > 700 and temperature <= 750 
        if pressure <= 95 
        flange_class = "150"
        pressure_rating = 95
        temperature_rating = 750
        elsif  pressure > 95 and pressure <= 490 
        flange_class = "300"
        pressure_rating = 490
        temperature_rating = 750
        elsif  pressure > 490 and pressure <= 655 
        flange_class = "400"
        pressure_rating = 655
        temperature_rating = 750
        elsif  pressure > 655 and pressure <= 985 
        flange_class = "600"
        pressure_rating = 985
        temperature_rating = 750
        elsif  pressure > 985 and pressure <= 1475 
        flange_class = "900"
        pressure_rating = 1475
        temperature_rating = 750
        elsif  pressure > 1475 and pressure <= 2460 
        flange_class = "1500"
        pressure_rating = 2460
        temperature_rating = 750
        elsif  pressure > 2460 and pressure <= 4100 
        flange_class = "2500"
        pressure_rating = 4100
        temperature_rating = 750
        
        end
    elsif temperature > 750 and temperature <= 800 
        if pressure <= 80 
        flange_class = "150"
        pressure_rating = 80
        temperature_rating = 800
        elsif  pressure > 80 and pressure <= 485 
        flange_class = "300"
        pressure_rating = 485
        temperature_rating = 800
        elsif  pressure > 485 and pressure <= 650 
        flange_class = "400"
        pressure_rating = 650
        temperature_rating = 800
        elsif  pressure > 650 and pressure <= 975 
        flange_class = "600"
        pressure_rating = 975
        temperature_rating = 800
        elsif  pressure > 975 and pressure <= 1460 
        flange_class = "900"
        pressure_rating = 1460
        temperature_rating = 800
        elsif  pressure > 1460 and pressure <= 2435 
        flange_class = "1500"
        pressure_rating = 2435
        temperature_rating = 800
        elsif  pressure > 2435 and pressure <= 4060 
        flange_class = "2500"
        pressure_rating = 4060
        temperature_rating = 800
        
        end
    elsif temperature > 800 and temperature <= 850 
        if pressure <= 65 
        flange_class = "150"
        pressure_rating = 65
        temperature_rating = 850
        elsif  pressure > 65 and pressure <= 485 
        flange_class = "300"
        pressure_rating = 485
        temperature_rating = 850
        elsif  pressure > 485 and pressure <= 645 
        flange_class = "400"
        pressure_rating = 645
        temperature_rating = 850
        elsif  pressure > 645 and pressure <= 970 
        flange_class = "600"
        pressure_rating = 970
        temperature_rating = 850
        elsif  pressure > 970 and pressure <= 1455 
        flange_class = "900"
        pressure_rating = 1455
        temperature_rating = 850
        elsif  pressure > 1455 and pressure <= 2425 
        flange_class = "1500"
        pressure_rating = 2425
        temperature_rating = 850
        elsif  pressure > 2425 and pressure <= 4040 
        flange_class = "2500"
        pressure_rating = 4040
        temperature_rating = 850
        
        end
    elsif temperature > 850 and temperature <= 900 
        if pressure <= 50 
        flange_class = "150"
        pressure_rating = 50
        temperature_rating = 900
        elsif  pressure > 50 and pressure <= 450 
        flange_class = "300"
        pressure_rating = 450
        temperature_rating = 900
        elsif  pressure > 450 and pressure <= 600 
        flange_class = "400"
        pressure_rating = 600
        temperature_rating = 900
        elsif  pressure > 600 and pressure <= 900 
        flange_class = "600"
        pressure_rating = 900
        temperature_rating = 900
        elsif  pressure > 900 and pressure <= 1350 
        flange_class = "900"
        pressure_rating = 1350
        temperature_rating = 900
        elsif  pressure > 1350 and pressure <= 2245 
        flange_class = "1500"
        pressure_rating = 2245
        temperature_rating = 900
        elsif  pressure > 2245 and pressure <= 3745 
        flange_class = "2500"
        pressure_rating = 3745
        temperature_rating = 900
        
        end
    elsif temperature > 900 and temperature <= 950 
        if pressure <= 35 
        flange_class = "150"
        pressure_rating = 35
        temperature_rating = 950
        elsif  pressure > 35 and pressure <= 385 
        flange_class = "300"
        pressure_rating = 385
        temperature_rating = 950
        elsif  pressure > 385 and pressure <= 515 
        flange_class = "400"
        pressure_rating = 515
        temperature_rating = 950
        elsif  pressure > 515 and pressure <= 775 
        flange_class = "600"
        pressure_rating = 775
        temperature_rating = 950
        elsif  pressure > 775 and pressure <= 1160 
        flange_class = "900"
        pressure_rating = 1160
        temperature_rating = 950
        elsif  pressure > 1160 and pressure <= 1930 
        flange_class = "1500"
        pressure_rating = 1930
        temperature_rating = 950
        elsif  pressure > 1930 and pressure <= 3220 
        flange_class = "2500"
        pressure_rating = 3220
        temperature_rating = 950
        
        end
    elsif temperature > 950 and temperature <= 1000 
        if pressure <= 20 
        flange_class = "150"
        pressure_rating = 20
        temperature_rating = 1000
        elsif  pressure > 20 and pressure <= 365 
        flange_class = "300"
        pressure_rating = 365
        temperature_rating = 1000
        elsif  pressure > 365 and pressure <= 485 
        flange_class = "400"
        pressure_rating = 485
        temperature_rating = 1000
        elsif  pressure > 485 and pressure <= 725 
        flange_class = "600"
        pressure_rating = 725
        temperature_rating = 1000
        elsif  pressure > 725 and pressure <= 1090 
        flange_class = "900"
        pressure_rating = 1090
        temperature_rating = 1000
        elsif  pressure > 1090 and pressure <= 1820 
        flange_class = "1500"
        pressure_rating = 1820
        temperature_rating = 1000
        elsif  pressure > 1820 and pressure <= 3030 
        flange_class = "2500"
        pressure_rating = 3030
        temperature_rating = 1000
        
        end
    elsif temperature > 1000 and temperature <= 1050 
        if pressure > 360 
        flange_class = "300"
        pressure_rating = 360
        temperature_rating = 1050
        elsif  pressure > 360 and pressure <= 480 
        flange_class = "400"
        pressure_rating = 480
        temperature_rating = 1050
        elsif  pressure > 480 and pressure <= 720 
        flange_class = "600"
        pressure_rating = 720
        temperature_rating = 1050
        elsif  pressure > 720 and pressure <= 1080 
        flange_class = "900"
        pressure_rating = 1080
        temperature_rating = 1050
        elsif  pressure > 1080 and pressure <= 1800 
        flange_class = "1500"
        pressure_rating = 1800
        temperature_rating = 1050
        elsif  pressure > 1800 and pressure <= 3000 
        flange_class = "2500"
        pressure_rating = 3000
        temperature_rating = 1050
        
        end
    elsif temperature > 1050 and temperature <= 1100 
        if pressure > 325 
        flange_class = "300"
        pressure_rating = 325
        temperature_rating = 1100
        elsif  pressure > 325 and pressure <= 430 
        flange_class = "400"
        pressure_rating = 430
        temperature_rating = 1100
        elsif  pressure > 430 and pressure <= 645 
        flange_class = "600"
        pressure_rating = 645
        temperature_rating = 1100
        elsif  pressure > 645 and pressure <= 965 
        flange_class = "900"
        pressure_rating = 965
        temperature_rating = 1100
        elsif  pressure > 965 and pressure <= 1610 
        flange_class = "1500"
        pressure_rating = 1610
        temperature_rating = 1100
        elsif  pressure > 1610 and pressure <= 2685 
        flange_class = "2500"
        pressure_rating = 2685
        temperature_rating = 1100
        
        end
    elsif temperature > 1100 and temperature <= 1150 
        if pressure > 275 
        flange_class = "300"
        pressure_rating = 275
        temperature_rating = 1150
        elsif  pressure > 275 and pressure <= 365 
        flange_class = "400"
        pressure_rating = 365
        temperature_rating = 1150
        elsif  pressure > 365 and pressure <= 550 
        flange_class = "600"
        pressure_rating = 550
        temperature_rating = 1150
        elsif  pressure > 550 and pressure <= 825 
        flange_class = "900"
        pressure_rating = 825
        temperature_rating = 1150
        elsif  pressure > 825 and pressure <= 1370 
        flange_class = "1500"
        pressure_rating = 1370
        temperature_rating = 1150
        elsif  pressure > 1370 and pressure <= 2285 
        flange_class = "2500"
        pressure_rating = 2285
        temperature_rating = 1150
        
        end
    elsif temperature > 1150 and temperature <= 1200 
        if pressure > 205 
        flange_class = "300"
        pressure_rating = 205
        temperature_rating = 1200
        elsif  pressure > 205 and pressure <= 275 
        flange_class = "400"
        pressure_rating = 275
        temperature_rating = 1200
        elsif  pressure > 275 and pressure <= 410 
        flange_class = "600"
        pressure_rating = 410
        temperature_rating = 1200
        elsif  pressure > 410 and pressure <= 620 
        flange_class = "900"
        pressure_rating = 620
        temperature_rating = 1200
        elsif  pressure > 620 and pressure <= 1030 
        flange_class = "1500"
        pressure_rating = 1030
        temperature_rating = 1200
        elsif  pressure > 1030 and pressure <= 1715 
        flange_class = "2500"
        pressure_rating = 1715
        temperature_rating = 1200
        
        end
    elsif temperature > 1200 and temperature <= 1250 
        if pressure > 180 
        flange_class = "300"
        pressure_rating = 150
        temperature_rating = 1250
        elsif  pressure > 180 and pressure <= 245 
        flange_class = "400"
        pressure_rating = 245
        temperature_rating = 1250
        elsif  pressure > 245 and pressure <= 365 
        flange_class = "600"
        pressure_rating = 365
        temperature_rating = 1250
        elsif  pressure > 365 and pressure <= 545 
        flange_class = "900"
        pressure_rating = 545
        temperature_rating = 1250
        elsif  pressure > 545 and pressure <= 910 
        flange_class = "1500"
        pressure_rating = 910
        temperature_rating = 1250
        elsif  pressure > 910 and pressure <= 1515 
        flange_class = "2500"
        pressure_rating = 1515
        temperature_rating = 1250
        
        end
    elsif temperature > 1250 and temperature <= 1300 
        if pressure > 140 
        flange_class = "300"
        pressure_rating = 140
        temperature_rating = 1300
        elsif  pressure > 140 and pressure <= 185 
        flange_class = "400"
        pressure_rating = 185
        temperature_rating = 1300
        elsif  pressure > 185 and pressure <= 275 
        flange_class = "600"
        pressure_rating = 275
        temperature_rating = 1300
        elsif  pressure > 275 and pressure <= 410 
        flange_class = "900"
        pressure_rating = 410
        temperature_rating = 1300
        elsif  pressure > 410 and pressure <= 685 
        flange_class = "1500"
        pressure_rating = 685
        temperature_rating = 1300
        elsif  pressure > 685 and pressure <= 1145 
        flange_class = "2500"
        pressure_rating = 1145
        temperature_rating = 1300
        
        end
    elsif temperature > 1300 and temperature <= 1350 
        if pressure > 105 
        flange_class = "300"
        pressure_rating = 105
        temperature_rating = 1350
        elsif  pressure > 105 and pressure <= 140 
        flange_class = "400"
        pressure_rating = 140
        temperature_rating = 1350
        elsif  pressure > 140 and pressure <= 205 
        flange_class = "600"
        pressure_rating = 205
        temperature_rating = 1350
        elsif  pressure > 205 and pressure <= 310 
        flange_class = "900"
        pressure_rating = 310
        temperature_rating = 1350
        elsif  pressure > 310 and pressure <= 515 
        flange_class = "1500"
        pressure_rating = 515
        temperature_rating = 1350
        elsif  pressure > 515 and pressure <= 860 
        flange_class = "2500"
        pressure_rating = 860
        temperature_rating = 1350
        
        end
    elsif temperature > 1350 and temperature <= 1400 
        if pressure > 75 
        flange_class = "300"
        pressure_rating = 75
        temperature_rating = 1400
        elsif  pressure > 75 and pressure <= 100 
        flange_class = "400"
        pressure_rating = 100
        temperature_rating = 1400
        elsif  pressure > 100 and pressure <= 150 
        flange_class = "600"
        pressure_rating = 150
        temperature_rating = 1400
        elsif  pressure > 150 and pressure <= 225 
        flange_class = "900"
        pressure_rating = 225
        temperature_rating = 1400
        elsif  pressure > 225 and pressure <= 380 
        flange_class = "1500"
        pressure_rating = 380
        temperature_rating = 1150
        elsif  pressure > 380 and pressure <= 630 
        flange_class = "2500"
        pressure_rating = 630
        temperature_rating = 1400
        
        end
    elsif temperature > 1400 and temperature <= 1450 
        if pressure > 60 
        flange_class = "300"
        pressure_rating = 60
        temperature_rating = 1450
        elsif  pressure > 60 and pressure <= 80 
        flange_class = "400"
        pressure_rating = 80
        temperature_rating = 1450
        elsif  pressure > 80 and pressure <= 115 
        flange_class = "600"
        pressure_rating = 115
        temperature_rating = 1450
        elsif  pressure > 115 and pressure <= 175 
        flange_class = "900"
        pressure_rating = 175
        temperature_rating = 1450
        elsif  pressure > 175 and pressure <= 290 
        flange_class = "1500"
        pressure_rating = 290
        temperature_rating = 1450
        elsif  pressure > 290 and pressure <= 485 
        flange_class = "2500"
        pressure_rating = 485
        temperature_rating = 1450
        
        end
    elsif temperature > 1450 and temperature <= 1500 
        if pressure > 40 
        flange_class = "300"
        pressure_rating = 40
        temperature_rating = 1500
        elsif  pressure > 40 and pressure <= 55 
        flange_class = "400"
        pressure_rating = 55
        temperature_rating = 1500
        elsif  pressure > 55 and pressure <= 85 
        flange_class = "600"
        pressure_rating = 85
        temperature_rating = 1500
        elsif  pressure > 85 and pressure <= 125 
        flange_class = "900"
        pressure_rating = 125
        temperature_rating = 1500
        elsif  pressure > 125 and pressure <= 205 
        flange_class = "1500"
        pressure_rating = 205
        temperature_rating = 1500
        elsif  pressure > 205 and pressure <= 345 
        flange_class = "2500"
        pressure_rating = 345
        temperature_rating = 1500
        
        end
    
    end
    
    if Worksheets("UOM").chkCustomary.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) Not to be used over 1000\B0F." & Chr(13) _
    & "(2) For temperatures over 1000\B0F use only if the material is heat treated by heating to a minimum temperature of 2000\B0F."
    elsif orksheets("UOM").chkSI.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) Not to be used over 538\B0C." & Chr(13) _
    & "(2) For temperatures over 538\B0C use only if the material is heat treated by heating to a minimum temperature of 1095\B0C."
    
    end
    
elsif material_group = "2.6" 
UserFormLineSegmentDesign.cmbMaterialDesignation.RowSource = "MaterialGroup2.6"
    if temperature >= -20 and temperature <= 100 
        if pressure <= 275 
        flange_class = "150"
        pressure_rating = 275
        temperature_rating = 100
        elsif  pressure > 275 and pressure <= 720 
        flange_class = "300"
        pressure_rating = 720
        temperature_rating = 100
        elsif  pressure > 720 and pressure <= 960 
        flange_class = "400"
        pressure_rating = 960
        temperature_rating = 100
        elsif  pressure > 960 and pressure <= 1440 
        flange_class = "600"
        pressure_rating = 1440
        temperature_rating = 100
        elsif  pressure > 1440 and pressure <= 2160 
        flange_class = "900"
        pressure_rating = 2160
        temperature_rating = 100
        elsif  pressure > 2160 and pressure <= 3600 
        flange_class = "1500"
        pressure_rating = 3600
        temperature_rating = 100
        elsif  pressure > 3600 and pressure <= 6000 
        flange_class = "2500"
        pressure_rating = 6000
        temperature_rating = 100
        
        end
    elsif temperature > 100 and temperature <= 200 
        if pressure <= 240 
        flange_class = "150"
        pressure_rating = 240
        temperature_rating = 200
        elsif  pressure > 240 and pressure <= 630 
        flange_class = "300"
        pressure_rating = 630
        temperature_rating = 200
        elsif  pressure > 630 and pressure <= 840 
        flange_class = "400"
        pressure_rating = 840
        temperature_rating = 200
        elsif  pressure > 840 and pressure <= 1260 
        flange_class = "600"
        pressure_rating = 1260
        temperature_rating = 200
        elsif  pressure > 1260 and pressure <= 1895 
        flange_class = "900"
        pressure_rating = 1895
        temperature_rating = 200
        elsif  pressure > 1895 and pressure <= 3155 
        flange_class = "1500"
        pressure_rating = 3155
        temperature_rating = 200
        elsif  pressure > 3155 and pressure <= 5260 
        flange_class = "2500"
        pressure_rating = 5260
        temperature_rating = 200
        
        end
    elsif temperature > 200 and temperature <= 300 
        if pressure <= 225 
        flange_class = "150"
        pressure_rating = 225
        temperature_rating = 300
        elsif  pressure > 225 and pressure <= 580 
        flange_class = "300"
        pressure_rating = 580
        temperature_rating = 300
        elsif  pressure > 580 and pressure <= 775 
        flange_class = "400"
        pressure_rating = 775
        temperature_rating = 300
        elsif  pressure > 775 and pressure <= 1160 
        flange_class = "600"
        pressure_rating = 1160
        temperature_rating = 300
        elsif  pressure > 1160 and pressure <= 1740 
        flange_class = "900"
        pressure_rating = 1740
        temperature_rating = 300
        elsif  pressure > 1740 and pressure <= 2905 
        flange_class = "1500"
        pressure_rating = 2905
        temperature_rating = 300
        elsif  pressure > 2905 and pressure <= 4840 
        flange_class = "2500"
        pressure_rating = 4840
        temperature_rating = 300
        
        end
    elsif temperature > 300 and temperature <= 400 
        if pressure <= 200 
        flange_class = "150"
        pressure_rating = 200
        temperature_rating = 400
        elsif  pressure > 200 and pressure <= 545 
        flange_class = "300"
        pressure_rating = 545
        temperature_rating = 400
        elsif  pressure > 545 and pressure <= 725 
        flange_class = "400"
        pressure_rating = 725
        temperature_rating = 400
        elsif  pressure > 725 and pressure <= 1090 
        flange_class = "600"
        pressure_rating = 1090
        temperature_rating = 400
        elsif  pressure > 1090 and pressure <= 1635 
        flange_class = "900"
        pressure_rating = 1635
        temperature_rating = 400
        elsif  pressure > 1635 and pressure <= 2725 
        flange_class = "1500"
        pressure_rating = 2725
        temperature_rating = 400
        elsif  pressure > 2725 and pressure <= 4540 
        flange_class = "2500"
        pressure_rating = 4540
        temperature_rating = 400
        
        end
    elsif temperature > 400 and temperature <= 500 
        if pressure <= 170 
        flange_class = "150"
        pressure_rating = 170
        temperature_rating = 500
        elsif  pressure > 170 and pressure <= 520 
        flange_class = "300"
        pressure_rating = 520
        temperature_rating = 500
        elsif  pressure > 520 and pressure <= 690 
        flange_class = "400"
        pressure_rating = 690
        temperature_rating = 500
        elsif  pressure > 690 and pressure <= 1035 
        flange_class = "600"
        pressure_rating = 1035
        temperature_rating = 500
        elsif  pressure > 1035 and pressure <= 1555 
        flange_class = "900"
        pressure_rating = 1555
        temperature_rating = 500
        elsif  pressure > 1555 and pressure <= 2590 
        flange_class = "1500"
        pressure_rating = 2590
        temperature_rating = 500
        elsif  pressure > 2590 and pressure <= 4320 
        flange_class = "2500"
        pressure_rating = 4320
        temperature_rating = 500
        
        end
    elsif temperature > 500 and temperature <= 600 
        if pressure <= 140 
        flange_class = "150"
        pressure_rating = 140
        temperature_rating = 600
        elsif  pressure > 140 and pressure <= 500 
        flange_class = "300"
        pressure_rating = 500
        temperature_rating = 600
        elsif  pressure > 500 and pressure <= 665 
        flange_class = "400"
        pressure_rating = 665
        temperature_rating = 600
        elsif  pressure > 665 and pressure <= 1000 
        flange_class = "600"
        pressure_rating = 1000
        temperature_rating = 600
        elsif  pressure > 1000 and pressure <= 1500 
        flange_class = "900"
        pressure_rating = 1500
        temperature_rating = 600
        elsif  pressure > 1500 and pressure <= 2495 
        flange_class = "1500"
        pressure_rating = 2495
        temperature_rating = 600
        elsif  pressure > 2495 and pressure <= 4160 
        flange_class = "2500"
        pressure_rating = 4160
        temperature_rating = 600
        
        end
    elsif temperature > 600 and temperature <= 650 
        if pressure <= 125 
        flange_class = "150"
        pressure_rating = 125
        temperature_rating = 650
        elsif  pressure > 125 and pressure <= 490 
        flange_class = "300"
        pressure_rating = 490
        temperature_rating = 650
        elsif  pressure > 490 and pressure <= 655 
        flange_class = "400"
        pressure_rating = 655
        temperature_rating = 650
        elsif  pressure > 655 and pressure <= 985 
        flange_class = "600"
        pressure_rating = 985
        temperature_rating = 650
        elsif  pressure > 985 and pressure <= 1475 
        flange_class = "900"
        pressure_rating = 1475
        temperature_rating = 650
        elsif  pressure > 1475 and pressure <= 2460 
        flange_class = "1500"
        pressure_rating = 2460
        temperature_rating = 650
        elsif  pressure > 2460 and pressure <= 4100 
        flange_class = "2500"
        pressure_rating = 4100
        temperature_rating = 650
        
        end
    elsif temperature > 650 and temperature <= 700 
        if pressure <= 110 
        flange_class = "150"
        pressure_rating = 110
        temperature_rating = 700
        elsif  pressure > 110 and pressure <= 485 
        flange_class = "300"
        pressure_rating = 485
        temperature_rating = 700
        elsif  pressure > 485 and pressure <= 645 
        flange_class = "400"
        pressure_rating = 645
        temperature_rating = 700
        elsif  pressure > 645 and pressure <= 970 
        flange_class = "600"
        pressure_rating = 970
        temperature_rating = 700
        elsif  pressure > 970 and pressure <= 1455 
        flange_class = "900"
        pressure_rating = 1455
        temperature_rating = 700
        elsif  pressure > 1455 and pressure <= 2425 
        flange_class = "1500"
        pressure_rating = 2425
        temperature_rating = 700
        elsif  pressure > 2425 and pressure <= 4040 
        flange_class = "2500"
        pressure_rating = 4040
        temperature_rating = 700
        
        end
    elsif temperature > 700 and temperature <= 750 
        if pressure <= 95 
        flange_class = "150"
        pressure_rating = 95
        temperature_rating = 750
        elsif  pressure > 95 and pressure <= 480 
        flange_class = "300"
        pressure_rating = 480
        temperature_rating = 750
        elsif  pressure > 480 and pressure <= 640 
        flange_class = "400"
        pressure_rating = 640
        temperature_rating = 750
        elsif  pressure > 640 and pressure <= 960 
        flange_class = "600"
        pressure_rating = 960
        temperature_rating = 750
        elsif  pressure > 960 and pressure <= 1440 
        flange_class = "900"
        pressure_rating = 1440
        temperature_rating = 750
        elsif  pressure > 1440 and pressure <= 2400 
        flange_class = "1500"
        pressure_rating = 2400
        temperature_rating = 750
        elsif  pressure > 2400 and pressure <= 4000 
        flange_class = "2500"
        pressure_rating = 4000
        temperature_rating = 750
        
        end
    elsif temperature > 750 and temperature <= 800 
        if pressure <= 80 
        flange_class = "150"
        pressure_rating = 80
        temperature_rating = 800
        elsif  pressure > 80 and pressure <= 475 
        flange_class = "300"
        pressure_rating = 475
        temperature_rating = 800
        elsif  pressure > 475 and pressure <= 630 
        flange_class = "400"
        pressure_rating = 630
        temperature_rating = 800
        elsif  pressure > 630 and pressure <= 945 
        flange_class = "600"
        pressure_rating = 945
        temperature_rating = 800
        elsif  pressure > 945 and pressure <= 1420 
        flange_class = "900"
        pressure_rating = 1420
        temperature_rating = 800
        elsif  pressure > 1420 and pressure <= 2365 
        flange_class = "1500"
        pressure_rating = 2365
        temperature_rating = 800
        elsif  pressure > 2365 and pressure <= 3940 
        flange_class = "2500"
        pressure_rating = 3940
        temperature_rating = 800
        
        end
    elsif temperature > 800 and temperature <= 850 
        if pressure <= 65 
        flange_class = "150"
        pressure_rating = 65
        temperature_rating = 850
        elsif  pressure > 65 and pressure <= 465 
        flange_class = "300"
        pressure_rating = 465
        temperature_rating = 850
        elsif  pressure > 465 and pressure <= 620 
        flange_class = "400"
        pressure_rating = 620
        temperature_rating = 850
        elsif  pressure > 620 and pressure <= 930 
        flange_class = "600"
        pressure_rating = 930
        temperature_rating = 850
        elsif  pressure > 930 and pressure <= 1395 
        flange_class = "900"
        pressure_rating = 1395
        temperature_rating = 850
        elsif  pressure > 1395 and pressure <= 2330 
        flange_class = "1500"
        pressure_rating = 2330
        temperature_rating = 850
        elsif  pressure > 2330 and pressure <= 3880 
        flange_class = "2500"
        pressure_rating = 3880
        temperature_rating = 850
        
        end
    elsif temperature > 850 and temperature <= 900 
        if pressure <= 50 
        flange_class = "150"
        pressure_rating = 50
        temperature_rating = 900
        elsif  pressure > 50 and pressure <= 450 
        flange_class = "300"
        pressure_rating = 450
        temperature_rating = 900
        elsif  pressure > 450 and pressure <= 600 
        flange_class = "400"
        pressure_rating = 600
        temperature_rating = 900
        elsif  pressure > 600 and pressure <= 900 
        flange_class = "600"
        pressure_rating = 900
        temperature_rating = 900
        elsif  pressure > 900 and pressure <= 1350 
        flange_class = "900"
        pressure_rating = 1350
        temperature_rating = 900
        elsif  pressure > 1350 and pressure <= 2245 
        flange_class = "1500"
        pressure_rating = 2245
        temperature_rating = 900
        elsif  pressure > 2245 and pressure <= 3745 
        flange_class = "2500"
        pressure_rating = 3745
        temperature_rating = 900
        
        end
    elsif temperature > 900 and temperature <= 950 
        if pressure <= 35 
        flange_class = "150"
        pressure_rating = 35
        temperature_rating = 950
        elsif  pressure > 35 and pressure <= 385 
        flange_class = "300"
        pressure_rating = 385
        temperature_rating = 950
        elsif  pressure > 385 and pressure <= 515 
        flange_class = "400"
        pressure_rating = 515
        temperature_rating = 950
        elsif  pressure > 515 and pressure <= 775 
        flange_class = "600"
        pressure_rating = 775
        temperature_rating = 950
        elsif  pressure > 775 and pressure <= 1160 
        flange_class = "900"
        pressure_rating = 1160
        temperature_rating = 950
        elsif  pressure > 1160 and pressure <= 1930 
        flange_class = "1500"
        pressure_rating = 1930
        temperature_rating = 950
        elsif  pressure > 1930 and pressure <= 3220 
        flange_class = "2500"
        pressure_rating = 3220
        temperature_rating = 950
        
        end
    elsif temperature > 950 and temperature <= 1000 
        if pressure <= 20 
        flange_class = "150"
        pressure_rating = 20
        temperature_rating = 1000
        elsif  pressure > 20 and pressure <= 365 
        flange_class = "300"
        pressure_rating = 365
        temperature_rating = 1000
        elsif  pressure > 365 and pressure <= 485 
        flange_class = "400"
        pressure_rating = 485
        temperature_rating = 1000
        elsif  pressure > 485 and pressure <= 725 
        flange_class = "600"
        pressure_rating = 725
        temperature_rating = 1000
        elsif  pressure > 725 and pressure <= 1090 
        flange_class = "900"
        pressure_rating = 1090
        temperature_rating = 1000
        elsif  pressure > 1090 and pressure <= 1820 
        flange_class = "1500"
        pressure_rating = 1820
        temperature_rating = 1000
        elsif  pressure > 1820 and pressure <= 3030 
        flange_class = "2500"
        pressure_rating = 3030
        temperature_rating = 1000
        
        end
    elsif temperature > 1000 and temperature <= 1050 
        if pressure > 355 
        flange_class = "300"
        pressure_rating = 355
        temperature_rating = 1050
        elsif  pressure > 355 and pressure <= 470 
        flange_class = "400"
        pressure_rating = 470
        temperature_rating = 1050
        elsif  pressure > 470 and pressure <= 705 
        flange_class = "600"
        pressure_rating = 705
        temperature_rating = 1050
        elsif  pressure > 705 and pressure <= 1060 
        flange_class = "900"
        pressure_rating = 1060
        temperature_rating = 1050
        elsif  pressure > 1060 and pressure <= 1765 
        flange_class = "1500"
        pressure_rating = 1765
        temperature_rating = 1050
        elsif  pressure > 1765 and pressure <= 2945 
        flange_class = "2500"
        pressure_rating = 2945
        temperature_rating = 1050
        
        end
    elsif temperature > 1050 and temperature <= 1100 
        if pressure > 260 
        flange_class = "300"
        pressure_rating = 260
        temperature_rating = 1100
        elsif  pressure > 260 and pressure <= 345 
        flange_class = "400"
        pressure_rating = 345
        temperature_rating = 1100
        elsif  pressure > 345 and pressure <= 520 
        flange_class = "600"
        pressure_rating = 520
        temperature_rating = 1100
        elsif  pressure > 520 and pressure <= 780 
        flange_class = "900"
        pressure_rating = 780
        temperature_rating = 1100
        elsif  pressure > 780 and pressure <= 1305 
        flange_class = "1500"
        pressure_rating = 1305
        temperature_rating = 1100
        elsif  pressure > 1305 and pressure <= 2170 
        flange_class = "2500"
        pressure_rating = 2170
        temperature_rating = 1100
        
        end
    elsif temperature > 1100 and temperature <= 1150 
        if pressure > 190 
        flange_class = "300"
        pressure_rating = 190
        temperature_rating = 1150
        elsif  pressure > 190 and pressure <= 250 
        flange_class = "400"
        pressure_rating = 250
        temperature_rating = 1150
        elsif  pressure > 250 and pressure <= 375 
        flange_class = "600"
        pressure_rating = 375
        temperature_rating = 1150
        elsif  pressure > 375 and pressure <= 565 
        flange_class = "900"
        pressure_rating = 565
        temperature_rating = 1150
        elsif  pressure > 565 and pressure <= 945 
        flange_class = "1500"
        pressure_rating = 945
        temperature_rating = 1150
        elsif  pressure > 945 and pressure <= 1570 
        flange_class = "2500"
        pressure_rating = 1570
        temperature_rating = 1150
        
        end
    elsif temperature > 1150 and temperature <= 1200 
        if pressure > 135 
        flange_class = "300"
        pressure_rating = 135
        temperature_rating = 1200
        elsif  pressure > 135 and pressure <= 185 
        flange_class = "400"
        pressure_rating = 185
        temperature_rating = 1200
        elsif  pressure > 185 and pressure <= 275 
        flange_class = "600"
        pressure_rating = 275
        temperature_rating = 1200
        elsif  pressure > 275 and pressure <= 410 
        flange_class = "900"
        pressure_rating = 410
        temperature_rating = 1200
        elsif  pressure > 410 and pressure <= 685 
        flange_class = "1500"
        pressure_rating = 685
        temperature_rating = 1200
        elsif  pressure > 685 and pressure <= 1145 
        flange_class = "2500"
        pressure_rating = 1145
        temperature_rating = 1200
        
        end
    elsif temperature > 1200 and temperature <= 1250 
        if pressure > 105 
        flange_class = "300"
        pressure_rating = 105
        temperature_rating = 1250
        elsif  pressure > 105 and pressure <= 135 
        flange_class = "400"
        pressure_rating = 135
        temperature_rating = 1250
        elsif  pressure > 135 and pressure <= 205 
        flange_class = "600"
        pressure_rating = 205
        temperature_rating = 1250
        elsif  pressure > 205 and pressure <= 310 
        flange_class = "900"
        pressure_rating = 310
        temperature_rating = 1250
        elsif  pressure > 310 and pressure <= 515 
        flange_class = "1500"
        pressure_rating = 515
        temperature_rating = 1250
        elsif  pressure > 515 and pressure <= 855 
        flange_class = "2500"
        pressure_rating = 855
        temperature_rating = 1250
        
        end
    elsif temperature > 1250 and temperature <= 1300 
        if pressure > 75 
        flange_class = "300"
        pressure_rating = 75
        temperature_rating = 1300
        elsif  pressure > 75 and pressure <= 100 
        flange_class = "400"
        pressure_rating = 100
        temperature_rating = 1300
        elsif  pressure > 100 and pressure <= 150 
        flange_class = "600"
        pressure_rating = 150
        temperature_rating = 1300
        elsif  pressure > 150 and pressure <= 225 
        flange_class = "900"
        pressure_rating = 225
        temperature_rating = 1300
        elsif  pressure > 225 and pressure <= 375 
        flange_class = "1500"
        pressure_rating = 375
        temperature_rating = 1300
        elsif  pressure > 375 and pressure <= 630 
        flange_class = "2500"
        pressure_rating = 630
        temperature_rating = 1300
        
        end
    elsif temperature > 1300 and temperature <= 1350 
        if pressure > 60 
        flange_class = "300"
        pressure_rating = 60
        temperature_rating = 1350
        elsif  pressure > 60 and pressure <= 80 
        flange_class = "400"
        pressure_rating = 80
        temperature_rating = 1350
        elsif  pressure > 80 and pressure <= 115 
        flange_class = "600"
        pressure_rating = 115
        temperature_rating = 1350
        elsif  pressure > 115 and pressure <= 175 
        flange_class = "900"
        pressure_rating = 175
        temperature_rating = 1350
        elsif  pressure > 175 and pressure <= 290 
        flange_class = "1500"
        pressure_rating = 290
        temperature_rating = 1350
        elsif  pressure > 290 and pressure <= 485 
        flange_class = "2500"
        pressure_rating = 485
        temperature_rating = 1350
        
        end
    elsif temperature > 1350 and temperature <= 1400 
        if pressure > 45 
        flange_class = "300"
        pressure_rating = 45
        temperature_rating = 1400
        elsif  pressure > 45 and pressure <= 60 
        flange_class = "400"
        pressure_rating = 60
        temperature_rating = 1400
        elsif  pressure > 60 and pressure <= 90 
        flange_class = "600"
        pressure_rating = 90
        temperature_rating = 1400
        elsif  pressure > 90 and pressure <= 135 
        flange_class = "900"
        pressure_rating = 135
        temperature_rating = 1400
        elsif  pressure > 135 and pressure <= 225 
        flange_class = "1500"
        pressure_rating = 225
        temperature_rating = 1150
        elsif  pressure > 225 and pressure <= 370 
        flange_class = "2500"
        pressure_rating = 370
        temperature_rating = 1400
        
        end
    elsif temperature > 1400 and temperature <= 1450 
        if pressure > 35 
        flange_class = "300"
        pressure_rating = 35
        temperature_rating = 1450
        elsif  pressure > 35 and pressure <= 45 
        flange_class = "400"
        pressure_rating = 45
        temperature_rating = 1450
        elsif  pressure > 45 and pressure <= 70 
        flange_class = "600"
        pressure_rating = 70
        temperature_rating = 1450
        elsif  pressure > 70 and pressure <= 105 
        flange_class = "900"
        pressure_rating = 105
        temperature_rating = 1450
        elsif  pressure > 105 and pressure <= 170 
        flange_class = "1500"
        pressure_rating = 170
        temperature_rating = 1450
        elsif  pressure > 170 and pressure <= 285 
        flange_class = "2500"
        pressure_rating = 285
        temperature_rating = 1450
        
        end
    elsif temperature > 1450 and temperature <= 1500 
        if pressure > 25 
        flange_class = "300"
        pressure_rating = 25
        temperature_rating = 1500
        elsif  pressure > 25 and pressure <= 35 
        flange_class = "400"
        pressure_rating = 35
        temperature_rating = 1500
        elsif  pressure > 35 and pressure <= 50 
        flange_class = "600"
        pressure_rating = 50
        temperature_rating = 1500
        elsif  pressure > 50 and pressure <= 75 
        flange_class = "900"
        pressure_rating = 75
        temperature_rating = 1500
        elsif  pressure > 75 and pressure <= 130 
        flange_class = "1500"
        pressure_rating = 130
        temperature_rating = 1500
        elsif  pressure > 130 and pressure <= 215 
        flange_class = "2500"
        pressure_rating = 215
        temperature_rating = 1500
        
        end
    
    end
    
    if Worksheets("UOM").chkCustomary.Value = True 
    UserFormLineSegmentDesign.lblNotes = ""
    elsif orksheets("UOM").chkSI.Value = True 
    UserFormLineSegmentDesign.lblNotes = ""
    
    end
    
elsif material_group = "2.7" 
UserFormLineSegmentDesign.cmbMaterialDesignation.RowSource = "MaterialGroup2.7"
    if temperature >= -20 and temperature <= 100 
        if pressure <= 275 
        flange_class = "150"
        pressure_rating = 275
        temperature_rating = 100
        elsif  pressure > 275 and pressure <= 720 
        flange_class = "300"
        pressure_rating = 720
        temperature_rating = 100
        elsif  pressure > 720 and pressure <= 960 
        flange_class = "400"
        pressure_rating = 960
        temperature_rating = 100
        elsif  pressure > 960 and pressure <= 1440 
        flange_class = "600"
        pressure_rating = 1440
        temperature_rating = 100
        elsif  pressure > 1440 and pressure <= 2160 
        flange_class = "900"
        pressure_rating = 2160
        temperature_rating = 100
        elsif  pressure > 2160 and pressure <= 3600 
        flange_class = "1500"
        pressure_rating = 3600
        temperature_rating = 100
        elsif  pressure > 3600 and pressure <= 6000 
        flange_class = "2500"
        pressure_rating = 6000
        temperature_rating = 100
        
        end
    elsif temperature > 100 and temperature <= 200 
        if pressure <= 245 
        flange_class = "150"
        pressure_rating = 245
        temperature_rating = 200
        elsif  pressure > 245 and pressure <= 635 
        flange_class = "300"
        pressure_rating = 635
        temperature_rating = 200
        elsif  pressure > 635 and pressure <= 850 
        flange_class = "400"
        pressure_rating = 850
        temperature_rating = 200
        elsif  pressure > 850 and pressure <= 1270 
        flange_class = "600"
        pressure_rating = 1270
        temperature_rating = 200
        elsif  pressure > 1270 and pressure <= 1910 
        flange_class = "900"
        pressure_rating = 1910
        temperature_rating = 200
        elsif  pressure > 1910 and pressure <= 3180 
        flange_class = "1500"
        pressure_rating = 3180
        temperature_rating = 200
        elsif  pressure > 3180 and pressure <= 5300 
        flange_class = "2500"
        pressure_rating = 5300
        temperature_rating = 200
        
        end
    elsif temperature > 200 and temperature <= 300 
        if pressure <= 225 
        flange_class = "150"
        pressure_rating = 225
        temperature_rating = 300
        elsif  pressure > 225 and pressure <= 580 
        flange_class = "300"
        pressure_rating = 580
        temperature_rating = 300
        elsif  pressure > 580 and pressure <= 775 
        flange_class = "400"
        pressure_rating = 775
        temperature_rating = 300
        elsif  pressure > 775 and pressure <= 1160 
        flange_class = "600"
        pressure_rating = 1160
        temperature_rating = 300
        elsif  pressure > 1160 and pressure <= 1740 
        flange_class = "900"
        pressure_rating = 1740
        temperature_rating = 300
        elsif  pressure > 1740 and pressure <= 2905 
        flange_class = "1500"
        pressure_rating = 2905
        temperature_rating = 300
        elsif  pressure > 2905 and pressure <= 4840 
        flange_class = "2500"
        pressure_rating = 4840
        temperature_rating = 300
        
        end
    elsif temperature > 300 and temperature <= 400 
        if pressure <= 200 
        flange_class = "150"
        pressure_rating = 200
        temperature_rating = 400
        elsif  pressure > 200 and pressure <= 540 
        flange_class = "300"
        pressure_rating = 540
        temperature_rating = 400
        elsif  pressure > 540 and pressure <= 725 
        flange_class = "400"
        pressure_rating = 725
        temperature_rating = 400
        elsif  pressure > 725 and pressure <= 1085 
        flange_class = "600"
        pressure_rating = 1085
        temperature_rating = 400
        elsif  pressure > 1085 and pressure <= 1625 
        flange_class = "900"
        pressure_rating = 1625
        temperature_rating = 400
        elsif  pressure > 1625 and pressure <= 2710 
        flange_class = "1500"
        pressure_rating = 2710
        temperature_rating = 400
        elsif  pressure > 2710 and pressure <= 4520 
        flange_class = "2500"
        pressure_rating = 4520
        temperature_rating = 400
        
        end
    elsif temperature > 400 and temperature <= 500 
        if pressure <= 170 
        flange_class = "150"
        pressure_rating = 170
        temperature_rating = 500
        elsif  pressure > 170 and pressure <= 515 
        flange_class = "300"
        pressure_rating = 515
        temperature_rating = 500
        elsif  pressure > 515 and pressure <= 685 
        flange_class = "400"
        pressure_rating = 685
        temperature_rating = 500
        elsif  pressure > 685 and pressure <= 1025 
        flange_class = "600"
        pressure_rating = 1025
        temperature_rating = 500
        elsif  pressure > 1025 and pressure <= 1540 
        flange_class = "900"
        pressure_rating = 1540
        temperature_rating = 500
        elsif  pressure > 1540 and pressure <= 2570 
        flange_class = "1500"
        pressure_rating = 2570
        temperature_rating = 500
        elsif  pressure > 2570 and pressure <= 4280 
        flange_class = "2500"
        pressure_rating = 4280
        temperature_rating = 500
        
        end
    elsif temperature > 500 and temperature <= 600 
        if pressure <= 140 
        flange_class = "150"
        pressure_rating = 140
        temperature_rating = 600
        elsif  pressure > 140 and pressure <= 495 
        flange_class = "300"
        pressure_rating = 495
        temperature_rating = 600
        elsif  pressure > 495 and pressure <= 660 
        flange_class = "400"
        pressure_rating = 660
        temperature_rating = 600
        elsif  pressure > 660 and pressure <= 990 
        flange_class = "600"
        pressure_rating = 990
        temperature_rating = 600
        elsif  pressure > 990 and pressure <= 1485 
        flange_class = "900"
        pressure_rating = 1485
        temperature_rating = 600
        elsif  pressure > 1485 and pressure <= 2470 
        flange_class = "1500"
        pressure_rating = 2470
        temperature_rating = 600
        elsif  pressure > 2470 and pressure <= 4120 
        flange_class = "2500"
        pressure_rating = 4120
        temperature_rating = 600
        
        end
    elsif temperature > 600 and temperature <= 650 
        if pressure <= 125 
        flange_class = "150"
        pressure_rating = 125
        temperature_rating = 650
        elsif  pressure > 125 and pressure <= 485 
        flange_class = "300"
        pressure_rating = 485
        temperature_rating = 650
        elsif  pressure > 485 and pressure <= 645 
        flange_class = "400"
        pressure_rating = 645
        temperature_rating = 650
        elsif  pressure > 645 and pressure <= 970 
        flange_class = "600"
        pressure_rating = 970
        temperature_rating = 650
        elsif  pressure > 970 and pressure <= 1455 
        flange_class = "900"
        pressure_rating = 1455
        temperature_rating = 650
        elsif  pressure > 1455 and pressure <= 2425 
        flange_class = "1500"
        pressure_rating = 2425
        temperature_rating = 650
        elsif  pressure > 2425 and pressure <= 4040 
        flange_class = "2500"
        pressure_rating = 4040
        temperature_rating = 650
        
        end
    elsif temperature > 650 and temperature <= 700 
        if pressure <= 110 
        flange_class = "150"
        pressure_rating = 110
        temperature_rating = 700
        elsif  pressure > 110 and pressure <= 480 
        flange_class = "300"
        pressure_rating = 480
        temperature_rating = 700
        elsif  pressure > 480 and pressure <= 635 
        flange_class = "400"
        pressure_rating = 635
        temperature_rating = 700
        elsif  pressure > 635 and pressure <= 955 
        flange_class = "600"
        pressure_rating = 955
        temperature_rating = 700
        elsif  pressure > 955 and pressure <= 1435 
        flange_class = "900"
        pressure_rating = 1435
        temperature_rating = 700
        elsif  pressure > 1435 and pressure <= 2390 
        flange_class = "1500"
        pressure_rating = 2390
        temperature_rating = 700
        elsif  pressure > 2390 and pressure <= 3980 
        flange_class = "2500"
        pressure_rating = 3980
        temperature_rating = 700
        
        end
    elsif temperature > 700 and temperature <= 750 
        if pressure <= 95 
        flange_class = "150"
        pressure_rating = 95
        temperature_rating = 750
        elsif  pressure > 95 and pressure <= 470 
        flange_class = "300"
        pressure_rating = 470
        temperature_rating = 750
        elsif  pressure > 470 and pressure <= 625 
        flange_class = "400"
        pressure_rating = 625
        temperature_rating = 750
        elsif  pressure > 625 and pressure <= 940 
        flange_class = "600"
        pressure_rating = 940
        temperature_rating = 750
        elsif  pressure > 940 and pressure <= 1410 
        flange_class = "900"
        pressure_rating = 1410
        temperature_rating = 750
        elsif  pressure > 1410 and pressure <= 2350 
        flange_class = "1500"
        pressure_rating = 2350
        temperature_rating = 750
        elsif  pressure > 2350 and pressure <= 3920 
        flange_class = "2500"
        pressure_rating = 3920
        temperature_rating = 750
        
        end
    elsif temperature > 750 and temperature <= 800 
        if pressure <= 80 
        flange_class = "150"
        pressure_rating = 80
        temperature_rating = 800
        elsif  pressure > 80 and pressure <= 465 
        flange_class = "300"
        pressure_rating = 465
        temperature_rating = 800
        elsif  pressure > 465 and pressure <= 620 
        flange_class = "400"
        pressure_rating = 620
        temperature_rating = 800
        elsif  pressure > 620 and pressure <= 930 
        flange_class = "600"
        pressure_rating = 930
        temperature_rating = 800
        elsif  pressure > 930 and pressure <= 1395 
        flange_class = "900"
        pressure_rating = 1395
        temperature_rating = 800
        elsif  pressure > 1395 and pressure <= 2330 
        flange_class = "1500"
        pressure_rating = 2330
        temperature_rating = 800
        elsif  pressure > 2330 and pressure <= 3880 
        flange_class = "2500"
        pressure_rating = 3880
        temperature_rating = 800
        
        end
    elsif temperature > 800 and temperature <= 850 
        if pressure <= 65 
        flange_class = "150"
        pressure_rating = 65
        temperature_rating = 850
        elsif  pressure > 65 and pressure <= 460 
        flange_class = "300"
        pressure_rating = 460
        temperature_rating = 850
        elsif  pressure > 460 and pressure <= 610 
        flange_class = "400"
        pressure_rating = 610
        temperature_rating = 850
        elsif  pressure > 610 and pressure <= 915 
        flange_class = "600"
        pressure_rating = 915
        temperature_rating = 850
        elsif  pressure > 915 and pressure <= 1375 
        flange_class = "900"
        pressure_rating = 1375
        temperature_rating = 850
        elsif  pressure > 1375 and pressure <= 2290 
        flange_class = "1500"
        pressure_rating = 2290
        temperature_rating = 850
        elsif  pressure > 2290 and pressure <= 3820 
        flange_class = "2500"
        pressure_rating = 3820
        temperature_rating = 850
        
        end
    elsif temperature > 850 and temperature <= 900 
        if pressure <= 50 
        flange_class = "150"
        pressure_rating = 50
        temperature_rating = 900
        elsif  pressure > 50 and pressure <= 450 
        flange_class = "300"
        pressure_rating = 450
        temperature_rating = 900
        elsif  pressure > 450 and pressure <= 600 
        flange_class = "400"
        pressure_rating = 600
        temperature_rating = 900
        elsif  pressure > 600 and pressure <= 900 
        flange_class = "600"
        pressure_rating = 900
        temperature_rating = 900
        elsif  pressure > 900 and pressure <= 1350 
        flange_class = "900"
        pressure_rating = 1350
        temperature_rating = 900
        elsif  pressure > 1350 and pressure <= 2245 
        flange_class = "1500"
        pressure_rating = 2245
        temperature_rating = 900
        elsif  pressure > 2245 and pressure <= 3745 
        flange_class = "2500"
        pressure_rating = 3745
        temperature_rating = 900
        
        end
    elsif temperature > 900 and temperature <= 950 
        if pressure <= 35 
        flange_class = "150"
        pressure_rating = 35
        temperature_rating = 950
        elsif  pressure > 35 and pressure <= 385 
        flange_class = "300"
        pressure_rating = 385
        temperature_rating = 950
        elsif  pressure > 385 and pressure <= 515 
        flange_class = "400"
        pressure_rating = 515
        temperature_rating = 950
        elsif  pressure > 515 and pressure <= 775 
        flange_class = "600"
        pressure_rating = 775
        temperature_rating = 950
        elsif  pressure > 775 and pressure <= 1160 
        flange_class = "900"
        pressure_rating = 1160
        temperature_rating = 950
        elsif  pressure > 1160 and pressure <= 1930 
        flange_class = "1500"
        pressure_rating = 1930
        temperature_rating = 950
        elsif  pressure > 1930 and pressure <= 3220 
        flange_class = "2500"
        pressure_rating = 3220
        temperature_rating = 950
        
        end
    elsif temperature > 950 and temperature <= 1000 
        if pressure <= 20 
        flange_class = "150"
        pressure_rating = 20
        temperature_rating = 1000
        elsif  pressure > 20 and pressure <= 365 
        flange_class = "300"
        pressure_rating = 365
        temperature_rating = 1000
        elsif  pressure > 365 and pressure <= 485 
        flange_class = "400"
        pressure_rating = 485
        temperature_rating = 1000
        elsif  pressure > 485 and pressure <= 725 
        flange_class = "600"
        pressure_rating = 725
        temperature_rating = 1000
        elsif  pressure > 725 and pressure <= 1090 
        flange_class = "900"
        pressure_rating = 1090
        temperature_rating = 1000
        elsif  pressure > 1090 and pressure <= 1820 
        flange_class = "1500"
        pressure_rating = 1820
        temperature_rating = 1000
        elsif  pressure > 1820 and pressure <= 3030 
        flange_class = "2500"
        pressure_rating = 3030
        temperature_rating = 1000
        
        end
    elsif temperature > 1000 and temperature <= 1050 
        if pressure > 355 
        flange_class = "300"
        pressure_rating = 355
        temperature_rating = 1050
        elsif  pressure > 355 and pressure <= 470 
        flange_class = "400"
        pressure_rating = 470
        temperature_rating = 1050
        elsif  pressure > 470 and pressure <= 705 
        flange_class = "600"
        pressure_rating = 705
        temperature_rating = 1050
        elsif  pressure > 705 and pressure <= 1060 
        flange_class = "900"
        pressure_rating = 1060
        temperature_rating = 1050
        elsif  pressure > 1060 and pressure <= 1765 
        flange_class = "1500"
        pressure_rating = 1765
        temperature_rating = 1050
        elsif  pressure > 1765 and pressure <= 2945 
        flange_class = "2500"
        pressure_rating = 2945
        temperature_rating = 1050
        
        end
    elsif temperature > 1050 and temperature <= 1100 
        if pressure > 260 
        flange_class = "300"
        pressure_rating = 260
        temperature_rating = 1100
        elsif  pressure > 260 and pressure <= 345 
        flange_class = "400"
        pressure_rating = 345
        temperature_rating = 1100
        elsif  pressure > 345 and pressure <= 520 
        flange_class = "600"
        pressure_rating = 520
        temperature_rating = 1100
        elsif  pressure > 520 and pressure <= 780 
        flange_class = "900"
        pressure_rating = 780
        temperature_rating = 1100
        elsif  pressure > 780 and pressure <= 1305 
        flange_class = "1500"
        pressure_rating = 1305
        temperature_rating = 1100
        elsif  pressure > 1305 and pressure <= 2170 
        flange_class = "2500"
        pressure_rating = 2170
        temperature_rating = 1100
        
        end
    elsif temperature > 1100 and temperature <= 1150 
        if pressure > 190 
        flange_class = "300"
        pressure_rating = 190
        temperature_rating = 1150
        elsif  pressure > 190 and pressure <= 250 
        flange_class = "400"
        pressure_rating = 250
        temperature_rating = 1150
        elsif  pressure > 250 and pressure <= 375 
        flange_class = "600"
        pressure_rating = 375
        temperature_rating = 1150
        elsif  pressure > 375 and pressure <= 565 
        flange_class = "900"
        pressure_rating = 565
        temperature_rating = 1150
        elsif  pressure > 565 and pressure <= 945 
        flange_class = "1500"
        pressure_rating = 945
        temperature_rating = 1150
        elsif  pressure > 945 and pressure <= 1570 
        flange_class = "2500"
        pressure_rating = 1570
        temperature_rating = 1150
        
        end
    elsif temperature > 1150 and temperature <= 1200 
        if pressure > 135 
        flange_class = "300"
        pressure_rating = 135
        temperature_rating = 1200
        elsif  pressure > 135 and pressure <= 185 
        flange_class = "400"
        pressure_rating = 185
        temperature_rating = 1200
        elsif  pressure > 185 and pressure <= 275 
        flange_class = "600"
        pressure_rating = 275
        temperature_rating = 1200
        elsif  pressure > 275 and pressure <= 410 
        flange_class = "900"
        pressure_rating = 410
        temperature_rating = 1200
        elsif  pressure > 410 and pressure <= 685 
        flange_class = "1500"
        pressure_rating = 685
        temperature_rating = 1200
        elsif  pressure > 685 and pressure <= 1145 
        flange_class = "2500"
        pressure_rating = 1145
        temperature_rating = 1200
        
        end
    elsif temperature > 1200 and temperature <= 1250 
        if pressure > 105 
        flange_class = "300"
        pressure_rating = 105
        temperature_rating = 1250
        elsif  pressure > 105 and pressure <= 135 
        flange_class = "400"
        pressure_rating = 135
        temperature_rating = 1250
        elsif  pressure > 135 and pressure <= 205 
        flange_class = "600"
        pressure_rating = 205
        temperature_rating = 1250
        elsif  pressure > 205 and pressure <= 310 
        flange_class = "900"
        pressure_rating = 310
        temperature_rating = 1250
        elsif  pressure > 310 and pressure <= 515 
        flange_class = "1500"
        pressure_rating = 515
        temperature_rating = 1250
        elsif  pressure > 515 and pressure <= 855 
        flange_class = "2500"
        pressure_rating = 855
        temperature_rating = 1250
        
        end
    elsif temperature > 1250 and temperature <= 1300 
        if pressure > 75 
        flange_class = "300"
        pressure_rating = 75
        temperature_rating = 1300
        elsif  pressure > 75 and pressure <= 100 
        flange_class = "400"
        pressure_rating = 100
        temperature_rating = 1300
        elsif  pressure > 100 and pressure <= 150 
        flange_class = "600"
        pressure_rating = 150
        temperature_rating = 1300
        elsif  pressure > 150 and pressure <= 225 
        flange_class = "900"
        pressure_rating = 225
        temperature_rating = 1300
        elsif  pressure > 225 and pressure <= 375 
        flange_class = "1500"
        pressure_rating = 375
        temperature_rating = 1300
        elsif  pressure > 375 and pressure <= 630 
        flange_class = "2500"
        pressure_rating = 630
        temperature_rating = 1300
        
        end
    elsif temperature > 1300 and temperature <= 1350 
        if pressure > 60 
        flange_class = "300"
        pressure_rating = 60
        temperature_rating = 1350
        elsif  pressure > 60 and pressure <= 80 
        flange_class = "400"
        pressure_rating = 80
        temperature_rating = 1350
        elsif  pressure > 80 and pressure <= 115 
        flange_class = "600"
        pressure_rating = 115
        temperature_rating = 1350
        elsif  pressure > 115 and pressure <= 175 
        flange_class = "900"
        pressure_rating = 175
        temperature_rating = 1350
        elsif  pressure > 175 and pressure <= 290 
        flange_class = "1500"
        pressure_rating = 290
        temperature_rating = 1350
        elsif  pressure > 290 and pressure <= 485 
        flange_class = "2500"
        pressure_rating = 485
        temperature_rating = 1350
        
        end
    elsif temperature > 1350 and temperature <= 1400 
        if pressure > 45 
        flange_class = "300"
        pressure_rating = 45
        temperature_rating = 1400
        elsif  pressure > 45 and pressure <= 60 
        flange_class = "400"
        pressure_rating = 60
        temperature_rating = 1400
        elsif  pressure > 60 and pressure <= 90 
        flange_class = "600"
        pressure_rating = 90
        temperature_rating = 1400
        elsif  pressure > 90 and pressure <= 135 
        flange_class = "900"
        pressure_rating = 135
        temperature_rating = 1400
        elsif  pressure > 135 and pressure <= 225 
        flange_class = "1500"
        pressure_rating = 225
        temperature_rating = 1150
        elsif  pressure > 225 and pressure <= 370 
        flange_class = "2500"
        pressure_rating = 370
        temperature_rating = 1400
        
        end
    elsif temperature > 1400 and temperature <= 1450 
        if pressure > 35 
        flange_class = "300"
        pressure_rating = 35
        temperature_rating = 1450
        elsif  pressure > 35 and pressure <= 45 
        flange_class = "400"
        pressure_rating = 45
        temperature_rating = 1450
        elsif  pressure > 45 and pressure <= 60 
        flange_class = "600"
        pressure_rating = 60
        temperature_rating = 1450
        elsif  pressure > 60 and pressure <= 100 
        flange_class = "900"
        pressure_rating = 100
        temperature_rating = 1450
        elsif  pressure > 100 and pressure <= 165 
        flange_class = "1500"
        pressure_rating = 165
        temperature_rating = 1450
        elsif  pressure > 165 and pressure <= 275 
        flange_class = "2500"
        pressure_rating = 275
        temperature_rating = 1450
        
        end
    elsif temperature > 1450 and temperature <= 1500 
        if pressure > 25 
        flange_class = "300"
        pressure_rating = 25
        temperature_rating = 1500
        elsif  pressure > 25 and pressure <= 35 
        flange_class = "400"
        pressure_rating = 35
        temperature_rating = 1500
        elsif  pressure > 35 and pressure <= 50 
        flange_class = "600"
        pressure_rating = 50
        temperature_rating = 1500
        elsif  pressure > 50 and pressure <= 75 
        flange_class = "900"
        pressure_rating = 75
        temperature_rating = 1500
        elsif  pressure > 75 and pressure <= 130 
        flange_class = "1500"
        pressure_rating = 130
        temperature_rating = 1500
        elsif  pressure > 130 and pressure <= 215 
        flange_class = "2500"
        pressure_rating = 215
        temperature_rating = 1500
        
        end
    
    end
    
    if Worksheets("UOM").chkCustomary.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) At temperatures over 1000\B0F, use only when the carbon content is 0.04% or higher." & Chr(13) _
    & "(2) Service temperatures of 1050\B0F and above should be used only when assurance is provided that grain size is not finer than ASTM 6."
    elsif orksheets("UOM").chkSI.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) At temperatures over 538\B0C, use only when the carbon content is 0.04% or higher." & Chr(13) _
    & "(2) Service temperatures of 565\B0C and above should be used only when assurance is provided that grain size is not finer than ASTM 6."
    
    end
    
elsif material_group = "2.8" 
UserFormLineSegmentDesign.cmbMaterialDesignation.RowSource = "MaterialGroup2.8"
if temperature >= -20 and temperature <= 100 
        if pressure <= 290 
        flange_class = "150"
        pressure_rating = 290
        temperature_rating = 100
        elsif  pressure > 290 and pressure <= 750 
        flange_class = "300"
        pressure_rating = 750
        temperature_rating = 100
        elsif  pressure > 750 and pressure <= 1000 
        flange_class = "400"
        pressure_rating = 1000
        temperature_rating = 100
        elsif  pressure > 1000 and pressure <= 1500 
        flange_class = "600"
        pressure_rating = 1500
        temperature_rating = 100
        elsif  pressure > 1500 and pressure <= 2250 
        flange_class = "900"
        pressure_rating = 2250
        temperature_rating = 100
        elsif  pressure > 2250 and pressure <= 3750 
        flange_class = "1500"
        pressure_rating = 3750
        temperature_rating = 100
        elsif  pressure > 3750 and pressure <= 6250 
        flange_class = "2500"
        pressure_rating = 6250
        temperature_rating = 100
        
        end
    elsif temperature > 100 and temperature <= 200 
        if pressure <= 260 
        flange_class = "150"
        pressure_rating = 260
        temperature_rating = 200
        elsif  pressure > 260 and pressure <= 745 
        flange_class = "300"
        pressure_rating = 745
        temperature_rating = 200
        elsif  pressure > 745 and pressure <= 990 
        flange_class = "400"
        pressure_rating = 990
        temperature_rating = 200
        elsif  pressure > 990 and pressure <= 1490 
        flange_class = "600"
        pressure_rating = 1490
        temperature_rating = 200
        elsif  pressure > 1490 and pressure <= 2230 
        flange_class = "900"
        pressure_rating = 2230
        temperature_rating = 200
        elsif  pressure > 2230 and pressure <= 3720 
        flange_class = "1500"
        pressure_rating = 3720
        temperature_rating = 200
        elsif  pressure > 3720 and pressure <= 6200 
        flange_class = "2500"
        pressure_rating = 6200
        temperature_rating = 200
        
        end
    elsif temperature > 200 and temperature <= 300 
        if pressure <= 230 
        flange_class = "150"
        pressure_rating = 230
        temperature_rating = 300
        elsif  pressure > 230 and pressure <= 665 
        flange_class = "300"
        pressure_rating = 665
        temperature_rating = 300
        elsif  pressure > 665 and pressure <= 890 
        flange_class = "400"
        pressure_rating = 890
        temperature_rating = 300
        elsif  pressure > 890 and pressure <= 1335 
        flange_class = "600"
        pressure_rating = 1335
        temperature_rating = 300
        elsif  pressure > 1335 and pressure <= 2000 
        flange_class = "900"
        pressure_rating = 2000
        temperature_rating = 300
        elsif  pressure > 2000 and pressure <= 3335 
        flange_class = "1500"
        pressure_rating = 3335
        temperature_rating = 300
        elsif  pressure > 3335 and pressure <= 5560 
        flange_class = "2500"
        pressure_rating = 5560
        temperature_rating = 300
        
        end
    elsif temperature > 300 and temperature <= 400 
        if pressure <= 200 
        flange_class = "150"
        pressure_rating = 200
        temperature_rating = 400
        elsif  pressure > 200 and pressure <= 615 
        flange_class = "300"
        pressure_rating = 615
        temperature_rating = 400
        elsif  pressure > 615 and pressure <= 820 
        flange_class = "400"
        pressure_rating = 820
        temperature_rating = 400
        elsif  pressure > 820 and pressure <= 1230 
        flange_class = "600"
        pressure_rating = 1230
        temperature_rating = 400
        elsif  pressure > 1230 and pressure <= 1845 
        flange_class = "900"
        pressure_rating = 1845
        temperature_rating = 400
        elsif  pressure > 1845 and pressure <= 3070 
        flange_class = "1500"
        pressure_rating = 3070
        temperature_rating = 400
        elsif  pressure > 3070 and pressure <= 5120 
        flange_class = "2500"
        pressure_rating = 5120
        temperature_rating = 400
        
        end
    elsif temperature > 400 and temperature <= 500 
        if pressure <= 170 
        flange_class = "150"
        pressure_rating = 170
        temperature_rating = 500
        elsif  pressure > 170 and pressure <= 580 
        flange_class = "300"
        pressure_rating = 580
        temperature_rating = 500
        elsif  pressure > 580 and pressure <= 775 
        flange_class = "400"
        pressure_rating = 775
        temperature_rating = 500
        elsif  pressure > 775 and pressure <= 1160 
        flange_class = "600"
        pressure_rating = 1160
        temperature_rating = 500
        elsif  pressure > 1160 and pressure <= 1740 
        flange_class = "900"
        pressure_rating = 1740
        temperature_rating = 500
        elsif  pressure > 1740 and pressure <= 2905 
        flange_class = "1500"
        pressure_rating = 2905
        temperature_rating = 500
        elsif  pressure > 2905 and pressure <= 4840 
        flange_class = "2500"
        pressure_rating = 4840
        temperature_rating = 500
        
        end
    elsif temperature > 500 and temperature <= 600 
        if pressure <= 140 
        flange_class = "150"
        pressure_rating = 140
        temperature_rating = 600
        elsif  pressure > 140 and pressure <= 555 
        flange_class = "300"
        pressure_rating = 555
        temperature_rating = 600
        elsif  pressure > 555 and pressure <= 740 
        flange_class = "400"
        pressure_rating = 740
        temperature_rating = 600
        elsif  pressure > 740 and pressure <= 1115 
        flange_class = "600"
        pressure_rating = 1115
        temperature_rating = 600
        elsif  pressure > 1115 and pressure <= 1670 
        flange_class = "900"
        pressure_rating = 1670
        temperature_rating = 600
        elsif  pressure > 1670 and pressure <= 2785 
        flange_class = "1500"
        pressure_rating = 2785
        temperature_rating = 600
        elsif  pressure > 2785 and pressure <= 4640 
        flange_class = "2500"
        pressure_rating = 4640
        temperature_rating = 600
        
        end
    elsif temperature > 600 and temperature <= 650 
        if pressure <= 125 
        flange_class = "150"
        pressure_rating = 125
        temperature_rating = 650
        elsif  pressure > 125 and pressure <= 545 
        flange_class = "300"
        pressure_rating = 545
        temperature_rating = 650
        elsif  pressure > 545 and pressure <= 730 
        flange_class = "400"
        pressure_rating = 730
        temperature_rating = 650
        elsif  pressure > 730 and pressure <= 1095 
        flange_class = "600"
        pressure_rating = 1095
        temperature_rating = 650
        elsif  pressure > 1095 and pressure <= 1640 
        flange_class = "900"
        pressure_rating = 1640
        temperature_rating = 650
        elsif  pressure > 1640 and pressure <= 2735 
        flange_class = "1500"
        pressure_rating = 2735
        temperature_rating = 650
        elsif  pressure > 2735 and pressure <= 4560 
        flange_class = "2500"
        pressure_rating = 4560
        temperature_rating = 650
        
        end
    elsif temperature > 650 and temperature <= 700 
        if pressure <= 110 
        flange_class = "150"
        pressure_rating = 110
        temperature_rating = 700
        elsif  pressure > 110 and pressure <= 540 
        flange_class = "300"
        pressure_rating = 540
        temperature_rating = 700
        elsif  pressure > 540 and pressure <= 725 
        flange_class = "400"
        pressure_rating = 725
        temperature_rating = 700
        elsif  pressure > 725 and pressure <= 1085 
        flange_class = "600"
        pressure_rating = 1085
        temperature_rating = 700
        elsif  pressure > 1085 and pressure <= 1625 
        flange_class = "900"
        pressure_rating = 1625
        temperature_rating = 700
        elsif  pressure > 1625 and pressure <= 2710 
        flange_class = "1500"
        pressure_rating = 2710
        temperature_rating = 700
        elsif  pressure > 2710 and pressure <= 4520 
        flange_class = "2500"
        pressure_rating = 4520
        temperature_rating = 700
        
        end
    elsif temperature > 700 and temperature <= 750 
        if pressure <= 95 
        flange_class = "150"
        pressure_rating = 95
        temperature_rating = 750
        elsif  pressure > 95 and pressure <= 530 
        flange_class = "300"
        pressure_rating = 530
        temperature_rating = 750
        elsif  pressure > 530 and pressure <= 710 
        flange_class = "400"
        pressure_rating = 710
        temperature_rating = 750
        elsif  pressure > 710 and pressure <= 1065 
        flange_class = "600"
        pressure_rating = 1065
        temperature_rating = 750
        elsif  pressure > 1065 and pressure <= 1595 
        flange_class = "900"
        pressure_rating = 1595
        temperature_rating = 750
        elsif  pressure > 1595 and pressure <= 2660 
        flange_class = "1500"
        pressure_rating = 2660
        temperature_rating = 750
        elsif  pressure > 2660 and pressure <= 4430 
        flange_class = "2500"
        pressure_rating = 4430
        temperature_rating = 750
        
        end
    
    end
    
    if Worksheets("UOM").chkCustomary.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) This steel may become brittle after service at moderately elevated temperatures. Not to be used over 600\B0F."
    elsif orksheets("UOM").chkSI.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) This steel may become brittle after service at moderately elevated temperatures. Not to be used over 315\B0C."
    
    end
    
elsif material_group = "2.9" 
UserFormLineSegmentDesign.cmbMaterialDesignation.RowSource = "MaterialGroup2.9"
    if temperature >= -20 and temperature <= 100 
        if pressure <= 275 
        flange_class = "150"
        pressure_rating = 275
        temperature_rating = 100
        elsif  pressure > 275 and pressure <= 720 
        flange_class = "300"
        pressure_rating = 720
        temperature_rating = 100
        elsif  pressure > 720 and pressure <= 960 
        flange_class = "400"
        pressure_rating = 960
        temperature_rating = 100
        elsif  pressure > 960 and pressure <= 1440 
        flange_class = "600"
        pressure_rating = 1440
        temperature_rating = 100
        elsif  pressure > 1440 and pressure <= 2160 
        flange_class = "900"
        pressure_rating = 2160
        temperature_rating = 100
        elsif  pressure > 2160 and pressure <= 3600 
        flange_class = "1500"
        pressure_rating = 3600
        temperature_rating = 100
        elsif  pressure > 3600 and pressure <= 6000 
        flange_class = "2500"
        pressure_rating = 6000
        temperature_rating = 100
        
        end
    elsif temperature > 100 and temperature <= 200 
        if pressure <= 240 
        flange_class = "150"
        pressure_rating = 240
        temperature_rating = 200
        elsif  pressure > 240 and pressure <= 630 
        flange_class = "300"
        pressure_rating = 630
        temperature_rating = 200
        elsif  pressure > 630 and pressure <= 840 
        flange_class = "400"
        pressure_rating = 840
        temperature_rating = 200
        elsif  pressure > 840 and pressure <= 1260 
        flange_class = "600"
        pressure_rating = 1260
        temperature_rating = 200
        elsif  pressure > 1260 and pressure <= 1895 
        flange_class = "900"
        pressure_rating = 1895
        temperature_rating = 200
        elsif  pressure > 1895 and pressure <= 3155 
        flange_class = "1500"
        pressure_rating = 3155
        temperature_rating = 200
        elsif  pressure > 3155 and pressure <= 5260 
        flange_class = "2500"
        pressure_rating = 5260
        temperature_rating = 200
        
        end
    elsif temperature > 200 and temperature <= 300 
        if pressure <= 225 
        flange_class = "150"
        pressure_rating = 225
        temperature_rating = 300
        elsif  pressure > 225 and pressure <= 580 
        flange_class = "300"
        pressure_rating = 580
        temperature_rating = 300
        elsif  pressure > 580 and pressure <= 775 
        flange_class = "400"
        pressure_rating = 775
        temperature_rating = 300
        elsif  pressure > 775 and pressure <= 1160 
        flange_class = "600"
        pressure_rating = 1160
        temperature_rating = 300
        elsif  pressure > 1160 and pressure <= 1740 
        flange_class = "900"
        pressure_rating = 1740
        temperature_rating = 300
        elsif  pressure > 1740 and pressure <= 2905 
        flange_class = "1500"
        pressure_rating = 2905
        temperature_rating = 300
        elsif  pressure > 2905 and pressure <= 4840 
        flange_class = "2500"
        pressure_rating = 4840
        temperature_rating = 300
        
        end
    elsif temperature > 300 and temperature <= 400 
        if pressure <= 200 
        flange_class = "150"
        pressure_rating = 200
        temperature_rating = 400
        elsif  pressure > 200 and pressure <= 540 
        flange_class = "300"
        pressure_rating = 540
        temperature_rating = 400
        elsif  pressure > 540 and pressure <= 725 
        flange_class = "400"
        pressure_rating = 725
        temperature_rating = 400
        elsif  pressure > 725 and pressure <= 1085 
        flange_class = "600"
        pressure_rating = 1085
        temperature_rating = 400
        elsif  pressure > 1085 and pressure <= 1625 
        flange_class = "900"
        pressure_rating = 1625
        temperature_rating = 400
        elsif  pressure > 1625 and pressure <= 2710 
        flange_class = "1500"
        pressure_rating = 2710
        temperature_rating = 400
        elsif  pressure > 2710 and pressure <= 4520 
        flange_class = "2500"
        pressure_rating = 4520
        temperature_rating = 400
        
        end
    elsif temperature > 400 and temperature <= 500 
        if pressure <= 170 
        flange_class = "150"
        pressure_rating = 170
        temperature_rating = 500
        elsif  pressure > 170 and pressure <= 515 
        flange_class = "300"
        pressure_rating = 515
        temperature_rating = 500
        elsif  pressure > 515 and pressure <= 685 
        flange_class = "400"
        pressure_rating = 685
        temperature_rating = 500
        elsif  pressure > 685 and pressure <= 1025 
        flange_class = "600"
        pressure_rating = 1025
        temperature_rating = 500
        elsif  pressure > 1025 and pressure <= 1540 
        flange_class = "900"
        pressure_rating = 1540
        temperature_rating = 500
        elsif  pressure > 1540 and pressure <= 2570 
        flange_class = "1500"
        pressure_rating = 2570
        temperature_rating = 500
        elsif  pressure > 2570 and pressure <= 4280 
        flange_class = "2500"
        pressure_rating = 4280
        temperature_rating = 500
        
        end
    elsif temperature > 500 and temperature <= 600 
        if pressure <= 140 
        flange_class = "150"
        pressure_rating = 140
        temperature_rating = 600
        elsif  pressure > 140 and pressure <= 495 
        flange_class = "300"
        pressure_rating = 495
        temperature_rating = 600
        elsif  pressure > 495 and pressure <= 660 
        flange_class = "400"
        pressure_rating = 660
        temperature_rating = 600
        elsif  pressure > 660 and pressure <= 990 
        flange_class = "600"
        pressure_rating = 990
        temperature_rating = 600
        elsif  pressure > 990 and pressure <= 1485 
        flange_class = "900"
        pressure_rating = 1485
        temperature_rating = 600
        elsif  pressure > 1485 and pressure <= 2470 
        flange_class = "1500"
        pressure_rating = 2470
        temperature_rating = 600
        elsif  pressure > 2470 and pressure <= 4120 
        flange_class = "2500"
        pressure_rating = 4120
        temperature_rating = 600
        
        end
    elsif temperature > 600 and temperature <= 650 
        if pressure <= 125 
        flange_class = "150"
        pressure_rating = 125
        temperature_rating = 650
        elsif  pressure > 125 and pressure <= 485 
        flange_class = "300"
        pressure_rating = 485
        temperature_rating = 650
        elsif  pressure > 485 and pressure <= 645 
        flange_class = "400"
        pressure_rating = 645
        temperature_rating = 650
        elsif  pressure > 645 and pressure <= 970 
        flange_class = "600"
        pressure_rating = 970
        temperature_rating = 650
        elsif  pressure > 970 and pressure <= 1455 
        flange_class = "900"
        pressure_rating = 1455
        temperature_rating = 650
        elsif  pressure > 1455 and pressure <= 2425 
        flange_class = "1500"
        pressure_rating = 2425
        temperature_rating = 650
        elsif  pressure > 2425 and pressure <= 4040 
        flange_class = "2500"
        pressure_rating = 4040
        temperature_rating = 650
        
        end
    elsif temperature > 650 and temperature <= 700 
        if pressure <= 110 
        flange_class = "150"
        pressure_rating = 110
        temperature_rating = 700
        elsif  pressure > 110 and pressure <= 480 
        flange_class = "300"
        pressure_rating = 480
        temperature_rating = 700
        elsif  pressure > 480 and pressure <= 635 
        flange_class = "400"
        pressure_rating = 635
        temperature_rating = 700
        elsif  pressure > 635 and pressure <= 955 
        flange_class = "600"
        pressure_rating = 955
        temperature_rating = 700
        elsif  pressure > 955 and pressure <= 1435 
        flange_class = "900"
        pressure_rating = 1435
        temperature_rating = 700
        elsif  pressure > 1435 and pressure <= 2390 
        flange_class = "1500"
        pressure_rating = 2390
        temperature_rating = 700
        elsif  pressure > 2390 and pressure <= 3980 
        flange_class = "2500"
        pressure_rating = 3980
        temperature_rating = 700
        
        end
    elsif temperature > 700 and temperature <= 750 
        if pressure <= 95 
        flange_class = "150"
        pressure_rating = 95
        temperature_rating = 750
        elsif  pressure > 95 and pressure <= 470 
        flange_class = "300"
        pressure_rating = 470
        temperature_rating = 750
        elsif  pressure > 470 and pressure <= 625 
        flange_class = "400"
        pressure_rating = 625
        temperature_rating = 750
        elsif  pressure > 625 and pressure <= 940 
        flange_class = "600"
        pressure_rating = 940
        temperature_rating = 750
        elsif  pressure > 940 and pressure <= 1410 
        flange_class = "900"
        pressure_rating = 1410
        temperature_rating = 750
        elsif  pressure > 1410 and pressure <= 2350 
        flange_class = "1500"
        pressure_rating = 2350
        temperature_rating = 750
        elsif  pressure > 2350 and pressure <= 3920 
        flange_class = "2500"
        pressure_rating = 3920
        temperature_rating = 750
        
        end
    elsif temperature > 750 and temperature <= 800 
        if pressure <= 80 
        flange_class = "150"
        pressure_rating = 80
        temperature_rating = 800
        elsif  pressure > 80 and pressure <= 465 
        flange_class = "300"
        pressure_rating = 465
        temperature_rating = 800
        elsif  pressure > 465 and pressure <= 620 
        flange_class = "400"
        pressure_rating = 620
        temperature_rating = 800
        elsif  pressure > 620 and pressure <= 930 
        flange_class = "600"
        pressure_rating = 930
        temperature_rating = 800
        elsif  pressure > 930 and pressure <= 1395 
        flange_class = "900"
        pressure_rating = 1395
        temperature_rating = 800
        elsif  pressure > 1395 and pressure <= 2330 
        flange_class = "1500"
        pressure_rating = 2330
        temperature_rating = 800
        elsif  pressure > 2330 and pressure <= 3880 
        flange_class = "2500"
        pressure_rating = 3880
        temperature_rating = 800
        
        end
    elsif temperature > 800 and temperature <= 850 
        if pressure <= 65 
        flange_class = "150"
        pressure_rating = 65
        temperature_rating = 850
        elsif  pressure > 65 and pressure <= 460 
        flange_class = "300"
        pressure_rating = 460
        temperature_rating = 850
        elsif  pressure > 460 and pressure <= 610 
        flange_class = "400"
        pressure_rating = 610
        temperature_rating = 850
        elsif  pressure > 610 and pressure <= 915 
        flange_class = "600"
        pressure_rating = 915
        temperature_rating = 850
        elsif  pressure > 915 and pressure <= 1375 
        flange_class = "900"
        pressure_rating = 1375
        temperature_rating = 850
        elsif  pressure > 1375 and pressure <= 2290 
        flange_class = "1500"
        pressure_rating = 2290
        temperature_rating = 850
        elsif  pressure > 2290 and pressure <= 3820 
        flange_class = "2500"
        pressure_rating = 3820
        temperature_rating = 850
        
        end
    elsif temperature > 850 and temperature <= 900 
        if pressure <= 50 
        flange_class = "150"
        pressure_rating = 50
        temperature_rating = 900
        elsif  pressure > 50 and pressure <= 450 
        flange_class = "300"
        pressure_rating = 450
        temperature_rating = 900
        elsif  pressure > 450 and pressure <= 600 
        flange_class = "400"
        pressure_rating = 600
        temperature_rating = 900
        elsif  pressure > 600 and pressure <= 900 
        flange_class = "600"
        pressure_rating = 900
        temperature_rating = 900
        elsif  pressure > 900 and pressure <= 1350 
        flange_class = "900"
        pressure_rating = 1350
        temperature_rating = 900
        elsif  pressure > 1350 and pressure <= 2245 
        flange_class = "1500"
        pressure_rating = 2245
        temperature_rating = 900
        elsif  pressure > 2245 and pressure <= 3745 
        flange_class = "2500"
        pressure_rating = 3745
        temperature_rating = 900
        
        end
    elsif temperature > 900 and temperature <= 950 
        if pressure <= 35 
        flange_class = "150"
        pressure_rating = 35
        temperature_rating = 950
        elsif  pressure > 35 and pressure <= 385 
        flange_class = "300"
        pressure_rating = 385
        temperature_rating = 950
        elsif  pressure > 385 and pressure <= 515 
        flange_class = "400"
        pressure_rating = 515
        temperature_rating = 950
        elsif  pressure > 515 and pressure <= 775 
        flange_class = "600"
        pressure_rating = 775
        temperature_rating = 950
        elsif  pressure > 775 and pressure <= 1160 
        flange_class = "900"
        pressure_rating = 1160
        temperature_rating = 950
        elsif  pressure > 1160 and pressure <= 1930 
        flange_class = "1500"
        pressure_rating = 1930
        temperature_rating = 950
        elsif  pressure > 1930 and pressure <= 3220 
        flange_class = "2500"
        pressure_rating = 3220
        temperature_rating = 950
        
        end
    elsif temperature > 950 and temperature <= 1000 
        if pressure <= 20 
        flange_class = "150"
        pressure_rating = 20
        temperature_rating = 1000
        elsif  pressure > 20 and pressure <= 340 
        flange_class = "300"
        pressure_rating = 340
        temperature_rating = 1000
        elsif  pressure > 340 and pressure <= 455 
        flange_class = "400"
        pressure_rating = 455
        temperature_rating = 1000
        elsif  pressure > 455 and pressure <= 680 
        flange_class = "600"
        pressure_rating = 680
        temperature_rating = 1000
        elsif  pressure > 680 and pressure <= 1020 
        flange_class = "900"
        pressure_rating = 1020
        temperature_rating = 1000
        elsif  pressure > 1020 and pressure <= 1695 
        flange_class = "1500"
        pressure_rating = 1695
        temperature_rating = 1000
        elsif  pressure > 1695 and pressure <= 2830 
        flange_class = "2500"
        pressure_rating = 2830
        temperature_rating = 1000
        
        end
    elsif temperature > 1000 and temperature <= 1050 
        if pressure > 245 
        flange_class = "300"
        pressure_rating = 245
        temperature_rating = 1050
        elsif  pressure > 245 and pressure <= 325 
        flange_class = "400"
        pressure_rating = 325
        temperature_rating = 1050
        elsif  pressure > 325 and pressure <= 485 
        flange_class = "600"
        pressure_rating = 485
        temperature_rating = 1050
        elsif  pressure > 485 and pressure <= 730 
        flange_class = "900"
        pressure_rating = 730
        temperature_rating = 1050
        elsif  pressure > 730 and pressure <= 1215 
        flange_class = "1500"
        pressure_rating = 1215
        temperature_rating = 1050
        elsif  pressure > 1215 and pressure <= 2030 
        flange_class = "2500"
        pressure_rating = 2030
        temperature_rating = 1050
        
        end
    elsif temperature > 1050 and temperature <= 1100 
        if pressure > 170 
        flange_class = "300"
        pressure_rating = 170
        temperature_rating = 1100
        elsif  pressure > 170 and pressure <= 230 
        flange_class = "400"
        pressure_rating = 230
        temperature_rating = 1100
        elsif  pressure > 230 and pressure <= 345 
        flange_class = "600"
        pressure_rating = 345
        temperature_rating = 1100
        elsif  pressure > 345 and pressure <= 515 
        flange_class = "900"
        pressure_rating = 515
        temperature_rating = 1100
        elsif  pressure > 515 and pressure <= 855 
        flange_class = "1500"
        pressure_rating = 855
        temperature_rating = 1100
        elsif  pressure > 855 and pressure <= 1430 
        flange_class = "2500"
        pressure_rating = 1430
        temperature_rating = 1100
        
        end
    elsif temperature > 1100 and temperature <= 1150 
        if pressure > 125 
        flange_class = "300"
        pressure_rating = 125
        temperature_rating = 1150
        elsif  pressure > 125 and pressure <= 165 
        flange_class = "400"
        pressure_rating = 165
        temperature_rating = 1150
        elsif  pressure > 165 and pressure <= 245 
        flange_class = "600"
        pressure_rating = 245
        temperature_rating = 1150
        elsif  pressure > 245 and pressure <= 370 
        flange_class = "900"
        pressure_rating = 370
        temperature_rating = 1150
        elsif  pressure > 370 and pressure <= 615 
        flange_class = "1500"
        pressure_rating = 615
        temperature_rating = 1150
        elsif  pressure > 615 and pressure <= 1030 
        flange_class = "2500"
        pressure_rating = 1030
        temperature_rating = 1150
        
        end
    elsif temperature > 1150 and temperature <= 1200 
        if pressure > 85 
        flange_class = "300"
        pressure_rating = 85
        temperature_rating = 1200
        elsif  pressure > 85 and pressure <= 115 
        flange_class = "400"
        pressure_rating = 115
        temperature_rating = 1200
        elsif  pressure > 115 and pressure <= 170 
        flange_class = "600"
        pressure_rating = 170
        temperature_rating = 1200
        elsif  pressure > 170 and pressure <= 255 
        flange_class = "900"
        pressure_rating = 255
        temperature_rating = 1200
        elsif  pressure > 255 and pressure <= 430 
        flange_class = "1500"
        pressure_rating = 430
        temperature_rating = 1200
        elsif  pressure > 430 and pressure <= 715 
        flange_class = "2500"
        pressure_rating = 715
        temperature_rating = 1200
        
        end
    elsif temperature > 1200 and temperature <= 1250 
        if pressure > 50 
        flange_class = "300"
        pressure_rating = 50
        temperature_rating = 1250
        elsif  pressure > 50 and pressure <= 70 
        flange_class = "400"
        pressure_rating = 70
        temperature_rating = 1250
        elsif  pressure > 70 and pressure <= 105 
        flange_class = "600"
        pressure_rating = 105
        temperature_rating = 1250
        elsif  pressure > 105 and pressure <= 155 
        flange_class = "900"
        pressure_rating = 155
        temperature_rating = 1250
        elsif  pressure > 155 and pressure <= 255 
        flange_class = "1500"
        pressure_rating = 255
        temperature_rating = 1250
        elsif  pressure > 255 and pressure <= 430 
        flange_class = "2500"
        pressure_rating = 430
        temperature_rating = 1250
        
        end
    elsif temperature > 1250 and temperature <= 1300 
        if pressure > 25 
        flange_class = "300"
        pressure_rating = 25
        temperature_rating = 1300
        elsif  pressure > 25 and pressure <= 35 
        flange_class = "400"
        pressure_rating = 35
        temperature_rating = 1300
        elsif  pressure > 35 and pressure <= 55 
        flange_class = "600"
        pressure_rating = 55
        temperature_rating = 1300
        elsif  pressure > 55 and pressure <= 80 
        flange_class = "900"
        pressure_rating = 80
        temperature_rating = 1300
        elsif  pressure > 80 and pressure <= 135 
        flange_class = "1500"
        pressure_rating = 135
        temperature_rating = 1300
        elsif  pressure > 135 and pressure <= 230 
        flange_class = "2500"
        pressure_rating = 230
        temperature_rating = 1300
        
        end
    elsif temperature > 1300 and temperature <= 1350 
        if pressure > 15 
        flange_class = "300"
        pressure_rating = 15
        temperature_rating = 1350
        elsif  pressure > 15 and pressure <= 25 
        flange_class = "400"
        pressure_rating = 25
        temperature_rating = 1350
        elsif  pressure > 25 and pressure <= 35 
        flange_class = "600"
        pressure_rating = 35
        temperature_rating = 1350
        elsif  pressure > 35 and pressure <= 50 
        flange_class = "900"
        pressure_rating = 50
        temperature_rating = 1350
        elsif  pressure > 50 and pressure <= 85 
        flange_class = "1500"
        pressure_rating = 85
        temperature_rating = 1350
        elsif  pressure > 85 and pressure <= 145 
        flange_class = "2500"
        pressure_rating = 145
        temperature_rating = 1350
        
        end
    elsif temperature > 1350 and temperature <= 1400 
        if pressure > 15 
        flange_class = "300"
        pressure_rating = 15
        temperature_rating = 1400
        elsif  pressure > 15 and pressure <= 20 
        flange_class = "400"
        pressure_rating = 20
        temperature_rating = 1400
        elsif  pressure > 20 and pressure <= 25 
        flange_class = "600"
        pressure_rating = 25
        temperature_rating = 1400
        elsif  pressure > 25 and pressure <= 40 
        flange_class = "900"
        pressure_rating = 40
        temperature_rating = 1400
        elsif  pressure > 40 and pressure <= 70 
        flange_class = "1500"
        pressure_rating = 70
        temperature_rating = 1150
        elsif  pressure > 70 and pressure <= 115 
        flange_class = "2500"
        pressure_rating = 115
        temperature_rating = 1400
        
        end
    elsif temperature > 1400 and temperature <= 1450 
        if pressure > 10 
        flange_class = "300"
        pressure_rating = 10
        temperature_rating = 1450
        elsif  pressure > 10 and pressure <= 15 
        flange_class = "400"
        pressure_rating = 15
        temperature_rating = 1450
        elsif  pressure > 15 and pressure <= 20 
        flange_class = "600"
        pressure_rating = 20
        temperature_rating = 1450
        elsif  pressure > 20 and pressure <= 30 
        flange_class = "900"
        pressure_rating = 30
        temperature_rating = 1450
        elsif  pressure > 30 and pressure <= 50 
        flange_class = "1500"
        pressure_rating = 50
        temperature_rating = 1450
        elsif  pressure > 50 and pressure <= 85 
        flange_class = "2500"
        pressure_rating = 85
        temperature_rating = 1450
        
        end
    elsif temperature > 1450 and temperature <= 1500 
        if pressure > 5 
        flange_class = "300"
        pressure_rating = 5
        temperature_rating = 1500
        elsif  pressure > 5 and pressure <= 10 
        flange_class = "400"
        pressure_rating = 10
        temperature_rating = 1500
        elsif  pressure > 10 and pressure <= 15 
        flange_class = "600"
        pressure_rating = 15
        temperature_rating = 1500
        elsif  pressure > 15 and pressure <= 20 
        flange_class = "900"
        pressure_rating = 20
        temperature_rating = 1500
        elsif  pressure > 20 and pressure <= 35 
        flange_class = "1500"
        pressure_rating = 35
        temperature_rating = 1500
        elsif  pressure > 35 and pressure <= 55 
        flange_class = "2500"
        pressure_rating = 55
        temperature_rating = 1500
        
        end
    
    end
    
    if Worksheets("UOM").chkCustomary.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) At temperatures over 1000\B0F, use only when the carbon content is 0.04% or higher." & Chr(13) _
    & "(2) At temperatures above 1000\B0F, use only if the material is solution heat treated to the minimum temperature specified in the specification, but not lower than 1900\B0F, and quenching in water or rapidly cooling by other means." & Chr(13) _
    & "(3) This material should be used for service temperatures 1050\B0F and above only when assurance is provided that grain size is not finer than ASTM 6."
    elsif orksheets("UOM").chkSI.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) At temperatures over 538\B0C, use only when the carbon content is 0.04% or higher." & Chr(13) _
    & "(2) At temperatures above 538\B0C, use only if the material is solution heat treated to the minimum temperature specified in the specification, but not lower than 1035\B0C, and quenching in water or rapidly cooling by other means." & Chr(13) _
    & "(3) This material should be used for service temperatures 565\B0C and above only when assurance is provided that grain size is not finer than ASTM 6."
    
    flange_classd if
    pressure_ratingElse
Call FlangePressuretemperature_rating5(pressure, temperature, MaterialGroup, FlangeClass, PressureRating, temperature_rating)
flange_class if

pressure_ratingSub

Sub FlangePressuretemperature_rating5(pressure, temperature, MaterialGroup, FlangeClass, PressureRating, temperature_rating)

if MaterialGroup = "2.10" 
UserFormLineSegmentDesign.cmbMaterialDesignation.RowSource = "MaterialGroup2.10"
    if temperature >= -20 and temperature <= 100 
        if pressure <= 260 
        flange_class = "150"
        pressure_rating = 260
        temperature_rating = 100
        elsif  pressure > 260 and pressure <= 670 
        flange_class = "300"
        pressure_rating = 670
        temperature_rating = 100
        elsif  pressure > 670 and pressure <= 895 
        flange_class = "400"
        pressure_rating = 895
        temperature_rating = 100
        elsif  pressure > 895 and pressure <= 1345 
        flange_class = "600"
        pressure_rating = 1345
        temperature_rating = 100
        elsif  pressure > 1345 and pressure <= 2015 
        flange_class = "900"
        pressure_rating = 2015
        temperature_rating = 100
        elsif  pressure > 2015 and pressure <= 3360 
        flange_class = "1500"
        pressure_rating = 3360
        temperature_rating = 100
        elsif  pressure > 3360 and pressure <= 5600 
        flange_class = "2500"
        pressure_rating = 5600
        temperature_rating = 100
        
        end
    elsif temperature > 100 and temperature <= 200 
        if pressure <= 210 
        flange_class = "150"
        pressure_rating = 210
        temperature_rating = 200
        elsif  pressure > 210 and pressure <= 550 
        flange_class = "300"
        pressure_rating = 550
        temperature_rating = 200
        elsif  pressure > 550 and pressure <= 735 
        flange_class = "400"
        pressure_rating = 735
        temperature_rating = 200
        elsif  pressure > 735 and pressure <= 1100 
        flange_class = "600"
        pressure_rating = 1100
        temperature_rating = 200
        elsif  pressure > 1100 and pressure <= 1650 
        flange_class = "900"
        pressure_rating = 1650
        temperature_rating = 200
        elsif  pressure > 1650 and pressure <= 2750 
        flange_class = "1500"
        pressure_rating = 2750
        temperature_rating = 200
        elsif  pressure > 2750 and pressure <= 4580 
        flange_class = "2500"
        pressure_rating = 4580
        temperature_rating = 200
        
        end
    elsif temperature > 200 and temperature <= 300 
        if pressure <= 195 
        flange_class = "150"
        pressure_rating = 195
        temperature_rating = 300
        elsif  pressure > 195 and pressure <= 505 
        flange_class = "300"
        pressure_rating = 505
        temperature_rating = 300
        elsif  pressure > 505 and pressure <= 675 
        flange_class = "400"
        pressure_rating = 675
        temperature_rating = 300
        elsif  pressure > 675 and pressure <= 1015 
        flange_class = "600"
        pressure_rating = 1015
        temperature_rating = 300
        elsif  pressure > 1015 and pressure <= 1520 
        flange_class = "900"
        pressure_rating = 1520
        temperature_rating = 300
        elsif  pressure > 1520 and pressure <= 2530 
        flange_class = "1500"
        pressure_rating = 2530
        temperature_rating = 300
        elsif  pressure > 2530 and pressure <= 4220 
        flange_class = "2500"
        pressure_rating = 4220
        temperature_rating = 300
        
        end
    elsif temperature > 300 and temperature <= 400 
        if pressure <= 185 
        flange_class = "150"
        pressure_rating = 185
        temperature_rating = 400
        elsif  pressure > 185 and pressure <= 485 
        flange_class = "300"
        pressure_rating = 485
        temperature_rating = 400
        elsif  pressure > 485 and pressure <= 645 
        flange_class = "400"
        pressure_rating = 645
        temperature_rating = 400
        elsif  pressure > 645 and pressure <= 970 
        flange_class = "600"
        pressure_rating = 970
        temperature_rating = 400
        elsif  pressure > 970 and pressure <= 1455 
        flange_class = "900"
        pressure_rating = 1455
        temperature_rating = 400
        elsif  pressure > 1455 and pressure <= 2425 
        flange_class = "1500"
        pressure_rating = 2425
        temperature_rating = 400
        elsif  pressure > 2425 and pressure <= 4040 
        flange_class = "2500"
        pressure_rating = 4040
        temperature_rating = 400
        
        end
    elsif temperature > 400 and temperature <= 500 
        if pressure <= 170 
        flange_class = "150"
        pressure_rating = 170
        temperature_rating = 500
        elsif  pressure > 170 and pressure <= 470 
        flange_class = "300"
        pressure_rating = 470
        temperature_rating = 500
        elsif  pressure > 470 and pressure <= 625 
        flange_class = "400"
        pressure_rating = 625
        temperature_rating = 500
        elsif  pressure > 625 and pressure <= 940 
        flange_class = "600"
        pressure_rating = 940
        temperature_rating = 500
        elsif  pressure > 940 and pressure <= 1410 
        flange_class = "900"
        pressure_rating = 1410
        temperature_rating = 500
        elsif  pressure > 1410 and pressure <= 2350 
        flange_class = "1500"
        pressure_rating = 2350
        temperature_rating = 500
        elsif  pressure > 2350 and pressure <= 3920 
        flange_class = "2500"
        pressure_rating = 3920
        temperature_rating = 500
        
        end
    elsif temperature > 500 and temperature <= 600 
        if pressure <= 140 
        flange_class = "150"
        pressure_rating = 140
        temperature_rating = 600
        elsif  pressure > 140 and pressure <= 455 
        flange_class = "300"
        pressure_rating = 455
        temperature_rating = 600
        elsif  pressure > 455 and pressure <= 610 
        flange_class = "400"
        pressure_rating = 610
        temperature_rating = 600
        elsif  pressure > 610 and pressure <= 910 
        flange_class = "600"
        pressure_rating = 910
        temperature_rating = 600
        elsif  pressure > 910 and pressure <= 1370 
        flange_class = "900"
        pressure_rating = 1370
        temperature_rating = 600
        elsif  pressure > 1370 and pressure <= 2280 
        flange_class = "1500"
        pressure_rating = 2280
        temperature_rating = 600
        elsif  pressure > 2280 and pressure <= 3800 
        flange_class = "2500"
        pressure_rating = 3800
        temperature_rating = 600
        
        end
    elsif temperature > 600 and temperature <= 650 
        if pressure <= 125 
        flange_class = "150"
        pressure_rating = 125
        temperature_rating = 650
        elsif  pressure > 125 and pressure <= 445 
        flange_class = "300"
        pressure_rating = 445
        temperature_rating = 650
        elsif  pressure > 445 and pressure <= 595 
        flange_class = "400"
        pressure_rating = 595
        temperature_rating = 650
        elsif  pressure > 595 and pressure <= 895 
        flange_class = "600"
        pressure_rating = 895
        temperature_rating = 650
        elsif  pressure > 895 and pressure <= 1340 
        flange_class = "900"
        pressure_rating = 1340
        temperature_rating = 650
        elsif  pressure > 1340 and pressure <= 2230 
        flange_class = "1500"
        pressure_rating = 2230
        temperature_rating = 650
        elsif  pressure > 2230 and pressure <= 3720 
        flange_class = "2500"
        pressure_rating = 3720
        temperature_rating = 650
        
        end
    elsif temperature > 650 and temperature <= 700 
        if pressure <= 110 
        flange_class = "150"
        pressure_rating = 110
        temperature_rating = 700
        elsif  pressure > 110 and pressure <= 435 
        flange_class = "300"
        pressure_rating = 435
        temperature_rating = 700
        elsif  pressure > 435 and pressure <= 580 
        flange_class = "400"
        pressure_rating = 580
        temperature_rating = 700
        elsif  pressure > 580 and pressure <= 870 
        flange_class = "600"
        pressure_rating = 870
        temperature_rating = 700
        elsif  pressure > 870 and pressure <= 1305 
        flange_class = "900"
        pressure_rating = 1305
        temperature_rating = 700
        elsif  pressure > 1305 and pressure <= 2170 
        flange_class = "1500"
        pressure_rating = 2170
        temperature_rating = 700
        elsif  pressure > 2170 and pressure <= 3620 
        flange_class = "2500"
        pressure_rating = 3620
        temperature_rating = 700
        
        end
    elsif temperature > 700 and temperature <= 750 
        if pressure <= 95 
        flange_class = "150"
        pressure_rating = 95
        temperature_rating = 750
        elsif  pressure > 95 and pressure <= 420 
        flange_class = "300"
        pressure_rating = 420
        temperature_rating = 750
        elsif  pressure > 420 and pressure <= 565 
        flange_class = "400"
        pressure_rating = 565
        temperature_rating = 750
        elsif  pressure > 565 and pressure <= 845 
        flange_class = "600"
        pressure_rating = 845
        temperature_rating = 750
        elsif  pressure > 845 and pressure <= 1265 
        flange_class = "900"
        pressure_rating = 1265
        temperature_rating = 750
        elsif  pressure > 1265 and pressure <= 2110 
        flange_class = "1500"
        pressure_rating = 2110
        temperature_rating = 750
        elsif  pressure > 2110 and pressure <= 3520 
        flange_class = "2500"
        pressure_rating = 3520
        temperature_rating = 750
        
        end
    elsif temperature > 750 and temperature <= 800 
        if pressure <= 80 
        flange_class = "150"
        pressure_rating = 80
        temperature_rating = 800
        elsif  pressure > 80 and pressure <= 410 
        flange_class = "300"
        pressure_rating = 410
        temperature_rating = 800
        elsif  pressure > 410 and pressure <= 545 
        flange_class = "400"
        pressure_rating = 545
        temperature_rating = 800
        elsif  pressure > 545 and pressure <= 820 
        flange_class = "600"
        pressure_rating = 820
        temperature_rating = 800
        elsif  pressure > 820 and pressure <= 1230 
        flange_class = "900"
        pressure_rating = 1230
        temperature_rating = 800
        elsif  pressure > 1230 and pressure <= 2050 
        flange_class = "1500"
        pressure_rating = 2050
        temperature_rating = 800
        elsif  pressure > 2050 and pressure <= 3420 
        flange_class = "2500"
        pressure_rating = 3420
        temperature_rating = 800
        
        end
    elsif temperature > 800 and temperature <= 850 
        if pressure <= 65 
        flange_class = "150"
        pressure_rating = 65
        temperature_rating = 850
        elsif  pressure > 65 and pressure <= 400 
        flange_class = "300"
        pressure_rating = 400
        temperature_rating = 850
        elsif  pressure > 400 and pressure <= 530 
        flange_class = "400"
        pressure_rating = 530
        temperature_rating = 850
        elsif  pressure > 530 and pressure <= 795 
        flange_class = "600"
        pressure_rating = 795
        temperature_rating = 850
        elsif  pressure > 795 and pressure <= 1195 
        flange_class = "900"
        pressure_rating = 1195
        temperature_rating = 850
        elsif  pressure > 1195 and pressure <= 1990 
        flange_class = "1500"
        pressure_rating = 1990
        temperature_rating = 850
        elsif  pressure > 1990 and pressure <= 3320 
        flange_class = "2500"
        pressure_rating = 3320
        temperature_rating = 850
        
        end
    elsif temperature > 850 and temperature <= 900 
        if pressure <= 50 
        flange_class = "150"
        pressure_rating = 50
        temperature_rating = 900
        elsif  pressure > 50 and pressure <= 385 
        flange_class = "300"
        pressure_rating = 385
        temperature_rating = 900
        elsif  pressure > 385 and pressure <= 510 
        flange_class = "400"
        pressure_rating = 510
        temperature_rating = 900
        elsif  pressure > 510 and pressure <= 770 
        flange_class = "600"
        pressure_rating = 770
        temperature_rating = 900
        elsif  pressure > 770 and pressure <= 1150 
        flange_class = "900"
        pressure_rating = 1150
        temperature_rating = 900
        elsif  pressure > 1150 and pressure <= 1920 
        flange_class = "1500"
        pressure_rating = 1920
        temperature_rating = 900
        elsif  pressure > 1920 and pressure <= 3200 
        flange_class = "2500"
        pressure_rating = 3200
        temperature_rating = 900
        
        end
    elsif temperature > 900 and temperature <= 950 
        if pressure <= 35 
        flange_class = "150"
        pressure_rating = 35
        temperature_rating = 950
        elsif  pressure > 35 and pressure <= 370 
        flange_class = "300"
        pressure_rating = 370
        temperature_rating = 950
        elsif  pressure > 370 and pressure <= 495 
        flange_class = "400"
        pressure_rating = 495
        temperature_rating = 950
        elsif  pressure > 495 and pressure <= 740 
        flange_class = "600"
        pressure_rating = 740
        temperature_rating = 950
        elsif  pressure > 740 and pressure <= 1110 
        flange_class = "900"
        pressure_rating = 1110
        temperature_rating = 950
        elsif  pressure > 1110 and pressure <= 1850 
        flange_class = "1500"
        pressure_rating = 1850
        temperature_rating = 950
        elsif  pressure > 1850 and pressure <= 3080 
        flange_class = "2500"
        pressure_rating = 3080
        temperature_rating = 950
        
        end
    elsif temperature > 950 and temperature <= 1000 
        if pressure <= 20 
        flange_class = "150"
        pressure_rating = 20
        temperature_rating = 1000
        elsif  pressure > 20 and pressure <= 340 
        flange_class = "300"
        pressure_rating = 340
        temperature_rating = 1000
        elsif  pressure > 340 and pressure <= 450 
        flange_class = "400"
        pressure_rating = 450
        temperature_rating = 1000
        elsif  pressure > 450 and pressure <= 675 
        flange_class = "600"
        pressure_rating = 675
        temperature_rating = 1000
        elsif  pressure > 675 and pressure <= 1015 
        flange_class = "900"
        pressure_rating = 1015
        temperature_rating = 1000
        elsif  pressure > 1015 and pressure <= 1690 
        flange_class = "1500"
        pressure_rating = 1690
        temperature_rating = 1000
        elsif  pressure > 1690 and pressure <= 2820 
        flange_class = "2500"
        pressure_rating = 2820
        temperature_rating = 1000
        
        end
    elsif temperature > 1000 and temperature <= 1050 
        if pressure > 290 
        flange_class = "300"
        pressure_rating = 290
        temperature_rating = 1050
        elsif  pressure > 290 and pressure <= 390 
        flange_class = "400"
        pressure_rating = 390
        temperature_rating = 1050
        elsif  pressure > 390 and pressure <= 585 
        flange_class = "600"
        pressure_rating = 585
        temperature_rating = 1050
        elsif  pressure > 585 and pressure <= 875 
        flange_class = "900"
        pressure_rating = 875
        temperature_rating = 1050
        elsif  pressure > 875 and pressure <= 1455 
        flange_class = "1500"
        pressure_rating = 1455
        temperature_rating = 1050
        elsif  pressure > 1455 and pressure <= 2430 
        flange_class = "2500"
        pressure_rating = 2430
        temperature_rating = 1050
        
        end
    elsif temperature > 1050 and temperature <= 1100 
        if pressure > 225 
        flange_class = "300"
        pressure_rating = 225
        temperature_rating = 1100
        elsif  pressure > 225 and pressure <= 295 
        flange_class = "400"
        pressure_rating = 295
        temperature_rating = 1100
        elsif  pressure > 295 and pressure <= 445 
        flange_class = "600"
        pressure_rating = 445
        temperature_rating = 1100
        elsif  pressure > 445 and pressure <= 670 
        flange_class = "900"
        pressure_rating = 670
        temperature_rating = 1100
        elsif  pressure > 670 and pressure <= 1115 
        flange_class = "1500"
        pressure_rating = 1115
        temperature_rating = 1100
        elsif  pressure > 1115 and pressure <= 1855 
        flange_class = "2500"
        pressure_rating = 1855
        temperature_rating = 1100
        
        end
    elsif temperature > 1100 and temperature <= 1150 
        if pressure > 170 
        flange_class = "300"
        pressure_rating = 170
        temperature_rating = 1150
        elsif  pressure > 170 and pressure <= 230 
        flange_class = "400"
        pressure_rating = 230
        temperature_rating = 1150
        elsif  pressure > 230 and pressure <= 345 
        flange_class = "600"
        pressure_rating = 345
        temperature_rating = 1150
        elsif  pressure > 345 and pressure <= 515 
        flange_class = "900"
        pressure_rating = 515
        temperature_rating = 1150
        elsif  pressure > 515 and pressure <= 855 
        flange_class = "1500"
        pressure_rating = 855
        temperature_rating = 1150
        elsif  pressure > 855 and pressure <= 1430 
        flange_class = "2500"
        pressure_rating = 1430
        temperature_rating = 1150
        
        end
    elsif temperature > 1150 and temperature <= 1200 
        if pressure > 130 
        flange_class = "300"
        pressure_rating = 130
        temperature_rating = 1200
        elsif  pressure > 130 and pressure <= 175 
        flange_class = "400"
        pressure_rating = 175
        temperature_rating = 1200
        elsif  pressure > 175 and pressure <= 260 
        flange_class = "600"
        pressure_rating = 260
        temperature_rating = 1200
        elsif  pressure > 260 and pressure <= 390 
        flange_class = "900"
        pressure_rating = 390
        temperature_rating = 1200
        elsif  pressure > 390 and pressure <= 650 
        flange_class = "1500"
        pressure_rating = 650
        temperature_rating = 1200
        elsif  pressure > 650 and pressure <= 1085 
        flange_class = "2500"
        pressure_rating = 1085
        temperature_rating = 1200
        
        end
    elsif temperature > 1200 and temperature <= 1250 
        if pressure > 100 
        flange_class = "300"
        pressure_rating = 100
        temperature_rating = 1250
        elsif  pressure > 100 and pressure <= 135 
        flange_class = "400"
        pressure_rating = 135
        temperature_rating = 1250
        elsif  pressure > 135 and pressure <= 200 
        flange_class = "600"
        pressure_rating = 200
        temperature_rating = 1250
        elsif  pressure > 200 and pressure <= 300 
        flange_class = "900"
        pressure_rating = 300
        temperature_rating = 1250
        elsif  pressure > 300 and pressure <= 495 
        flange_class = "1500"
        pressure_rating = 495
        temperature_rating = 1250
        elsif  pressure > 495 and pressure <= 830 
        flange_class = "2500"
        pressure_rating = 830
        temperature_rating = 1250
        
        end
    elsif temperature > 1250 and temperature <= 1300 
        if pressure > 80 
        flange_class = "300"
        pressure_rating = 80
        temperature_rating = 1300
        elsif  pressure > 80 and pressure <= 105 
        flange_class = "400"
        pressure_rating = 105
        temperature_rating = 1300
        elsif  pressure > 105 and pressure <= 160 
        flange_class = "600"
        pressure_rating = 160
        temperature_rating = 1300
        elsif  pressure > 160 and pressure <= 235 
        flange_class = "900"
        pressure_rating = 235
        temperature_rating = 1300
        elsif  pressure > 235 and pressure <= 395 
        flange_class = "1500"
        pressure_rating = 395
        temperature_rating = 1300
        elsif  pressure > 395 and pressure <= 655 
        flange_class = "2500"
        pressure_rating = 655
        temperature_rating = 1300
        
        end
    elsif temperature > 1300 and temperature <= 1350 
        if pressure > 60 
        flange_class = "300"
        pressure_rating = 60
        temperature_rating = 1350
        elsif  pressure > 60 and pressure <= 80 
        flange_class = "400"
        pressure_rating = 80
        temperature_rating = 1350
        elsif  pressure > 80 and pressure <= 125 
        flange_class = "600"
        pressure_rating = 125
        temperature_rating = 1350
        elsif  pressure > 125 and pressure <= 185 
        flange_class = "900"
        pressure_rating = 185
        temperature_rating = 1350
        elsif  pressure > 185 and pressure <= 310 
        flange_class = "1500"
        pressure_rating = 310
        temperature_rating = 1350
        elsif  pressure > 310 and pressure <= 515 
        flange_class = "2500"
        pressure_rating = 515
        temperature_rating = 1350
        
        end
    elsif temperature > 1350 and temperature <= 1400 
        if pressure > 45 
        flange_class = "300"
        pressure_rating = 45
        temperature_rating = 1400
        elsif  pressure > 45 and pressure <= 60 
        flange_class = "400"
        pressure_rating = 60
        temperature_rating = 1400
        elsif  pressure > 60 and pressure <= 90 
        flange_class = "600"
        pressure_rating = 90
        temperature_rating = 1400
        elsif  pressure > 90 and pressure <= 135 
        flange_class = "900"
        pressure_rating = 135
        temperature_rating = 1400
        elsif  pressure > 135 and pressure <= 225 
        flange_class = "1500"
        pressure_rating = 225
        temperature_rating = 1150
        elsif  pressure > 225 and pressure <= 370 
        flange_class = "2500"
        pressure_rating = 370
        temperature_rating = 1400
        
        end
    elsif temperature > 1400 and temperature <= 1450 
        if pressure > 30 
        flange_class = "300"
        pressure_rating = 30
        temperature_rating = 1450
        elsif  pressure > 30 and pressure <= 40 
        flange_class = "400"
        pressure_rating = 40
        temperature_rating = 1450
        elsif  pressure > 40 and pressure <= 60 
        flange_class = "600"
        pressure_rating = 60
        temperature_rating = 1450
        elsif  pressure > 60 and pressure <= 95 
        flange_class = "900"
        pressure_rating = 95
        temperature_rating = 1450
        elsif  pressure > 95 and pressure <= 155 
        flange_class = "1500"
        pressure_rating = 155
        temperature_rating = 1450
        elsif  pressure > 155 and pressure <= 255 
        flange_class = "2500"
        pressure_rating = 255
        temperature_rating = 1450
        
        end
    elsif temperature > 1450 and temperature <= 1500 
        if pressure > 25 
        flange_class = "300"
        pressure_rating = 25
        temperature_rating = 1500
        elsif  pressure > 25 and pressure <= 35 
        flange_class = "400"
        pressure_rating = 35
        temperature_rating = 1500
        elsif  pressure > 35 and pressure <= 55 
        flange_class = "600"
        pressure_rating = 55
        temperature_rating = 1500
        elsif  pressure > 55 and pressure <= 80 
        flange_class = "900"
        pressure_rating = 80
        temperature_rating = 1500
        elsif  pressure > 80 and pressure <= 135 
        flange_class = "1500"
        pressure_rating = 135
        temperature_rating = 1500
        elsif  pressure > 135 and pressure <= 230 
        flange_class = "2500"
        pressure_rating = 230
        temperature_rating = 1500
        
        end
    
    end
    
    if Worksheets("UOM").chkCustomary.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) At temperatures over 1000\B0F, use only when the carbon content is 0.04% or higher."
    elsif orksheets("UOM").chkSI.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) At temperatures over 538\B0C, use only when the carbon content is 0.04% or higher."
    
    end
    
elsif material_group = "2.11" 
UserFormLineSegmentDesign.cmbMaterialDesignation.RowSource = "MaterialGroup2.11"
    if temperature >= -20 and temperature <= 100 
        if pressure <= 275 
        flange_class = "150"
        pressure_rating = 275
        temperature_rating = 100
        elsif  pressure > 275 and pressure <= 720 
        flange_class = "300"
        pressure_rating = 720
        temperature_rating = 100
        elsif  pressure > 720 and pressure <= 960 
        flange_class = "400"
        pressure_rating = 960
        temperature_rating = 100
        elsif  pressure > 960 and pressure <= 1440 
        flange_class = "600"
        pressure_rating = 1440
        temperature_rating = 100
        elsif  pressure > 1440 and pressure <= 2160 
        flange_class = "900"
        pressure_rating = 2160
        temperature_rating = 100
        elsif  pressure > 2160 and pressure <= 3600 
        flange_class = "1500"
        pressure_rating = 3600
        temperature_rating = 100
        elsif  pressure > 3600 and pressure <= 6000 
        flange_class = "2500"
        pressure_rating = 6000
        temperature_rating = 100
        
        end
    elsif temperature > 100 and temperature <= 200 
        if pressure <= 255 
        flange_class = "150"
        pressure_rating = 255
        temperature_rating = 200
        elsif  pressure > 255 and pressure <= 660 
        flange_class = "300"
        pressure_rating = 660
        temperature_rating = 200
        elsif  pressure > 660 and pressure <= 885 
        flange_class = "400"
        pressure_rating = 885
        temperature_rating = 200
        elsif  pressure > 885 and pressure <= 1325 
        flange_class = "600"
        pressure_rating = 1325
        temperature_rating = 200
        elsif  pressure > 1325 and pressure <= 1985 
        flange_class = "900"
        pressure_rating = 1985
        temperature_rating = 200
        elsif  pressure > 1985 and pressure <= 3310 
        flange_class = "1500"
        pressure_rating = 3310
        temperature_rating = 200
        elsif  pressure > 3310 and pressure <= 5520 
        flange_class = "2500"
        pressure_rating = 5520
        temperature_rating = 200
        
        end
    elsif temperature > 200 and temperature <= 300 
        if pressure <= 230 
        flange_class = "150"
        pressure_rating = 230
        temperature_rating = 300
        elsif  pressure > 230 and pressure <= 615 
        flange_class = "300"
        pressure_rating = 615
        temperature_rating = 300
        elsif  pressure > 615 and pressure <= 820 
        flange_class = "400"
        pressure_rating = 820
        temperature_rating = 300
        elsif  pressure > 820 and pressure <= 1235 
        flange_class = "600"
        pressure_rating = 1235
        temperature_rating = 300
        elsif  pressure > 1235 and pressure <= 1850 
        flange_class = "900"
        pressure_rating = 1850
        temperature_rating = 300
        elsif  pressure > 1850 and pressure <= 3085 
        flange_class = "1500"
        pressure_rating = 3085
        temperature_rating = 300
        elsif  pressure > 3085 and pressure <= 5140 
        flange_class = "2500"
        pressure_rating = 5140
        temperature_rating = 300
        
        end
    elsif temperature > 300 and temperature <= 400 
        if pressure <= 200 
        flange_class = "150"
        pressure_rating = 200
        temperature_rating = 400
        elsif  pressure > 200 and pressure <= 575 
        flange_class = "300"
        pressure_rating = 575
        temperature_rating = 400
        elsif  pressure > 575 and pressure <= 770 
        flange_class = "400"
        pressure_rating = 770
        temperature_rating = 400
        elsif  pressure > 770 and pressure <= 1150 
        flange_class = "600"
        pressure_rating = 1150
        temperature_rating = 400
        elsif  pressure > 1150 and pressure <= 1730 
        flange_class = "900"
        pressure_rating = 1730
        temperature_rating = 400
        elsif  pressure > 1730 and pressure <= 2880 
        flange_class = "1500"
        pressure_rating = 2880
        temperature_rating = 400
        elsif  pressure > 2880 and pressure <= 4800 
        flange_class = "2500"
        pressure_rating = 4800
        temperature_rating = 400
        
        end
    elsif temperature > 400 and temperature <= 500 
        if pressure <= 170 
        flange_class = "150"
        pressure_rating = 170
        temperature_rating = 500
        elsif  pressure > 170 and pressure <= 540 
        flange_class = "300"
        pressure_rating = 540
        temperature_rating = 500
        elsif  pressure > 540 and pressure <= 725 
        flange_class = "400"
        pressure_rating = 725
        temperature_rating = 500
        elsif  pressure > 725 and pressure <= 1085 
        flange_class = "600"
        pressure_rating = 1085
        temperature_rating = 500
        elsif  pressure > 1085 and pressure <= 1625 
        flange_class = "900"
        pressure_rating = 1625
        temperature_rating = 500
        elsif  pressure > 1625 and pressure <= 2710 
        flange_class = "1500"
        pressure_rating = 2710
        temperature_rating = 500
        elsif  pressure > 2710 and pressure <= 4520 
        flange_class = "2500"
        pressure_rating = 4520
        temperature_rating = 500
        
        end
    elsif temperature > 500 and temperature <= 600 
        if pressure <= 140 
        flange_class = "150"
        pressure_rating = 140
        temperature_rating = 600
        elsif  pressure > 140 and pressure <= 515 
        flange_class = "300"
        pressure_rating = 515
        temperature_rating = 600
        elsif  pressure > 515 and pressure <= 690 
        flange_class = "400"
        pressure_rating = 690
        temperature_rating = 600
        elsif  pressure > 690 and pressure <= 1030 
        flange_class = "600"
        pressure_rating = 1030
        temperature_rating = 600
        elsif  pressure > 1030 and pressure <= 1550 
        flange_class = "900"
        pressure_rating = 1550
        temperature_rating = 600
        elsif  pressure > 1550 and pressure <= 2580 
        flange_class = "1500"
        pressure_rating = 2580
        temperature_rating = 600
        elsif  pressure > 2580 and pressure <= 4300 
        flange_class = "2500"
        pressure_rating = 4300
        temperature_rating = 600
        
        end
    elsif temperature > 600 and temperature <= 650 
        if pressure <= 125 
        flange_class = "150"
        pressure_rating = 125
        temperature_rating = 650
        elsif  pressure > 125 and pressure <= 505 
        flange_class = "300"
        pressure_rating = 505
        temperature_rating = 650
        elsif  pressure > 505 and pressure <= 675 
        flange_class = "400"
        pressure_rating = 675
        temperature_rating = 650
        elsif  pressure > 675 and pressure <= 1015 
        flange_class = "600"
        pressure_rating = 1015
        temperature_rating = 650
        elsif  pressure > 1015 and pressure <= 1520 
        flange_class = "900"
        pressure_rating = 1520
        temperature_rating = 650
        elsif  pressure > 1520 and pressure <= 2530 
        flange_class = "1500"
        pressure_rating = 2530
        temperature_rating = 650
        elsif  pressure > 2530 and pressure <= 4220 
        flange_class = "2500"
        pressure_rating = 4220
        temperature_rating = 650
        
        end
    elsif temperature > 650 and temperature <= 700 
        if pressure <= 110 
        flange_class = "150"
        pressure_rating = 110
        temperature_rating = 700
        elsif  pressure > 110 and pressure <= 495 
        flange_class = "300"
        pressure_rating = 495
        temperature_rating = 700
        elsif  pressure > 495 and pressure <= 660 
        flange_class = "400"
        pressure_rating = 660
        temperature_rating = 700
        elsif  pressure > 660 and pressure <= 995 
        flange_class = "600"
        pressure_rating = 995
        temperature_rating = 700
        elsif  pressure > 995 and pressure <= 1490 
        flange_class = "900"
        pressure_rating = 1490
        temperature_rating = 700
        elsif  pressure > 1490 and pressure <= 2485 
        flange_class = "1500"
        pressure_rating = 2485
        temperature_rating = 700
        elsif  pressure > 2485 and pressure <= 4140 
        flange_class = "2500"
        pressure_rating = 4140
        temperature_rating = 700
        
        end
    elsif temperature > 700 and temperature <= 750 
        if pressure <= 95 
        flange_class = "150"
        pressure_rating = 95
        temperature_rating = 750
        elsif  pressure > 95 and pressure <= 490 
        flange_class = "300"
        pressure_rating = 490
        temperature_rating = 750
        elsif  pressure > 490 and pressure <= 655 
        flange_class = "400"
        pressure_rating = 655
        temperature_rating = 750
        elsif  pressure > 655 and pressure <= 985 
        flange_class = "600"
        pressure_rating = 985
        temperature_rating = 750
        elsif  pressure > 985 and pressure <= 1475 
        flange_class = "900"
        pressure_rating = 1475
        temperature_rating = 750
        elsif  pressure > 1475 and pressure <= 2460 
        flange_class = "1500"
        pressure_rating = 2460
        temperature_rating = 750
        elsif  pressure > 2460 and pressure <= 4100 
        flange_class = "2500"
        pressure_rating = 4100
        temperature_rating = 750
        
        end
    elsif temperature > 750 and temperature <= 800 
        if pressure <= 80 
        flange_class = "150"
        pressure_rating = 80
        temperature_rating = 800
        elsif  pressure > 80 and pressure <= 485 
        flange_class = "300"
        pressure_rating = 485
        temperature_rating = 800
        elsif  pressure > 485 and pressure <= 650 
        flange_class = "400"
        pressure_rating = 650
        temperature_rating = 800
        elsif  pressure > 650 and pressure <= 975 
        flange_class = "600"
        pressure_rating = 975
        temperature_rating = 800
        elsif  pressure > 975 and pressure <= 1460 
        flange_class = "900"
        pressure_rating = 1460
        temperature_rating = 800
        elsif  pressure > 1460 and pressure <= 2435 
        flange_class = "1500"
        pressure_rating = 2435
        temperature_rating = 800
        elsif  pressure > 2435 and pressure <= 4060 
        flange_class = "2500"
        pressure_rating = 4060
        temperature_rating = 800
        
        end
    elsif temperature > 800 and temperature <= 850 
        if pressure <= 65 
        flange_class = "150"
        pressure_rating = 65
        temperature_rating = 850
        elsif  pressure > 65 and pressure <= 485 
        flange_class = "300"
        pressure_rating = 485
        temperature_rating = 850
        elsif  pressure > 485 and pressure <= 645 
        flange_class = "400"
        pressure_rating = 645
        temperature_rating = 850
        elsif  pressure > 645 and pressure <= 970 
        flange_class = "600"
        pressure_rating = 970
        temperature_rating = 850
        elsif  pressure > 970 and pressure <= 1455 
        flange_class = "900"
        pressure_rating = 1455
        temperature_rating = 850
        elsif  pressure > 1455 and pressure <= 2425 
        flange_class = "1500"
        pressure_rating = 2425
        temperature_rating = 850
        elsif  pressure > 2425 and pressure <= 4040 
        flange_class = "2500"
        pressure_rating = 4040
        temperature_rating = 850
        
        end
    elsif temperature > 850 and temperature <= 900 
        if pressure <= 50 
        flange_class = "150"
        pressure_rating = 50
        temperature_rating = 900
        elsif  pressure > 50 and pressure <= 450 
        flange_class = "300"
        pressure_rating = 450
        temperature_rating = 900
        elsif  pressure > 450 and pressure <= 600 
        flange_class = "400"
        pressure_rating = 600
        temperature_rating = 900
        elsif  pressure > 600 and pressure <= 900 
        flange_class = "600"
        pressure_rating = 900
        temperature_rating = 900
        elsif  pressure > 900 and pressure <= 1350 
        flange_class = "900"
        pressure_rating = 1350
        temperature_rating = 900
        elsif  pressure > 1350 and pressure <= 2245 
        flange_class = "1500"
        pressure_rating = 2245
        temperature_rating = 900
        elsif  pressure > 2245 and pressure <= 3745 
        flange_class = "2500"
        pressure_rating = 3745
        temperature_rating = 900
        
        end
    elsif temperature > 900 and temperature <= 950 
        if pressure <= 35 
        flange_class = "150"
        pressure_rating = 35
        temperature_rating = 950
        elsif  pressure > 35 and pressure <= 385 
        flange_class = "300"
        pressure_rating = 385
        temperature_rating = 950
        elsif  pressure > 385 and pressure <= 515 
        flange_class = "400"
        pressure_rating = 515
        temperature_rating = 950
        elsif  pressure > 515 and pressure <= 775 
        flange_class = "600"
        pressure_rating = 775
        temperature_rating = 950
        elsif  pressure > 775 and pressure <= 1160 
        flange_class = "900"
        pressure_rating = 1160
        temperature_rating = 950
        elsif  pressure > 1160 and pressure <= 1930 
        flange_class = "1500"
        pressure_rating = 1930
        temperature_rating = 950
        elsif  pressure > 1930 and pressure <= 3220 
        flange_class = "2500"
        pressure_rating = 3220
        temperature_rating = 950
        
        end
    elsif temperature > 950 and temperature <= 1000 
        if pressure <= 20 
        flange_class = "150"
        pressure_rating = 20
        temperature_rating = 1000
        elsif  pressure > 20 and pressure <= 365 
        flange_class = "300"
        pressure_rating = 365
        temperature_rating = 1000
        elsif  pressure > 365 and pressure <= 485 
        flange_class = "400"
        pressure_rating = 485
        temperature_rating = 1000
        elsif  pressure > 485 and pressure <= 725 
        flange_class = "600"
        pressure_rating = 725
        temperature_rating = 1000
        elsif  pressure > 725 and pressure <= 1090 
        flange_class = "900"
        pressure_rating = 1090
        temperature_rating = 1000
        elsif  pressure > 1090 and pressure <= 1820 
        flange_class = "1500"
        pressure_rating = 1820
        temperature_rating = 1000
        elsif  pressure > 1820 and pressure <= 3030 
        flange_class = "2500"
        pressure_rating = 3030
        temperature_rating = 1000
        
        end
    elsif temperature > 1000 and temperature <= 1050 
        if pressure > 360 
        flange_class = "300"
        pressure_rating = 360
        temperature_rating = 1050
        elsif  pressure > 360 and pressure <= 480 
        flange_class = "400"
        pressure_rating = 480
        temperature_rating = 1050
        elsif  pressure > 480 and pressure <= 720 
        flange_class = "600"
        pressure_rating = 720
        temperature_rating = 1050
        elsif  pressure > 720 and pressure <= 1080 
        flange_class = "900"
        pressure_rating = 1080
        temperature_rating = 1050
        elsif  pressure > 1080 and pressure <= 1800 
        flange_class = "1500"
        pressure_rating = 1800
        temperature_rating = 1050
        elsif  pressure > 1800 and pressure <= 3000 
        flange_class = "2500"
        pressure_rating = 3000
        temperature_rating = 1050
        
        end
    elsif temperature > 1050 and temperature <= 1100 
        if pressure > 310 
        flange_class = "300"
        pressure_rating = 310
        temperature_rating = 1100
        elsif  pressure > 310 and pressure <= 415 
        flange_class = "400"
        pressure_rating = 415
        temperature_rating = 1100
        elsif  pressure > 415 and pressure <= 625 
        flange_class = "600"
        pressure_rating = 625
        temperature_rating = 1100
        elsif  pressure > 625 and pressure <= 935 
        flange_class = "900"
        pressure_rating = 935
        temperature_rating = 1100
        elsif  pressure > 935 and pressure <= 1560 
        flange_class = "1500"
        pressure_rating = 1560
        temperature_rating = 1100
        elsif  pressure > 1560 and pressure <= 2600 
        flange_class = "2500"
        pressure_rating = 2600
        temperature_rating = 1100
        
        end
    elsif temperature > 1100 and temperature <= 1150 
        if pressure > 210 
        flange_class = "300"
        pressure_rating = 210
        temperature_rating = 1150
        elsif  pressure > 210 and pressure <= 280 
        flange_class = "400"
        pressure_rating = 280
        temperature_rating = 1150
        elsif  pressure > 280 and pressure <= 420 
        flange_class = "600"
        pressure_rating = 420
        temperature_rating = 1150
        elsif  pressure > 420 and pressure <= 625 
        flange_class = "900"
        pressure_rating = 625
        temperature_rating = 1150
        elsif  pressure > 625 and pressure <= 1045 
        flange_class = "1500"
        pressure_rating = 1045
        temperature_rating = 1150
        elsif  pressure > 1045 and pressure <= 1745 
        flange_class = "2500"
        pressure_rating = 1745
        temperature_rating = 1150
        
        end
    elsif temperature > 1150 and temperature <= 1200 
        if pressure > 150 
        flange_class = "300"
        pressure_rating = 150
        temperature_rating = 1200
        elsif  pressure > 150 and pressure <= 200 
        flange_class = "400"
        pressure_rating = 200
        temperature_rating = 1200
        elsif  pressure > 200 and pressure <= 300 
        flange_class = "600"
        pressure_rating = 300
        temperature_rating = 1200
        elsif  pressure > 300 and pressure <= 455 
        flange_class = "900"
        pressure_rating = 455
        temperature_rating = 1200
        elsif  pressure > 455 and pressure <= 755 
        flange_class = "1500"
        pressure_rating = 755
        temperature_rating = 1200
        elsif  pressure > 755 and pressure <= 1255 
        flange_class = "2500"
        pressure_rating = 1255
        temperature_rating = 1200
        
        end
    elsif temperature > 1200 and temperature <= 1250 
        if pressure > 115 
        flange_class = "300"
        pressure_rating = 115
        temperature_rating = 1250
        elsif  pressure > 115 and pressure <= 150 
        flange_class = "400"
        pressure_rating = 150
        temperature_rating = 1250
        elsif  pressure > 150 and pressure <= 225 
        flange_class = "600"
        pressure_rating = 225
        temperature_rating = 1250
        elsif  pressure > 225 and pressure <= 340 
        flange_class = "900"
        pressure_rating = 340
        temperature_rating = 1250
        elsif  pressure > 340 and pressure <= 565 
        flange_class = "1500"
        pressure_rating = 565
        temperature_rating = 1250
        elsif  pressure > 565 and pressure <= 945 
        flange_class = "2500"
        pressure_rating = 945
        temperature_rating = 1250
        
        end
    elsif temperature > 1250 and temperature <= 1300 
        if pressure > 75 
        flange_class = "300"
        pressure_rating = 75
        temperature_rating = 1300
        elsif  pressure > 75 and pressure <= 100 
        flange_class = "400"
        pressure_rating = 100
        temperature_rating = 1300
        elsif  pressure > 100 and pressure <= 150 
        flange_class = "600"
        pressure_rating = 150
        temperature_rating = 1300
        elsif  pressure > 150 and pressure <= 225 
        flange_class = "900"
        pressure_rating = 225
        temperature_rating = 1300
        elsif  pressure > 225 and pressure <= 375 
        flange_class = "1500"
        pressure_rating = 375
        temperature_rating = 1300
        elsif  pressure > 375 and pressure <= 630 
        flange_class = "2500"
        pressure_rating = 630
        temperature_rating = 1300
        
        end
    elsif temperature > 1300 and temperature <= 1350 
        if pressure > 50 
        flange_class = "300"
        pressure_rating = 50
        temperature_rating = 1350
        elsif  pressure > 50 and pressure <= 70 
        flange_class = "400"
        pressure_rating = 70
        temperature_rating = 1350
        elsif  pressure > 70 and pressure <= 105 
        flange_class = "600"
        pressure_rating = 105
        temperature_rating = 1350
        elsif  pressure > 105 and pressure <= 155 
        flange_class = "900"
        pressure_rating = 155
        temperature_rating = 1350
        elsif  pressure > 155 and pressure <= 255 
        flange_class = "1500"
        pressure_rating = 255
        temperature_rating = 1350
        elsif  pressure > 255 and pressure <= 430 
        flange_class = "2500"
        pressure_rating = 430
        temperature_rating = 1350
        
        end
    elsif temperature > 1350 and temperature <= 1400 
        if pressure > 40 
        flange_class = "300"
        pressure_rating = 40
        temperature_rating = 1400
        elsif  pressure > 40 and pressure <= 55 
        flange_class = "400"
        pressure_rating = 55
        temperature_rating = 1400
        elsif  pressure > 55 and pressure <= 80 
        flange_class = "600"
        pressure_rating = 80
        temperature_rating = 1400
        elsif  pressure > 80 and pressure <= 125 
        flange_class = "900"
        pressure_rating = 125
        temperature_rating = 1400
        elsif  pressure > 125 and pressure <= 205 
        flange_class = "1500"
        pressure_rating = 205
        temperature_rating = 1150
        elsif  pressure > 205 and pressure <= 345 
        flange_class = "2500"
        pressure_rating = 345
        temperature_rating = 1400
        
        end
    elsif temperature > 1400 and temperature <= 1450 
        if pressure > 30 
        flange_class = "300"
        pressure_rating = 30
        temperature_rating = 1450
        elsif  pressure > 30 and pressure <= 40 
        flange_class = "400"
        pressure_rating = 40
        temperature_rating = 1450
        elsif  pressure > 40 and pressure <= 60 
        flange_class = "600"
        pressure_rating = 60
        temperature_rating = 1450
        elsif  pressure > 60 and pressure <= 95 
        flange_class = "900"
        pressure_rating = 95
        temperature_rating = 1450
        elsif  pressure > 95 and pressure <= 155 
        flange_class = "1500"
        pressure_rating = 155
        temperature_rating = 1450
        elsif  pressure > 155 and pressure <= 255 
        flange_class = "2500"
        pressure_rating = 255
        temperature_rating = 1450
        
        end
    elsif temperature > 1450 and temperature <= 1500 
        if pressure > 25 
        flange_class = "300"
        pressure_rating = 25
        temperature_rating = 1500
        elsif  pressure > 25 and pressure <= 35 
        flange_class = "400"
        pressure_rating = 35
        temperature_rating = 1500
        elsif  pressure > 35 and pressure <= 55 
        flange_class = "600"
        pressure_rating = 55
        temperature_rating = 1500
        elsif  pressure > 55 and pressure <= 80 
        flange_class = "900"
        pressure_rating = 80
        temperature_rating = 1500
        elsif  pressure > 80 and pressure <= 135 
        flange_class = "1500"
        pressure_rating = 135
        temperature_rating = 1500
        elsif  pressure > 135 and pressure <= 230 
        flange_class = "2500"
        pressure_rating = 230
        temperature_rating = 1500
        
        end
    
    end
    
    if Worksheets("UOM").chkCustomary.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) At temperatures over 1000\B0F, use only when the carbon content is 0.04% or higher."
    elsif orksheets("UOM").chkSI.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) At temperatures over 538\B0C, use only when the carbon content is 0.04% or higher."
    
    end
    
elsif material_group = "2.12" 
UserFormLineSegmentDesign.cmbMaterialDesignation.RowSource = "MaterialGroup2.12"
    if temperature >= -20 and temperature <= 100 
        if pressure <= 260 
        flange_class = "150"
        pressure_rating = 260
        temperature_rating = 100
        elsif  pressure > 260 and pressure <= 670 
        flange_class = "300"
        pressure_rating = 670
        temperature_rating = 100
        elsif  pressure > 670 and pressure <= 895 
        flange_class = "400"
        pressure_rating = 895
        temperature_rating = 100
        elsif  pressure > 895 and pressure <= 1345 
        flange_class = "600"
        pressure_rating = 1345
        temperature_rating = 100
        elsif  pressure > 1345 and pressure <= 2015 
        flange_class = "900"
        pressure_rating = 2015
        temperature_rating = 100
        elsif  pressure > 2015 and pressure <= 3360 
        flange_class = "1500"
        pressure_rating = 3360
        temperature_rating = 100
        elsif  pressure > 3360 and pressure <= 5600 
        flange_class = "2500"
        pressure_rating = 5600
        temperature_rating = 100
        
        end
    elsif temperature > 100 and temperature <= 200 
        if pressure <= 210 
        flange_class = "150"
        pressure_rating = 210
        temperature_rating = 200
        elsif  pressure > 210 and pressure <= 550 
        flange_class = "300"
        pressure_rating = 550
        temperature_rating = 200
        elsif  pressure > 550 and pressure <= 735 
        flange_class = "400"
        pressure_rating = 735
        temperature_rating = 200
        elsif  pressure > 735 and pressure <= 1100 
        flange_class = "600"
        pressure_rating = 1100
        temperature_rating = 200
        elsif  pressure > 1100 and pressure <= 1650 
        flange_class = "900"
        pressure_rating = 1650
        temperature_rating = 200
        elsif  pressure > 1650 and pressure <= 2750 
        flange_class = "1500"
        pressure_rating = 2750
        temperature_rating = 200
        elsif  pressure > 2750 and pressure <= 4580 
        flange_class = "2500"
        pressure_rating = 4580
        temperature_rating = 200
        
        end
    elsif temperature > 200 and temperature <= 300 
        if pressure <= 195 
        flange_class = "150"
        pressure_rating = 195
        temperature_rating = 300
        elsif  pressure > 195 and pressure <= 505 
        flange_class = "300"
        pressure_rating = 505
        temperature_rating = 300
        elsif  pressure > 505 and pressure <= 675 
        flange_class = "400"
        pressure_rating = 675
        temperature_rating = 300
        elsif  pressure > 675 and pressure <= 1015 
        flange_class = "600"
        pressure_rating = 1015
        temperature_rating = 300
        elsif  pressure > 1015 and pressure <= 1520 
        flange_class = "900"
        pressure_rating = 1520
        temperature_rating = 300
        elsif  pressure > 1520 and pressure <= 2530 
        flange_class = "1500"
        pressure_rating = 2530
        temperature_rating = 300
        elsif  pressure > 2530 and pressure <= 4220 
        flange_class = "2500"
        pressure_rating = 4220
        temperature_rating = 300
        
        end
    elsif temperature > 300 and temperature <= 400 
        if pressure <= 185 
        flange_class = "150"
        pressure_rating = 185
        temperature_rating = 400
        elsif  pressure > 185 and pressure <= 485 
        flange_class = "300"
        pressure_rating = 485
        temperature_rating = 400
        elsif  pressure > 485 and pressure <= 645 
        flange_class = "400"
        pressure_rating = 645
        temperature_rating = 400
        elsif  pressure > 645 and pressure <= 970 
        flange_class = "600"
        pressure_rating = 970
        temperature_rating = 400
        elsif  pressure > 970 and pressure <= 1455 
        flange_class = "900"
        pressure_rating = 1455
        temperature_rating = 400
        elsif  pressure > 1455 and pressure <= 2425 
        flange_class = "1500"
        pressure_rating = 2425
        temperature_rating = 400
        elsif  pressure > 2425 and pressure <= 4040 
        flange_class = "2500"
        pressure_rating = 4040
        temperature_rating = 400
        
        end
    elsif temperature > 400 and temperature <= 500 
        if pressure <= 170 
        flange_class = "150"
        pressure_rating = 170
        temperature_rating = 500
        elsif  pressure > 170 and pressure <= 470 
        flange_class = "300"
        pressure_rating = 470
        temperature_rating = 500
        elsif  pressure > 470 and pressure <= 625 
        flange_class = "400"
        pressure_rating = 625
        temperature_rating = 500
        elsif  pressure > 625 and pressure <= 940 
        flange_class = "600"
        pressure_rating = 940
        temperature_rating = 500
        elsif  pressure > 940 and pressure <= 1410 
        flange_class = "900"
        pressure_rating = 1410
        temperature_rating = 500
        elsif  pressure > 1410 and pressure <= 2350 
        flange_class = "1500"
        pressure_rating = 2350
        temperature_rating = 500
        elsif  pressure > 2350 and pressure <= 3920 
        flange_class = "2500"
        pressure_rating = 3920
        temperature_rating = 500
        
        end
    elsif temperature > 500 and temperature <= 600 
        if pressure <= 140 
        flange_class = "150"
        pressure_rating = 140
        temperature_rating = 600
        elsif  pressure > 140 and pressure <= 455 
        flange_class = "300"
        pressure_rating = 455
        temperature_rating = 600
        elsif  pressure > 455 and pressure <= 610 
        flange_class = "400"
        pressure_rating = 610
        temperature_rating = 600
        elsif  pressure > 610 and pressure <= 910 
        flange_class = "600"
        pressure_rating = 910
        temperature_rating = 600
        elsif  pressure > 910 and pressure <= 1370 
        flange_class = "900"
        pressure_rating = 1370
        temperature_rating = 600
        elsif  pressure > 1370 and pressure <= 2280 
        flange_class = "1500"
        pressure_rating = 2280
        temperature_rating = 600
        elsif  pressure > 2280 and pressure <= 3800 
        flange_class = "2500"
        pressure_rating = 3800
        temperature_rating = 600
        
        end
    elsif temperature > 600 and temperature <= 650 
        if pressure <= 125 
        flange_class = "150"
        pressure_rating = 125
        temperature_rating = 650
        elsif  pressure > 125 and pressure <= 445 
        flange_class = "300"
        pressure_rating = 445
        temperature_rating = 650
        elsif  pressure > 445 and pressure <= 595 
        flange_class = "400"
        pressure_rating = 595
        temperature_rating = 650
        elsif  pressure > 595 and pressure <= 895 
        flange_class = "600"
        pressure_rating = 895
        temperature_rating = 650
        elsif  pressure > 895 and pressure <= 1340 
        flange_class = "900"
        pressure_rating = 1340
        temperature_rating = 650
        elsif  pressure > 1340 and pressure <= 2230 
        flange_class = "1500"
        pressure_rating = 2230
        temperature_rating = 650
        elsif  pressure > 2230 and pressure <= 3720 
        flange_class = "2500"
        pressure_rating = 3720
        temperature_rating = 650
        
        end
    elsif temperature > 650 and temperature <= 700 
        if pressure <= 110 
        flange_class = "150"
        pressure_rating = 110
        temperature_rating = 700
        elsif  pressure > 110 and pressure <= 435 
        flange_class = "300"
        pressure_rating = 435
        temperature_rating = 700
        elsif  pressure > 435 and pressure <= 580 
        flange_class = "400"
        pressure_rating = 580
        temperature_rating = 700
        elsif  pressure > 580 and pressure <= 870 
        flange_class = "600"
        pressure_rating = 870
        temperature_rating = 700
        elsif  pressure > 870 and pressure <= 1305 
        flange_class = "900"
        pressure_rating = 1305
        temperature_rating = 700
        elsif  pressure > 1305 and pressure <= 2170 
        flange_class = "1500"
        pressure_rating = 2170
        temperature_rating = 700
        elsif  pressure > 2170 and pressure <= 3620 
        flange_class = "2500"
        pressure_rating = 3620
        temperature_rating = 700
        
        end
    elsif temperature > 700 and temperature <= 750 
        if pressure <= 95 
        flange_class = "150"
        pressure_rating = 95
        temperature_rating = 750
        elsif  pressure > 95 and pressure <= 420 
        flange_class = "300"
        pressure_rating = 420
        temperature_rating = 750
        elsif  pressure > 420 and pressure <= 565 
        flange_class = "400"
        pressure_rating = 565
        temperature_rating = 750
        elsif  pressure > 565 and pressure <= 845 
        flange_class = "600"
        pressure_rating = 845
        temperature_rating = 750
        elsif  pressure > 845 and pressure <= 1265 
        flange_class = "900"
        pressure_rating = 1265
        temperature_rating = 750
        elsif  pressure > 1265 and pressure <= 2110 
        flange_class = "1500"
        pressure_rating = 2110
        temperature_rating = 750
        elsif  pressure > 2110 and pressure <= 3520 
        flange_class = "2500"
        pressure_rating = 3520
        temperature_rating = 750
        
        end
    elsif temperature > 750 and temperature <= 800 
        if pressure <= 80 
        flange_class = "150"
        pressure_rating = 80
        temperature_rating = 800
        elsif  pressure > 80 and pressure <= 410 
        flange_class = "300"
        pressure_rating = 410
        temperature_rating = 800
        elsif  pressure > 410 and pressure <= 545 
        flange_class = "400"
        pressure_rating = 545
        temperature_rating = 800
        elsif  pressure > 545 and pressure <= 820 
        flange_class = "600"
        pressure_rating = 820
        temperature_rating = 800
        elsif  pressure > 820 and pressure <= 1230 
        flange_class = "900"
        pressure_rating = 1230
        temperature_rating = 800
        elsif  pressure > 1230 and pressure <= 2050 
        flange_class = "1500"
        pressure_rating = 2050
        temperature_rating = 800
        elsif  pressure > 2050 and pressure <= 3420 
        flange_class = "2500"
        pressure_rating = 3420
        temperature_rating = 800
        
        end
    elsif temperature > 800 and temperature <= 850 
        if pressure <= 65 
        flange_class = "150"
        pressure_rating = 65
        temperature_rating = 850
        elsif  pressure > 65 and pressure <= 400 
        flange_class = "300"
        pressure_rating = 400
        temperature_rating = 850
        elsif  pressure > 400 and pressure <= 530 
        flange_class = "400"
        pressure_rating = 530
        temperature_rating = 850
        elsif  pressure > 530 and pressure <= 795 
        flange_class = "600"
        pressure_rating = 795
        temperature_rating = 850
        elsif  pressure > 795 and pressure <= 1195 
        flange_class = "900"
        pressure_rating = 1195
        temperature_rating = 850
        elsif  pressure > 1195 and pressure <= 1990 
        flange_class = "1500"
        pressure_rating = 1990
        temperature_rating = 850
        elsif  pressure > 1990 and pressure <= 3320 
        flange_class = "2500"
        pressure_rating = 3320
        temperature_rating = 850
        
        end
    elsif temperature > 850 and temperature <= 900 
        if pressure <= 50 
        flange_class = "150"
        pressure_rating = 50
        temperature_rating = 900
        elsif  pressure > 50 and pressure <= 385 
        flange_class = "300"
        pressure_rating = 385
        temperature_rating = 900
        elsif  pressure > 385 and pressure <= 510 
        flange_class = "400"
        pressure_rating = 510
        temperature_rating = 900
        elsif  pressure > 510 and pressure <= 770 
        flange_class = "600"
        pressure_rating = 770
        temperature_rating = 900
        elsif  pressure > 770 and pressure <= 1150 
        flange_class = "900"
        pressure_rating = 1150
        temperature_rating = 900
        elsif  pressure > 1150 and pressure <= 1920 
        flange_class = "1500"
        pressure_rating = 1920
        temperature_rating = 900
        elsif  pressure > 1920 and pressure <= 3200 
        flange_class = "2500"
        pressure_rating = 3200
        temperature_rating = 900
        
        end
    elsif temperature > 900 and temperature <= 950 
        if pressure <= 35 
        flange_class = "150"
        pressure_rating = 35
        temperature_rating = 950
        elsif  pressure > 35 and pressure <= 370 
        flange_class = "300"
        pressure_rating = 370
        temperature_rating = 950
        elsif  pressure > 370 and pressure <= 495 
        flange_class = "400"
        pressure_rating = 495
        temperature_rating = 950
        elsif  pressure > 495 and pressure <= 740 
        flange_class = "600"
        pressure_rating = 740
        temperature_rating = 950
        elsif  pressure > 740 and pressure <= 1110 
        flange_class = "900"
        pressure_rating = 1110
        temperature_rating = 950
        elsif  pressure > 1110 and pressure <= 1850 
        flange_class = "1500"
        pressure_rating = 1850
        temperature_rating = 950
        elsif  pressure > 1850 and pressure <= 3080 
        flange_class = "2500"
        pressure_rating = 3080
        temperature_rating = 950
        
        end
    elsif temperature > 950 and temperature <= 1000 
        if pressure <= 20 
        flange_class = "150"
        pressure_rating = 20
        temperature_rating = 1000
        elsif  pressure > 20 and pressure <= 340 
        flange_class = "300"
        pressure_rating = 340
        temperature_rating = 1000
        elsif  pressure > 340 and pressure <= 450 
        flange_class = "400"
        pressure_rating = 450
        temperature_rating = 1000
        elsif  pressure > 450 and pressure <= 675 
        flange_class = "600"
        pressure_rating = 675
        temperature_rating = 1000
        elsif  pressure > 675 and pressure <= 1015 
        flange_class = "900"
        pressure_rating = 1015
        temperature_rating = 1000
        elsif  pressure > 1015 and pressure <= 1690 
        flange_class = "1500"
        pressure_rating = 1690
        temperature_rating = 1000
        elsif  pressure > 1690 and pressure <= 2820 
        flange_class = "2500"
        pressure_rating = 2820
        temperature_rating = 1000
        
        end
    elsif temperature > 1000 and temperature <= 1050 
        if pressure > 325 
        flange_class = "300"
        pressure_rating = 325
        temperature_rating = 1050
        elsif  pressure > 325 and pressure <= 435 
        flange_class = "400"
        pressure_rating = 435
        temperature_rating = 1050
        elsif  pressure > 435 and pressure <= 650 
        flange_class = "600"
        pressure_rating = 650
        temperature_rating = 1050
        elsif  pressure > 650 and pressure <= 975 
        flange_class = "900"
        pressure_rating = 975
        temperature_rating = 1050
        elsif  pressure > 975 and pressure <= 1630 
        flange_class = "1500"
        pressure_rating = 1630
        temperature_rating = 1050
        elsif  pressure > 1630 and pressure <= 2715 
        flange_class = "2500"
        pressure_rating = 2715
        temperature_rating = 1050
        
        end
    elsif temperature > 1050 and temperature <= 1100 
        if pressure > 290 
        flange_class = "300"
        pressure_rating = 290
        temperature_rating = 1100
        elsif  pressure > 290 and pressure <= 390 
        flange_class = "400"
        pressure_rating = 390
        temperature_rating = 1100
        elsif  pressure > 390 and pressure <= 585 
        flange_class = "600"
        pressure_rating = 585
        temperature_rating = 1100
        elsif  pressure > 585 and pressure <= 875 
        flange_class = "900"
        pressure_rating = 875
        temperature_rating = 1100
        elsif  pressure > 875 and pressure <= 1455 
        flange_class = "1500"
        pressure_rating = 1455
        temperature_rating = 1100
        elsif  pressure > 1455 and pressure <= 2430 
        flange_class = "2500"
        pressure_rating = 2430
        temperature_rating = 1100
        
        end
    elsif temperature > 1100 and temperature <= 1150 
        if pressure > 250 
        flange_class = "300"
        pressure_rating = 250
        temperature_rating = 1150
        elsif  pressure > 250 and pressure <= 335 
        flange_class = "400"
        pressure_rating = 335
        temperature_rating = 1150
        elsif  pressure > 335 and pressure <= 500 
        flange_class = "600"
        pressure_rating = 500
        temperature_rating = 1150
        elsif  pressure > 500 and pressure <= 750 
        flange_class = "900"
        pressure_rating = 750
        temperature_rating = 1150
        elsif  pressure > 750 and pressure <= 1250 
        flange_class = "1500"
        pressure_rating = 1250
        temperature_rating = 1150
        elsif  pressure > 1250 and pressure <= 2085 
        flange_class = "2500"
        pressure_rating = 2085
        temperature_rating = 1150
        
        end
    elsif temperature > 1150 and temperature <= 1200 
        if pressure > 205 
        flange_class = "300"
        pressure_rating = 205
        temperature_rating = 1200
        elsif  pressure > 205 and pressure <= 275 
        flange_class = "400"
        pressure_rating = 275
        temperature_rating = 1200
        elsif  pressure > 275 and pressure <= 410 
        flange_class = "600"
        pressure_rating = 410
        temperature_rating = 1200
        elsif  pressure > 410 and pressure <= 615 
        flange_class = "900"
        pressure_rating = 615
        temperature_rating = 1200
        elsif  pressure > 615 and pressure <= 1030 
        flange_class = "1500"
        pressure_rating = 1030
        temperature_rating = 1200
        elsif  pressure > 1030 and pressure <= 1715 
        flange_class = "2500"
        pressure_rating = 1715
        temperature_rating = 1200
        
        end
    elsif temperature > 1200 and temperature <= 1250 
        if pressure > 165 
        flange_class = "300"
        pressure_rating = 165
        temperature_rating = 1250
        elsif  pressure > 165 and pressure <= 220 
        flange_class = "400"
        pressure_rating = 220
        temperature_rating = 1250
        elsif  pressure > 220 and pressure <= 330 
        flange_class = "600"
        pressure_rating = 330
        temperature_rating = 1250
        elsif  pressure > 330 and pressure <= 495 
        flange_class = "900"
        pressure_rating = 495
        temperature_rating = 1250
        elsif  pressure > 495 and pressure <= 825 
        flange_class = "1500"
        pressure_rating = 825
        temperature_rating = 1250
        elsif  pressure > 825 and pressure <= 1370 
        flange_class = "2500"
        pressure_rating = 1370
        temperature_rating = 1250
        
        end
    elsif temperature > 1250 and temperature <= 1300 
        if pressure > 120 
        flange_class = "300"
        pressure_rating = 120
        temperature_rating = 1300
        elsif  pressure > 120 and pressure <= 160 
        flange_class = "400"
        pressure_rating = 160
        temperature_rating = 1300
        elsif  pressure > 160 and pressure <= 240 
        flange_class = "600"
        pressure_rating = 240
        temperature_rating = 1300
        elsif  pressure > 240 and pressure <= 360 
        flange_class = "900"
        pressure_rating = 360
        temperature_rating = 1300
        elsif  pressure > 360 and pressure <= 600 
        flange_class = "1500"
        pressure_rating = 600
        temperature_rating = 1300
        elsif  pressure > 600 and pressure <= 1000 
        flange_class = "2500"
        pressure_rating = 1000
        temperature_rating = 1300
        
        end
    elsif temperature > 1300 and temperature <= 1350 
        if pressure > 80 
        flange_class = "300"
        pressure_rating = 80
        temperature_rating = 1350
        elsif  pressure > 80 and pressure <= 110 
        flange_class = "400"
        pressure_rating = 110
        temperature_rating = 1350
        elsif  pressure > 110 and pressure <= 165 
        flange_class = "600"
        pressure_rating = 165
        temperature_rating = 1350
        elsif  pressure > 165 and pressure <= 245 
        flange_class = "900"
        pressure_rating = 245
        temperature_rating = 1350
        elsif  pressure > 245 and pressure <= 410 
        flange_class = "1500"
        pressure_rating = 410
        temperature_rating = 1350
        elsif  pressure > 410 and pressure <= 685 
        flange_class = "2500"
        pressure_rating = 685
        temperature_rating = 1350
        
        end
    elsif temperature > 1350 and temperature <= 1400 
        if pressure > 55 
        flange_class = "300"
        pressure_rating = 55
        temperature_rating = 1400
        elsif  pressure > 55 and pressure <= 75 
        flange_class = "400"
        pressure_rating = 75
        temperature_rating = 1400
        elsif  pressure > 75 and pressure <= 110 
        flange_class = "600"
        pressure_rating = 110
        temperature_rating = 1400
        elsif  pressure > 110 and pressure <= 165 
        flange_class = "900"
        pressure_rating = 165
        temperature_rating = 1400
        elsif  pressure > 165 and pressure <= 275 
        flange_class = "1500"
        pressure_rating = 275
        temperature_rating = 1150
        elsif  pressure > 275 and pressure <= 455 
        flange_class = "2500"
        pressure_rating = 455
        temperature_rating = 1400
        
        end
    elsif temperature > 1400 and temperature <= 1450 
        if pressure > 40 
        flange_class = "300"
        pressure_rating = 40
        temperature_rating = 1450
        elsif  pressure > 40 and pressure <= 50 
        flange_class = "400"
        pressure_rating = 50
        temperature_rating = 1450
        elsif  pressure > 50 and pressure <= 75 
        flange_class = "600"
        pressure_rating = 75
        temperature_rating = 1450
        elsif  pressure > 75 and pressure <= 115 
        flange_class = "900"
        pressure_rating = 115
        temperature_rating = 1450
        elsif  pressure > 115 and pressure <= 190 
        flange_class = "1500"
        pressure_rating = 190
        temperature_rating = 1450
        elsif  pressure > 190 and pressure <= 315 
        flange_class = "2500"
        pressure_rating = 315
        temperature_rating = 1450
        
        end
    elsif temperature > 1450 and temperature <= 1500 
        if pressure > 25 
        flange_class = "300"
        pressure_rating = 25
        temperature_rating = 1500
        elsif  pressure > 25 and pressure <= 35 
        flange_class = "400"
        pressure_rating = 35
        temperature_rating = 1500
        elsif  pressure > 35 and pressure <= 55 
        flange_class = "600"
        pressure_rating = 55
        temperature_rating = 1500
        elsif  pressure > 55 and pressure <= 80 
        flange_class = "900"
        pressure_rating = 80
        temperature_rating = 1500
        elsif  pressure > 80 and pressure <= 135 
        flange_class = "1500"
        pressure_rating = 135
        temperature_rating = 1500
        elsif  pressure > 135 and pressure <= 230 
        flange_class = "2500"
        pressure_rating = 230
        temperature_rating = 1500
        
        end
    
    end
    
    if Worksheets("UOM").chkCustomary.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) At temperatures over 1000\B0F, use only when the carbon content is 0.04% or higher."
    elsif orksheets("UOM").chkSI.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) At temperatures over 538\B0C, use only when the carbon content is 0.04% or higher."
    
    end
    
elsif material_group = "3.1" 
UserFormLineSegmentDesign.cmbMaterialDesignation.RowSource = "MaterialGroup3.1"
    if temperature >= -20 and temperature <= 100 
        if pressure <= 290 
        flange_class = "150"
        pressure_rating = 290
        temperature_rating = 100
        elsif  pressure > 290 and pressure <= 750 
        flange_class = "300"
        pressure_rating = 750
        temperature_rating = 100
        elsif  pressure > 750 and pressure <= 1000 
        flange_class = "400"
        pressure_rating = 1000
        temperature_rating = 100
        elsif  pressure > 1000 and pressure <= 1500 
        flange_class = "600"
        pressure_rating = 1500
        temperature_rating = 100
        elsif  pressure > 1500 and pressure <= 2250 
        flange_class = "900"
        pressure_rating = 2250
        temperature_rating = 100
        elsif  pressure > 2250 and pressure <= 3750 
        flange_class = "1500"
        pressure_rating = 3750
        temperature_rating = 100
        elsif  pressure > 3750 and pressure <= 6250 
        flange_class = "2500"
        pressure_rating = 6250
        temperature_rating = 100
        
        end
    elsif temperature > 100 and temperature <= 200 
        if pressure <= 260 
        flange_class = "150"
        pressure_rating = 260
        temperature_rating = 200
        elsif  pressure > 260 and pressure <= 740 
        flange_class = "300"
        pressure_rating = 740
        temperature_rating = 200
        elsif  pressure > 740 and pressure <= 990 
        flange_class = "400"
        pressure_rating = 990
        temperature_rating = 200
        elsif  pressure > 990 and pressure <= 1485 
        flange_class = "600"
        pressure_rating = 1485
        temperature_rating = 200
        elsif  pressure > 1485 and pressure <= 2225 
        flange_class = "900"
        pressure_rating = 2225
        temperature_rating = 200
        elsif  pressure > 2225 and pressure <= 3710 
        flange_class = "1500"
        pressure_rating = 3710
        temperature_rating = 200
        elsif  pressure > 3710 and pressure <= 6180 
        flange_class = "2500"
        pressure_rating = 6180
        temperature_rating = 200
        
        end
    elsif temperature > 200 and temperature <= 300 
        if pressure <= 230 
        flange_class = "150"
        pressure_rating = 230
        temperature_rating = 300
        elsif  pressure > 230 and pressure <= 710 
        flange_class = "300"
        pressure_rating = 710
        temperature_rating = 300
        elsif  pressure > 710 and pressure <= 945 
        flange_class = "400"
        pressure_rating = 945
        temperature_rating = 300
        elsif  pressure > 945 and pressure <= 1420 
        flange_class = "600"
        pressure_rating = 1420
        temperature_rating = 300
        elsif  pressure > 1420 and pressure <= 2130 
        flange_class = "900"
        pressure_rating = 2130
        temperature_rating = 300
        elsif  pressure > 2130 and pressure <= 3550 
        flange_class = "1500"
        pressure_rating = 3550
        temperature_rating = 300
        elsif  pressure > 3550 and pressure <= 5920 
        flange_class = "2500"
        pressure_rating = 5920
        temperature_rating = 300
        
        end
    elsif temperature > 300 and temperature <= 400 
        if pressure <= 200 
        flange_class = "150"
        pressure_rating = 200
        temperature_rating = 400
        elsif  pressure > 200 and pressure <= 680 
        flange_class = "300"
        pressure_rating = 680
        temperature_rating = 400
        elsif  pressure > 680 and pressure <= 910 
        flange_class = "400"
        pressure_rating = 910
        temperature_rating = 400
        elsif  pressure > 910 and pressure <= 1365 
        flange_class = "600"
        pressure_rating = 1365
        temperature_rating = 400
        elsif  pressure > 1365 and pressure <= 2045 
        flange_class = "900"
        pressure_rating = 2045
        temperature_rating = 400
        elsif  pressure > 2045 and pressure <= 3410 
        flange_class = "1500"
        pressure_rating = 3410
        temperature_rating = 400
        elsif  pressure > 3410 and pressure <= 5680 
        flange_class = "2500"
        pressure_rating = 5680
        temperature_rating = 400
        
        end
    elsif temperature > 400 and temperature <= 500 
        if pressure <= 170 
        flange_class = "150"
        pressure_rating = 170
        temperature_rating = 500
        elsif  pressure > 170 and pressure <= 655 
        flange_class = "300"
        pressure_rating = 655
        temperature_rating = 500
        elsif  pressure > 655 and pressure <= 875 
        flange_class = "400"
        pressure_rating = 875
        temperature_rating = 500
        elsif  pressure > 875 and pressure <= 1310 
        flange_class = "600"
        pressure_rating = 1310
        temperature_rating = 500
        elsif  pressure > 1310 and pressure <= 1965 
        flange_class = "900"
        pressure_rating = 1965
        temperature_rating = 500
        elsif  pressure > 1965 and pressure <= 3275 
        flange_class = "1500"
        pressure_rating = 3275
        temperature_rating = 500
        elsif  pressure > 3275 and pressure <= 5460 
        flange_class = "2500"
        pressure_rating = 5460
        temperature_rating = 500
        
        end
    elsif temperature > 500 and temperature <= 600 
        if pressure <= 140 
        flange_class = "150"
        pressure_rating = 140
        temperature_rating = 600
        elsif  pressure > 140 and pressure <= 605 
        flange_class = "300"
        pressure_rating = 605
        temperature_rating = 600
        elsif  pressure > 605 and pressure <= 805 
        flange_class = "400"
        pressure_rating = 805
        temperature_rating = 600
        elsif  pressure > 805 and pressure <= 1210 
        flange_class = "600"
        pressure_rating = 1210
        temperature_rating = 600
        elsif  pressure > 1210 and pressure <= 1815 
        flange_class = "900"
        pressure_rating = 1815
        temperature_rating = 600
        elsif  pressure > 1815 and pressure <= 3025 
        flange_class = "1500"
        pressure_rating = 3025
        temperature_rating = 600
        elsif  pressure > 3025 and pressure <= 5040 
        flange_class = "2500"
        pressure_rating = 5040
        temperature_rating = 600
        
        end
    elsif temperature > 600 and temperature <= 650 
        if pressure <= 125 
        flange_class = "150"
        pressure_rating = 125
        temperature_rating = 650
        elsif  pressure > 125 and pressure <= 590 
        flange_class = "300"
        pressure_rating = 590
        temperature_rating = 650
        elsif  pressure > 590 and pressure <= 785 
        flange_class = "400"
        pressure_rating = 785
        temperature_rating = 650
        elsif  pressure > 785 and pressure <= 1175 
        flange_class = "600"
        pressure_rating = 1175
        temperature_rating = 650
        elsif  pressure > 1175 and pressure <= 1765 
        flange_class = "900"
        pressure_rating = 1765
        temperature_rating = 650
        elsif  pressure > 1765 and pressure <= 2940 
        flange_class = "1500"
        pressure_rating = 2940
        temperature_rating = 650
        elsif  pressure > 2940 and pressure <= 4905 
        flange_class = "2500"
        pressure_rating = 4905
        temperature_rating = 650
        
        end
    elsif temperature > 650 and temperature <= 700 
        if pressure <= 110 
        flange_class = "150"
        pressure_rating = 110
        temperature_rating = 700
        elsif  pressure > 110 and pressure <= 570 
        flange_class = "300"
        pressure_rating = 570
        temperature_rating = 700
        elsif  pressure > 570 and pressure <= 755 
        flange_class = "400"
        pressure_rating = 755
        temperature_rating = 700
        elsif  pressure > 755 and pressure <= 1135 
        flange_class = "600"
        pressure_rating = 1135
        temperature_rating = 700
        elsif  pressure > 1135 and pressure <= 1705 
        flange_class = "900"
        pressure_rating = 1705
        temperature_rating = 700
        elsif  pressure > 1705 and pressure <= 2840 
        flange_class = "1500"
        pressure_rating = 2840
        temperature_rating = 700
        elsif  pressure > 2840 and pressure <= 4730 
        flange_class = "2500"
        pressure_rating = 4730
        temperature_rating = 700
        
        end
    elsif temperature > 700 and temperature <= 750 
        if pressure <= 95 
        flange_class = "150"
        pressure_rating = 95
        temperature_rating = 750
        elsif  pressure > 95 and pressure <= 530 
        flange_class = "300"
        pressure_rating = 530
        temperature_rating = 750
        elsif  pressure > 530 and pressure <= 710 
        flange_class = "400"
        pressure_rating = 710
        temperature_rating = 750
        elsif  pressure > 710 and pressure <= 1065 
        flange_class = "600"
        pressure_rating = 1065
        temperature_rating = 750
        elsif  pressure > 1065 and pressure <= 1595 
        flange_class = "900"
        pressure_rating = 1595
        temperature_rating = 750
        elsif  pressure > 1595 and pressure <= 2660 
        flange_class = "1500"
        pressure_rating = 2660
        temperature_rating = 750
        elsif  pressure > 2660 and pressure <= 4430 
        flange_class = "2500"
        pressure_rating = 4430
        temperature_rating = 750
        
        end
    elsif temperature > 750 and temperature <= 800 
        if pressure <= 80 
        flange_class = "150"
        pressure_rating = 80
        temperature_rating = 800
        elsif  pressure > 80 and pressure <= 510 
        flange_class = "300"
        pressure_rating = 510
        temperature_rating = 800
        elsif  pressure > 510 and pressure <= 675 
        flange_class = "400"
        pressure_rating = 675
        temperature_rating = 800
        elsif  pressure > 675 and pressure <= 1015 
        flange_class = "600"
        pressure_rating = 1015
        temperature_rating = 800
        elsif  pressure > 1015 and pressure <= 1525 
        flange_class = "900"
        pressure_rating = 1525
        temperature_rating = 800
        elsif  pressure > 1525 and pressure <= 2540 
        flange_class = "1500"
        pressure_rating = 2540
        temperature_rating = 800
        elsif  pressure > 2540 and pressure <= 4230 
        flange_class = "2500"
        pressure_rating = 4230
        temperature_rating = 800
        
        end
    
    end
    
    if Worksheets("UOM").chkCustomary.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) Use annealed material only."
    elsif orksheets("UOM").chkSI.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) Use annealed material only."
    
    end
    
elsif material_group = "3.2" 
UserFormLineSegmentDesign.cmbMaterialDesignation.RowSource = "MaterialGroup3.2"
    if temperature >= -20 and temperature <= 100 
        if pressure <= 185 
        flange_class = "150"
        pressure_rating = 185
        temperature_rating = 100
        elsif  pressure > 185 and pressure <= 480 
        flange_class = "300"
        pressure_rating = 480
        temperature_rating = 100
        elsif  pressure > 480 and pressure <= 640 
        flange_class = "400"
        pressure_rating = 640
        temperature_rating = 100
        elsif  pressure > 640 and pressure <= 960 
        flange_class = "600"
        pressure_rating = 960
        temperature_rating = 100
        elsif  pressure > 960 and pressure <= 1440 
        flange_class = "900"
        pressure_rating = 1440
        temperature_rating = 100
        elsif  pressure > 1440 and pressure <= 2400 
        flange_class = "1500"
        pressure_rating = 2400
        temperature_rating = 100
        elsif  pressure > 2400 and pressure <= 4000 
        flange_class = "2500"
        pressure_rating = 4000
        temperature_rating = 100
        
        end
    elsif temperature > 100 and temperature <= 200 
        if pressure <= 185 
        flange_class = "150"
        pressure_rating = 185
        temperature_rating = 200
        elsif  pressure > 185 and pressure <= 480 
        flange_class = "300"
        pressure_rating = 480
        temperature_rating = 200
        elsif  pressure > 480 and pressure <= 640 
        flange_class = "400"
        pressure_rating = 640
        temperature_rating = 200
        elsif  pressure > 640 and pressure <= 960 
        flange_class = "600"
        pressure_rating = 960
        temperature_rating = 200
        elsif  pressure > 960 and pressure <= 1440 
        flange_class = "900"
        pressure_rating = 1440
        temperature_rating = 200
        elsif  pressure > 1440 and pressure <= 2400 
        flange_class = "1500"
        pressure_rating = 2400
        temperature_rating = 200
        elsif  pressure > 2400 and pressure <= 4000 
        flange_class = "2500"
        pressure_rating = 4000
        temperature_rating = 200
        
        end
    elsif temperature > 200 and temperature <= 300 
        if pressure <= 185 
        flange_class = "150"
        pressure_rating = 185
        temperature_rating = 300
        elsif  pressure > 185 and pressure <= 480 
        flange_class = "300"
        pressure_rating = 480
        temperature_rating = 300
        elsif  pressure > 480 and pressure <= 640 
        flange_class = "400"
        pressure_rating = 640
        temperature_rating = 300
        elsif  pressure > 640 and pressure <= 960 
        flange_class = "600"
        pressure_rating = 960
        temperature_rating = 300
        elsif  pressure > 960 and pressure <= 1440 
        flange_class = "900"
        pressure_rating = 1440
        temperature_rating = 300
        elsif  pressure > 1440 and pressure <= 2400 
        flange_class = "1500"
        pressure_rating = 2400
        temperature_rating = 300
        elsif  pressure > 2400 and pressure <= 4000 
        flange_class = "2500"
        pressure_rating = 4000
        temperature_rating = 300
        
        end
    elsif temperature > 300 and temperature <= 400 
        if pressure <= 185 
        flange_class = "150"
        pressure_rating = 185
        temperature_rating = 400
        elsif  pressure > 185 and pressure <= 480 
        flange_class = "300"
        pressure_rating = 480
        temperature_rating = 400
        elsif  pressure > 480 and pressure <= 640 
        flange_class = "400"
        pressure_rating = 640
        temperature_rating = 400
        elsif  pressure > 640 and pressure <= 960 
        flange_class = "600"
        pressure_rating = 960
        temperature_rating = 400
        elsif  pressure > 960 and pressure <= 1440 
        flange_class = "900"
        pressure_rating = 1440
        temperature_rating = 400
        elsif  pressure > 1440 and pressure <= 2400 
        flange_class = "1500"
        pressure_rating = 2400
        temperature_rating = 400
        elsif  pressure > 2400 and pressure <= 4000 
        flange_class = "2500"
        pressure_rating = 4000
        temperature_rating = 400
        
        end
    elsif temperature > 400 and temperature <= 500 
        if pressure <= 170 
        flange_class = "150"
        pressure_rating = 170
        temperature_rating = 500
        elsif  pressure > 170 and pressure <= 455 
        flange_class = "300"
        pressure_rating = 455
        temperature_rating = 500
        elsif  pressure > 455 and pressure <= 605 
        flange_class = "400"
        pressure_rating = 605
        temperature_rating = 500
        elsif  pressure > 605 and pressure <= 905 
        flange_class = "600"
        pressure_rating = 905
        temperature_rating = 500
        elsif  pressure > 905 and pressure <= 1360 
        flange_class = "900"
        pressure_rating = 1360
        temperature_rating = 500
        elsif  pressure > 1360 and pressure <= 2270 
        flange_class = "1500"
        pressure_rating = 2270
        temperature_rating = 500
        elsif  pressure > 2270 and pressure <= 3780 
        flange_class = "2500"
        pressure_rating = 3780
        temperature_rating = 500
        
        end
    elsif temperature > 500 and temperature <= 600 
        if pressure <= 140 
        flange_class = "150"
        pressure_rating = 140
        temperature_rating = 600
        elsif  pressure > 140 and pressure <= 415 
        flange_class = "300"
        pressure_rating = 415
        temperature_rating = 600
        elsif  pressure > 415 and pressure <= 550 
        flange_class = "400"
        pressure_rating = 550
        temperature_rating = 600
        elsif  pressure > 550 and pressure <= 825 
        flange_class = "600"
        pressure_rating = 825
        temperature_rating = 600
        elsif  pressure > 825 and pressure <= 1240 
        flange_class = "900"
        pressure_rating = 1240
        temperature_rating = 600
        elsif  pressure > 1240 and pressure <= 2065 
        flange_class = "1500"
        pressure_rating = 2065
        temperature_rating = 600
        elsif  pressure > 2065 and pressure <= 3440 
        flange_class = "2500"
        pressure_rating = 3440
        temperature_rating = 600
        
        end
    
    end
    
    if Worksheets("UOM").chkCustomary.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) Use annealed material only." & Chr(13) _
    & "(2) The chemical composition, mechanical properties, heat treating requirements, and grain size requirements shall conform to the applicable ASTM specification. The manufacturing procedures, tolerances, tests, certification, and markings shall be in accordance with ASTM B 564."
    elsif orksheets("UOM").chkSI.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) Use annealed material only." & Chr(13) _
    & "(2) The chemical composition, mechanical properties, heat treating requirements, and grain size requirements shall conform to the applicable ASTM specification. The manufacturing procedures, tolerances, tests, certification, and markings shall be in accordance with ASTM B 564."
    
    flange_classd if
    pressure_ratingElse
Call FlangePressuretemperature_rating6(pressure, temperature, MaterialGroup, FlangeClass, PressureRating, temperature_rating)
flange_class if

pressure_ratingSub

Sub FlangePressuretemperature_rating6(pressure, temperature, MaterialGroup, FlangeClass, PressureRating, temperature_rating)

if MaterialGroup = "3.3" 
UserFormLineSegmentDesign.cmbMaterialDesignation.RowSource = "MaterialGroup3.3"
    if temperature >= -20 and temperature <= 100 
        if pressure <= 90 
        flange_class = "150"
        pressure_rating = 90
        temperature_rating = 100
        elsif  pressure > 90 and pressure <= 240 
        flange_class = "300"
        pressure_rating = 240
        temperature_rating = 100
        elsif  pressure > 240 and pressure <= 320 
        flange_class = "400"
        pressure_rating = 320
        temperature_rating = 100
        elsif  pressure > 320 and pressure <= 480 
        flange_class = "600"
        pressure_rating = 480
        temperature_rating = 100
        elsif  pressure > 480 and pressure <= 720 
        flange_class = "900"
        pressure_rating = 720
        temperature_rating = 100
        elsif  pressure > 720 and pressure <= 1200 
        flange_class = "1500"
        pressure_rating = 1200
        temperature_rating = 100
        elsif  pressure > 1200 and pressure <= 2000 
        flange_class = "2500"
        pressure_rating = 2000
        temperature_rating = 100
        
        end
    elsif temperature > 100 and temperature <= 200 
        if pressure <= 90 
        flange_class = "150"
        pressure_rating = 90
        temperature_rating = 200
        elsif  pressure > 90 and pressure <= 230 
        flange_class = "300"
        pressure_rating = 230
        temperature_rating = 200
        elsif  pressure > 230 and pressure <= 305 
        flange_class = "400"
        pressure_rating = 305
        temperature_rating = 200
        elsif  pressure > 305 and pressure <= 460 
        flange_class = "600"
        pressure_rating = 460
        temperature_rating = 200
        elsif  pressure > 460 and pressure <= 690 
        flange_class = "900"
        pressure_rating = 690
        temperature_rating = 200
        elsif  pressure > 690 and pressure <= 1150 
        flange_class = "1500"
        pressure_rating = 1150
        temperature_rating = 200
        elsif  pressure > 1150 and pressure <= 1920 
        flange_class = "2500"
        pressure_rating = 1920
        temperature_rating = 200
        
        end
    elsif temperature > 200 and temperature <= 300 
        if pressure <= 85 
        flange_class = "150"
        pressure_rating = 85
        temperature_rating = 300
        elsif  pressure > 85 and pressure <= 225 
        flange_class = "300"
        pressure_rating = 225
        temperature_rating = 300
        elsif  pressure > 225 and pressure <= 300 
        flange_class = "400"
        pressure_rating = 300
        temperature_rating = 300
        elsif  pressure > 300 and pressure <= 450 
        flange_class = "600"
        pressure_rating = 450
        temperature_rating = 300
        elsif  pressure > 450 and pressure <= 675 
        flange_class = "900"
        pressure_rating = 675
        temperature_rating = 300
        elsif  pressure > 675 and pressure <= 1130 
        flange_class = "1500"
        pressure_rating = 1130
        temperature_rating = 300
        elsif  pressure > 1130 and pressure <= 1880 
        flange_class = "2500"
        pressure_rating = 1880
        temperature_rating = 300
        
        end
    elsif temperature > 300 and temperature <= 400 
        if pressure <= 85 
        flange_class = "150"
        pressure_rating = 85
        temperature_rating = 400
        elsif  pressure > 85 and pressure <= 225 
        flange_class = "300"
        pressure_rating = 225
        temperature_rating = 400
        elsif  pressure > 225 and pressure <= 300 
        flange_class = "400"
        pressure_rating = 300
        temperature_rating = 400
        elsif  pressure > 300 and pressure <= 450 
        flange_class = "600"
        pressure_rating = 450
        temperature_rating = 400
        elsif  pressure > 450 and pressure <= 675 
        flange_class = "900"
        pressure_rating = 675
        temperature_rating = 400
        elsif  pressure > 675 and pressure <= 1130 
        flange_class = "1500"
        pressure_rating = 1130
        temperature_rating = 400
        elsif  pressure > 1130 and pressure <= 1880 
        flange_class = "2500"
        pressure_rating = 1880
        temperature_rating = 400
        
        end
    elsif temperature > 400 and temperature <= 500 
        if pressure <= 85 
        flange_class = "150"
        pressure_rating = 85
        temperature_rating = 500
        elsif  pressure > 85 and pressure <= 225 
        flange_class = "300"
        pressure_rating = 225
        temperature_rating = 500
        elsif  pressure > 225 and pressure <= 300 
        flange_class = "400"
        pressure_rating = 300
        temperature_rating = 500
        elsif  pressure > 300 and pressure <= 450 
        flange_class = "600"
        pressure_rating = 450
        temperature_rating = 500
        elsif  pressure > 450 and pressure <= 675 
        flange_class = "900"
        pressure_rating = 675
        temperature_rating = 500
        elsif  pressure > 675 and pressure <= 1130 
        flange_class = "1500"
        pressure_rating = 1130
        temperature_rating = 500
        elsif  pressure > 1130 and pressure <= 1880 
        flange_class = "2500"
        pressure_rating = 1880
        temperature_rating = 500
        
        end
    elsif temperature > 500 and temperature <= 600 
        if pressure <= 85 
        flange_class = "150"
        pressure_rating = 85
        temperature_rating = 600
        elsif  pressure > 85 and pressure <= 225 
        flange_class = "300"
        pressure_rating = 225
        temperature_rating = 600
        elsif  pressure > 225 and pressure <= 300 
        flange_class = "400"
        pressure_rating = 300
        temperature_rating = 600
        elsif  pressure > 300 and pressure <= 450 
        flange_class = "600"
        pressure_rating = 450
        temperature_rating = 600
        elsif  pressure > 450 and pressure <= 675 
        flange_class = "900"
        pressure_rating = 675
        temperature_rating = 600
        elsif  pressure > 675 and pressure <= 1130 
        flange_class = "1500"
        pressure_rating = 1130
        temperature_rating = 600
        elsif  pressure > 1130 and pressure <= 1880 
        flange_class = "2500"
        pressure_rating = 1880
        temperature_rating = 600
        
        end
    elsif temperature > 600 and temperature <= 650 
        if pressure <= 85 
        flange_class = "150"
        pressure_rating = 85
        temperature_rating = 650
        elsif  pressure > 85 and pressure <= 225 
        flange_class = "300"
        pressure_rating = 225
        temperature_rating = 650
        elsif  pressure > 225 and pressure <= 300 
        flange_class = "400"
        pressure_rating = 300
        temperature_rating = 650
        elsif  pressure > 300 and pressure <= 445 
        flange_class = "600"
        pressure_rating = 445
        temperature_rating = 650
        elsif  pressure > 445 and pressure <= 670 
        flange_class = "900"
        pressure_rating = 670
        temperature_rating = 650
        elsif  pressure > 670 and pressure <= 1115 
        flange_class = "1500"
        pressure_rating = 1115
        temperature_rating = 650
        elsif  pressure > 1115 and pressure <= 1860 
        flange_class = "2500"
        pressure_rating = 1860
        temperature_rating = 650
        
        end
    elsif temperature > 650 and temperature <= 700 
        if pressure <= 85 
        flange_class = "150"
        pressure_rating = 85
        temperature_rating = 700
        elsif  pressure > 85 and pressure <= 225 
        flange_class = "300"
        pressure_rating = 225
        temperature_rating = 700
        elsif  pressure > 225 and pressure <= 300 
        flange_class = "400"
        pressure_rating = 300
        temperature_rating = 700
        elsif  pressure > 300 and pressure <= 445 
        flange_class = "600"
        pressure_rating = 445
        temperature_rating = 700
        elsif  pressure > 445 and pressure <= 670 
        flange_class = "900"
        pressure_rating = 670
        temperature_rating = 700
        elsif  pressure > 670 and pressure <= 1115 
        flange_class = "1500"
        pressure_rating = 1115
        temperature_rating = 700
        elsif  pressure > 1115 and pressure <= 1860 
        flange_class = "2500"
        pressure_rating = 1860
        temperature_rating = 700
        
        end
    elsif temperature > 700 and temperature <= 750 
        if pressure <= 85 
        flange_class = "150"
        pressure_rating = 85
        temperature_rating = 750
        elsif  pressure > 85 and pressure <= 220 
        flange_class = "300"
        pressure_rating = 220
        temperature_rating = 750
        elsif  pressure > 220 and pressure <= 295 
        flange_class = "400"
        pressure_rating = 295
        temperature_rating = 750
        elsif  pressure > 295 and pressure <= 440 
        flange_class = "600"
        pressure_rating = 440
        temperature_rating = 750
        elsif  pressure > 440 and pressure <= 660 
        flange_class = "900"
        pressure_rating = 660
        temperature_rating = 750
        elsif  pressure > 660 and pressure <= 1105 
        flange_class = "1500"
        pressure_rating = 1105
        temperature_rating = 750
        elsif  pressure > 1105 and pressure <= 1840 
        flange_class = "2500"
        pressure_rating = 1840
        temperature_rating = 750
        
        end
    elsif temperature > 750 and temperature <= 800 
        if pressure <= 80 
        flange_class = "150"
        pressure_rating = 80
        temperature_rating = 800
        elsif  pressure > 80 and pressure <= 215 
        flange_class = "300"
        pressure_rating = 215
        temperature_rating = 800
        elsif  pressure > 215 and pressure <= 290 
        flange_class = "400"
        pressure_rating = 290
        temperature_rating = 800
        elsif  pressure > 290 and pressure <= 430 
        flange_class = "600"
        pressure_rating = 430
        temperature_rating = 800
        elsif  pressure > 430 and pressure <= 650 
        flange_class = "900"
        pressure_rating = 650
        temperature_rating = 800
        elsif  pressure > 650 and pressure <= 1080 
        flange_class = "1500"
        pressure_rating = 1080
        temperature_rating = 800
        elsif  pressure > 1080 and pressure <= 1800 
        flange_class = "2500"
        pressure_rating = 1800
        temperature_rating = 800
        
        end
    elsif temperature > 800 and temperature <= 850 
        if pressure <= 65 
        flange_class = "150"
        pressure_rating = 65
        temperature_rating = 850
        elsif  pressure > 65 and pressure <= 210 
        flange_class = "300"
        pressure_rating = 210
        temperature_rating = 850
        elsif  pressure > 210 and pressure <= 280 
        flange_class = "400"
        pressure_rating = 280
        temperature_rating = 850
        elsif  pressure > 280 and pressure <= 420 
        flange_class = "600"
        pressure_rating = 420
        temperature_rating = 850
        elsif  pressure > 420 and pressure <= 635 
        flange_class = "900"
        pressure_rating = 635
        temperature_rating = 850
        elsif  pressure > 635 and pressure <= 1055 
        flange_class = "1500"
        pressure_rating = 1055
        temperature_rating = 850
        elsif  pressure > 1055 and pressure <= 1760 
        flange_class = "2500"
        pressure_rating = 1760
        temperature_rating = 850
        
        end
    elsif temperature > 850 and temperature <= 900 
        if pressure <= 50 
        flange_class = "150"
        pressure_rating = 50
        temperature_rating = 900
        elsif  pressure > 50 and pressure <= 205 
        flange_class = "300"
        pressure_rating = 205
        temperature_rating = 900
        elsif  pressure > 205 and pressure <= 275 
        flange_class = "400"
        pressure_rating = 275
        temperature_rating = 900
        elsif  pressure > 275 and pressure <= 415 
        flange_class = "600"
        pressure_rating = 415
        temperature_rating = 900
        elsif  pressure > 415 and pressure <= 620 
        flange_class = "900"
        pressure_rating = 620
        temperature_rating = 900
        elsif  pressure > 620 and pressure <= 1030 
        flange_class = "1500"
        pressure_rating = 1030
        temperature_rating = 900
        elsif  pressure > 1030 and pressure <= 1720 
        flange_class = "2500"
        pressure_rating = 1720
        temperature_rating = 900
        
        end
    elsif temperature > 900 and temperature <= 950 
        if pressure <= 35 
        flange_class = "150"
        pressure_rating = 35
        temperature_rating = 950
        elsif  pressure > 35 and pressure <= 195 
        flange_class = "300"
        pressure_rating = 195
        temperature_rating = 950
        elsif  pressure > 195 and pressure <= 260 
        flange_class = "400"
        pressure_rating = 260
        temperature_rating = 950
        elsif  pressure > 260 and pressure <= 395 
        flange_class = "600"
        pressure_rating = 395
        temperature_rating = 950
        elsif  pressure > 395 and pressure <= 590 
        flange_class = "900"
        pressure_rating = 590
        temperature_rating = 950
        elsif  pressure > 590 and pressure <= 985 
        flange_class = "1500"
        pressure_rating = 985
        temperature_rating = 950
        elsif  pressure > 985 and pressure <= 1640 
        flange_class = "2500"
        pressure_rating = 1640
        temperature_rating = 950
        
        end
    elsif temperature > 950 and temperature <= 1000 
        if pressure <= 20 
        flange_class = "150"
        pressure_rating = 20
        temperature_rating = 1000
        elsif  pressure > 20 and pressure <= 190 
        flange_class = "300"
        pressure_rating = 190
        temperature_rating = 1000
        elsif  pressure > 190 and pressure <= 255 
        flange_class = "400"
        pressure_rating = 255
        temperature_rating = 1000
        elsif  pressure > 255 and pressure <= 380 
        flange_class = "600"
        pressure_rating = 380
        temperature_rating = 1000
        elsif  pressure > 380 and pressure <= 570 
        flange_class = "900"
        pressure_rating = 570
        temperature_rating = 1000
        elsif  pressure > 570 and pressure <= 950 
        flange_class = "1500"
        pressure_rating = 950
        temperature_rating = 1000
        elsif  pressure > 950 and pressure <= 1580 
        flange_class = "2500"
        pressure_rating = 1580
        temperature_rating = 1000
        
        end
    elsif temperature > 1000 and temperature <= 1050 
        if pressure > 80 
        flange_class = "300"
        pressure_rating = 80
        temperature_rating = 1050
        elsif  pressure > 80 and pressure <= 110 
        flange_class = "400"
        pressure_rating = 110
        temperature_rating = 1050
        elsif  pressure > 110 and pressure <= 165 
        flange_class = "600"
        pressure_rating = 165
        temperature_rating = 1050
        elsif  pressure > 165 and pressure <= 245 
        flange_class = "900"
        pressure_rating = 245
        temperature_rating = 1050
        elsif  pressure > 245 and pressure <= 410 
        flange_class = "1500"
        pressure_rating = 410
        temperature_rating = 1050
        elsif  pressure > 410 and pressure <= 685 
        flange_class = "2500"
        pressure_rating = 685
        temperature_rating = 1050
        
        end
    elsif temperature > 1050 and temperature <= 1100 
        if pressure > 70 
        flange_class = "300"
        pressure_rating = 70
        temperature_rating = 1100
        elsif  pressure > 70 and pressure <= 90 
        flange_class = "400"
        pressure_rating = 90
        temperature_rating = 1100
        elsif  pressure > 90 and pressure <= 135 
        flange_class = "600"
        pressure_rating = 135
        temperature_rating = 1100
        elsif  pressure > 135 and pressure <= 205 
        flange_class = "900"
        pressure_rating = 205
        temperature_rating = 1100
        elsif  pressure > 205 and pressure <= 345 
        flange_class = "1500"
        pressure_rating = 345
        temperature_rating = 1100
        elsif  pressure > 345 and pressure <= 570 
        flange_class = "2500"
        pressure_rating = 570
        temperature_rating = 1100
        
        end
    elsif temperature > 1100 and temperature <= 1150 
        if pressure > 50 
        flange_class = "300"
        pressure_rating = 50
        temperature_rating = 1150
        elsif  pressure > 50 and pressure <= 70 
        flange_class = "400"
        pressure_rating = 70
        temperature_rating = 1150
        elsif  pressure > 70 and pressure <= 105 
        flange_class = "600"
        pressure_rating = 105
        temperature_rating = 1150
        elsif  pressure > 105 and pressure <= 155 
        flange_class = "900"
        pressure_rating = 155
        temperature_rating = 1150
        elsif  pressure > 155 and pressure <= 255 
        flange_class = "1500"
        pressure_rating = 255
        temperature_rating = 1150
        elsif  pressure > 255 and pressure <= 430 
        flange_class = "2500"
        pressure_rating = 430
        temperature_rating = 1150
        
        end
    elsif temperature > 1150 and temperature <= 1200 
        if pressure > 40 
        flange_class = "300"
        pressure_rating = 40
        temperature_rating = 1200
        elsif  pressure > 40 and pressure <= 55 
        flange_class = "400"
        pressure_rating = 55
        temperature_rating = 1200
        elsif  pressure > 55 and pressure <= 80 
        flange_class = "600"
        pressure_rating = 80
        temperature_rating = 1200
        elsif  pressure > 80 and pressure <= 125 
        flange_class = "900"
        pressure_rating = 125
        temperature_rating = 1200
        elsif  pressure > 125 and pressure <= 205 
        flange_class = "1500"
        pressure_rating = 205
        temperature_rating = 1200
        elsif  pressure > 205 and pressure <= 345 
        flange_class = "2500"
        pressure_rating = 345
        temperature_rating = 1200
        
        end
    
    end
    
    if Worksheets("UOM").chkCustomary.Value = True 
    UserFormLineSegmentDesign.lblNotes = "((1) Use annealed material only." & Chr(13) _
    & "(2) The chemical composition, mechanical properties, heat treating requirements, and grain size requirements shall conform to the applicable ASTM specification. The manufacturing procedures, tolerances, tests, certification, and markings shall be in accordance with ASTM B 564."
    elsif orksheets("UOM").chkSI.Value = True 
    UserFormLineSegmentDesign.lblNotes = "((1) Use annealed material only." & Chr(13) _
    & "(2) The chemical composition, mechanical properties, heat treating requirements, and grain size requirements shall conform to the applicable ASTM specification. The manufacturing procedures, tolerances, tests, certification, and markings shall be in accordance with ASTM B 564."
    
    end
    
elsif material_group = "3.4" 
UserFormLineSegmentDesign.cmbMaterialDesignation.RowSource = "MaterialGroup3.4"
if temperature >= -20 and temperature <= 100 
        if pressure <= 230 
        flange_class = "150"
        pressure_rating = 230
        temperature_rating = 100
        elsif  pressure > 230 and pressure <= 600 
        flange_class = "300"
        pressure_rating = 600
        temperature_rating = 100
        elsif  pressure > 600 and pressure <= 800 
        flange_class = "400"
        pressure_rating = 800
        temperature_rating = 100
        elsif  pressure > 800 and pressure <= 1200 
        flange_class = "600"
        pressure_rating = 1200
        temperature_rating = 100
        elsif  pressure > 1200 and pressure <= 1800 
        flange_class = "900"
        pressure_rating = 1800
        temperature_rating = 100
        elsif  pressure > 1800 and pressure <= 3000 
        flange_class = "1500"
        pressure_rating = 3000
        temperature_rating = 100
        elsif  pressure > 3000 and pressure <= 5000 
        flange_class = "2500"
        pressure_rating = 5000
        temperature_rating = 100
        
        end
    elsif temperature > 100 and temperature <= 200 
        if pressure <= 200 
        flange_class = "150"
        pressure_rating = 200
        temperature_rating = 200
        elsif  pressure > 200 and pressure <= 525 
        flange_class = "300"
        pressure_rating = 525
        temperature_rating = 200
        elsif  pressure > 525 and pressure <= 700 
        flange_class = "400"
        pressure_rating = 700
        temperature_rating = 200
        elsif  pressure > 700 and pressure <= 1050 
        flange_class = "600"
        pressure_rating = 1050
        temperature_rating = 200
        elsif  pressure > 1050 and pressure <= 1575 
        flange_class = "900"
        pressure_rating = 1575
        temperature_rating = 200
        elsif  pressure > 1575 and pressure <= 2630 
        flange_class = "1500"
        pressure_rating = 2630
        temperature_rating = 200
        elsif  pressure > 2630 and pressure <= 4380 
        flange_class = "2500"
        pressure_rating = 4380
        temperature_rating = 200
        
        end
    elsif temperature > 200 and temperature <= 300 
        if pressure <= 190 
        flange_class = "150"
        pressure_rating = 190
        temperature_rating = 300
        elsif  pressure > 190 and pressure <= 490 
        flange_class = "300"
        pressure_rating = 490
        temperature_rating = 300
        elsif  pressure > 490 and pressure <= 655 
        flange_class = "400"
        pressure_rating = 655
        temperature_rating = 300
        elsif  pressure > 655 and pressure <= 980 
        flange_class = "600"
        pressure_rating = 980
        temperature_rating = 300
        elsif  pressure > 980 and pressure <= 1470 
        flange_class = "900"
        pressure_rating = 1470
        temperature_rating = 300
        elsif  pressure > 1470 and pressure <= 2450 
        flange_class = "1500"
        pressure_rating = 2450
        temperature_rating = 300
        elsif  pressure > 2450 and pressure <= 4080 
        flange_class = "2500"
        pressure_rating = 4080
        temperature_rating = 300
        
        end
    elsif temperature > 300 and temperature <= 400 
        if pressure <= 180 
        flange_class = "150"
        pressure_rating = 180
        temperature_rating = 400
        elsif  pressure > 180 and pressure <= 475 
        flange_class = "300"
        pressure_rating = 475
        temperature_rating = 400
        elsif  pressure > 475 and pressure <= 630 
        flange_class = "400"
        pressure_rating = 630
        temperature_rating = 400
        elsif  pressure > 630 and pressure <= 945 
        flange_class = "600"
        pressure_rating = 945
        temperature_rating = 400
        elsif  pressure > 945 and pressure <= 1420 
        flange_class = "900"
        pressure_rating = 1420
        temperature_rating = 400
        elsif  pressure > 1420 and pressure <= 2365 
        flange_class = "1500"
        pressure_rating = 2365
        temperature_rating = 400
        elsif  pressure > 2365 and pressure <= 3940 
        flange_class = "2500"
        pressure_rating = 3940
        temperature_rating = 400
        
        end
    elsif temperature > 400 and temperature <= 500 
        if pressure <= 170 
        flange_class = "150"
        pressure_rating = 170
        temperature_rating = 500
        elsif  pressure > 170 and pressure <= 475 
        flange_class = "300"
        pressure_rating = 475
        temperature_rating = 500
        elsif  pressure > 475 and pressure <= 630 
        flange_class = "400"
        pressure_rating = 630
        temperature_rating = 500
        elsif  pressure > 630 and pressure <= 945 
        flange_class = "600"
        pressure_rating = 945
        temperature_rating = 500
        elsif  pressure > 945 and pressure <= 1420 
        flange_class = "900"
        pressure_rating = 1420
        temperature_rating = 500
        elsif  pressure > 1420 and pressure <= 2365 
        flange_class = "1500"
        pressure_rating = 2365
        temperature_rating = 500
        elsif  pressure > 2365 and pressure <= 3940 
        flange_class = "2500"
        pressure_rating = 3940
        temperature_rating = 500
        
        end
    elsif temperature > 500 and temperature <= 600 
        if pressure <= 140 
        flange_class = "150"
        pressure_rating = 140
        temperature_rating = 600
        elsif  pressure > 140 and pressure <= 475 
        flange_class = "300"
        pressure_rating = 475
        temperature_rating = 600
        elsif  pressure > 475 and pressure <= 630 
        flange_class = "400"
        pressure_rating = 630
        temperature_rating = 600
        elsif  pressure > 630 and pressure <= 945 
        flange_class = "600"
        pressure_rating = 945
        temperature_rating = 600
        elsif  pressure > 945 and pressure <= 1420 
        flange_class = "900"
        pressure_rating = 1420
        temperature_rating = 600
        elsif  pressure > 1420 and pressure <= 2365 
        flange_class = "1500"
        pressure_rating = 2365
        temperature_rating = 600
        elsif  pressure > 2365 and pressure <= 3940 
        flange_class = "2500"
        pressure_rating = 3940
        temperature_rating = 600
        
        end
    elsif temperature > 600 and temperature <= 650 
        if pressure <= 125 
        flange_class = "150"
        pressure_rating = 125
        temperature_rating = 650
        elsif  pressure > 125 and pressure <= 475 
        flange_class = "300"
        pressure_rating = 475
        temperature_rating = 650
        elsif  pressure > 475 and pressure <= 630 
        flange_class = "400"
        pressure_rating = 630
        temperature_rating = 650
        elsif  pressure > 630 and pressure <= 945 
        flange_class = "600"
        pressure_rating = 945
        temperature_rating = 650
        elsif  pressure > 945 and pressure <= 1420 
        flange_class = "900"
        pressure_rating = 1420
        temperature_rating = 650
        elsif  pressure > 1420 and pressure <= 2365 
        flange_class = "1500"
        pressure_rating = 2365
        temperature_rating = 650
        elsif  pressure > 2365 and pressure <= 3940 
        flange_class = "2500"
        pressure_rating = 3940
        temperature_rating = 650
        
        end
    elsif temperature > 650 and temperature <= 700 
        if pressure <= 110 
        flange_class = "150"
        pressure_rating = 110
        temperature_rating = 700
        elsif  pressure > 110 and pressure <= 470 
        flange_class = "300"
        pressure_rating = 470
        temperature_rating = 700
        elsif  pressure > 470 and pressure <= 625 
        flange_class = "400"
        pressure_rating = 625
        temperature_rating = 700
        elsif  pressure > 625 and pressure <= 940 
        flange_class = "600"
        pressure_rating = 940
        temperature_rating = 700
        elsif  pressure > 940 and pressure <= 1410 
        flange_class = "900"
        pressure_rating = 1410
        temperature_rating = 700
        elsif  pressure > 1410 and pressure <= 2350 
        flange_class = "1500"
        pressure_rating = 2350
        temperature_rating = 700
        elsif  pressure > 2350 and pressure <= 3920 
        flange_class = "2500"
        pressure_rating = 3920
        temperature_rating = 700
        
        end
    elsif temperature > 700 and temperature <= 750 
        if pressure <= 95 
        flange_class = "150"
        pressure_rating = 95
        temperature_rating = 750
        elsif  pressure > 95 and pressure <= 465 
        flange_class = "300"
        pressure_rating = 465
        temperature_rating = 750
        elsif  pressure > 465 and pressure <= 620 
        flange_class = "400"
        pressure_rating = 620
        temperature_rating = 750
        elsif  pressure > 620 and pressure <= 930 
        flange_class = "600"
        pressure_rating = 930
        temperature_rating = 750
        elsif  pressure > 930 and pressure <= 1395 
        flange_class = "900"
        pressure_rating = 1395
        temperature_rating = 750
        elsif  pressure > 1395 and pressure <= 2330 
        flange_class = "1500"
        pressure_rating = 2330
        temperature_rating = 750
        elsif  pressure > 2330 and pressure <= 3880 
        flange_class = "2500"
        pressure_rating = 3880
        temperature_rating = 750
        
        end
    elsif temperature > 750 and temperature <= 800 
        if pressure <= 80 
        flange_class = "150"
        pressure_rating = 80
        temperature_rating = 800
        elsif  pressure > 80 and pressure <= 460 
        flange_class = "300"
        pressure_rating = 460
        temperature_rating = 800
        elsif  pressure > 460 and pressure <= 610 
        flange_class = "400"
        pressure_rating = 610
        temperature_rating = 800
        elsif  pressure > 610 and pressure <= 915 
        flange_class = "600"
        pressure_rating = 915
        temperature_rating = 800
        elsif  pressure > 915 and pressure <= 1375 
        flange_class = "900"
        pressure_rating = 1375
        temperature_rating = 800
        elsif  pressure > 1375 and pressure <= 2290 
        flange_class = "1500"
        pressure_rating = 2290
        temperature_rating = 800
        elsif  pressure > 2290 and pressure <= 3820 
        flange_class = "2500"
        pressure_rating = 3820
        temperature_rating = 800
        
        end
    elsif temperature > 800 and temperature <= 850 
        if pressure <= 65 
        flange_class = "150"
        pressure_rating = 65
        temperature_rating = 850
        elsif  pressure > 65 and pressure <= 375 
        flange_class = "300"
        pressure_rating = 375
        temperature_rating = 850
        elsif  pressure > 375 and pressure <= 505 
        flange_class = "400"
        pressure_rating = 505
        temperature_rating = 850
        elsif  pressure > 505 and pressure <= 755 
        flange_class = "600"
        pressure_rating = 755
        temperature_rating = 850
        elsif  pressure > 755 and pressure <= 1130 
        flange_class = "900"
        pressure_rating = 1130
        temperature_rating = 850
        elsif  pressure > 1130 and pressure <= 1885 
        flange_class = "1500"
        pressure_rating = 1885
        temperature_rating = 850
        elsif  pressure > 1885 and pressure <= 3145 
        flange_class = "2500"
        pressure_rating = 3145
        temperature_rating = 850
        
        end
    elsif temperature > 850 and temperature <= 900 
        if pressure <= 50 
        flange_class = "150"
        pressure_rating = 50
        temperature_rating = 900
        elsif  pressure > 50 and pressure <= 275 
        flange_class = "300"
        pressure_rating = 275
        temperature_rating = 900
        elsif  pressure > 275 and pressure <= 365 
        flange_class = "400"
        pressure_rating = 365
        temperature_rating = 900
        elsif  pressure > 365 and pressure <= 550 
        flange_class = "600"
        pressure_rating = 550
        temperature_rating = 900
        elsif  pressure > 550 and pressure <= 825 
        flange_class = "900"
        pressure_rating = 825
        temperature_rating = 900
        elsif  pressure > 825 and pressure <= 1370 
        flange_class = "1500"
        pressure_rating = 1370
        temperature_rating = 900
        elsif  pressure > 1370 and pressure <= 2285 
        flange_class = "2500"
        pressure_rating = 2285
        temperature_rating = 900
        
        end
    
    end
    
    if Worksheets("UOM").chkCustomary.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) Use annealed material only." & Chr(13) _
    & "(2) The chemical composition, mechanical properties, heat treating requirements, and grain size requirements shall conform to the applicable ASTM specification. The manufacturing procedures, tolerances, tests, certification, and markings shall be in accordance with ASTM B 564."
    elsif orksheets("UOM").chkSI.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) Use annealed material only." & Chr(13) _
    & "(2) The chemical composition, mechanical properties, heat treating requirements, and grain size requirements shall conform to the applicable ASTM specification. The manufacturing procedures, tolerances, tests, certification, and markings shall be in accordance with ASTM B 564."
    
    end
    
elsif material_group = "3.5" 
UserFormLineSegmentDesign.cmbMaterialDesignation.RowSource = "MaterialGroup3.5"
    if temperature >= -20 and temperature <= 100 
        if pressure <= 290 
        flange_class = "150"
        pressure_rating = 290
        temperature_rating = 100
        elsif  pressure > 290 and pressure <= 750 
        flange_class = "300"
        pressure_rating = 750
        temperature_rating = 100
        elsif  pressure > 750 and pressure <= 1000 
        flange_class = "400"
        pressure_rating = 1000
        temperature_rating = 100
        elsif  pressure > 1000 and pressure <= 1500 
        flange_class = "600"
        pressure_rating = 1500
        temperature_rating = 100
        elsif  pressure > 1500 and pressure <= 2250 
        flange_class = "900"
        pressure_rating = 2250
        temperature_rating = 100
        elsif  pressure > 2250 and pressure <= 3750 
        flange_class = "1500"
        pressure_rating = 3750
        temperature_rating = 100
        elsif  pressure > 3750 and pressure <= 6250 
        flange_class = "2500"
        pressure_rating = 6250
        temperature_rating = 100
        
        end
    elsif temperature > 100 and temperature <= 200 
        if pressure <= 260 
        flange_class = "150"
        pressure_rating = 260
        temperature_rating = 200
        elsif  pressure > 260 and pressure <= 750 
        flange_class = "300"
        pressure_rating = 750
        temperature_rating = 200
        elsif  pressure > 750 and pressure <= 1000 
        flange_class = "400"
        pressure_rating = 1000
        temperature_rating = 200
        elsif  pressure > 1000 and pressure <= 1500 
        flange_class = "600"
        pressure_rating = 1500
        temperature_rating = 200
        elsif  pressure > 1500 and pressure <= 2250 
        flange_class = "900"
        pressure_rating = 2250
        temperature_rating = 200
        elsif  pressure > 2250 and pressure <= 3750 
        flange_class = "1500"
        pressure_rating = 3750
        temperature_rating = 200
        elsif  pressure > 3750 and pressure <= 6250 
        flange_class = "2500"
        pressure_rating = 6250
        temperature_rating = 200
        
        end
    elsif temperature > 200 and temperature <= 300 
        if pressure <= 230 
        flange_class = "150"
        pressure_rating = 230
        temperature_rating = 300
        elsif  pressure > 230 and pressure <= 730 
        flange_class = "300"
        pressure_rating = 730
        temperature_rating = 300
        elsif  pressure > 730 and pressure <= 970 
        flange_class = "400"
        pressure_rating = 970
        temperature_rating = 300
        elsif  pressure > 970 and pressure <= 1455 
        flange_class = "600"
        pressure_rating = 1455
        temperature_rating = 300
        elsif  pressure > 1455 and pressure <= 2185 
        flange_class = "900"
        pressure_rating = 2185
        temperature_rating = 300
        elsif  pressure > 2185 and pressure <= 3640 
        flange_class = "1500"
        pressure_rating = 3640
        temperature_rating = 300
        elsif  pressure > 3640 and pressure <= 6070 
        flange_class = "2500"
        pressure_rating = 6070
        temperature_rating = 300
        
        end
    elsif temperature > 300 and temperature <= 400 
        if pressure <= 200 
        flange_class = "150"
        pressure_rating = 200
        temperature_rating = 400
        elsif  pressure > 200 and pressure <= 705 
        flange_class = "300"
        pressure_rating = 705
        temperature_rating = 400
        elsif  pressure > 705 and pressure <= 940 
        flange_class = "400"
        pressure_rating = 940
        temperature_rating = 400
        elsif  pressure > 940 and pressure <= 1410 
        flange_class = "600"
        pressure_rating = 1410
        temperature_rating = 400
        elsif  pressure > 1410 and pressure <= 2115 
        flange_class = "900"
        pressure_rating = 2115
        temperature_rating = 400
        elsif  pressure > 2115 and pressure <= 3530 
        flange_class = "1500"
        pressure_rating = 3530
        temperature_rating = 400
        elsif  pressure > 3530 and pressure <= 5880 
        flange_class = "2500"
        pressure_rating = 5880
        temperature_rating = 400
        
        end
    elsif temperature > 400 and temperature <= 500 
        if pressure <= 170 
        flange_class = "150"
        pressure_rating = 170
        temperature_rating = 500
        elsif  pressure > 170 and pressure <= 665 
        flange_class = "300"
        pressure_rating = 665
        temperature_rating = 500
        elsif  pressure > 665 and pressure <= 885 
        flange_class = "400"
        pressure_rating = 885
        temperature_rating = 500
        elsif  pressure > 885 and pressure <= 1330 
        flange_class = "600"
        pressure_rating = 1330
        temperature_rating = 500
        elsif  pressure > 1330 and pressure <= 1995 
        flange_class = "900"
        pressure_rating = 1995
        temperature_rating = 500
        elsif  pressure > 1995 and pressure <= 3325 
        flange_class = "1500"
        pressure_rating = 3325
        temperature_rating = 500
        elsif  pressure > 3325 and pressure <= 5540 
        flange_class = "2500"
        pressure_rating = 5540
        temperature_rating = 500
        
        end
    elsif temperature > 500 and temperature <= 600 
        if pressure <= 140 
        flange_class = "150"
        pressure_rating = 140
        temperature_rating = 600
        elsif  pressure > 140 and pressure <= 605 
        flange_class = "300"
        pressure_rating = 605
        temperature_rating = 600
        elsif  pressure > 605 and pressure <= 805 
        flange_class = "400"
        pressure_rating = 805
        temperature_rating = 600
        elsif  pressure > 805 and pressure <= 1210 
        flange_class = "600"
        pressure_rating = 1210
        temperature_rating = 600
        elsif  pressure > 1210 and pressure <= 1815 
        flange_class = "900"
        pressure_rating = 1815
        temperature_rating = 600
        elsif  pressure > 1815 and pressure <= 3025 
        flange_class = "1500"
        pressure_rating = 3025
        temperature_rating = 600
        elsif  pressure > 3025 and pressure <= 5040 
        flange_class = "2500"
        pressure_rating = 5040
        temperature_rating = 600
        
        end
    elsif temperature > 600 and temperature <= 650 
        if pressure <= 125 
        flange_class = "150"
        pressure_rating = 125
        temperature_rating = 650
        elsif  pressure > 125 and pressure <= 590 
        flange_class = "300"
        pressure_rating = 590
        temperature_rating = 650
        elsif  pressure > 590 and pressure <= 785 
        flange_class = "400"
        pressure_rating = 785
        temperature_rating = 650
        elsif  pressure > 785 and pressure <= 1175 
        flange_class = "600"
        pressure_rating = 1175
        temperature_rating = 650
        elsif  pressure > 1175 and pressure <= 1765 
        flange_class = "900"
        pressure_rating = 1765
        temperature_rating = 650
        elsif  pressure > 1765 and pressure <= 2940 
        flange_class = "1500"
        pressure_rating = 2940
        temperature_rating = 650
        elsif  pressure > 2940 and pressure <= 4905 
        flange_class = "2500"
        pressure_rating = 4905
        temperature_rating = 650
        
        end
    elsif temperature > 650 and temperature <= 700 
        if pressure <= 110 
        flange_class = "150"
        pressure_rating = 110
        temperature_rating = 700
        elsif  pressure > 110 and pressure <= 570 
        flange_class = "300"
        pressure_rating = 570
        temperature_rating = 700
        elsif  pressure > 570 and pressure <= 755 
        flange_class = "400"
        pressure_rating = 755
        temperature_rating = 700
        elsif  pressure > 755 and pressure <= 1135 
        flange_class = "600"
        pressure_rating = 1135
        temperature_rating = 700
        elsif  pressure > 1135 and pressure <= 1705 
        flange_class = "900"
        pressure_rating = 1705
        temperature_rating = 700
        elsif  pressure > 1705 and pressure <= 2840 
        flange_class = "1500"
        pressure_rating = 2840
        temperature_rating = 700
        elsif  pressure > 2840 and pressure <= 4730 
        flange_class = "2500"
        pressure_rating = 4730
        temperature_rating = 700
        
        end
    elsif temperature > 700 and temperature <= 750 
        if pressure <= 95 
        flange_class = "150"
        pressure_rating = 95
        temperature_rating = 750
        elsif  pressure > 95 and pressure <= 530 
        flange_class = "300"
        pressure_rating = 530
        temperature_rating = 750
        elsif  pressure > 530 and pressure <= 710 
        flange_class = "400"
        pressure_rating = 710
        temperature_rating = 750
        elsif  pressure > 710 and pressure <= 1065 
        flange_class = "600"
        pressure_rating = 1065
        temperature_rating = 750
        elsif  pressure > 1065 and pressure <= 1595 
        flange_class = "900"
        pressure_rating = 1595
        temperature_rating = 750
        elsif  pressure > 1595 and pressure <= 2660 
        flange_class = "1500"
        pressure_rating = 2660
        temperature_rating = 750
        elsif  pressure > 2660 and pressure <= 4430 
        flange_class = "2500"
        pressure_rating = 4430
        temperature_rating = 750
        
        end
    elsif temperature > 750 and temperature <= 800 
        if pressure <= 80 
        flange_class = "150"
        pressure_rating = 80
        temperature_rating = 800
        elsif  pressure > 80 and pressure <= 510 
        flange_class = "300"
        pressure_rating = 510
        temperature_rating = 800
        elsif  pressure > 510 and pressure <= 675 
        flange_class = "400"
        pressure_rating = 675
        temperature_rating = 800
        elsif  pressure > 675 and pressure <= 1015 
        flange_class = "600"
        pressure_rating = 1015
        temperature_rating = 800
        elsif  pressure > 1015 and pressure <= 1525 
        flange_class = "900"
        pressure_rating = 1525
        temperature_rating = 800
        elsif  pressure > 1525 and pressure <= 2660 
        flange_class = "1500"
        pressure_rating = 2660
        temperature_rating = 800
        elsif  pressure > 2660 and pressure <= 4430 
        flange_class = "2500"
        pressure_rating = 4430
        temperature_rating = 800
        
        end
    elsif temperature > 800 and temperature <= 850 
        if pressure <= 65 
        flange_class = "150"
        pressure_rating = 65
        temperature_rating = 850
        elsif  pressure > 65 and pressure <= 485 
        flange_class = "300"
        pressure_rating = 485
        temperature_rating = 850
        elsif  pressure > 485 and pressure <= 650 
        flange_class = "400"
        pressure_rating = 650
        temperature_rating = 850
        elsif  pressure > 650 and pressure <= 975 
        flange_class = "600"
        pressure_rating = 975
        temperature_rating = 850
        elsif  pressure > 975 and pressure <= 1460 
        flange_class = "900"
        pressure_rating = 1460
        temperature_rating = 850
        elsif  pressure > 1460 and pressure <= 2435 
        flange_class = "1500"
        pressure_rating = 2435
        temperature_rating = 850
        elsif  pressure > 2435 and pressure <= 4060 
        flange_class = "2500"
        pressure_rating = 4060
        temperature_rating = 850
        
        end
    elsif temperature > 850 and temperature <= 900 
        if pressure <= 50 
        flange_class = "150"
        pressure_rating = 50
        temperature_rating = 900
        elsif  pressure > 50 and pressure <= 450 
        flange_class = "300"
        pressure_rating = 450
        temperature_rating = 900
        elsif  pressure > 450 and pressure <= 600 
        flange_class = "400"
        pressure_rating = 600
        temperature_rating = 900
        elsif  pressure > 600 and pressure <= 900 
        flange_class = "600"
        pressure_rating = 900
        temperature_rating = 900
        elsif  pressure > 900 and pressure <= 1350 
        flange_class = "900"
        pressure_rating = 1350
        temperature_rating = 900
        elsif  pressure > 1350 and pressure <= 2245 
        flange_class = "1500"
        pressure_rating = 2245
        temperature_rating = 900
        elsif  pressure > 2245 and pressure <= 3745 
        flange_class = "2500"
        pressure_rating = 3745
        temperature_rating = 900
        
        end
    elsif temperature > 900 and temperature <= 950 
        if pressure <= 35 
        flange_class = "150"
        pressure_rating = 35
        temperature_rating = 950
        elsif  pressure > 35 and pressure <= 365 
        flange_class = "300"
        pressure_rating = 365
        temperature_rating = 950
        elsif  pressure > 365 and pressure <= 485 
        flange_class = "400"
        pressure_rating = 485
        temperature_rating = 950
        elsif  pressure > 485 and pressure <= 725 
        flange_class = "600"
        pressure_rating = 725
        temperature_rating = 950
        elsif  pressure > 725 and pressure <= 1090 
        flange_class = "900"
        pressure_rating = 1090
        temperature_rating = 950
        elsif  pressure > 1090 and pressure <= 1815 
        flange_class = "1500"
        pressure_rating = 1815
        temperature_rating = 950
        elsif  pressure > 1815 and pressure <= 3030 
        flange_class = "2500"
        pressure_rating = 3030
        temperature_rating = 950
        
        end
    elsif temperature > 950 and temperature <= 1000 
        if pressure <= 20 
        flange_class = "150"
        pressure_rating = 20
        temperature_rating = 1000
        elsif  pressure > 20 and pressure <= 240 
        flange_class = "300"
        pressure_rating = 240
        temperature_rating = 1000
        elsif  pressure > 240 and pressure <= 320 
        flange_class = "400"
        pressure_rating = 320
        temperature_rating = 1000
        elsif  pressure > 320 and pressure <= 480 
        flange_class = "600"
        pressure_rating = 480
        temperature_rating = 1000
        elsif  pressure > 480 and pressure <= 720 
        flange_class = "900"
        pressure_rating = 720
        temperature_rating = 1000
        elsif  pressure > 720 and pressure <= 1200 
        flange_class = "1500"
        pressure_rating = 1200
        temperature_rating = 1000
        elsif  pressure > 1200 and pressure <= 2000 
        flange_class = "2500"
        pressure_rating = 2000
        temperature_rating = 1000
        
        end
    elsif temperature > 1000 and temperature <= 1050 
        if pressure > 155 
        flange_class = "300"
        pressure_rating = 155
        temperature_rating = 1050
        elsif  pressure > 155 and pressure <= 205 
        flange_class = "400"
        pressure_rating = 205
        temperature_rating = 1050
        elsif  pressure > 205 and pressure <= 310 
        flange_class = "600"
        pressure_rating = 310
        temperature_rating = 1050
        elsif  pressure > 310 and pressure <= 465 
        flange_class = "900"
        pressure_rating = 465
        temperature_rating = 1050
        elsif  pressure > 465 and pressure <= 770 
        flange_class = "1500"
        pressure_rating = 770
        temperature_rating = 1050
        elsif  pressure > 770 and pressure <= 1285 
        flange_class = "2500"
        pressure_rating = 1285
        temperature_rating = 1050
        
        end
    elsif temperature > 1050 and temperature <= 1100 
        if pressure > 105 
        flange_class = "300"
        pressure_rating = 105
        temperature_rating = 1100
        elsif  pressure > 105 and pressure <= 135 
        flange_class = "400"
        pressure_rating = 135
        temperature_rating = 1100
        elsif  pressure > 135 and pressure <= 205 
        flange_class = "600"
        pressure_rating = 205
        temperature_rating = 1100
        elsif  pressure > 205 and pressure <= 310 
        flange_class = "900"
        pressure_rating = 310
        temperature_rating = 1100
        elsif  pressure > 310 and pressure <= 515 
        flange_class = "1500"
        pressure_rating = 515
        temperature_rating = 1100
        elsif  pressure > 515 and pressure <= 855 
        flange_class = "2500"
        pressure_rating = 855
        temperature_rating = 1100
        
        end
    elsif temperature > 1100 and temperature <= 1150 
        if pressure > 75 
        flange_class = "300"
        pressure_rating = 75
        temperature_rating = 1150
        elsif  pressure > 75 and pressure <= 100 
        flange_class = "400"
        pressure_rating = 100
        temperature_rating = 1150
        elsif  pressure > 100 and pressure <= 150 
        flange_class = "600"
        pressure_rating = 150
        temperature_rating = 1150
        elsif  pressure > 150 and pressure <= 225 
        flange_class = "900"
        pressure_rating = 225
        temperature_rating = 1150
        elsif  pressure > 225 and pressure <= 375 
        flange_class = "1500"
        pressure_rating = 375
        temperature_rating = 1150
        elsif  pressure > 375 and pressure <= 630 
        flange_class = "2500"
        pressure_rating = 630
        temperature_rating = 1150
        
        end
    elsif temperature > 1150 and temperature <= 1200 
        if pressure > 70 
        flange_class = "300"
        pressure_rating = 70
        temperature_rating = 1200
        elsif  pressure > 70 and pressure <= 90 
        flange_class = "400"
        pressure_rating = 90
        temperature_rating = 1200
        elsif  pressure > 90 and pressure <= 135 
        flange_class = "600"
        pressure_rating = 135
        temperature_rating = 1200
        elsif  pressure > 135 and pressure <= 205 
        flange_class = "900"
        pressure_rating = 205
        temperature_rating = 1200
        elsif  pressure > 205 and pressure <= 345 
        flange_class = "1500"
        pressure_rating = 345
        temperature_rating = 1200
        elsif  pressure > 345 and pressure <= 570 
        flange_class = "2500"
        pressure_rating = 570
        temperature_rating = 1200
        
        end
    
    end
    
    if Worksheets("UOM").chkCustomary.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) Use annealed material only."
    elsif orksheets("UOM").chkSI.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) Use annealed material only."
    
    end
    
elsif material_group = "3.6" 
UserFormLineSegmentDesign.cmbMaterialDesignation.RowSource = "MaterialGroup3.6"
    if temperature >= -20 and temperature <= 100 
        if pressure <= 275 
        flange_class = "150"
        pressure_rating = 275
        temperature_rating = 100
        elsif  pressure > 275 and pressure <= 720 
        flange_class = "300"
        pressure_rating = 720
        temperature_rating = 100
        elsif  pressure > 720 and pressure <= 960 
        flange_class = "400"
        pressure_rating = 960
        temperature_rating = 100
        elsif  pressure > 960 and pressure <= 1440 
        flange_class = "600"
        pressure_rating = 1440
        temperature_rating = 100
        elsif  pressure > 1440 and pressure <= 2160 
        flange_class = "900"
        pressure_rating = 2160
        temperature_rating = 100
        elsif  pressure > 2160 and pressure <= 3600 
        flange_class = "1500"
        pressure_rating = 3600
        temperature_rating = 100
        elsif  pressure > 3600 and pressure <= 6000 
        flange_class = "2500"
        pressure_rating = 6000
        temperature_rating = 100
        
        end
    elsif temperature > 100 and temperature <= 200 
        if pressure <= 255 
        flange_class = "150"
        pressure_rating = 255
        temperature_rating = 200
        elsif  pressure > 255 and pressure <= 665 
        flange_class = "300"
        pressure_rating = 665
        temperature_rating = 200
        elsif  pressure > 665 and pressure <= 885 
        flange_class = "400"
        pressure_rating = 885
        temperature_rating = 200
        elsif  pressure > 885 and pressure <= 1330 
        flange_class = "600"
        pressure_rating = 1330
        temperature_rating = 200
        elsif  pressure > 1330 and pressure <= 1995 
        flange_class = "900"
        pressure_rating = 1995
        temperature_rating = 200
        elsif  pressure > 1995 and pressure <= 3325 
        flange_class = "1500"
        pressure_rating = 3325
        temperature_rating = 200
        elsif  pressure > 3325 and pressure <= 5540 
        flange_class = "2500"
        pressure_rating = 5540
        temperature_rating = 200
        
        end
    elsif temperature > 200 and temperature <= 300 
        if pressure <= 230 
        flange_class = "150"
        pressure_rating = 230
        temperature_rating = 300
        elsif  pressure > 230 and pressure <= 640 
        flange_class = "300"
        pressure_rating = 640
        temperature_rating = 300
        elsif  pressure > 640 and pressure <= 850 
        flange_class = "400"
        pressure_rating = 850
        temperature_rating = 300
        elsif  pressure > 850 and pressure <= 1275 
        flange_class = "600"
        pressure_rating = 1275
        temperature_rating = 300
        elsif  pressure > 1275 and pressure <= 1915 
        flange_class = "900"
        pressure_rating = 1915
        temperature_rating = 300
        elsif  pressure > 1915 and pressure <= 3190 
        flange_class = "1500"
        pressure_rating = 3190
        temperature_rating = 300
        elsif  pressure > 3190 and pressure <= 5320 
        flange_class = "2500"
        pressure_rating = 5320
        temperature_rating = 300
        
        end
    elsif temperature > 300 and temperature <= 400 
        if pressure <= 200 
        flange_class = "150"
        pressure_rating = 200
        temperature_rating = 400
        elsif  pressure > 200 and pressure <= 620 
        flange_class = "300"
        pressure_rating = 620
        temperature_rating = 400
        elsif  pressure > 620 and pressure <= 825 
        flange_class = "400"
        pressure_rating = 825
        temperature_rating = 400
        elsif  pressure > 825 and pressure <= 1240 
        flange_class = "600"
        pressure_rating = 1240
        temperature_rating = 400
        elsif  pressure > 1240 and pressure <= 1860 
        flange_class = "900"
        pressure_rating = 1860
        temperature_rating = 400
        elsif  pressure > 1860 and pressure <= 3095 
        flange_class = "1500"
        pressure_rating = 3095
        temperature_rating = 400
        elsif  pressure > 3095 and pressure <= 5160 
        flange_class = "2500"
        pressure_rating = 5160
        temperature_rating = 400
        
        end
    elsif temperature > 400 and temperature <= 500 
        if pressure <= 170 
        flange_class = "150"
        pressure_rating = 170
        temperature_rating = 500
        elsif  pressure > 170 and pressure <= 600 
        flange_class = "300"
        pressure_rating = 600
        temperature_rating = 500
        elsif  pressure > 600 and pressure <= 805 
        flange_class = "400"
        pressure_rating = 805
        temperature_rating = 500
        elsif  pressure > 805 and pressure <= 1205 
        flange_class = "600"
        pressure_rating = 1205
        temperature_rating = 500
        elsif  pressure > 1205 and pressure <= 1805 
        flange_class = "900"
        pressure_rating = 1805
        temperature_rating = 500
        elsif  pressure > 1805 and pressure <= 3010 
        flange_class = "1500"
        pressure_rating = 3010
        temperature_rating = 500
        elsif  pressure > 3010 and pressure <= 5020 
        flange_class = "2500"
        pressure_rating = 5020
        temperature_rating = 500
        
        end
    elsif temperature > 500 and temperature <= 600 
        if pressure <= 140 
        flange_class = "150"
        pressure_rating = 140
        temperature_rating = 600
        elsif  pressure > 140 and pressure <= 590 
        flange_class = "300"
        pressure_rating = 590
        temperature_rating = 600
        elsif  pressure > 590 and pressure <= 785 
        flange_class = "400"
        pressure_rating = 785
        temperature_rating = 600
        elsif  pressure > 785 and pressure <= 1175 
        flange_class = "600"
        pressure_rating = 1175
        temperature_rating = 600
        elsif  pressure > 1175 and pressure <= 1765 
        flange_class = "900"
        pressure_rating = 1765
        temperature_rating = 600
        elsif  pressure > 1765 and pressure <= 2940 
        flange_class = "1500"
        pressure_rating = 2940
        temperature_rating = 600
        elsif  pressure > 2940 and pressure <= 4900 
        flange_class = "2500"
        pressure_rating = 4900
        temperature_rating = 600
        
        end
    elsif temperature > 600 and temperature <= 650 
        if pressure <= 125 
        flange_class = "150"
        pressure_rating = 125
        temperature_rating = 650
        elsif  pressure > 125 and pressure <= 580 
        flange_class = "300"
        pressure_rating = 580
        temperature_rating = 650
        elsif  pressure > 580 and pressure <= 770 
        flange_class = "400"
        pressure_rating = 770
        temperature_rating = 650
        elsif  pressure > 770 and pressure <= 1155 
        flange_class = "600"
        pressure_rating = 1155
        temperature_rating = 650
        elsif  pressure > 1155 and pressure <= 1735 
        flange_class = "900"
        pressure_rating = 1735
        temperature_rating = 650
        elsif  pressure > 1735 and pressure <= 2890 
        flange_class = "1500"
        pressure_rating = 2890
        temperature_rating = 650
        elsif  pressure > 2890 and pressure <= 4820 
        flange_class = "2500"
        pressure_rating = 4820
        temperature_rating = 650
        
        end
    elsif temperature > 650 and temperature <= 700 
        if pressure <= 110 
        flange_class = "150"
        pressure_rating = 110
        temperature_rating = 700
        elsif  pressure > 110 and pressure <= 570 
        flange_class = "300"
        pressure_rating = 570
        temperature_rating = 700
        elsif  pressure > 570 and pressure <= 755 
        flange_class = "400"
        pressure_rating = 755
        temperature_rating = 700
        elsif  pressure > 755 and pressure <= 1135 
        flange_class = "600"
        pressure_rating = 1135
        temperature_rating = 700
        elsif  pressure > 1135 and pressure <= 1705 
        flange_class = "900"
        pressure_rating = 1705
        temperature_rating = 700
        elsif  pressure > 1705 and pressure <= 2840 
        flange_class = "1500"
        pressure_rating = 2840
        temperature_rating = 700
        elsif  pressure > 2840 and pressure <= 4730 
        flange_class = "2500"
        pressure_rating = 4730
        temperature_rating = 700
        
        end
    elsif temperature > 700 and temperature <= 750 
        if pressure <= 95 
        flange_class = "150"
        pressure_rating = 95
        temperature_rating = 750
        elsif  pressure > 95 and pressure <= 530 
        flange_class = "300"
        pressure_rating = 530
        temperature_rating = 750
        elsif  pressure > 530 and pressure <= 710 
        flange_class = "400"
        pressure_rating = 710
        temperature_rating = 750
        elsif  pressure > 710 and pressure <= 1065 
        flange_class = "600"
        pressure_rating = 1065
        temperature_rating = 750
        elsif  pressure > 1065 and pressure <= 1595 
        flange_class = "900"
        pressure_rating = 1595
        temperature_rating = 750
        elsif  pressure > 1595 and pressure <= 2660 
        flange_class = "1500"
        pressure_rating = 2660
        temperature_rating = 750
        elsif  pressure > 2660 and pressure <= 4430 
        flange_class = "2500"
        pressure_rating = 4430
        temperature_rating = 750
        
        end
    elsif temperature > 750 and temperature <= 800 
        if pressure <= 80 
        flange_class = "150"
        pressure_rating = 80
        temperature_rating = 800
        elsif  pressure > 80 and pressure <= 510 
        flange_class = "300"
        pressure_rating = 510
        temperature_rating = 800
        elsif  pressure > 510 and pressure <= 675 
        flange_class = "400"
        pressure_rating = 675
        temperature_rating = 800
        elsif  pressure > 675 and pressure <= 1015 
        flange_class = "600"
        pressure_rating = 1015
        temperature_rating = 800
        elsif  pressure > 1015 and pressure <= 1525 
        flange_class = "900"
        pressure_rating = 1525
        temperature_rating = 800
        elsif  pressure > 1525 and pressure <= 2540 
        flange_class = "1500"
        pressure_rating = 2450
        temperature_rating = 800
        elsif  pressure > 2450 and pressure <= 4230 
        flange_class = "2500"
        pressure_rating = 4230
        temperature_rating = 800
        
        end
    elsif temperature > 800 and temperature <= 850 
        if pressure <= 65 
        flange_class = "150"
        pressure_rating = 65
        temperature_rating = 850
        elsif  pressure > 65 and pressure <= 485 
        flange_class = "300"
        pressure_rating = 485
        temperature_rating = 850
        elsif  pressure > 485 and pressure <= 650 
        flange_class = "400"
        pressure_rating = 650
        temperature_rating = 850
        elsif  pressure > 650 and pressure <= 975 
        flange_class = "600"
        pressure_rating = 975
        temperature_rating = 850
        elsif  pressure > 975 and pressure <= 1460 
        flange_class = "900"
        pressure_rating = 1460
        temperature_rating = 850
        elsif  pressure > 1460 and pressure <= 2435 
        flange_class = "1500"
        pressure_rating = 2435
        temperature_rating = 850
        elsif  pressure > 2435 and pressure <= 4060 
        flange_class = "2500"
        pressure_rating = 4060
        temperature_rating = 850
        
        end
    elsif temperature > 850 and temperature <= 900 
        if pressure <= 50 
        flange_class = "150"
        pressure_rating = 50
        temperature_rating = 900
        elsif  pressure > 50 and pressure <= 450 
        flange_class = "300"
        pressure_rating = 450
        temperature_rating = 900
        elsif  pressure > 450 and pressure <= 600 
        flange_class = "400"
        pressure_rating = 600
        temperature_rating = 900
        elsif  pressure > 600 and pressure <= 900 
        flange_class = "600"
        pressure_rating = 900
        temperature_rating = 900
        elsif  pressure > 900 and pressure <= 1350 
        flange_class = "900"
        pressure_rating = 1350
        temperature_rating = 900
        elsif  pressure > 1350 and pressure <= 2245 
        flange_class = "1500"
        pressure_rating = 2245
        temperature_rating = 900
        elsif  pressure > 2245 and pressure <= 3745 
        flange_class = "2500"
        pressure_rating = 3745
        temperature_rating = 900
        
        end
    elsif temperature > 900 and temperature <= 950 
        if pressure <= 35 
        flange_class = "150"
        pressure_rating = 35
        temperature_rating = 950
        elsif  pressure > 35 and pressure <= 385 
        flange_class = "300"
        pressure_rating = 385
        temperature_rating = 950
        elsif  pressure > 385 and pressure <= 515 
        flange_class = "400"
        pressure_rating = 515
        temperature_rating = 950
        elsif  pressure > 515 and pressure <= 775 
        flange_class = "600"
        pressure_rating = 775
        temperature_rating = 950
        elsif  pressure > 775 and pressure <= 1160 
        flange_class = "900"
        pressure_rating = 1160
        temperature_rating = 950
        elsif  pressure > 1160 and pressure <= 1930 
        flange_class = "1500"
        pressure_rating = 1930
        temperature_rating = 950
        elsif  pressure > 1930 and pressure <= 3220 
        flange_class = "2500"
        pressure_rating = 3220
        temperature_rating = 950
        
        end
    elsif temperature > 950 and temperature <= 1000 
        if pressure <= 20 
        flange_class = "150"
        pressure_rating = 20
        temperature_rating = 1000
        elsif  pressure > 20 and pressure <= 365 
        flange_class = "300"
        pressure_rating = 365
        temperature_rating = 1000
        elsif  pressure > 365 and pressure <= 485 
        flange_class = "400"
        pressure_rating = 485
        temperature_rating = 1000
        elsif  pressure > 485 and pressure <= 725 
        flange_class = "600"
        pressure_rating = 725
        temperature_rating = 1000
        elsif  pressure > 725 and pressure <= 1090 
        flange_class = "900"
        pressure_rating = 1090
        temperature_rating = 1000
        elsif  pressure > 1090 and pressure <= 1820 
        flange_class = "1500"
        pressure_rating = 1820
        temperature_rating = 1000
        elsif  pressure > 1820 and pressure <= 3030 
        flange_class = "2500"
        pressure_rating = 3030
        temperature_rating = 1000
        
        end
    elsif temperature > 1000 and temperature <= 1050 
        if pressure > 360 
        flange_class = "300"
        pressure_rating = 360
        temperature_rating = 1050
        elsif  pressure > 360 and pressure <= 480 
        flange_class = "400"
        pressure_rating = 480
        temperature_rating = 1050
        elsif  pressure > 480 and pressure <= 720 
        flange_class = "600"
        pressure_rating = 720
        temperature_rating = 1050
        elsif  pressure > 720 and pressure <= 1080 
        flange_class = "900"
        pressure_rating = 1080
        temperature_rating = 1050
        elsif  pressure > 1080 and pressure <= 1800 
        flange_class = "1500"
        pressure_rating = 1800
        temperature_rating = 1050
        elsif  pressure > 1800 and pressure <= 3000 
        flange_class = "2500"
        pressure_rating = 3000
        temperature_rating = 1050
        
        end
    elsif temperature > 1050 and temperature <= 1100 
        if pressure > 325 
        flange_class = "300"
        pressure_rating = 325
        temperature_rating = 1100
        elsif  pressure > 325 and pressure <= 430 
        flange_class = "400"
        pressure_rating = 430
        temperature_rating = 1100
        elsif  pressure > 430 and pressure <= 645 
        flange_class = "600"
        pressure_rating = 645
        temperature_rating = 1100
        elsif  pressure > 645 and pressure <= 965 
        flange_class = "900"
        pressure_rating = 965
        temperature_rating = 1100
        elsif  pressure > 965 and pressure <= 1610 
        flange_class = "1500"
        pressure_rating = 1610
        temperature_rating = 1100
        elsif  pressure > 1610 and pressure <= 2685 
        flange_class = "2500"
        pressure_rating = 2685
        temperature_rating = 1100
        
        end
    elsif temperature > 1100 and temperature <= 1150 
        if pressure > 275 
        flange_class = "300"
        pressure_rating = 275
        temperature_rating = 1150
        elsif  pressure > 275 and pressure <= 365 
        flange_class = "400"
        pressure_rating = 365
        temperature_rating = 1150
        elsif  pressure > 365 and pressure <= 550 
        flange_class = "600"
        pressure_rating = 550
        temperature_rating = 1150
        elsif  pressure > 550 and pressure <= 825 
        flange_class = "900"
        pressure_rating = 825
        temperature_rating = 1150
        elsif  pressure > 825 and pressure <= 1370 
        flange_class = "1500"
        pressure_rating = 1370
        temperature_rating = 1150
        elsif  pressure > 1370 and pressure <= 2285 
        flange_class = "2500"
        pressure_rating = 2285
        temperature_rating = 1150
        
        end
    elsif temperature > 1150 and temperature <= 1200 
        if pressure > 205 
        flange_class = "300"
        pressure_rating = 205
        temperature_rating = 1200
        elsif  pressure > 205 and pressure <= 275 
        flange_class = "400"
        pressure_rating = 275
        temperature_rating = 1200
        elsif  pressure > 275 and pressure <= 410 
        flange_class = "600"
        pressure_rating = 410
        temperature_rating = 1200
        elsif  pressure > 410 and pressure <= 620 
        flange_class = "900"
        pressure_rating = 620
        temperature_rating = 1200
        elsif  pressure > 620 and pressure <= 1030 
        flange_class = "1500"
        pressure_rating = 1030
        temperature_rating = 1200
        elsif  pressure > 1030 and pressure <= 1715 
        flange_class = "2500"
        pressure_rating = 1715
        temperature_rating = 1200
        
        end
    elsif temperature > 1200 and temperature <= 1250 
        if pressure > 145 
        flange_class = "300"
        pressure_rating = 145
        temperature_rating = 1250
        elsif  pressure > 145 and pressure <= 190 
        flange_class = "400"
        pressure_rating = 190
        temperature_rating = 1250
        elsif  pressure > 190 and pressure <= 290 
        flange_class = "600"
        pressure_rating = 290
        temperature_rating = 1250
        elsif  pressure > 290 and pressure <= 430 
        flange_class = "900"
        pressure_rating = 430
        temperature_rating = 1250
        elsif  pressure > 430 and pressure <= 720 
        flange_class = "1500"
        pressure_rating = 720
        temperature_rating = 1250
        elsif  pressure > 720 and pressure <= 1200 
        flange_class = "2500"
        pressure_rating = 1200
        temperature_rating = 1250
        
        end
    elsif temperature > 1250 and temperature <= 1300 
        if pressure > 70 
        flange_class = "300"
        pressure_rating = 70
        temperature_rating = 1300
        elsif  pressure > 70 and pressure <= 90 
        flange_class = "400"
        pressure_rating = 90
        temperature_rating = 1300
        elsif  pressure > 90 and pressure <= 135 
        flange_class = "600"
        pressure_rating = 135
        temperature_rating = 1300
        elsif  pressure > 135 and pressure <= 205 
        flange_class = "900"
        pressure_rating = 205
        temperature_rating = 1300
        elsif  pressure > 205 and pressure <= 345 
        flange_class = "1500"
        pressure_rating = 345
        temperature_rating = 1300
        elsif  pressure > 345 and pressure <= 570 
        flange_class = "2500"
        pressure_rating = 570
        temperature_rating = 1300
        
        end
    elsif temperature > 1300 and temperature <= 1350 
        if pressure > 55 
        flange_class = "300"
        pressure_rating = 55
        temperature_rating = 1350
        elsif  pressure > 55 and pressure <= 75 
        flange_class = "400"
        pressure_rating = 75
        temperature_rating = 1350
        elsif  pressure > 75 and pressure <= 110 
        flange_class = "600"
        pressure_rating = 110
        temperature_rating = 1350
        elsif  pressure > 110 and pressure <= 165 
        flange_class = "900"
        pressure_rating = 165
        temperature_rating = 1350
        elsif  pressure > 165 and pressure <= 275 
        flange_class = "1500"
        pressure_rating = 275
        temperature_rating = 1350
        elsif  pressure > 275 and pressure <= 455 
        flange_class = "2500"
        pressure_rating = 455
        temperature_rating = 1350
        
        end
    elsif temperature > 1350 and temperature <= 1400 
        if pressure > 40 
        flange_class = "300"
        pressure_rating = 40
        temperature_rating = 1400
        elsif  pressure > 40 and pressure <= 50 
        flange_class = "400"
        pressure_rating = 50
        temperature_rating = 1400
        elsif  pressure > 50 and pressure <= 75 
        flange_class = "600"
        pressure_rating = 75
        temperature_rating = 1400
        elsif  pressure > 75 and pressure <= 115 
        flange_class = "900"
        pressure_rating = 115
        temperature_rating = 1400
        elsif  pressure > 115 and pressure <= 190 
        flange_class = "1500"
        pressure_rating = 190
        temperature_rating = 1150
        elsif  pressure > 190 and pressure <= 315 
        flange_class = "2500"
        pressure_rating = 315
        temperature_rating = 1400
        
        end
    elsif temperature > 1400 and temperature <= 1450 
        if pressure > 35 
        flange_class = "300"
        pressure_rating = 35
        temperature_rating = 1450
        elsif  pressure > 35 and pressure <= 45 
        flange_class = "400"
        pressure_rating = 45
        temperature_rating = 1450
        elsif  pressure > 45 and pressure <= 70 
        flange_class = "600"
        pressure_rating = 70
        temperature_rating = 1450
        elsif  pressure > 70 and pressure <= 105 
        flange_class = "900"
        pressure_rating = 105
        temperature_rating = 1450
        elsif  pressure > 105 and pressure <= 170 
        flange_class = "1500"
        pressure_rating = 170
        temperature_rating = 1450
        elsif  pressure > 170 and pressure <= 285 
        flange_class = "2500"
        pressure_rating = 285
        temperature_rating = 1450
        
        end
    elsif temperature > 1450 and temperature <= 1500 
        if pressure > 25 
        flange_class = "300"
        pressure_rating = 25
        temperature_rating = 1500
        elsif  pressure > 25 and pressure <= 35 
        flange_class = "400"
        pressure_rating = 35
        temperature_rating = 1500
        elsif  pressure > 35 and pressure <= 55 
        flange_class = "600"
        pressure_rating = 55
        temperature_rating = 1500
        elsif  pressure > 55 and pressure <= 80 
        flange_class = "900"
        pressure_rating = 80
        temperature_rating = 1500
        elsif  pressure > 80 and pressure <= 135 
        flange_class = "1500"
        pressure_rating = 135
        temperature_rating = 1500
        elsif  pressure > 135 and pressure <= 230 
        flange_class = "2500"
        pressure_rating = 230
        temperature_rating = 1500
        
        end
    
    end
    
    if Worksheets("UOM").chkCustomary.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) Use annealed material only."
    elsif orksheets("UOM").chkSI.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) Use annealed material only."
    
    end
    
elsif material_group = "3.7" 
UserFormLineSegmentDesign.cmbMaterialDesignation.RowSource = "MaterialGroup3.7"
    if temperature >= -20 and temperature <= 100 
        if pressure <= 290 
        flange_class = "150"
        pressure_rating = 290
        temperature_rating = 100
        elsif  pressure > 290 and pressure <= 750 
        flange_class = "300"
        pressure_rating = 750
        temperature_rating = 100
        elsif  pressure > 750 and pressure <= 1000 
        flange_class = "400"
        pressure_rating = 1000
        temperature_rating = 100
        elsif  pressure > 1000 and pressure <= 1500 
        flange_class = "600"
        pressure_rating = 1500
        temperature_rating = 100
        elsif  pressure > 1500 and pressure <= 2250 
        flange_class = "900"
        pressure_rating = 2250
        temperature_rating = 100
        elsif  pressure > 2250 and pressure <= 3750 
        flange_class = "1500"
        pressure_rating = 3750
        temperature_rating = 100
        elsif  pressure > 3750 and pressure <= 6250 
        flange_class = "2500"
        pressure_rating = 6250
        temperature_rating = 100
        
        end
    elsif temperature > 100 and temperature <= 200 
        if pressure <= 260 
        flange_class = "150"
        pressure_rating = 260
        temperature_rating = 200
        elsif  pressure > 260 and pressure <= 750 
        flange_class = "300"
        pressure_rating = 750
        temperature_rating = 200
        elsif  pressure > 750 and pressure <= 1000 
        flange_class = "400"
        pressure_rating = 1000
        temperature_rating = 200
        elsif  pressure > 1000 and pressure <= 1500 
        flange_class = "600"
        pressure_rating = 1500
        temperature_rating = 200
        elsif  pressure > 1500 and pressure <= 2250 
        flange_class = "900"
        pressure_rating = 2250
        temperature_rating = 200
        elsif  pressure > 2250 and pressure <= 3750 
        flange_class = "1500"
        pressure_rating = 3750
        temperature_rating = 200
        elsif  pressure > 3750 and pressure <= 6250 
        flange_class = "2500"
        pressure_rating = 6250
        temperature_rating = 200
        
        end
    elsif temperature > 200 and temperature <= 300 
        if pressure <= 230 
        flange_class = "150"
        pressure_rating = 230
        temperature_rating = 300
        elsif  pressure > 230 and pressure <= 730 
        flange_class = "300"
        pressure_rating = 730
        temperature_rating = 300
        elsif  pressure > 730 and pressure <= 970 
        flange_class = "400"
        pressure_rating = 970
        temperature_rating = 300
        elsif  pressure > 970 and pressure <= 1455 
        flange_class = "600"
        pressure_rating = 1455
        temperature_rating = 300
        elsif  pressure > 1455 and pressure <= 2185 
        flange_class = "900"
        pressure_rating = 2185
        temperature_rating = 300
        elsif  pressure > 2185 and pressure <= 3640 
        flange_class = "1500"
        pressure_rating = 3640
        temperature_rating = 300
        elsif  pressure > 3640 and pressure <= 6070 
        flange_class = "2500"
        pressure_rating = 6070
        temperature_rating = 300
        
        end
    elsif temperature > 300 and temperature <= 400 
        if pressure <= 200 
        flange_class = "150"
        pressure_rating = 200
        temperature_rating = 400
        elsif  pressure > 200 and pressure <= 705 
        flange_class = "300"
        pressure_rating = 705
        temperature_rating = 400
        elsif  pressure > 705 and pressure <= 940 
        flange_class = "400"
        pressure_rating = 940
        temperature_rating = 400
        elsif  pressure > 940 and pressure <= 1410 
        flange_class = "600"
        pressure_rating = 1410
        temperature_rating = 400
        elsif  pressure > 1410 and pressure <= 2115 
        flange_class = "900"
        pressure_rating = 2115
        temperature_rating = 400
        elsif  pressure > 2115 and pressure <= 3325 
        flange_class = "1500"
        pressure_rating = 3325
        temperature_rating = 400
        elsif  pressure > 3325 and pressure <= 5540 
        flange_class = "2500"
        pressure_rating = 5540
        temperature_rating = 400
        
        end
    elsif temperature > 400 and temperature <= 500 
        if pressure <= 170 
        flange_class = "150"
        pressure_rating = 170
        temperature_rating = 500
        elsif  pressure > 170 and pressure <= 665 
        flange_class = "300"
        pressure_rating = 665
        temperature_rating = 500
        elsif  pressure > 665 and pressure <= 885 
        flange_class = "400"
        pressure_rating = 885
        temperature_rating = 500
        elsif  pressure > 885 and pressure <= 1330 
        flange_class = "600"
        pressure_rating = 1330
        temperature_rating = 500
        elsif  pressure > 1330 and pressure <= 1995 
        flange_class = "900"
        pressure_rating = 1995
        temperature_rating = 500
        elsif  pressure > 1995 and pressure <= 3325 
        flange_class = "1500"
        pressure_rating = 3325
        temperature_rating = 500
        elsif  pressure > 3325 and pressure <= 5540 
        flange_class = "2500"
        pressure_rating = 5540
        temperature_rating = 500
        
        end
    elsif temperature > 500 and temperature <= 600 
        if pressure <= 140 
        flange_class = "150"
        pressure_rating = 140
        temperature_rating = 600
        elsif  pressure > 140 and pressure <= 605 
        flange_class = "300"
        pressure_rating = 605
        temperature_rating = 600
        elsif  pressure > 605 and pressure <= 805 
        flange_class = "400"
        pressure_rating = 805
        temperature_rating = 600
        elsif  pressure > 805 and pressure <= 1210 
        flange_class = "600"
        pressure_rating = 1210
        temperature_rating = 600
        elsif  pressure > 1210 and pressure <= 1815 
        flange_class = "900"
        pressure_rating = 1815
        temperature_rating = 600
        elsif  pressure > 1815 and pressure <= 3025 
        flange_class = "1500"
        pressure_rating = 3025
        temperature_rating = 600
        elsif  pressure > 3025 and pressure <= 5040 
        flange_class = "2500"
        pressure_rating = 5040
        temperature_rating = 600
        
        end
    elsif temperature > 600 and temperature <= 650 
        if pressure <= 125 
        flange_class = "150"
        pressure_rating = 125
        temperature_rating = 650
        elsif  pressure > 125 and pressure <= 590 
        flange_class = "300"
        pressure_rating = 590
        temperature_rating = 650
        elsif  pressure > 590 and pressure <= 785 
        flange_class = "400"
        pressure_rating = 785
        temperature_rating = 650
        elsif  pressure > 785 and pressure <= 1175 
        flange_class = "600"
        pressure_rating = 1175
        temperature_rating = 650
        elsif  pressure > 1175 and pressure <= 1765 
        flange_class = "900"
        pressure_rating = 1765
        temperature_rating = 650
        elsif  pressure > 1765 and pressure <= 2940 
        flange_class = "1500"
        pressure_rating = 2940
        temperature_rating = 650
        elsif  pressure > 2940 and pressure <= 4905 
        flange_class = "2500"
        pressure_rating = 4905
        temperature_rating = 650
        
        end
    elsif temperature > 650 and temperature <= 700 
        if pressure <= 110 
        flange_class = "150"
        pressure_rating = 110
        temperature_rating = 700
        elsif  pressure > 110 and pressure <= 570 
        flange_class = "300"
        pressure_rating = 570
        temperature_rating = 700
        elsif  pressure > 570 and pressure <= 755 
        flange_class = "400"
        pressure_rating = 755
        temperature_rating = 700
        elsif  pressure > 755 and pressure <= 1135 
        flange_class = "600"
        pressure_rating = 1135
        temperature_rating = 700
        elsif  pressure > 1135 and pressure <= 1705 
        flange_class = "900"
        pressure_rating = 1705
        temperature_rating = 700
        elsif  pressure > 1705 and pressure <= 2840 
        flange_class = "1500"
        pressure_rating = 2840
        temperature_rating = 700
        elsif  pressure > 2840 and pressure <= 4730 
        flange_class = "2500"
        pressure_rating = 4730
        temperature_rating = 700
        
        end
    elsif temperature > 700 and temperature <= 750 
        if pressure <= 95 
        flange_class = "150"
        pressure_rating = 95
        temperature_rating = 750
        elsif  pressure > 95 and pressure <= 530 
        flange_class = "300"
        pressure_rating = 530
        temperature_rating = 750
        elsif  pressure > 530 and pressure <= 710 
        flange_class = "400"
        pressure_rating = 710
        temperature_rating = 750
        elsif  pressure > 710 and pressure <= 1065 
        flange_class = "600"
        pressure_rating = 1065
        temperature_rating = 750
        elsif  pressure > 1065 and pressure <= 1595 
        flange_class = "900"
        pressure_rating = 1595
        temperature_rating = 750
        elsif  pressure > 1595 and pressure <= 2660 
        flange_class = "1500"
        pressure_rating = 2660
        temperature_rating = 750
        elsif  pressure > 2660 and pressure <= 4430 
        flange_class = "2500"
        pressure_rating = 4430
        temperature_rating = 750
        
        end
    elsif temperature > 750 and temperature <= 800 
        if pressure <= 80 
        flange_class = "150"
        pressure_rating = 80
        temperature_rating = 800
        elsif  pressure > 80 and pressure <= 510 
        flange_class = "300"
        pressure_rating = 510
        temperature_rating = 800
        elsif  pressure > 510 and pressure <= 675 
        flange_class = "400"
        pressure_rating = 675
        temperature_rating = 800
        elsif  pressure > 675 and pressure <= 1015 
        flange_class = "600"
        pressure_rating = 1015
        temperature_rating = 800
        elsif  pressure > 1015 and pressure <= 1525 
        flange_class = "900"
        pressure_rating = 1525
        temperature_rating = 800
        elsif  pressure > 1525 and pressure <= 2540 
        flange_class = "1500"
        pressure_rating = 2450
        temperature_rating = 800
        elsif  pressure > 2450 and pressure <= 4230 
        flange_class = "2500"
        pressure_rating = 4230
        temperature_rating = 800
        
        end
    
    end
    
    if Worksheets("UOM").chkCustomary.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) Use solution annealed material only."
    elsif orksheets("UOM").chkSI.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) Use solution annealed material only."
    
    end
    
elsif material_group = "3.8" 
UserFormLineSegmentDesign.cmbMaterialDesignation.RowSource = "MaterialGroup3.8"
    if temperature >= -20 and temperature <= 100 
        if pressure <= 290 
        flange_class = "150"
        pressure_rating = 290
        temperature_rating = 100
        elsif  pressure > 290 and pressure <= 750 
        flange_class = "300"
        pressure_rating = 750
        temperature_rating = 100
        elsif  pressure > 750 and pressure <= 1000 
        flange_class = "400"
        pressure_rating = 1000
        temperature_rating = 100
        elsif  pressure > 1000 and pressure <= 1500 
        flange_class = "600"
        pressure_rating = 1500
        temperature_rating = 100
        elsif  pressure > 1500 and pressure <= 2250 
        flange_class = "900"
        pressure_rating = 2250
        temperature_rating = 100
        elsif  pressure > 2250 and pressure <= 3750 
        flange_class = "1500"
        pressure_rating = 3750
        temperature_rating = 100
        elsif  pressure > 3750 and pressure <= 6250 
        flange_class = "2500"
        pressure_rating = 6250
        temperature_rating = 100
        
        end
    elsif temperature > 100 and temperature <= 200 
        if pressure <= 260 
        flange_class = "150"
        pressure_rating = 260
        temperature_rating = 200
        elsif  pressure > 260 and pressure <= 750 
        flange_class = "300"
        pressure_rating = 750
        temperature_rating = 200
        elsif  pressure > 750 and pressure <= 1000 
        flange_class = "400"
        pressure_rating = 1000
        temperature_rating = 200
        elsif  pressure > 1000 and pressure <= 1500 
        flange_class = "600"
        pressure_rating = 1500
        temperature_rating = 200
        elsif  pressure > 1500 and pressure <= 2250 
        flange_class = "900"
        pressure_rating = 2250
        temperature_rating = 200
        elsif  pressure > 2250 and pressure <= 3750 
        flange_class = "1500"
        pressure_rating = 3750
        temperature_rating = 200
        elsif  pressure > 3750 and pressure <= 6250 
        flange_class = "2500"
        pressure_rating = 6250
        temperature_rating = 200
        
        end
    elsif temperature > 200 and temperature <= 300 
        if pressure <= 230 
        flange_class = "150"
        pressure_rating = 230
        temperature_rating = 300
        elsif  pressure > 230 and pressure <= 730 
        flange_class = "300"
        pressure_rating = 730
        temperature_rating = 300
        elsif  pressure > 730 and pressure <= 970 
        flange_class = "400"
        pressure_rating = 970
        temperature_rating = 300
        elsif  pressure > 970 and pressure <= 1455 
        flange_class = "600"
        pressure_rating = 1455
        temperature_rating = 300
        elsif  pressure > 1455 and pressure <= 2185 
        flange_class = "900"
        pressure_rating = 2185
        temperature_rating = 300
        elsif  pressure > 2185 and pressure <= 3640 
        flange_class = "1500"
        pressure_rating = 3640
        temperature_rating = 300
        elsif  pressure > 3640 and pressure <= 6070 
        flange_class = "2500"
        pressure_rating = 6070
        temperature_rating = 300
        
        end
    elsif temperature > 300 and temperature <= 400 
        if pressure <= 200 
        flange_class = "150"
        pressure_rating = 200
        temperature_rating = 400
        elsif  pressure > 200 and pressure <= 700 
        flange_class = "300"
        pressure_rating = 700
        temperature_rating = 400
        elsif  pressure > 700 and pressure <= 930 
        flange_class = "400"
        pressure_rating = 930
        temperature_rating = 400
        elsif  pressure > 930 and pressure <= 1395 
        flange_class = "600"
        pressure_rating = 1395
        temperature_rating = 400
        elsif  pressure > 1395 and pressure <= 2095 
        flange_class = "900"
        pressure_rating = 2095
        temperature_rating = 400
        elsif  pressure > 2095 and pressure <= 3490 
        flange_class = "1500"
        pressure_rating = 3490
        temperature_rating = 400
        elsif  pressure > 3490 and pressure <= 5820 
        flange_class = "2500"
        pressure_rating = 5820
        temperature_rating = 400
        
        end
    elsif temperature > 400 and temperature <= 500 
        if pressure <= 170 
        flange_class = "150"
        pressure_rating = 170
        temperature_rating = 500
        elsif  pressure > 170 and pressure <= 665 
        flange_class = "300"
        pressure_rating = 665
        temperature_rating = 500
        elsif  pressure > 665 and pressure <= 885 
        flange_class = "400"
        pressure_rating = 885
        temperature_rating = 500
        elsif  pressure > 885 and pressure <= 1330 
        flange_class = "600"
        pressure_rating = 1330
        temperature_rating = 500
        elsif  pressure > 1330 and pressure <= 1995 
        flange_class = "900"
        pressure_rating = 1995
        temperature_rating = 500
        elsif  pressure > 1995 and pressure <= 3325 
        flange_class = "1500"
        pressure_rating = 3325
        temperature_rating = 500
        elsif  pressure > 3325 and pressure <= 5540 
        flange_class = "2500"
        pressure_rating = 5540
        temperature_rating = 500
        
        end
    elsif temperature > 500 and temperature <= 600 
        if pressure <= 140 
        flange_class = "150"
        pressure_rating = 140
        temperature_rating = 600
        elsif  pressure > 140 and pressure <= 605 
        flange_class = "300"
        pressure_rating = 605
        temperature_rating = 600
        elsif  pressure > 605 and pressure <= 805 
        flange_class = "400"
        pressure_rating = 805
        temperature_rating = 600
        elsif  pressure > 805 and pressure <= 1210 
        flange_class = "600"
        pressure_rating = 1210
        temperature_rating = 600
        elsif  pressure > 1210 and pressure <= 1815 
        flange_class = "900"
        pressure_rating = 1815
        temperature_rating = 600
        elsif  pressure > 1815 and pressure <= 3025 
        flange_class = "1500"
        pressure_rating = 3025
        temperature_rating = 600
        elsif  pressure > 3025 and pressure <= 5040 
        flange_class = "2500"
        pressure_rating = 5040
        temperature_rating = 600
        
        end
    elsif temperature > 600 and temperature <= 650 
        if pressure <= 125 
        flange_class = "150"
        pressure_rating = 125
        temperature_rating = 650
        elsif  pressure > 125 and pressure <= 590 
        flange_class = "300"
        pressure_rating = 590
        temperature_rating = 650
        elsif  pressure > 590 and pressure <= 785 
        flange_class = "400"
        pressure_rating = 785
        temperature_rating = 650
        elsif  pressure > 785 and pressure <= 1175 
        flange_class = "600"
        pressure_rating = 1175
        temperature_rating = 650
        elsif  pressure > 1175 and pressure <= 1765 
        flange_class = "900"
        pressure_rating = 1765
        temperature_rating = 650
        elsif  pressure > 1765 and pressure <= 2940 
        flange_class = "1500"
        pressure_rating = 2940
        temperature_rating = 650
        elsif  pressure > 2940 and pressure <= 4905 
        flange_class = "2500"
        pressure_rating = 4905
        temperature_rating = 650
        
        end
    elsif temperature > 650 and temperature <= 700 
        if pressure <= 110 
        flange_class = "150"
        pressure_rating = 110
        temperature_rating = 700
        elsif  pressure > 110 and pressure <= 570 
        flange_class = "300"
        pressure_rating = 570
        temperature_rating = 700
        elsif  pressure > 570 and pressure <= 755 
        flange_class = "400"
        pressure_rating = 755
        temperature_rating = 700
        elsif  pressure > 755 and pressure <= 1135 
        flange_class = "600"
        pressure_rating = 1135
        temperature_rating = 700
        elsif  pressure > 1135 and pressure <= 1705 
        flange_class = "900"
        pressure_rating = 1705
        temperature_rating = 700
        elsif  pressure > 1705 and pressure <= 2840 
        flange_class = "1500"
        pressure_rating = 2840
        temperature_rating = 700
        elsif  pressure > 2840 and pressure <= 4730 
        flange_class = "2500"
        pressure_rating = 4730
        temperature_rating = 700
        
        end
    elsif temperature > 700 and temperature <= 750 
        if pressure <= 95 
        flange_class = "150"
        pressure_rating = 95
        temperature_rating = 750
        elsif  pressure > 95 and pressure <= 530 
        flange_class = "300"
        pressure_rating = 530
        temperature_rating = 750
        elsif  pressure > 530 and pressure <= 710 
        flange_class = "400"
        pressure_rating = 710
        temperature_rating = 750
        elsif  pressure > 710 and pressure <= 1065 
        flange_class = "600"
        pressure_rating = 1065
        temperature_rating = 750
        elsif  pressure > 1065 and pressure <= 1595 
        flange_class = "900"
        pressure_rating = 1595
        temperature_rating = 750
        elsif  pressure > 1595 and pressure <= 2660 
        flange_class = "1500"
        pressure_rating = 2660
        temperature_rating = 750
        elsif  pressure > 2660 and pressure <= 4430 
        flange_class = "2500"
        pressure_rating = 4430
        temperature_rating = 750
        
        end
    elsif temperature > 750 and temperature <= 800 
        if pressure <= 80 
        flange_class = "150"
        pressure_rating = 80
        temperature_rating = 800
        elsif  pressure > 80 and pressure <= 510 
        flange_class = "300"
        pressure_rating = 510
        temperature_rating = 800
        elsif  pressure > 510 and pressure <= 675 
        flange_class = "400"
        pressure_rating = 675
        temperature_rating = 800
        elsif  pressure > 675 and pressure <= 1015 
        flange_class = "600"
        pressure_rating = 1015
        temperature_rating = 800
        elsif  pressure > 1015 and pressure <= 1525 
        flange_class = "900"
        pressure_rating = 1525
        temperature_rating = 800
        elsif  pressure > 1525 and pressure <= 2540 
        flange_class = "1500"
        pressure_rating = 2450
        temperature_rating = 800
        elsif  pressure > 2450 and pressure <= 4230 
        flange_class = "2500"
        pressure_rating = 4230
        temperature_rating = 800
        
        end
    elsif temperature > 800 and temperature <= 850 
        if pressure <= 65 
        flange_class = "150"
        pressure_rating = 65
        temperature_rating = 850
        elsif  pressure > 65 and pressure <= 485 
        flange_class = "300"
        pressure_rating = 485
        temperature_rating = 850
        elsif  pressure > 485 and pressure <= 650 
        flange_class = "400"
        pressure_rating = 650
        temperature_rating = 850
        elsif  pressure > 650 and pressure <= 975 
        flange_class = "600"
        pressure_rating = 975
        temperature_rating = 850
        elsif  pressure > 975 and pressure <= 1460 
        flange_class = "900"
        pressure_rating = 1460
        temperature_rating = 850
        elsif  pressure > 1460 and pressure <= 2435 
        flange_class = "1500"
        pressure_rating = 2435
        temperature_rating = 850
        elsif  pressure > 2435 and pressure <= 4060 
        flange_class = "2500"
        pressure_rating = 4060
        temperature_rating = 850
        
        end
    elsif temperature > 850 and temperature <= 900 
        if pressure <= 50 
        flange_class = "150"
        pressure_rating = 50
        temperature_rating = 900
        elsif  pressure > 50 and pressure <= 450 
        flange_class = "300"
        pressure_rating = 450
        temperature_rating = 900
        elsif  pressure > 450 and pressure <= 600 
        flange_class = "400"
        pressure_rating = 600
        temperature_rating = 900
        elsif  pressure > 600 and pressure <= 900 
        flange_class = "600"
        pressure_rating = 900
        temperature_rating = 900
        elsif  pressure > 900 and pressure <= 1350 
        flange_class = "900"
        pressure_rating = 1350
        temperature_rating = 900
        elsif  pressure > 1350 and pressure <= 2245 
        flange_class = "1500"
        pressure_rating = 2245
        temperature_rating = 900
        elsif  pressure > 2245 and pressure <= 3745 
        flange_class = "2500"
        pressure_rating = 3745
        temperature_rating = 900
        
        end
    elsif temperature > 900 and temperature <= 950 
        if pressure <= 35 
        flange_class = "150"
        pressure_rating = 35
        temperature_rating = 950
        elsif  pressure > 35 and pressure <= 385 
        flange_class = "300"
        pressure_rating = 385
        temperature_rating = 950
        elsif  pressure > 385 and pressure <= 515 
        flange_class = "400"
        pressure_rating = 515
        temperature_rating = 950
        elsif  pressure > 515 and pressure <= 775 
        flange_class = "600"
        pressure_rating = 775
        temperature_rating = 950
        elsif  pressure > 775 and pressure <= 1160 
        flange_class = "900"
        pressure_rating = 1160
        temperature_rating = 950
        elsif  pressure > 1160 and pressure <= 1930 
        flange_class = "1500"
        pressure_rating = 1930
        temperature_rating = 950
        elsif  pressure > 1930 and pressure <= 3220 
        flange_class = "2500"
        pressure_rating = 3220
        temperature_rating = 950
        
        end
    elsif temperature > 950 and temperature <= 1000 
        if pressure <= 20 
        flange_class = "150"
        pressure_rating = 20
        temperature_rating = 1000
        elsif  pressure > 20 and pressure <= 365 
        flange_class = "300"
        pressure_rating = 365
        temperature_rating = 1000
        elsif  pressure > 365 and pressure <= 485 
        flange_class = "400"
        pressure_rating = 485
        temperature_rating = 1000
        elsif  pressure > 485 and pressure <= 725 
        flange_class = "600"
        pressure_rating = 725
        temperature_rating = 1000
        elsif  pressure > 725 and pressure <= 1090 
        flange_class = "900"
        pressure_rating = 1090
        temperature_rating = 1000
        elsif  pressure > 1090 and pressure <= 1820 
        flange_class = "1500"
        pressure_rating = 1820
        temperature_rating = 1000
        elsif  pressure > 1820 and pressure <= 3030 
        flange_class = "2500"
        pressure_rating = 3030
        temperature_rating = 1000
        
        end
    elsif temperature > 1000 and temperature <= 1050 
        if pressure > 360 
        flange_class = "300"
        pressure_rating = 360
        temperature_rating = 1050
        elsif  pressure > 360 and pressure <= 480 
        flange_class = "400"
        pressure_rating = 480
        temperature_rating = 1050
        elsif  pressure > 480 and pressure <= 720 
        flange_class = "600"
        pressure_rating = 720
        temperature_rating = 1050
        elsif  pressure > 720 and pressure <= 1080 
        flange_class = "900"
        pressure_rating = 1080
        temperature_rating = 1050
        elsif  pressure > 1080 and pressure <= 1800 
        flange_class = "1500"
        pressure_rating = 1800
        temperature_rating = 1050
        elsif  pressure > 1800 and pressure <= 3000 
        flange_class = "2500"
        pressure_rating = 3000
        temperature_rating = 1050
        
        end
    elsif temperature > 1050 and temperature <= 1100 
        if pressure > 325 
        flange_class = "300"
        pressure_rating = 325
        temperature_rating = 1100
        elsif  pressure > 325 and pressure <= 430 
        flange_class = "400"
        pressure_rating = 430
        temperature_rating = 1100
        elsif  pressure > 430 and pressure <= 645 
        flange_class = "600"
        pressure_rating = 645
        temperature_rating = 1100
        elsif  pressure > 645 and pressure <= 965 
        flange_class = "900"
        pressure_rating = 965
        temperature_rating = 1100
        elsif  pressure > 965 and pressure <= 1610 
        flange_class = "1500"
        pressure_rating = 1610
        temperature_rating = 1100
        elsif  pressure > 1610 and pressure <= 2685 
        flange_class = "2500"
        pressure_rating = 2685
        temperature_rating = 1100
        
        end
    elsif temperature > 1100 and temperature <= 1150 
        if pressure > 275 
        flange_class = "300"
        pressure_rating = 275
        temperature_rating = 1150
        elsif  pressure > 275 and pressure <= 365 
        flange_class = "400"
        pressure_rating = 365
        temperature_rating = 1150
        elsif  pressure > 365 and pressure <= 550 
        flange_class = "600"
        pressure_rating = 550
        temperature_rating = 1150
        elsif  pressure > 550 and pressure <= 825 
        flange_class = "900"
        pressure_rating = 825
        temperature_rating = 1150
        elsif  pressure > 825 and pressure <= 1370 
        flange_class = "1500"
        pressure_rating = 1370
        temperature_rating = 1150
        elsif  pressure > 1370 and pressure <= 2285 
        flange_class = "2500"
        pressure_rating = 2285
        temperature_rating = 1150
        
        end
    elsif temperature > 1150 and temperature <= 1200 
        if pressure > 205 
        flange_class = "300"
        pressure_rating = 205
        temperature_rating = 1200
        elsif  pressure > 205 and pressure <= 275 
        flange_class = "400"
        pressure_rating = 275
        temperature_rating = 1200
        elsif  pressure > 275 and pressure <= 410 
        flange_class = "600"
        pressure_rating = 410
        temperature_rating = 1200
        elsif  pressure > 410 and pressure <= 615 
        flange_class = "900"
        pressure_rating = 615
        temperature_rating = 1200
        elsif  pressure > 615 and pressure <= 1030 
        flange_class = "1500"
        pressure_rating = 1030
        temperature_rating = 1200
        elsif  pressure > 1030 and pressure <= 1715 
        flange_class = "2500"
        pressure_rating = 1715
        temperature_rating = 1200
        
        end
    elsif temperature > 1200 and temperature <= 1250 
        if pressure > 165 
        flange_class = "300"
        pressure_rating = 165
        temperature_rating = 1250
        elsif  pressure > 165 and pressure <= 220 
        flange_class = "400"
        pressure_rating = 220
        temperature_rating = 1250
        elsif  pressure > 220 and pressure <= 330 
        flange_class = "600"
        pressure_rating = 330
        temperature_rating = 1250
        elsif  pressure > 330 and pressure <= 495 
        flange_class = "900"
        pressure_rating = 495
        temperature_rating = 1250
        elsif  pressure > 495 and pressure <= 825 
        flange_class = "1500"
        pressure_rating = 825
        temperature_rating = 1250
        elsif  pressure > 825 and pressure <= 1370 
        flange_class = "2500"
        pressure_rating = 1370
        temperature_rating = 1250
        
        end
    elsif temperature > 1250 and temperature <= 1300 
        if pressure > 120 
        flange_class = "300"
        pressure_rating = 120
        temperature_rating = 1300
        elsif  pressure > 120 and pressure <= 160 
        flange_class = "400"
        pressure_rating = 160
        temperature_rating = 1300
        elsif  pressure > 160 and pressure <= 240 
        flange_class = "600"
        pressure_rating = 240
        temperature_rating = 1300
        elsif  pressure > 240 and pressure <= 360 
        flange_class = "900"
        pressure_rating = 360
        temperature_rating = 1300
        elsif  pressure > 360 and pressure <= 600 
        flange_class = "1500"
        pressure_rating = 600
        temperature_rating = 1300
        elsif  pressure > 600 and pressure <= 1000 
        flange_class = "2500"
        pressure_rating = 1000
        temperature_rating = 1300
        
        end
    
    end
    
    if Worksheets("UOM").chkCustomary.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) Use solution annealed material only." & Chr(13) _
    & "(2) Not to be used over 1250\B0F." & Chr(13) _
    & "(3) Use annealed material only." & Chr(13) _
    & "(4) Not to be used over 1200\B0F. Alloy N06625 in the annealed condition is subject to severe loss of impact strength at room temperatures after exposure in the range of 1000\B0F to 1400\B0F." & Chr(13) _
    & "(5) The chemical composition, mechanical properties, heat treating requirements, and grain size requirements shall conform to the applicable ASTM specification. The manufacturing procedures, tolerances, tests, certification, and markings shall be in accordance with ASTM B 564." & Chr(13) _
    & "(6) Not to be used over 800\B0F." & Chr(13) _
    & "(7) Not to be used over 1000\B0F." & Chr(13) _
    & "(8) Alloy N06022 in the solution annealed condition is subject to severe loss of impact strength at room temperature after exposure to temperatures in the range of 1000\B0F to 1250\B0F."
    elsif orksheets("UOM").chkSI.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) Use solution annealed material only." & Chr(13) _
    & "(2) Not to be used over 675\B0C." & Chr(13) _
    & "(3) Use annealed material only." & Chr(13) _
    & "(4) Not to be used over 645\B0C. Alloy N06625 in the annealed condition is subject to severe loss of impact strength at room temperatures after exposure in the range of 538\B0C to 760\B0C." & Chr(13) _
    & "(5) Not to be used over 425\B0C." & Chr(13) _
    & "(6) The chemical composition, mechanical properties, heat treating requirements, and grain size requirements shall conform to the applicable ASTM specification. The manufacturing procedures, tolerances, tests, certification, and markings shall be in accordance with ASTM B 564." & Chr(13) _
    & "(7) Not to be used over 538\B0C." & Chr(13) _
    & "(8) Alloy N06022 in the solution annealed condition is subject to severe loss of impact strength at room temperature after exposure to temperatures in the range of 538\B0C to 675\B0C."
    
    flange_classd if
    pressure_ratingElse
Call FlangePressuretemperature_rating7(pressure, temperature, MaterialGroup, FlangeClass, PressureRating, temperature_rating)
flange_class if

pressure_ratingSub

Sub FlangePressuretemperature_rating7(pressure, temperature, MaterialGroup, FlangeClass, PressureRating, temperature_rating)

if MaterialGroup = "3.9" 
UserFormLineSegmentDesign.cmbMaterialDesignation.RowSource = "MaterialGroup3.9"
    if temperature >= -20 and temperature <= 100 
        if pressure <= 290 
        flange_class = "150"
        pressure_rating = 290
        temperature_rating = 100
        elsif  pressure > 290 and pressure <= 750 
        flange_class = "300"
        pressure_rating = 750
        temperature_rating = 100
        elsif  pressure > 750 and pressure <= 1000 
        flange_class = "400"
        pressure_rating = 1000
        temperature_rating = 100
        elsif  pressure > 1000 and pressure <= 1500 
        flange_class = "600"
        pressure_rating = 1500
        temperature_rating = 100
        elsif  pressure > 1500 and pressure <= 2250 
        flange_class = "900"
        pressure_rating = 2250
        temperature_rating = 100
        elsif  pressure > 2250 and pressure <= 3750 
        flange_class = "1500"
        pressure_rating = 3750
        temperature_rating = 100
        elsif  pressure > 3750 and pressure <= 6250 
        flange_class = "2500"
        pressure_rating = 6250
        temperature_rating = 100
        
        end
    elsif temperature > 100 and temperature <= 200 
        if pressure <= 260 
        flange_class = "150"
        pressure_rating = 260
        temperature_rating = 200
        elsif  pressure > 260 and pressure <= 750 
        flange_class = "300"
        pressure_rating = 750
        temperature_rating = 200
        elsif  pressure > 750 and pressure <= 1000 
        flange_class = "400"
        pressure_rating = 1000
        temperature_rating = 200
        elsif  pressure > 1000 and pressure <= 1500 
        flange_class = "600"
        pressure_rating = 1500
        temperature_rating = 200
        elsif  pressure > 1500 and pressure <= 2250 
        flange_class = "900"
        pressure_rating = 2250
        temperature_rating = 200
        elsif  pressure > 2250 and pressure <= 3750 
        flange_class = "1500"
        pressure_rating = 3750
        temperature_rating = 200
        elsif  pressure > 3750 and pressure <= 6250 
        flange_class = "2500"
        pressure_rating = 6250
        temperature_rating = 200
        
        end
    elsif temperature > 200 and temperature <= 300 
        if pressure <= 230 
        flange_class = "150"
        pressure_rating = 230
        temperature_rating = 300
        elsif  pressure > 230 and pressure <= 690 
        flange_class = "300"
        pressure_rating = 690
        temperature_rating = 300
        elsif  pressure > 690 and pressure <= 920 
        flange_class = "400"
        pressure_rating = 920
        temperature_rating = 300
        elsif  pressure > 920 and pressure <= 1380 
        flange_class = "600"
        pressure_rating = 1380
        temperature_rating = 300
        elsif  pressure > 1380 and pressure <= 2075 
        flange_class = "900"
        pressure_rating = 2075
        temperature_rating = 300
        elsif  pressure > 2075 and pressure <= 3455 
        flange_class = "1500"
        pressure_rating = 3455
        temperature_rating = 300
        elsif  pressure > 3455 and pressure <= 5760 
        flange_class = "2500"
        pressure_rating = 5760
        temperature_rating = 300
        
        end
    elsif temperature > 300 and temperature <= 400 
        if pressure <= 200 
        flange_class = "150"
        pressure_rating = 200
        temperature_rating = 400
        elsif  pressure > 200 and pressure <= 640 
        flange_class = "300"
        pressure_rating = 640
        temperature_rating = 400
        elsif  pressure > 640 and pressure <= 850 
        flange_class = "400"
        pressure_rating = 850
        temperature_rating = 400
        elsif  pressure > 850 and pressure <= 1275 
        flange_class = "600"
        pressure_rating = 1275
        temperature_rating = 400
        elsif  pressure > 1275 and pressure <= 1915 
        flange_class = "900"
        pressure_rating = 1915
        temperature_rating = 400
        elsif  pressure > 1915 and pressure <= 3190 
        flange_class = "1500"
        pressure_rating = 3190
        temperature_rating = 400
        elsif  pressure > 3190 and pressure <= 5320 
        flange_class = "2500"
        pressure_rating = 5320
        temperature_rating = 400
        
        end
    elsif temperature > 400 and temperature <= 500 
        if pressure <= 170 
        flange_class = "150"
        pressure_rating = 170
        temperature_rating = 500
        elsif  pressure > 170 and pressure <= 595 
        flange_class = "300"
        pressure_rating = 595
        temperature_rating = 500
        elsif  pressure > 595 and pressure <= 795 
        flange_class = "400"
        pressure_rating = 795
        temperature_rating = 500
        elsif  pressure > 795 and pressure <= 1190 
        flange_class = "600"
        pressure_rating = 1190
        temperature_rating = 500
        elsif  pressure > 1190 and pressure <= 1785 
        flange_class = "900"
        pressure_rating = 1785
        temperature_rating = 500
        elsif  pressure > 1785 and pressure <= 2975 
        flange_class = "1500"
        pressure_rating = 2975
        temperature_rating = 500
        elsif  pressure > 2975 and pressure <= 4960 
        flange_class = "2500"
        pressure_rating = 4960
        temperature_rating = 500
        
        end
    elsif temperature > 500 and temperature <= 600 
        if pressure <= 140 
        flange_class = "150"
        pressure_rating = 140
        temperature_rating = 600
        elsif  pressure > 140 and pressure <= 565 
        flange_class = "300"
        pressure_rating = 565
        temperature_rating = 600
        elsif  pressure > 565 and pressure <= 750 
        flange_class = "400"
        pressure_rating = 750
        temperature_rating = 600
        elsif  pressure > 750 and pressure <= 1130 
        flange_class = "600"
        pressure_rating = 1130
        temperature_rating = 600
        elsif  pressure > 1130 and pressure <= 1690 
        flange_class = "900"
        pressure_rating = 1690
        temperature_rating = 600
        elsif  pressure > 1690 and pressure <= 2820 
        flange_class = "1500"
        pressure_rating = 2820
        temperature_rating = 600
        elsif  pressure > 2820 and pressure <= 4700 
        flange_class = "2500"
        pressure_rating = 4700
        temperature_rating = 600
        
        end
    elsif temperature > 600 and temperature <= 650 
        if pressure <= 125 
        flange_class = "150"
        pressure_rating = 125
        temperature_rating = 650
        elsif  pressure > 125 and pressure <= 550 
        flange_class = "300"
        pressure_rating = 550
        temperature_rating = 650
        elsif  pressure > 550 and pressure <= 735 
        flange_class = "400"
        pressure_rating = 735
        temperature_rating = 650
        elsif  pressure > 735 and pressure <= 1105 
        flange_class = "600"
        pressure_rating = 1105
        temperature_rating = 650
        elsif  pressure > 1105 and pressure <= 1655 
        flange_class = "900"
        pressure_rating = 1655
        temperature_rating = 650
        elsif  pressure > 1655 and pressure <= 2760 
        flange_class = "1500"
        pressure_rating = 2760
        temperature_rating = 650
        elsif  pressure > 2760 and pressure <= 4600 
        flange_class = "2500"
        pressure_rating = 4600
        temperature_rating = 650
        
        end
    elsif temperature > 650 and temperature <= 700 
        if pressure <= 110 
        flange_class = "150"
        pressure_rating = 110
        temperature_rating = 700
        elsif  pressure > 110 and pressure <= 540 
        flange_class = "300"
        pressure_rating = 540
        temperature_rating = 700
        elsif  pressure > 540 and pressure <= 725 
        flange_class = "400"
        pressure_rating = 725
        temperature_rating = 700
        elsif  pressure > 725 and pressure <= 1085 
        flange_class = "600"
        pressure_rating = 1085
        temperature_rating = 700
        elsif  pressure > 1085 and pressure <= 1625 
        flange_class = "900"
        pressure_rating = 1625
        temperature_rating = 700
        elsif  pressure > 1625 and pressure <= 2710 
        flange_class = "1500"
        pressure_rating = 2710
        temperature_rating = 700
        elsif  pressure > 2710 and pressure <= 4520 
        flange_class = "2500"
        pressure_rating = 4520
        temperature_rating = 700
        
        end
    elsif temperature > 700 and temperature <= 750 
        if pressure <= 95 
        flange_class = "150"
        pressure_rating = 95
        temperature_rating = 750
        elsif  pressure > 95 and pressure <= 530 
        flange_class = "300"
        pressure_rating = 530
        temperature_rating = 750
        elsif  pressure > 530 and pressure <= 710 
        flange_class = "400"
        pressure_rating = 710
        temperature_rating = 750
        elsif  pressure > 710 and pressure <= 1065 
        flange_class = "600"
        pressure_rating = 1065
        temperature_rating = 750
        elsif  pressure > 1065 and pressure <= 1595 
        flange_class = "900"
        pressure_rating = 1595
        temperature_rating = 750
        elsif  pressure > 1595 and pressure <= 2660 
        flange_class = "1500"
        pressure_rating = 2660
        temperature_rating = 750
        elsif  pressure > 2660 and pressure <= 4430 
        flange_class = "2500"
        pressure_rating = 4430
        temperature_rating = 750
        
        end
    elsif temperature > 750 and temperature <= 800 
        if pressure <= 80 
        flange_class = "150"
        pressure_rating = 80
        temperature_rating = 800
        elsif  pressure > 80 and pressure <= 510 
        flange_class = "300"
        pressure_rating = 510
        temperature_rating = 800
        elsif  pressure > 510 and pressure <= 675 
        flange_class = "400"
        pressure_rating = 675
        temperature_rating = 800
        elsif  pressure > 675 and pressure <= 1015 
        flange_class = "600"
        pressure_rating = 1015
        temperature_rating = 800
        elsif  pressure > 1015 and pressure <= 1525 
        flange_class = "900"
        pressure_rating = 1525
        temperature_rating = 800
        elsif  pressure > 1525 and pressure <= 2540 
        flange_class = "1500"
        pressure_rating = 2450
        temperature_rating = 800
        elsif  pressure > 2450 and pressure <= 4230 
        flange_class = "2500"
        pressure_rating = 4230
        temperature_rating = 800
        
        end
    elsif temperature > 800 and temperature <= 850 
        if pressure <= 65 
        flange_class = "150"
        pressure_rating = 65
        temperature_rating = 850
        elsif  pressure > 65 and pressure <= 485 
        flange_class = "300"
        pressure_rating = 485
        temperature_rating = 850
        elsif  pressure > 485 and pressure <= 650 
        flange_class = "400"
        pressure_rating = 650
        temperature_rating = 850
        elsif  pressure > 650 and pressure <= 975 
        flange_class = "600"
        pressure_rating = 975
        temperature_rating = 850
        elsif  pressure > 975 and pressure <= 1460 
        flange_class = "900"
        pressure_rating = 1460
        temperature_rating = 850
        elsif  pressure > 1460 and pressure <= 2435 
        flange_class = "1500"
        pressure_rating = 2435
        temperature_rating = 850
        elsif  pressure > 2435 and pressure <= 4060 
        flange_class = "2500"
        pressure_rating = 4060
        temperature_rating = 850
        
        end
    elsif temperature > 850 and temperature <= 900 
        if pressure <= 50 
        flange_class = "150"
        pressure_rating = 50
        temperature_rating = 900
        elsif  pressure > 50 and pressure <= 450 
        flange_class = "300"
        pressure_rating = 450
        temperature_rating = 900
        elsif  pressure > 450 and pressure <= 600 
        flange_class = "400"
        pressure_rating = 600
        temperature_rating = 900
        elsif  pressure > 600 and pressure <= 900 
        flange_class = "600"
        pressure_rating = 900
        temperature_rating = 900
        elsif  pressure > 900 and pressure <= 1350 
        flange_class = "900"
        pressure_rating = 1350
        temperature_rating = 900
        elsif  pressure > 1350 and pressure <= 2245 
        flange_class = "1500"
        pressure_rating = 2245
        temperature_rating = 900
        elsif  pressure > 2245 and pressure <= 3745 
        flange_class = "2500"
        pressure_rating = 3745
        temperature_rating = 900
        
        end
    elsif temperature > 900 and temperature <= 950 
        if pressure <= 35 
        flange_class = "150"
        pressure_rating = 35
        temperature_rating = 950
        elsif  pressure > 35 and pressure <= 385 
        flange_class = "300"
        pressure_rating = 385
        temperature_rating = 950
        elsif  pressure > 385 and pressure <= 515 
        flange_class = "400"
        pressure_rating = 515
        temperature_rating = 950
        elsif  pressure > 515 and pressure <= 775 
        flange_class = "600"
        pressure_rating = 775
        temperature_rating = 950
        elsif  pressure > 775 and pressure <= 1160 
        flange_class = "900"
        pressure_rating = 1160
        temperature_rating = 950
        elsif  pressure > 1160 and pressure <= 1930 
        flange_class = "1500"
        pressure_rating = 1930
        temperature_rating = 950
        elsif  pressure > 1930 and pressure <= 3220 
        flange_class = "2500"
        pressure_rating = 3220
        temperature_rating = 950
        
        end
    elsif temperature > 950 and temperature <= 1000 
        if pressure <= 20 
        flange_class = "150"
        pressure_rating = 20
        temperature_rating = 1000
        elsif  pressure > 20 and pressure <= 365 
        flange_class = "300"
        pressure_rating = 365
        temperature_rating = 1000
        elsif  pressure > 365 and pressure <= 485 
        flange_class = "400"
        pressure_rating = 485
        temperature_rating = 1000
        elsif  pressure > 485 and pressure <= 725 
        flange_class = "600"
        pressure_rating = 725
        temperature_rating = 1000
        elsif  pressure > 725 and pressure <= 1090 
        flange_class = "900"
        pressure_rating = 1090
        temperature_rating = 1000
        elsif  pressure > 1090 and pressure <= 1820 
        flange_class = "1500"
        pressure_rating = 1820
        temperature_rating = 1000
        elsif  pressure > 1820 and pressure <= 3030 
        flange_class = "2500"
        pressure_rating = 3030
        temperature_rating = 1000
        
        end
    elsif temperature > 1000 and temperature <= 1050 
        if pressure > 360 
        flange_class = "300"
        pressure_rating = 360
        temperature_rating = 1050
        elsif  pressure > 360 and pressure <= 480 
        flange_class = "400"
        pressure_rating = 480
        temperature_rating = 1050
        elsif  pressure > 480 and pressure <= 720 
        flange_class = "600"
        pressure_rating = 720
        temperature_rating = 1050
        elsif  pressure > 720 and pressure <= 1080 
        flange_class = "900"
        pressure_rating = 1080
        temperature_rating = 1050
        elsif  pressure > 1080 and pressure <= 1800 
        flange_class = "1500"
        pressure_rating = 1800
        temperature_rating = 1050
        elsif  pressure > 1800 and pressure <= 3000 
        flange_class = "2500"
        pressure_rating = 3000
        temperature_rating = 1050
        
        end
    elsif temperature > 1050 and temperature <= 1100 
        if pressure > 325 
        flange_class = "300"
        pressure_rating = 325
        temperature_rating = 1100
        elsif  pressure > 325 and pressure <= 430 
        flange_class = "400"
        pressure_rating = 430
        temperature_rating = 1100
        elsif  pressure > 430 and pressure <= 645 
        flange_class = "600"
        pressure_rating = 645
        temperature_rating = 1100
        elsif  pressure > 645 and pressure <= 965 
        flange_class = "900"
        pressure_rating = 965
        temperature_rating = 1100
        elsif  pressure > 965 and pressure <= 1610 
        flange_class = "1500"
        pressure_rating = 1610
        temperature_rating = 1100
        elsif  pressure > 1610 and pressure <= 2685 
        flange_class = "2500"
        pressure_rating = 2685
        temperature_rating = 1100
        
        end
    elsif temperature > 1100 and temperature <= 1150 
        if pressure > 275 
        flange_class = "300"
        pressure_rating = 275
        temperature_rating = 1150
        elsif  pressure > 275 and pressure <= 365 
        flange_class = "400"
        pressure_rating = 365
        temperature_rating = 1150
        elsif  pressure > 365 and pressure <= 550 
        flange_class = "600"
        pressure_rating = 550
        temperature_rating = 1150
        elsif  pressure > 550 and pressure <= 825 
        flange_class = "900"
        pressure_rating = 825
        temperature_rating = 1150
        elsif  pressure > 825 and pressure <= 1370 
        flange_class = "1500"
        pressure_rating = 1370
        temperature_rating = 1150
        elsif  pressure > 1370 and pressure <= 2285 
        flange_class = "2500"
        pressure_rating = 2285
        temperature_rating = 1150
        
        end
    elsif temperature > 1150 and temperature <= 1200 
        if pressure > 205 
        flange_class = "300"
        pressure_rating = 205
        temperature_rating = 1200
        elsif  pressure > 205 and pressure <= 275 
        flange_class = "400"
        pressure_rating = 275
        temperature_rating = 1200
        elsif  pressure > 275 and pressure <= 410 
        flange_class = "600"
        pressure_rating = 410
        temperature_rating = 1200
        elsif  pressure > 410 and pressure <= 620 
        flange_class = "900"
        pressure_rating = 620
        temperature_rating = 1200
        elsif  pressure > 620 and pressure <= 1030 
        flange_class = "1500"
        pressure_rating = 1030
        temperature_rating = 1200
        elsif  pressure > 1030 and pressure <= 1715 
        flange_class = "2500"
        pressure_rating = 1715
        temperature_rating = 1200
        
        end
    elsif temperature > 1200 and temperature <= 1250 
        if pressure > 180 
        flange_class = "300"
        pressure_rating = 180
        temperature_rating = 1250
        elsif  pressure > 180 and pressure <= 245 
        flange_class = "400"
        pressure_rating = 245
        temperature_rating = 1250
        elsif  pressure > 245 and pressure <= 365 
        flange_class = "600"
        pressure_rating = 365
        temperature_rating = 1250
        elsif  pressure > 365 and pressure <= 545 
        flange_class = "900"
        pressure_rating = 545
        temperature_rating = 1250
        elsif  pressure > 545 and pressure <= 910 
        flange_class = "1500"
        pressure_rating = 910
        temperature_rating = 1250
        elsif  pressure > 910 and pressure <= 1515 
        flange_class = "2500"
        pressure_rating = 1515
        temperature_rating = 1250
        
        end
    elsif temperature > 1250 and temperature <= 1300 
        if pressure > 140 
        flange_class = "300"
        pressure_rating = 140
        temperature_rating = 1300
        elsif  pressure > 140 and pressure <= 185 
        flange_class = "400"
        pressure_rating = 185
        temperature_rating = 1300
        elsif  pressure > 185 and pressure <= 275 
        flange_class = "600"
        pressure_rating = 275
        temperature_rating = 1300
        elsif  pressure > 275 and pressure <= 410 
        flange_class = "900"
        pressure_rating = 410
        temperature_rating = 1300
        elsif  pressure > 410 and pressure <= 685 
        flange_class = "1500"
        pressure_rating = 685
        temperature_rating = 1300
        elsif  pressure > 685 and pressure <= 1145 
        flange_class = "2500"
        pressure_rating = 1145
        temperature_rating = 1300
        
        end
    elsif temperature > 1300 and temperature <= 1350 
        if pressure > 105 
        flange_class = "300"
        pressure_rating = 105
        temperature_rating = 1350
        elsif  pressure > 105 and pressure <= 140 
        flange_class = "400"
        pressure_rating = 140
        temperature_rating = 1350
        elsif  pressure > 140 and pressure <= 205 
        flange_class = "600"
        pressure_rating = 205
        temperature_rating = 1350
        elsif  pressure > 205 and pressure <= 310 
        flange_class = "900"
        pressure_rating = 310
        temperature_rating = 1350
        elsif  pressure > 310 and pressure <= 515 
        flange_class = "1500"
        pressure_rating = 515
        temperature_rating = 1350
        elsif  pressure > 515 and pressure <= 860 
        flange_class = "2500"
        pressure_rating = 860
        temperature_rating = 1350
        
        end
    elsif temperature > 1350 and temperature <= 1400 
        if pressure > 75 
        flange_class = "300"
        pressure_rating = 75
        temperature_rating = 1400
        elsif  pressure > 75 and pressure <= 100 
        flange_class = "400"
        pressure_rating = 100
        temperature_rating = 1400
        elsif  pressure > 100 and pressure <= 150 
        flange_class = "600"
        pressure_rating = 150
        temperature_rating = 1400
        elsif  pressure > 150 and pressure <= 225 
        flange_class = "900"
        pressure_rating = 225
        temperature_rating = 1400
        elsif  pressure > 225 and pressure <= 380 
        flange_class = "1500"
        pressure_rating = 380
        temperature_rating = 1150
        elsif  pressure > 380 and pressure <= 630 
        flange_class = "2500"
        pressure_rating = 630
        temperature_rating = 1400
        
        end
    elsif temperature > 1400 and temperature <= 1450 
        if pressure > 60 
        flange_class = "300"
        pressure_rating = 60
        temperature_rating = 1450
        elsif  pressure > 60 and pressure <= 80 
        flange_class = "400"
        pressure_rating = 80
        temperature_rating = 1450
        elsif  pressure > 80 and pressure <= 115 
        flange_class = "600"
        pressure_rating = 115
        temperature_rating = 1450
        elsif  pressure > 115 and pressure <= 175 
        flange_class = "900"
        pressure_rating = 175
        temperature_rating = 1450
        elsif  pressure > 175 and pressure <= 290 
        flange_class = "1500"
        pressure_rating = 290
        temperature_rating = 1450
        elsif  pressure > 290 and pressure <= 485 
        flange_class = "2500"
        pressure_rating = 485
        temperature_rating = 1450
        
        end
    elsif temperature > 1450 and temperature <= 1500 
        if pressure > 40 
        flange_class = "300"
        pressure_rating = 40
        temperature_rating = 1500
        elsif  pressure > 40 and pressure <= 55 
        flange_class = "400"
        pressure_rating = 55
        temperature_rating = 1500
        elsif  pressure > 55 and pressure <= 85 
        flange_class = "600"
        pressure_rating = 85
        temperature_rating = 1500
        elsif  pressure > 85 and pressure <= 125 
        flange_class = "900"
        pressure_rating = 125
        temperature_rating = 1500
        elsif  pressure > 125 and pressure <= 205 
        flange_class = "1500"
        pressure_rating = 205
        temperature_rating = 1500
        elsif  pressure > 205 and pressure <= 345 
        flange_class = "2500"
        pressure_rating = 345
        temperature_rating = 1500
        
        end
    
    end
    
    if Worksheets("UOM").chkCustomary.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) Use solution annealed material only." & Chr(13) _
    & "(2) The chemical composition, mechanical properties, heat treating requirements, and grain size requirements shall conform to the applicable ASTM specification. The manufacturing procedures, tolerances, tests, certification, and markings shall be in accordance with ASTM B 564."
    elsif orksheets("UOM").chkSI.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) Use solution annealed material only." & Chr(13) _
    & "(2) The chemical composition, mechanical properties, heat treating requirements, and grain size requirements shall conform to the applicable ASTM specification. The manufacturing procedures, tolerances, tests, certification, and markings shall be in accordance with ASTM B 564."
    
    end
    
elsif material_group = "3.10" 
UserFormLineSegmentDesign.cmbMaterialDesignation.RowSource = "MaterialGroup3.10"
if temperature >= -20 and temperature <= 100 
        if pressure <= 290 
        flange_class = "150"
        pressure_rating = 290
        temperature_rating = 100
        elsif  pressure > 290 and pressure <= 750 
        flange_class = "300"
        pressure_rating = 750
        temperature_rating = 100
        elsif  pressure > 750 and pressure <= 1000 
        flange_class = "400"
        pressure_rating = 1000
        temperature_rating = 100
        elsif  pressure > 1000 and pressure <= 1500 
        flange_class = "600"
        pressure_rating = 1500
        temperature_rating = 100
        elsif  pressure > 1500 and pressure <= 2250 
        flange_class = "900"
        pressure_rating = 2250
        temperature_rating = 100
        elsif  pressure > 2250 and pressure <= 3750 
        flange_class = "1500"
        pressure_rating = 3750
        temperature_rating = 100
        elsif  pressure > 3750 and pressure <= 6250 
        flange_class = "2500"
        pressure_rating = 6250
        temperature_rating = 100
        
        end
    elsif temperature > 100 and temperature <= 200 
        if pressure <= 260 
        flange_class = "150"
        pressure_rating = 260
        temperature_rating = 200
        elsif  pressure > 260 and pressure <= 750 
        flange_class = "300"
        pressure_rating = 750
        temperature_rating = 200
        elsif  pressure > 750 and pressure <= 1000 
        flange_class = "400"
        pressure_rating = 1000
        temperature_rating = 200
        elsif  pressure > 1000 and pressure <= 1500 
        flange_class = "600"
        pressure_rating = 1500
        temperature_rating = 200
        elsif  pressure > 1500 and pressure <= 2250 
        flange_class = "900"
        pressure_rating = 2250
        temperature_rating = 200
        elsif  pressure > 2250 and pressure <= 3750 
        flange_class = "1500"
        pressure_rating = 3750
        temperature_rating = 200
        elsif  pressure > 3750 and pressure <= 6250 
        flange_class = "2500"
        pressure_rating = 6250
        temperature_rating = 200
        
        end
    elsif temperature > 200 and temperature <= 300 
        if pressure <= 230 
        flange_class = "150"
        pressure_rating = 230
        temperature_rating = 300
        elsif  pressure > 230 and pressure <= 685 
        flange_class = "300"
        pressure_rating = 685
        temperature_rating = 300
        elsif  pressure > 685 and pressure <= 910 
        flange_class = "400"
        pressure_rating = 910
        temperature_rating = 300
        elsif  pressure > 910 and pressure <= 1370 
        flange_class = "600"
        pressure_rating = 1370
        temperature_rating = 300
        elsif  pressure > 1370 and pressure <= 2050 
        flange_class = "900"
        pressure_rating = 2050
        temperature_rating = 300
        elsif  pressure > 2050 and pressure <= 3420 
        flange_class = "1500"
        pressure_rating = 3420
        temperature_rating = 300
        elsif  pressure > 3420 and pressure <= 5700 
        flange_class = "2500"
        pressure_rating = 5700
        temperature_rating = 300
        
        end
    elsif temperature > 300 and temperature <= 400 
        if pressure <= 200 
        flange_class = "150"
        pressure_rating = 200
        temperature_rating = 400
        elsif  pressure > 200 and pressure <= 640 
        flange_class = "300"
        pressure_rating = 640
        temperature_rating = 400
        elsif  pressure > 640 and pressure <= 850 
        flange_class = "400"
        pressure_rating = 850
        temperature_rating = 400
        elsif  pressure > 850 and pressure <= 1275 
        flange_class = "600"
        pressure_rating = 1275
        temperature_rating = 400
        elsif  pressure > 1275 and pressure <= 1915 
        flange_class = "900"
        pressure_rating = 1915
        temperature_rating = 400
        elsif  pressure > 1915 and pressure <= 3190 
        flange_class = "1500"
        pressure_rating = 3190
        temperature_rating = 400
        elsif  pressure > 3190 and pressure <= 5320 
        flange_class = "2500"
        pressure_rating = 5320
        temperature_rating = 400
        
        end
    elsif temperature > 400 and temperature <= 500 
        if pressure <= 170 
        flange_class = "150"
        pressure_rating = 170
        temperature_rating = 500
        elsif  pressure > 170 and pressure <= 615 
        flange_class = "300"
        pressure_rating = 615
        temperature_rating = 500
        elsif  pressure > 615 and pressure <= 820 
        flange_class = "400"
        pressure_rating = 820
        temperature_rating = 500
        elsif  pressure > 820 and pressure <= 1235 
        flange_class = "600"
        pressure_rating = 1235
        temperature_rating = 500
        elsif  pressure > 1235 and pressure <= 1850 
        flange_class = "900"
        pressure_rating = 1850
        temperature_rating = 500
        elsif  pressure > 1850 and pressure <= 3085 
        flange_class = "1500"
        pressure_rating = 3085
        temperature_rating = 500
        elsif  pressure > 3085 and pressure <= 5140 
        flange_class = "2500"
        pressure_rating = 5140
        temperature_rating = 500
        
        end
    elsif temperature > 500 and temperature <= 600 
        if pressure <= 140 
        flange_class = "150"
        pressure_rating = 140
        temperature_rating = 600
        elsif  pressure > 140 and pressure <= 595 
        flange_class = "300"
        pressure_rating = 595
        temperature_rating = 600
        elsif  pressure > 595 and pressure <= 790 
        flange_class = "400"
        pressure_rating = 790
        temperature_rating = 600
        elsif  pressure > 790 and pressure <= 1185 
        flange_class = "600"
        pressure_rating = 1185
        temperature_rating = 600
        elsif  pressure > 1185 and pressure <= 1780 
        flange_class = "900"
        pressure_rating = 1780
        temperature_rating = 600
        elsif  pressure > 1780 and pressure <= 2965 
        flange_class = "1500"
        pressure_rating = 2965
        temperature_rating = 600
        elsif  pressure > 2965 and pressure <= 4940 
        flange_class = "2500"
        pressure_rating = 4940
        temperature_rating = 600
        
        end
    elsif temperature > 600 and temperature <= 650 
        if pressure <= 125 
        flange_class = "150"
        pressure_rating = 125
        temperature_rating = 650
        elsif  pressure > 125 and pressure <= 570 
        flange_class = "300"
        pressure_rating = 570
        temperature_rating = 650
        elsif  pressure > 570 and pressure <= 760 
        flange_class = "400"
        pressure_rating = 760
        temperature_rating = 650
        elsif  pressure > 760 and pressure <= 1140 
        flange_class = "600"
        pressure_rating = 1140
        temperature_rating = 650
        elsif  pressure > 1140 and pressure <= 1715 
        flange_class = "900"
        pressure_rating = 1715
        temperature_rating = 650
        elsif  pressure > 1715 and pressure <= 2855 
        flange_class = "1500"
        pressure_rating = 2855
        temperature_rating = 650
        elsif  pressure > 2855 and pressure <= 4760 
        flange_class = "2500"
        pressure_rating = 4760
        temperature_rating = 650
        
        end
    
    end
    
    if Worksheets("UOM").chkCustomary.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) Use solution annealed material only." & Chr(13) _
    & "(2) The chemical composition, mechanical properties, heat treating requirements, and grain size requirements shall conform to the applicable ASTM specification. The manufacturing procedures, tolerances, tests, certification, and markings shall be in accordance with ASTM B 564."
    elsif orksheets("UOM").chkSI.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) Use solution annealed material only." & Chr(13) _
    & "(2) The chemical composition, mechanical properties, heat treating requirements, and grain size requirements shall conform to the applicable ASTM specification. The manufacturing procedures, tolerances, tests, certification, and markings shall be in accordance with ASTM B 564."
    
    end
    
elsif material_group = "3.11" 
UserFormLineSegmentDesign.cmbMaterialDesignation.RowSource = "MaterialGroup3.11"
    if temperature >= -20 and temperature <= 100 
        if pressure <= 285 
        flange_class = "150"
        pressure_rating = 285
        temperature_rating = 100
        elsif  pressure > 285 and pressure <= 745 
        flange_class = "300"
        pressure_rating = 745
        temperature_rating = 100
        elsif  pressure > 745 and pressure <= 990 
        flange_class = "400"
        pressure_rating = 990
        temperature_rating = 100
        elsif  pressure > 990 and pressure <= 1490 
        flange_class = "600"
        pressure_rating = 1490
        temperature_rating = 100
        elsif  pressure > 1490 and pressure <= 2230 
        flange_class = "900"
        pressure_rating = 2230
        temperature_rating = 100
        elsif  pressure > 2230 and pressure <= 3720 
        flange_class = "1500"
        pressure_rating = 3720
        temperature_rating = 100
        elsif  pressure > 3720 and pressure <= 6200 
        flange_class = "2500"
        pressure_rating = 6200
        temperature_rating = 100
        
        end
    elsif temperature > 100 and temperature <= 200 
        if pressure <= 230 
        flange_class = "150"
        pressure_rating = 230
        temperature_rating = 200
        elsif  pressure > 230 and pressure <= 600 
        flange_class = "300"
        pressure_rating = 600
        temperature_rating = 200
        elsif  pressure > 600 and pressure <= 805 
        flange_class = "400"
        pressure_rating = 805
        temperature_rating = 200
        elsif  pressure > 805 and pressure <= 1205 
        flange_class = "600"
        pressure_rating = 1205
        temperature_rating = 200
        elsif  pressure > 1205 and pressure <= 1805 
        flange_class = "900"
        pressure_rating = 1805
        temperature_rating = 200
        elsif  pressure > 1805 and pressure <= 3010 
        flange_class = "1500"
        pressure_rating = 3010
        temperature_rating = 200
        elsif  pressure > 3010 and pressure <= 5020 
        flange_class = "2500"
        pressure_rating = 5020
        temperature_rating = 200
        
        end
    elsif temperature > 200 and temperature <= 300 
        if pressure <= 210 
        flange_class = "150"
        pressure_rating = 210
        temperature_rating = 300
        elsif  pressure > 210 and pressure <= 545 
        flange_class = "300"
        pressure_rating = 545
        temperature_rating = 300
        elsif  pressure > 545 and pressure <= 725 
        flange_class = "400"
        pressure_rating = 725
        temperature_rating = 300
        elsif  pressure > 725 and pressure <= 1090 
        flange_class = "600"
        pressure_rating = 1090
        temperature_rating = 300
        elsif  pressure > 1090 and pressure <= 1635 
        flange_class = "900"
        pressure_rating = 1635
        temperature_rating = 300
        elsif  pressure > 1635 and pressure <= 2725 
        flange_class = "1500"
        pressure_rating = 2725
        temperature_rating = 300
        elsif  pressure > 2725 and pressure <= 4540 
        flange_class = "2500"
        pressure_rating = 4540
        temperature_rating = 300
        
        end
    elsif temperature > 300 and temperature <= 400 
        if pressure <= 190 
        flange_class = "150"
        pressure_rating = 190
        temperature_rating = 400
        elsif  pressure > 190 and pressure <= 500 
        flange_class = "300"
        pressure_rating = 500
        temperature_rating = 400
        elsif  pressure > 500 and pressure <= 665 
        flange_class = "400"
        pressure_rating = 665
        temperature_rating = 400
        elsif  pressure > 665 and pressure <= 1000 
        flange_class = "600"
        pressure_rating = 1000
        temperature_rating = 400
        elsif  pressure > 1000 and pressure <= 1500 
        flange_class = "900"
        pressure_rating = 1500
        temperature_rating = 400
        elsif  pressure > 1500 and pressure <= 2495 
        flange_class = "1500"
        pressure_rating = 2495
        temperature_rating = 400
        elsif  pressure > 2495 and pressure <= 4160 
        flange_class = "2500"
        pressure_rating = 4160
        temperature_rating = 400
        
        end
    elsif temperature > 400 and temperature <= 500 
        if pressure <= 170 
        flange_class = "150"
        pressure_rating = 170
        temperature_rating = 500
        elsif  pressure > 170 and pressure <= 445 
        flange_class = "300"
        pressure_rating = 445
        temperature_rating = 500
        elsif  pressure > 445 and pressure <= 610 
        flange_class = "400"
        pressure_rating = 610
        temperature_rating = 500
        elsif  pressure > 610 and pressure <= 910 
        flange_class = "600"
        pressure_rating = 910
        temperature_rating = 500
        elsif  pressure > 910 and pressure <= 1370 
        flange_class = "900"
        pressure_rating = 1370
        temperature_rating = 500
        elsif  pressure > 1370 and pressure <= 2280 
        flange_class = "1500"
        pressure_rating = 2280
        temperature_rating = 500
        elsif  pressure > 2280 and pressure <= 3800 
        flange_class = "2500"
        pressure_rating = 3800
        temperature_rating = 500
        
        end
    elsif temperature > 500 and temperature <= 600 
        if pressure <= 140 
        flange_class = "150"
        pressure_rating = 140
        temperature_rating = 600
        elsif  pressure > 140 and pressure <= 425 
        flange_class = "300"
        pressure_rating = 425
        temperature_rating = 600
        elsif  pressure > 425 and pressure <= 570 
        flange_class = "400"
        pressure_rating = 570
        temperature_rating = 600
        elsif  pressure > 570 and pressure <= 855 
        flange_class = "600"
        pressure_rating = 855
        temperature_rating = 600
        elsif  pressure > 855 and pressure <= 1280 
        flange_class = "900"
        pressure_rating = 1280
        temperature_rating = 600
        elsif  pressure > 1280 and pressure <= 2135 
        flange_class = "1500"
        pressure_rating = 2135
        temperature_rating = 600
        elsif  pressure > 2135 and pressure <= 3560 
        flange_class = "2500"
        pressure_rating = 3560
        temperature_rating = 600
        
        end
    elsif temperature > 600 and temperature <= 650 
        if pressure <= 125 
        flange_class = "150"
        pressure_rating = 125
        temperature_rating = 650
        elsif  pressure > 125 and pressure <= 420 
        flange_class = "300"
        pressure_rating = 420
        temperature_rating = 650
        elsif  pressure > 420 and pressure <= 555 
        flange_class = "400"
        pressure_rating = 555
        temperature_rating = 650
        elsif  pressure > 555 and pressure <= 835 
        flange_class = "600"
        pressure_rating = 835
        temperature_rating = 650
        elsif  pressure > 835 and pressure <= 1255 
        flange_class = "900"
        pressure_rating = 1255
        temperature_rating = 650
        elsif  pressure > 1255 and pressure <= 2090 
        flange_class = "1500"
        pressure_rating = 2090
        temperature_rating = 650
        elsif  pressure > 2090 and pressure <= 3480 
        flange_class = "2500"
        pressure_rating = 3480
        temperature_rating = 650
        
        end
    elsif temperature > 650 and temperature <= 700 
        if pressure <= 110 
        flange_class = "150"
        pressure_rating = 110
        temperature_rating = 700
        elsif  pressure > 110 and pressure <= 410 
        flange_class = "300"
        pressure_rating = 410
        temperature_rating = 700
        elsif  pressure > 410 and pressure <= 545 
        flange_class = "400"
        pressure_rating = 545
        temperature_rating = 700
        elsif  pressure > 545 and pressure <= 820 
        flange_class = "600"
        pressure_rating = 820
        temperature_rating = 700
        elsif  pressure > 820 and pressure <= 1230 
        flange_class = "900"
        pressure_rating = 1230
        temperature_rating = 700
        elsif  pressure > 1230 and pressure <= 2050 
        flange_class = "1500"
        pressure_rating = 2050
        temperature_rating = 700
        elsif  pressure > 2050 and pressure <= 3420 
        flange_class = "2500"
        pressure_rating = 3420
        temperature_rating = 700
        
        end
    
    end
    
    if Worksheets("UOM").chkCustomary.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) Use solution annealed material only." & Chr(13) _
    & "(2) The chemical composition, mechanical properties, heat treating requirements, and grain size requirements shall conform to the applicable ASTM specification. The manufacturing procedures, tolerances, tests, certification, and markings shall be in accordance with ASTM B 564."
    elsif orksheets("UOM").chkSI.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) Use solution annealed material only." & Chr(13) _
    & "(2) The chemical composition, mechanical properties, heat treating requirements, and grain size requirements shall conform to the applicable ASTM specification. The manufacturing procedures, tolerances, tests, certification, and markings shall be in accordance with ASTM B 564."
    
    end
    
elsif material_group = "3.12" 
UserFormLineSegmentDesign.cmbMaterialDesignation.RowSource = "MaterialGroup3.12"
    if temperature >= -20 and temperature <= 100 
        if pressure <= 260 
        flange_class = "150"
        pressure_rating = 260
        temperature_rating = 100
        elsif  pressure > 260 and pressure <= 670 
        flange_class = "300"
        pressure_rating = 670
        temperature_rating = 100
        elsif  pressure > 670 and pressure <= 895 
        flange_class = "400"
        pressure_rating = 895
        temperature_rating = 100
        elsif  pressure > 895 and pressure <= 1345 
        flange_class = "600"
        pressure_rating = 1345
        temperature_rating = 100
        elsif  pressure > 1345 and pressure <= 2015 
        flange_class = "900"
        pressure_rating = 2015
        temperature_rating = 100
        elsif  pressure > 2015 and pressure <= 3360 
        flange_class = "1500"
        pressure_rating = 3360
        temperature_rating = 100
        elsif  pressure > 3360 and pressure <= 5600 
        flange_class = "2500"
        pressure_rating = 5600
        temperature_rating = 100
        
        end
    elsif temperature > 100 and temperature <= 200 
        if pressure <= 240 
        flange_class = "150"
        pressure_rating = 240
        temperature_rating = 200
        elsif  pressure > 240 and pressure <= 620 
        flange_class = "300"
        pressure_rating = 620
        temperature_rating = 200
        elsif  pressure > 620 and pressure <= 830 
        flange_class = "400"
        pressure_rating = 830
        temperature_rating = 200
        elsif  pressure > 830 and pressure <= 1245 
        flange_class = "600"
        pressure_rating = 1245
        temperature_rating = 200
        elsif  pressure > 1245 and pressure <= 1865 
        flange_class = "900"
        pressure_rating = 1865
        temperature_rating = 200
        elsif  pressure > 1865 and pressure <= 3110 
        flange_class = "1500"
        pressure_rating = 3110
        temperature_rating = 200
        elsif  pressure > 3110 and pressure <= 5180 
        flange_class = "2500"
        pressure_rating = 5180
        temperature_rating = 200
        
        end
    elsif temperature > 200 and temperature <= 300 
        if pressure <= 225 
        flange_class = "150"
        pressure_rating = 225
        temperature_rating = 300
        elsif  pressure > 225 and pressure <= 585 
        flange_class = "300"
        pressure_rating = 585
        temperature_rating = 300
        elsif  pressure > 585 and pressure <= 780 
        flange_class = "400"
        pressure_rating = 780
        temperature_rating = 300
        elsif  pressure > 780 and pressure <= 1165 
        flange_class = "600"
        pressure_rating = 1165
        temperature_rating = 300
        elsif  pressure > 1165 and pressure <= 1750 
        flange_class = "900"
        pressure_rating = 1750
        temperature_rating = 300
        elsif  pressure > 1750 and pressure <= 2915 
        flange_class = "1500"
        pressure_rating = 2915
        temperature_rating = 300
        elsif  pressure > 2915 and pressure <= 4860 
        flange_class = "2500"
        pressure_rating = 4860
        temperature_rating = 300
        
        end
    elsif temperature > 300 and temperature <= 400 
        if pressure <= 200 
        flange_class = "150"
        pressure_rating = 200
        temperature_rating = 400
        elsif  pressure > 200 and pressure <= 540 
        flange_class = "300"
        pressure_rating = 540
        temperature_rating = 400
        elsif  pressure > 540 and pressure <= 715 
        flange_class = "400"
        pressure_rating = 715
        temperature_rating = 400
        elsif  pressure > 715 and pressure <= 1075 
        flange_class = "600"
        pressure_rating = 1075
        temperature_rating = 400
        elsif  pressure > 1075 and pressure <= 1615 
        flange_class = "900"
        pressure_rating = 1615
        temperature_rating = 400
        elsif  pressure > 1615 and pressure <= 2690 
        flange_class = "1500"
        pressure_rating = 2690
        temperature_rating = 400
        elsif  pressure > 2960 and pressure <= 4480 
        flange_class = "2500"
        pressure_rating = 4480
        temperature_rating = 400
        
        end
    elsif temperature > 400 and temperature <= 500 
        if pressure <= 170 
        flange_class = "150"
        pressure_rating = 170
        temperature_rating = 500
        elsif  pressure > 170 and pressure <= 500 
        flange_class = "300"
        pressure_rating = 500
        temperature_rating = 500
        elsif  pressure > 500 and pressure <= 665 
        flange_class = "400"
        pressure_rating = 665
        temperature_rating = 500
        elsif  pressure > 665 and pressure <= 1000 
        flange_class = "600"
        pressure_rating = 1000
        temperature_rating = 500
        elsif  pressure > 1000 and pressure <= 1500 
        flange_class = "900"
        pressure_rating = 1500
        temperature_rating = 500
        elsif  pressure > 1500 and pressure <= 2495 
        flange_class = "1500"
        pressure_rating = 2495
        temperature_rating = 500
        elsif  pressure > 2495 and pressure <= 4160 
        flange_class = "2500"
        pressure_rating = 4160
        temperature_rating = 500
        
        end
    elsif temperature > 500 and temperature <= 600 
        if pressure <= 140 
        flange_class = "150"
        pressure_rating = 140
        temperature_rating = 600
        elsif  pressure > 140 and pressure <= 475 
        flange_class = "300"
        pressure_rating = 475
        temperature_rating = 600
        elsif  pressure > 475 and pressure <= 630 
        flange_class = "400"
        pressure_rating = 630
        temperature_rating = 600
        elsif  pressure > 630 and pressure <= 945 
        flange_class = "600"
        pressure_rating = 945
        temperature_rating = 600
        elsif  pressure > 945 and pressure <= 1420 
        flange_class = "900"
        pressure_rating = 1420
        temperature_rating = 600
        elsif  pressure > 1420 and pressure <= 2365 
        flange_class = "1500"
        pressure_rating = 2365
        temperature_rating = 600
        elsif  pressure > 2365 and pressure <= 3940 
        flange_class = "2500"
        pressure_rating = 3940
        temperature_rating = 600
        
        end
    elsif temperature > 600 and temperature <= 650 
        if pressure <= 125 
        flange_class = "150"
        pressure_rating = 125
        temperature_rating = 650
        elsif  pressure > 125 and pressure <= 460 
        flange_class = "300"
        pressure_rating = 460
        temperature_rating = 650
        elsif  pressure > 460 and pressure <= 615 
        flange_class = "400"
        pressure_rating = 615
        temperature_rating = 650
        elsif  pressure > 615 and pressure <= 920 
        flange_class = "600"
        pressure_rating = 920
        temperature_rating = 650
        elsif  pressure > 920 and pressure <= 1380 
        flange_class = "900"
        pressure_rating = 1380
        temperature_rating = 650
        elsif  pressure > 1380 and pressure <= 2305 
        flange_class = "1500"
        pressure_rating = 2305
        temperature_rating = 650
        elsif  pressure > 2305 and pressure <= 3840 
        flange_class = "2500"
        pressure_rating = 3840
        temperature_rating = 650
        
        end
    elsif temperature > 650 and temperature <= 700 
        if pressure <= 110 
        flange_class = "150"
        pressure_rating = 110
        temperature_rating = 700
        elsif  pressure > 110 and pressure <= 450 
        flange_class = "300"
        pressure_rating = 450
        temperature_rating = 700
        elsif  pressure > 450 and pressure <= 600 
        flange_class = "400"
        pressure_rating = 600
        temperature_rating = 700
        elsif  pressure > 600 and pressure <= 900 
        flange_class = "600"
        pressure_rating = 900
        temperature_rating = 700
        elsif  pressure > 900 and pressure <= 1355 
        flange_class = "900"
        pressure_rating = 1355
        temperature_rating = 700
        elsif  pressure > 1355 and pressure <= 2255 
        flange_class = "1500"
        pressure_rating = 2255
        temperature_rating = 700
        elsif  pressure > 2255 and pressure <= 3760 
        flange_class = "2500"
        pressure_rating = 3760
        temperature_rating = 700
        
        end
    elsif temperature > 700 and temperature <= 750 
        if pressure <= 95 
        flange_class = "150"
        pressure_rating = 95
        temperature_rating = 750
        elsif  pressure > 95 and pressure <= 440 
        flange_class = "300"
        pressure_rating = 440
        temperature_rating = 750
        elsif  pressure > 440 and pressure <= 590 
        flange_class = "400"
        pressure_rating = 590
        temperature_rating = 750
        elsif  pressure > 590 and pressure <= 885 
        flange_class = "600"
        pressure_rating = 885
        temperature_rating = 750
        elsif  pressure > 885 and pressure <= 1325 
        flange_class = "900"
        pressure_rating = 1325
        temperature_rating = 750
        elsif  pressure > 1325 and pressure <= 2210 
        flange_class = "1500"
        pressure_rating = 2210
        temperature_rating = 750
        elsif  pressure > 2210 and pressure <= 3680 
        flange_class = "2500"
        pressure_rating = 3680
        temperature_rating = 750
        
        end
    elsif temperature > 750 and temperature <= 800 
        if pressure <= 80 
        flange_class = "150"
        pressure_rating = 80
        temperature_rating = 800
        elsif  pressure > 80 and pressure <= 430 
        flange_class = "300"
        pressure_rating = 430
        temperature_rating = 800
        elsif  pressure > 430 and pressure <= 575 
        flange_class = "400"
        pressure_rating = 575
        temperature_rating = 800
        elsif  pressure > 575 and pressure <= 865 
        flange_class = "600"
        pressure_rating = 865
        temperature_rating = 800
        elsif  pressure > 865 and pressure <= 1295 
        flange_class = "900"
        pressure_rating = 1295
        temperature_rating = 800
        elsif  pressure > 1295 and pressure <= 2160 
        flange_class = "1500"
        pressure_rating = 2160
        temperature_rating = 800
        elsif  pressure > 2160 and pressure <= 3600 
        flange_class = "2500"
        pressure_rating = 3600
        temperature_rating = 800
        
        end
    
    end
    
    if Worksheets("UOM").chkCustomary.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) Use solution annealed material only." & Chr(13) _
    & "(2) The chemical composition, mechanical properties, heat treating requirements, and grain size requirements shall conform to the applicable ASTM specification. The manufacturing procedures, tolerances, tests, certification, and markings shall be in accordance with ASTM B 564."
    elsif orksheets("UOM").chkSI.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) Use solution annealed material only." & Chr(13) _
    & "(2) The chemical composition, mechanical properties, heat treating requirements, and grain size requirements shall conform to the applicable ASTM specification. The manufacturing procedures, tolerances, tests, certification, and markings shall be in accordance with ASTM B 564."
    
    end
    
elsif material_group = "3.13" 
UserFormLineSegmentDesign.cmbMaterialDesignation.RowSource = "MaterialGroup3.13"
    if temperature >= -20 and temperature <= 100 
        if pressure <= 290 
        flange_class = "150"
        pressure_rating = 290
        temperature_rating = 100
        elsif  pressure > 290 and pressure <= 750 
        flange_class = "300"
        pressure_rating = 750
        temperature_rating = 100
        elsif  pressure > 750 and pressure <= 1000 
        flange_class = "400"
        pressure_rating = 1000
        temperature_rating = 100
        elsif  pressure > 1000 and pressure <= 1500 
        flange_class = "600"
        pressure_rating = 1500
        temperature_rating = 100
        elsif  pressure > 1500 and pressure <= 2250 
        flange_class = "900"
        pressure_rating = 2250
        temperature_rating = 100
        elsif  pressure > 2250 and pressure <= 3750 
        flange_class = "1500"
        pressure_rating = 3750
        temperature_rating = 100
        elsif  pressure > 3750 and pressure <= 6250 
        flange_class = "2500"
        pressure_rating = 6250
        temperature_rating = 100
        
        end
    elsif temperature > 100 and temperature <= 200 
        if pressure <= 260 
        flange_class = "150"
        pressure_rating = 260
        temperature_rating = 200
        elsif  pressure > 260 and pressure <= 705 
        flange_class = "300"
        pressure_rating = 705
        temperature_rating = 200
        elsif  pressure > 705 and pressure <= 940 
        flange_class = "400"
        pressure_rating = 940
        temperature_rating = 200
        elsif  pressure > 940 and pressure <= 1405 
        flange_class = "600"
        pressure_rating = 1405
        temperature_rating = 200
        elsif  pressure > 1405 and pressure <= 2110 
        flange_class = "900"
        pressure_rating = 2110
        temperature_rating = 200
        elsif  pressure > 2110 and pressure <= 3515 
        flange_class = "1500"
        pressure_rating = 3515
        temperature_rating = 200
        elsif  pressure > 3515 and pressure <= 5860 
        flange_class = "2500"
        pressure_rating = 5860
        temperature_rating = 200
        
        end
    elsif temperature > 200 and temperature <= 300 
        if pressure <= 230 
        flange_class = "150"
        pressure_rating = 230
        temperature_rating = 300
        elsif  pressure > 230 and pressure <= 665 
        flange_class = "300"
        pressure_rating = 665
        temperature_rating = 300
        elsif  pressure > 665 and pressure <= 885 
        flange_class = "400"
        pressure_rating = 885
        temperature_rating = 300
        elsif  pressure > 885 and pressure <= 1330 
        flange_class = "600"
        pressure_rating = 1330
        temperature_rating = 300
        elsif  pressure > 1330 and pressure <= 1995 
        flange_class = "900"
        pressure_rating = 1995
        temperature_rating = 300
        elsif  pressure > 1995 and pressure <= 3325 
        flange_class = "1500"
        pressure_rating = 3325
        temperature_rating = 300
        elsif  pressure > 3325 and pressure <= 5540 
        flange_class = "2500"
        pressure_rating = 5540
        temperature_rating = 300
        
        end
    elsif temperature > 300 and temperature <= 400 
        if pressure <= 200 
        flange_class = "150"
        pressure_rating = 200
        temperature_rating = 400
        elsif  pressure > 200 and pressure <= 630 
        flange_class = "300"
        pressure_rating = 630
        temperature_rating = 400
        elsif  pressure > 630 and pressure <= 840 
        flange_class = "400"
        pressure_rating = 840
        temperature_rating = 400
        elsif  pressure > 840 and pressure <= 1260 
        flange_class = "600"
        pressure_rating = 1260
        temperature_rating = 400
        elsif  pressure > 1260 and pressure <= 1885 
        flange_class = "900"
        pressure_rating = 1885
        temperature_rating = 400
        elsif  pressure > 1885 and pressure <= 3145 
        flange_class = "1500"
        pressure_rating = 3145
        temperature_rating = 400
        elsif  pressure > 3145 and pressure <= 5240 
        flange_class = "2500"
        pressure_rating = 5240
        temperature_rating = 400
        
        end
    elsif temperature > 400 and temperature <= 500 
        if pressure <= 170 
        flange_class = "150"
        pressure_rating = 170
        temperature_rating = 500
        elsif  pressure > 170 and pressure <= 595 
        flange_class = "300"
        pressure_rating = 595
        temperature_rating = 500
        elsif  pressure > 595 and pressure <= 795 
        flange_class = "400"
        pressure_rating = 795
        temperature_rating = 500
        elsif  pressure > 795 and pressure <= 1190 
        flange_class = "600"
        pressure_rating = 1190
        temperature_rating = 500
        elsif  pressure > 1190 and pressure <= 1785 
        flange_class = "900"
        pressure_rating = 1785
        temperature_rating = 500
        elsif  pressure > 1785 and pressure <= 2975 
        flange_class = "1500"
        pressure_rating = 2975
        temperature_rating = 500
        elsif  pressure > 2975 and pressure <= 4960 
        flange_class = "2500"
        pressure_rating = 4960
        temperature_rating = 500
        
        end
    elsif temperature > 500 and temperature <= 600 
        if pressure <= 140 
        flange_class = "150"
        pressure_rating = 140
        temperature_rating = 600
        elsif  pressure > 140 and pressure <= 560 
        flange_class = "300"
        pressure_rating = 560
        temperature_rating = 600
        elsif  pressure > 560 and pressure <= 750 
        flange_class = "400"
        pressure_rating = 750
        temperature_rating = 600
        elsif  pressure > 750 and pressure <= 1125 
        flange_class = "600"
        pressure_rating = 1125
        temperature_rating = 600
        elsif  pressure > 1125 and pressure <= 1685 
        flange_class = "900"
        pressure_rating = 1685
        temperature_rating = 600
        elsif  pressure > 1685 and pressure <= 2810 
        flange_class = "1500"
        pressure_rating = 2810
        temperature_rating = 600
        elsif  pressure > 2810 and pressure <= 4680 
        flange_class = "2500"
        pressure_rating = 4680
        temperature_rating = 600
        
        end
    elsif temperature > 600 and temperature <= 650 
        if pressure <= 125 
        flange_class = "150"
        pressure_rating = 125
        temperature_rating = 650
        elsif  pressure > 125 and pressure <= 550 
        flange_class = "300"
        pressure_rating = 550
        temperature_rating = 650
        elsif  pressure > 550 and pressure <= 735 
        flange_class = "400"
        pressure_rating = 735
        temperature_rating = 650
        elsif  pressure > 735 and pressure <= 1100 
        flange_class = "600"
        pressure_rating = 1100
        temperature_rating = 650
        elsif  pressure > 1100 and pressure <= 1650 
        flange_class = "900"
        pressure_rating = 1650
        temperature_rating = 650
        elsif  pressure > 1650 and pressure <= 2750 
        flange_class = "1500"
        pressure_rating = 2750
        temperature_rating = 650
        elsif  pressure > 2750 and pressure <= 4580 
        flange_class = "2500"
        pressure_rating = 4580
        temperature_rating = 650
        
        end
    elsif temperature > 650 and temperature <= 700 
        if pressure <= 110 
        flange_class = "150"
        pressure_rating = 110
        temperature_rating = 700
        elsif  pressure > 110 and pressure <= 540 
        flange_class = "300"
        pressure_rating = 540
        temperature_rating = 700
        elsif  pressure > 540 and pressure <= 720 
        flange_class = "400"
        pressure_rating = 720
        temperature_rating = 700
        elsif  pressure > 720 and pressure <= 1080 
        flange_class = "600"
        pressure_rating = 1080
        temperature_rating = 700
        elsif  pressure > 1080 and pressure <= 1620 
        flange_class = "900"
        pressure_rating = 1620
        temperature_rating = 700
        elsif  pressure > 1620 and pressure <= 2700 
        flange_class = "1500"
        pressure_rating = 2700
        temperature_rating = 700
        elsif  pressure > 2700 and pressure <= 4500 
        flange_class = "2500"
        pressure_rating = 4500
        temperature_rating = 700
        
        end
    elsif temperature > 700 and temperature <= 750 
        if pressure <= 95 
        flange_class = "150"
        pressure_rating = 95
        temperature_rating = 750
        elsif  pressure > 95 and pressure <= 530 
        flange_class = "300"
        pressure_rating = 530
        temperature_rating = 750
        elsif  pressure > 530 and pressure <= 710 
        flange_class = "400"
        pressure_rating = 710
        temperature_rating = 750
        elsif  pressure > 710 and pressure <= 1065 
        flange_class = "600"
        pressure_rating = 1065
        temperature_rating = 750
        elsif  pressure > 1065 and pressure <= 1595 
        flange_class = "900"
        pressure_rating = 1595
        temperature_rating = 750
        elsif  pressure > 1595 and pressure <= 2660 
        flange_class = "1500"
        pressure_rating = 2660
        temperature_rating = 750
        elsif  pressure > 2660 and pressure <= 4430 
        flange_class = "2500"
        pressure_rating = 4430
        temperature_rating = 750
        
        end
    elsif temperature > 750 and temperature <= 800 
        if pressure <= 80 
        flange_class = "150"
        pressure_rating = 80
        temperature_rating = 800
        elsif  pressure > 80 and pressure <= 510 
        flange_class = "300"
        pressure_rating = 510
        temperature_rating = 800
        elsif  pressure > 510 and pressure <= 675 
        flange_class = "400"
        pressure_rating = 675
        temperature_rating = 800
        elsif  pressure > 675 and pressure <= 1015 
        flange_class = "600"
        pressure_rating = 1015
        temperature_rating = 800
        elsif  pressure > 1015 and pressure <= 1525 
        flange_class = "900"
        pressure_rating = 1525
        temperature_rating = 800
        elsif  pressure > 1525 and pressure <= 2540 
        flange_class = "1500"
        pressure_rating = 2540
        temperature_rating = 800
        elsif  pressure > 2540 and pressure <= 4230 
        flange_class = "2500"
        pressure_rating = 4230
        temperature_rating = 800
        
        end
    
    end
    
    if Worksheets("UOM").chkCustomary.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) Use solution annealed material only." & Chr(13) _
    & "(2) The chemical composition, mechanical properties, heat treating requirements, and grain size requirements shall conform to the applicable ASTM specification. The manufacturing procedures, tolerances, tests, certification, and markings shall be in accordance with ASTM B 564." & Chr(13) _
    & "(3) Use annealed material only."
    elsif orksheets("UOM").chkSI.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) Use solution annealed material only." & Chr(13) _
    & "(2) The chemical composition, mechanical properties, heat treating requirements, and grain size requirements shall conform to the applicable ASTM specification. The manufacturing procedures, tolerances, tests, certification, and markings shall be in accordance with ASTM B 564." & Chr(13) _
    & "(3) Use annealed material only."
    
    flange_classd if
    pressure_ratingElse
Call FlangePressuretemperature_rating8(pressure, temperature, MaterialGroup, FlangeClass, PressureRating, temperature_rating)
flange_class if

pressure_ratingSub

Sub FlangePressuretemperature_rating8(pressure, temperature, MaterialGroup, FlangeClass, PressureRating, temperature_rating)

if MaterialGroup = "3.14" 
UserFormLineSegmentDesign.cmbMaterialDesignation.RowSource = "MaterialGroup3.14"
    if temperature >= -20 and temperature <= 100 
        if pressure <= 275 
        flange_class = "150"
        pressure_rating = 275
        temperature_rating = 100
        elsif  pressure > 275 and pressure <= 720 
        flange_class = "300"
        pressure_rating = 720
        temperature_rating = 100
        elsif  pressure > 720 and pressure <= 960 
        flange_class = "400"
        pressure_rating = 960
        temperature_rating = 100
        elsif  pressure > 960 and pressure <= 1440 
        flange_class = "600"
        pressure_rating = 1440
        temperature_rating = 100
        elsif  pressure > 1440 and pressure <= 2160 
        flange_class = "900"
        pressure_rating = 2160
        temperature_rating = 100
        elsif  pressure > 2160 and pressure <= 3600 
        flange_class = "1500"
        pressure_rating = 3600
        temperature_rating = 100
        elsif  pressure > 3600 and pressure <= 6000 
        flange_class = "2500"
        pressure_rating = 6000
        temperature_rating = 100
        
        end
    elsif temperature > 100 and temperature <= 200 
        if pressure <= 250 
        flange_class = "150"
        pressure_rating = 250
        temperature_rating = 200
        elsif  pressure > 250 and pressure <= 650 
        flange_class = "300"
        pressure_rating = 650
        temperature_rating = 200
        elsif  pressure > 650 and pressure <= 865 
        flange_class = "400"
        pressure_rating = 865
        temperature_rating = 200
        elsif  pressure > 865 and pressure <= 1295 
        flange_class = "600"
        pressure_rating = 1295
        temperature_rating = 200
        elsif  pressure > 1295 and pressure <= 1945 
        flange_class = "900"
        pressure_rating = 1945
        temperature_rating = 200
        elsif  pressure > 1945 and pressure <= 3240 
        flange_class = "1500"
        pressure_rating = 3240
        temperature_rating = 200
        elsif  pressure > 3240 and pressure <= 5400 
        flange_class = "2500"
        pressure_rating = 5400
        temperature_rating = 200
        
        end
    elsif temperature > 200 and temperature <= 300 
        if pressure <= 230 
        flange_class = "150"
        pressure_rating = 230
        temperature_rating = 300
        elsif  pressure > 230 and pressure <= 600 
        flange_class = "300"
        pressure_rating = 600
        temperature_rating = 300
        elsif  pressure > 600 and pressure <= 800 
        flange_class = "400"
        pressure_rating = 800
        temperature_rating = 300
        elsif  pressure > 800 and pressure <= 1200 
        flange_class = "600"
        pressure_rating = 1200
        temperature_rating = 300
        elsif  pressure > 1200 and pressure <= 1800 
        flange_class = "900"
        pressure_rating = 1800
        temperature_rating = 300
        elsif  pressure > 1800 and pressure <= 3000 
        flange_class = "1500"
        pressure_rating = 3000
        temperature_rating = 300
        elsif  pressure > 3000 and pressure <= 5000 
        flange_class = "2500"
        pressure_rating = 5000
        temperature_rating = 300
        
        end
    elsif temperature > 300 and temperature <= 400 
        if pressure <= 200 
        flange_class = "150"
        pressure_rating = 200
        temperature_rating = 400
        elsif  pressure > 200 and pressure <= 565 
        flange_class = "300"
        pressure_rating = 565
        temperature_rating = 400
        elsif  pressure > 565 and pressure <= 750 
        flange_class = "400"
        pressure_rating = 750
        temperature_rating = 400
        elsif  pressure > 750 and pressure <= 1130 
        flange_class = "600"
        pressure_rating = 1130
        temperature_rating = 400
        elsif  pressure > 1130 and pressure <= 1690 
        flange_class = "900"
        pressure_rating = 1690
        temperature_rating = 400
        elsif  pressure > 1690 and pressure <= 2820 
        flange_class = "1500"
        pressure_rating = 2820
        temperature_rating = 400
        elsif  pressure > 2820 and pressure <= 4700 
        flange_class = "2500"
        pressure_rating = 4700
        temperature_rating = 400
        
        end
    elsif temperature > 400 and temperature <= 500 
        if pressure <= 170 
        flange_class = "150"
        pressure_rating = 170
        temperature_rating = 500
        elsif  pressure > 170 and pressure <= 540 
        flange_class = "300"
        pressure_rating = 540
        temperature_rating = 500
        elsif  pressure > 540 and pressure <= 715 
        flange_class = "400"
        pressure_rating = 715
        temperature_rating = 500
        elsif  pressure > 715 and pressure <= 1075 
        flange_class = "600"
        pressure_rating = 1075
        temperature_rating = 500
        elsif  pressure > 1615 and pressure <= 2690 
        flange_class = "900"
        pressure_rating = 2690
        temperature_rating = 500
        elsif  pressure > 2690 and pressure <= 2690 
        flange_class = "1500"
        pressure_rating = 2690
        temperature_rating = 500
        elsif  pressure > 2690 and pressure <= 4480 
        flange_class = "2500"
        pressure_rating = 4480
        temperature_rating = 500
        
        end
    elsif temperature > 500 and temperature <= 600 
        if pressure <= 140 
        flange_class = "150"
        pressure_rating = 140
        temperature_rating = 600
        elsif  pressure > 140 and pressure <= 520 
        flange_class = "300"
        pressure_rating = 520
        temperature_rating = 600
        elsif  pressure > 520 and pressure <= 690 
        flange_class = "400"
        pressure_rating = 690
        temperature_rating = 600
        elsif  pressure > 690 and pressure <= 1035 
        flange_class = "600"
        pressure_rating = 1035
        temperature_rating = 600
        elsif  pressure > 1035 and pressure <= 1555 
        flange_class = "900"
        pressure_rating = 1555
        temperature_rating = 600
        elsif  pressure > 1555 and pressure <= 2590 
        flange_class = "1500"
        pressure_rating = 2590
        temperature_rating = 600
        elsif  pressure > 2590 and pressure <= 4320 
        flange_class = "2500"
        pressure_rating = 4320
        temperature_rating = 600
        
        end
    elsif temperature > 600 and temperature <= 650 
        if pressure <= 125 
        flange_class = "150"
        pressure_rating = 125
        temperature_rating = 650
        elsif  pressure > 125 and pressure <= 510 
        flange_class = "300"
        pressure_rating = 510
        temperature_rating = 650
        elsif  pressure > 510 and pressure <= 680 
        flange_class = "400"
        pressure_rating = 680
        temperature_rating = 650
        elsif  pressure > 680 and pressure <= 1020 
        flange_class = "600"
        pressure_rating = 1020
        temperature_rating = 650
        elsif  pressure > 1020 and pressure <= 1535 
        flange_class = "900"
        pressure_rating = 1535
        temperature_rating = 650
        elsif  pressure > 1535 and pressure <= 2555 
        flange_class = "1500"
        pressure_rating = 2555
        temperature_rating = 650
        elsif  pressure > 2555 and pressure <= 4260 
        flange_class = "2500"
        pressure_rating = 4260
        temperature_rating = 650
        
        end
    elsif temperature > 650 and temperature <= 700 
        if pressure <= 110 
        flange_class = "150"
        pressure_rating = 110
        temperature_rating = 700
        elsif  pressure > 110 and pressure <= 505 
        flange_class = "300"
        pressure_rating = 505
        temperature_rating = 700
        elsif  pressure > 505 and pressure <= 675 
        flange_class = "400"
        pressure_rating = 675
        temperature_rating = 700
        elsif  pressure > 675 and pressure <= 1015 
        flange_class = "600"
        pressure_rating = 1015
        temperature_rating = 700
        elsif  pressure > 1015 and pressure <= 1520 
        flange_class = "900"
        pressure_rating = 1520
        temperature_rating = 700
        elsif  pressure > 1520 and pressure <= 2530 
        flange_class = "1500"
        pressure_rating = 2530
        temperature_rating = 700
        elsif  pressure > 2530 and pressure <= 4220 
        flange_class = "2500"
        pressure_rating = 4220
        temperature_rating = 700
        
        end
    elsif temperature > 700 and temperature <= 750 
        if pressure <= 95 
        flange_class = "150"
        pressure_rating = 95
        temperature_rating = 750
        elsif  pressure > 95 and pressure <= 500 
        flange_class = "300"
        pressure_rating = 500
        temperature_rating = 750
        elsif  pressure > 500 and pressure <= 670 
        flange_class = "400"
        pressure_rating = 670
        temperature_rating = 750
        elsif  pressure > 670 and pressure <= 1005 
        flange_class = "600"
        pressure_rating = 1005
        temperature_rating = 750
        elsif  pressure > 1005 and pressure <= 1505 
        flange_class = "900"
        pressure_rating = 1505
        temperature_rating = 750
        elsif  pressure > 1505 and pressure <= 2510 
        flange_class = "1500"
        pressure_rating = 2510
        temperature_rating = 750
        elsif  pressure > 2510 and pressure <= 4180 
        flange_class = "2500"
        pressure_rating = 4180
        temperature_rating = 750
        
        end
    elsif temperature > 750 and temperature <= 800 
        if pressure <= 80 
        flange_class = "150"
        pressure_rating = 80
        temperature_rating = 800
        elsif  pressure > 80 and pressure <= 500 
        flange_class = "300"
        pressure_rating = 500
        temperature_rating = 800
        elsif  pressure > 500 and pressure <= 665 
        flange_class = "400"
        pressure_rating = 665
        temperature_rating = 800
        elsif  pressure > 665 and pressure <= 1000 
        flange_class = "600"
        pressure_rating = 1000
        temperature_rating = 800
        elsif  pressure > 1000 and pressure <= 1500 
        flange_class = "900"
        pressure_rating = 1500
        temperature_rating = 800
        elsif  pressure > 1500 and pressure <= 2495 
        flange_class = "1500"
        pressure_rating = 2495
        temperature_rating = 800
        elsif  pressure > 2495 and pressure <= 4160 
        flange_class = "2500"
        pressure_rating = 4160
        temperature_rating = 800
        
        end
    elsif temperature > 800 and temperature <= 850 
        if pressure <= 65 
        flange_class = "150"
        pressure_rating = 65
        temperature_rating = 850
        elsif  pressure > 65 and pressure <= 485 
        flange_class = "300"
        pressure_rating = 485
        temperature_rating = 850
        elsif  pressure > 485 and pressure <= 650 
        flange_class = "400"
        pressure_rating = 650
        temperature_rating = 850
        elsif  pressure > 650 and pressure <= 975 
        flange_class = "600"
        pressure_rating = 975
        temperature_rating = 850
        elsif  pressure > 975 and pressure <= 1460 
        flange_class = "900"
        pressure_rating = 1460
        temperature_rating = 850
        elsif  pressure > 1460 and pressure <= 2435 
        flange_class = "1500"
        pressure_rating = 2435
        temperature_rating = 850
        elsif  pressure > 2435 and pressure <= 4060 
        flange_class = "2500"
        pressure_rating = 4060
        temperature_rating = 850
        
        end
    elsif temperature > 850 and temperature <= 900 
        if pressure <= 50 
        flange_class = "150"
        pressure_rating = 50
        temperature_rating = 900
        elsif  pressure > 50 and pressure <= 450 
        flange_class = "300"
        pressure_rating = 450
        temperature_rating = 900
        elsif  pressure > 450 and pressure <= 600 
        flange_class = "400"
        pressure_rating = 600
        temperature_rating = 900
        elsif  pressure > 600 and pressure <= 900 
        flange_class = "600"
        pressure_rating = 900
        temperature_rating = 900
        elsif  pressure > 900 and pressure <= 1350 
        flange_class = "900"
        pressure_rating = 1350
        temperature_rating = 900
        elsif  pressure > 1350 and pressure <= 2245 
        flange_class = "1500"
        pressure_rating = 2245
        temperature_rating = 900
        elsif  pressure > 2245 and pressure <= 3745 
        flange_class = "2500"
        pressure_rating = 3745
        temperature_rating = 900
        
        end
    elsif temperature > 900 and temperature <= 950 
        if pressure <= 35 
        flange_class = "150"
        pressure_rating = 35
        temperature_rating = 950
        elsif  pressure > 35 and pressure <= 385 
        flange_class = "300"
        pressure_rating = 385
        temperature_rating = 950
        elsif  pressure > 385 and pressure <= 515 
        flange_class = "400"
        pressure_rating = 515
        temperature_rating = 950
        elsif  pressure > 515 and pressure <= 775 
        flange_class = "600"
        pressure_rating = 775
        temperature_rating = 950
        elsif  pressure > 775 and pressure <= 1160 
        flange_class = "900"
        pressure_rating = 1160
        temperature_rating = 950
        elsif  pressure > 1160 and pressure <= 1930 
        flange_class = "1500"
        pressure_rating = 1930
        temperature_rating = 950
        elsif  pressure > 1930 and pressure <= 3220 
        flange_class = "2500"
        pressure_rating = 3220
        temperature_rating = 950
        
        end
    elsif temperature > 950 and temperature <= 1000 
        if pressure <= 20 
        flange_class = "150"
        pressure_rating = 20
        temperature_rating = 1000
        elsif  pressure > 20 and pressure <= 365 
        flange_class = "300"
        pressure_rating = 365
        temperature_rating = 1000
        elsif  pressure > 365 and pressure <= 485 
        flange_class = "400"
        pressure_rating = 485
        temperature_rating = 1000
        elsif  pressure > 485 and pressure <= 725 
        flange_class = "600"
        pressure_rating = 725
        temperature_rating = 1000
        elsif  pressure > 725 and pressure <= 1090 
        flange_class = "900"
        pressure_rating = 1090
        temperature_rating = 1000
        elsif  pressure > 1090 and pressure <= 1820 
        flange_class = "1500"
        pressure_rating = 1820
        temperature_rating = 1000
        elsif  pressure > 1820 and pressure <= 3030 
        flange_class = "2500"
        pressure_rating = 3030
        temperature_rating = 1000
        
        end
    
    end
    
    if Worksheets("UOM").chkCustomary.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) Use solution annealed material only." & Chr(13) _
    & "(2) The chemical composition, mechanical properties, heat treating requirements, and grain size requirements shall conform to the applicable ASTM specification. The manufacturing procedures, tolerances, tests, certification, and markings shall be in accordance with ASTM B 564." & Chr(13) _
    & "(3) Not to be used over 800\B0F."
    elsif orksheets("UOM").chkSI.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) Use solution annealed material only." & Chr(13) _
    & "(2) The chemical composition, mechanical properties, heat treating requirements, and grain size requirements shall conform to the applicable ASTM specification. The manufacturing procedures, tolerances, tests, certification, and markings shall be in accordance with ASTM B 564." & Chr(13) _
    & "(3) Not to be used over 425\B0C."
    
    end
    
elsif material_group = "3.15" 
UserFormLineSegmentDesign.cmbMaterialDesignation.RowSource = "MaterialGroup3.15"
    if temperature >= -20 and temperature <= 100 
        if pressure <= 230 
        flange_class = "150"
        pressure_rating = 230
        temperature_rating = 100
        elsif  pressure > 230 and pressure <= 600 
        flange_class = "300"
        pressure_rating = 600
        temperature_rating = 100
        elsif  pressure > 600 and pressure <= 800 
        flange_class = "400"
        pressure_rating = 800
        temperature_rating = 100
        elsif  pressure > 800 and pressure <= 1200 
        flange_class = "600"
        pressure_rating = 1200
        temperature_rating = 100
        elsif  pressure > 1200 and pressure <= 1800 
        flange_class = "900"
        pressure_rating = 1800
        temperature_rating = 100
        elsif  pressure > 1800 and pressure <= 3000 
        flange_class = "1500"
        pressure_rating = 3000
        temperature_rating = 100
        elsif  pressure > 3000 and pressure <= 5000 
        flange_class = "2500"
        pressure_rating = 5000
        temperature_rating = 100
        
        end
    elsif temperature > 100 and temperature <= 200 
        if pressure <= 210 
        flange_class = "150"
        pressure_rating = 210
        temperature_rating = 200
        elsif  pressure > 210 and pressure <= 550 
        flange_class = "300"
        pressure_rating = 550
        temperature_rating = 200
        elsif  pressure > 550 and pressure <= 735 
        flange_class = "400"
        pressure_rating = 735
        temperature_rating = 200
        elsif  pressure > 735 and pressure <= 1105 
        flange_class = "600"
        pressure_rating = 1105
        temperature_rating = 200
        elsif  pressure > 1105 and pressure <= 1655 
        flange_class = "900"
        pressure_rating = 1655
        temperature_rating = 200
        elsif  pressure > 1655 and pressure <= 2760 
        flange_class = "1500"
        pressure_rating = 2760
        temperature_rating = 200
        elsif  pressure > 2760 and pressure <= 4600 
        flange_class = "2500"
        pressure_rating = 4600
        temperature_rating = 200
        
        end
    elsif temperature > 200 and temperature <= 300 
        if pressure <= 200 
        flange_class = "150"
        pressure_rating = 200
        temperature_rating = 300
        elsif  pressure > 200 and pressure <= 520 
        flange_class = "300"
        pressure_rating = 520
        temperature_rating = 300
        elsif  pressure > 520 and pressure <= 695 
        flange_class = "400"
        pressure_rating = 695
        temperature_rating = 300
        elsif  pressure > 695 and pressure <= 1040 
        flange_class = "600"
        pressure_rating = 1040
        temperature_rating = 300
        elsif  pressure > 1040 and pressure <= 1560 
        flange_class = "900"
        pressure_rating = 1560
        temperature_rating = 300
        elsif  pressure > 1560 and pressure <= 2605 
        flange_class = "1500"
        pressure_rating = 2605
        temperature_rating = 300
        elsif  pressure > 2605 and pressure <= 4340 
        flange_class = "2500"
        pressure_rating = 4340
        temperature_rating = 300
        
        end
    elsif temperature > 300 and temperature <= 400 
        if pressure <= 190 
        flange_class = "150"
        pressure_rating = 190
        temperature_rating = 400
        elsif  pressure > 190 and pressure <= 490 
        flange_class = "300"
        pressure_rating = 490
        temperature_rating = 400
        elsif  pressure > 490 and pressure <= 655 
        flange_class = "400"
        pressure_rating = 655
        temperature_rating = 400
        elsif  pressure > 655 and pressure <= 980 
        flange_class = "600"
        pressure_rating = 980
        temperature_rating = 400
        elsif  pressure > 980 and pressure <= 1470 
        flange_class = "900"
        pressure_rating = 1470
        temperature_rating = 400
        elsif  pressure > 1470 and pressure <= 2450 
        flange_class = "1500"
        pressure_rating = 2450
        temperature_rating = 400
        elsif  pressure > 2450 and pressure <= 4080 
        flange_class = "2500"
        pressure_rating = 4080
        temperature_rating = 400
        
        end
    elsif temperature > 400 and temperature <= 500 
        if pressure <= 170 
        flange_class = "150"
        pressure_rating = 170
        temperature_rating = 500
        elsif  pressure > 170 and pressure <= 465 
        flange_class = "300"
        pressure_rating = 465
        temperature_rating = 500
        elsif  pressure > 465 and pressure <= 620 
        flange_class = "400"
        pressure_rating = 620
        temperature_rating = 500
        elsif  pressure > 620 and pressure <= 925 
        flange_class = "600"
        pressure_rating = 925
        temperature_rating = 500
        elsif  pressure > 925 and pressure <= 1390 
        flange_class = "900"
        pressure_rating = 1390
        temperature_rating = 500
        elsif  pressure > 1390 and pressure <= 2315 
        flange_class = "1500"
        pressure_rating = 2315
        temperature_rating = 500
        elsif  pressure > 2315 and pressure <= 3860 
        flange_class = "2500"
        pressure_rating = 3860
        temperature_rating = 500
        
        end
    elsif temperature > 500 and temperature <= 600 
        if pressure <= 140 
        flange_class = "150"
        pressure_rating = 140
        temperature_rating = 600
        elsif  pressure > 140 and pressure <= 440 
        flange_class = "300"
        pressure_rating = 440
        temperature_rating = 600
        elsif  pressure > 440 and pressure <= 585 
        flange_class = "400"
        pressure_rating = 585
        temperature_rating = 600
        elsif  pressure > 585 and pressure <= 880 
        flange_class = "600"
        pressure_rating = 880
        temperature_rating = 600
        elsif  pressure > 880 and pressure <= 1320 
        flange_class = "900"
        pressure_rating = 1320
        temperature_rating = 600
        elsif  pressure > 1320 and pressure <= 2195 
        flange_class = "1500"
        pressure_rating = 2195
        temperature_rating = 600
        elsif  pressure > 2195 and pressure <= 3660 
        flange_class = "2500"
        pressure_rating = 3660
        temperature_rating = 600
        
        end
    elsif temperature > 600 and temperature <= 650 
        if pressure <= 125 
        flange_class = "150"
        pressure_rating = 125
        temperature_rating = 650
        elsif  pressure > 125 and pressure <= 430 
        flange_class = "300"
        pressure_rating = 430
        temperature_rating = 650
        elsif  pressure > 430 and pressure <= 575 
        flange_class = "400"
        pressure_rating = 575
        temperature_rating = 650
        elsif  pressure > 575 and pressure <= 860 
        flange_class = "600"
        pressure_rating = 860
        temperature_rating = 650
        elsif  pressure > 860 and pressure <= 1290 
        flange_class = "900"
        pressure_rating = 1290
        temperature_rating = 650
        elsif  pressure > 1290 and pressure <= 2150 
        flange_class = "1500"
        pressure_rating = 2150
        temperature_rating = 650
        elsif  pressure > 2150 and pressure <= 3580 
        flange_class = "2500"
        pressure_rating = 3580
        temperature_rating = 650
        
        end
    elsif temperature > 650 and temperature <= 700 
        if pressure <= 110 
        flange_class = "150"
        pressure_rating = 110
        temperature_rating = 700
        elsif  pressure > 110 and pressure <= 420 
        flange_class = "300"
        pressure_rating = 420
        temperature_rating = 700
        elsif  pressure > 420 and pressure <= 555 
        flange_class = "400"
        pressure_rating = 555
        temperature_rating = 700
        elsif  pressure > 555 and pressure <= 835 
        flange_class = "600"
        pressure_rating = 835
        temperature_rating = 700
        elsif  pressure > 835 and pressure <= 1255 
        flange_class = "900"
        pressure_rating = 1255
        temperature_rating = 700
        elsif  pressure > 1255 and pressure <= 2090 
        flange_class = "1500"
        pressure_rating = 2090
        temperature_rating = 700
        elsif  pressure > 2090 and pressure <= 3480 
        flange_class = "2500"
        pressure_rating = 3480
        temperature_rating = 700
        
        end
    elsif temperature > 700 and temperature <= 750 
        if pressure <= 95 
        flange_class = "150"
        pressure_rating = 95
        temperature_rating = 750
        elsif  pressure > 95 and pressure <= 410 
        flange_class = "300"
        pressure_rating = 410
        temperature_rating = 750
        elsif  pressure > 410 and pressure <= 545 
        flange_class = "400"
        pressure_rating = 545
        temperature_rating = 750
        elsif  pressure > 545 and pressure <= 820 
        flange_class = "600"
        pressure_rating = 820
        temperature_rating = 750
        elsif  pressure > 820 and pressure <= 1230 
        flange_class = "900"
        pressure_rating = 1230
        temperature_rating = 750
        elsif  pressure > 1230 and pressure <= 2050 
        flange_class = "1500"
        pressure_rating = 2050
        temperature_rating = 750
        elsif  pressure > 2050 and pressure <= 3420 
        flange_class = "2500"
        pressure_rating = 3420
        temperature_rating = 750
        
        end
    elsif temperature > 750 and temperature <= 800 
        if pressure <= 80 
        flange_class = "150"
        pressure_rating = 80
        temperature_rating = 800
        elsif  pressure > 80 and pressure <= 400 
        flange_class = "300"
        pressure_rating = 400
        temperature_rating = 800
        elsif  pressure > 400 and pressure <= 535 
        flange_class = "400"
        pressure_rating = 535
        temperature_rating = 800
        elsif  pressure > 535 and pressure <= 800 
        flange_class = "600"
        pressure_rating = 800
        temperature_rating = 800
        elsif  pressure > 800 and pressure <= 1200 
        flange_class = "900"
        pressure_rating = 1200
        temperature_rating = 800
        elsif  pressure > 1200 and pressure <= 2005 
        flange_class = "1500"
        pressure_rating = 2005
        temperature_rating = 800
        elsif  pressure > 2005 and pressure <= 3340 
        flange_class = "2500"
        pressure_rating = 3340
        temperature_rating = 800
        
        end
    elsif temperature > 800 and temperature <= 850 
        if pressure <= 65 
        flange_class = "150"
        pressure_rating = 65
        temperature_rating = 850
        elsif  pressure > 65 and pressure <= 395 
        flange_class = "300"
        pressure_rating = 395
        temperature_rating = 850
        elsif  pressure > 395 and pressure <= 525 
        flange_class = "400"
        pressure_rating = 525
        temperature_rating = 850
        elsif  pressure > 525 and pressure <= 785 
        flange_class = "600"
        pressure_rating = 785
        temperature_rating = 850
        elsif  pressure > 785 and pressure <= 1180 
        flange_class = "900"
        pressure_rating = 1180
        temperature_rating = 850
        elsif  pressure > 1180 and pressure <= 1970 
        flange_class = "1500"
        pressure_rating = 1970
        temperature_rating = 850
        elsif  pressure > 1970 and pressure <= 3280 
        flange_class = "2500"
        pressure_rating = 3280
        temperature_rating = 850
        
        end
    elsif temperature > 850 and temperature <= 900 
        if pressure <= 50 
        flange_class = "150"
        pressure_rating = 50
        temperature_rating = 900
        elsif  pressure > 50 and pressure <= 385 
        flange_class = "300"
        pressure_rating = 385
        temperature_rating = 900
        elsif  pressure > 385 and pressure <= 515 
        flange_class = "400"
        pressure_rating = 515
        temperature_rating = 900
        elsif  pressure > 515 and pressure <= 775 
        flange_class = "600"
        pressure_rating = 775
        temperature_rating = 900
        elsif  pressure > 775 and pressure <= 1160 
        flange_class = "900"
        pressure_rating = 1160
        temperature_rating = 900
        elsif  pressure > 1160 and pressure <= 1930 
        flange_class = "1500"
        pressure_rating = 1930
        temperature_rating = 900
        elsif  pressure > 1930 and pressure <= 3220 
        flange_class = "2500"
        pressure_rating = 3220
        temperature_rating = 900
        
        end
    elsif temperature > 900 and temperature <= 950 
        if pressure <= 35 
        flange_class = "150"
        pressure_rating = 35
        temperature_rating = 950
        elsif  pressure > 35 and pressure <= 380 
        flange_class = "300"
        pressure_rating = 380
        temperature_rating = 950
        elsif  pressure > 380 and pressure <= 505 
        flange_class = "400"
        pressure_rating = 505
        temperature_rating = 950
        elsif  pressure > 505 and pressure <= 760 
        flange_class = "600"
        pressure_rating = 760
        temperature_rating = 950
        elsif  pressure > 760 and pressure <= 1140 
        flange_class = "900"
        pressure_rating = 1140
        temperature_rating = 950
        elsif  pressure > 1140 and pressure <= 1895 
        flange_class = "1500"
        pressure_rating = 1895
        temperature_rating = 950
        elsif  pressure > 1895 and pressure <= 3160 
        flange_class = "2500"
        pressure_rating = 3160
        temperature_rating = 950
        
        end
    elsif temperature > 950 and temperature <= 1000 
        if pressure <= 20 
        flange_class = "150"
        pressure_rating = 20
        temperature_rating = 1000
        elsif  pressure > 20 and pressure <= 365 
        flange_class = "300"
        pressure_rating = 365
        temperature_rating = 1000
        elsif  pressure > 365 and pressure <= 485 
        flange_class = "400"
        pressure_rating = 485
        temperature_rating = 1000
        elsif  pressure > 485 and pressure <= 725 
        flange_class = "600"
        pressure_rating = 725
        temperature_rating = 1000
        elsif  pressure > 725 and pressure <= 1090 
        flange_class = "900"
        pressure_rating = 1090
        temperature_rating = 1000
        elsif  pressure > 1090 and pressure <= 1820 
        flange_class = "1500"
        pressure_rating = 1820
        temperature_rating = 1000
        elsif  pressure > 1820 and pressure <= 3030 
        flange_class = "2500"
        pressure_rating = 3030
        temperature_rating = 1000
        
        end
    elsif temperature > 1000 and temperature <= 1050 
        if pressure > 350 
        flange_class = "300"
        pressure_rating = 350
        temperature_rating = 1050
        elsif  pressure > 350 and pressure <= 465 
        flange_class = "400"
        pressure_rating = 465
        temperature_rating = 1050
        elsif  pressure > 465 and pressure <= 700 
        flange_class = "600"
        pressure_rating = 700
        temperature_rating = 1050
        elsif  pressure > 700 and pressure <= 1050 
        flange_class = "900"
        pressure_rating = 1050
        temperature_rating = 1050
        elsif  pressure > 1050 and pressure <= 1750 
        flange_class = "1500"
        pressure_rating = 1750
        temperature_rating = 1050
        elsif  pressure > 1750 and pressure <= 2915 
        flange_class = "2500"
        pressure_rating = 2915
        temperature_rating = 1050
        
        end
    elsif temperature > 1050 and temperature <= 1100 
        if pressure > 325 
        flange_class = "300"
        pressure_rating = 325
        temperature_rating = 1100
        elsif  pressure > 325 and pressure <= 430 
        flange_class = "400"
        pressure_rating = 430
        temperature_rating = 1100
        elsif  pressure > 430 and pressure <= 645 
        flange_class = "600"
        pressure_rating = 645
        temperature_rating = 1100
        elsif  pressure > 645 and pressure <= 965 
        flange_class = "900"
        pressure_rating = 965
        temperature_rating = 1100
        elsif  pressure > 965 and pressure <= 1610 
        flange_class = "1500"
        pressure_rating = 1610
        temperature_rating = 1100
        elsif  pressure > 1610 and pressure <= 2685 
        flange_class = "2500"
        pressure_rating = 2685
        temperature_rating = 1100
        
        end
    elsif temperature > 1100 and temperature <= 1150 
        if pressure > 275 
        flange_class = "300"
        pressure_rating = 275
        temperature_rating = 1150
        elsif  pressure > 275 and pressure <= 365 
        flange_class = "400"
        pressure_rating = 365
        temperature_rating = 1150
        elsif  pressure > 365 and pressure <= 550 
        flange_class = "600"
        pressure_rating = 550
        temperature_rating = 1150
        elsif  pressure > 550 and pressure <= 825 
        flange_class = "900"
        pressure_rating = 825
        temperature_rating = 1150
        elsif  pressure > 825 and pressure <= 1370 
        flange_class = "1500"
        pressure_rating = 1370
        temperature_rating = 1150
        elsif  pressure > 1370 and pressure <= 2285 
        flange_class = "2500"
        pressure_rating = 2285
        temperature_rating = 1150
        
        end
    elsif temperature > 1150 and temperature <= 1200 
        if pressure > 205 
        flange_class = "300"
        pressure_rating = 205
        temperature_rating = 1200
        elsif  pressure > 205 and pressure <= 275 
        flange_class = "400"
        pressure_rating = 275
        temperature_rating = 1200
        elsif  pressure > 275 and pressure <= 410 
        flange_class = "600"
        pressure_rating = 410
        temperature_rating = 1200
        elsif  pressure > 410 and pressure <= 620 
        flange_class = "900"
        pressure_rating = 620
        temperature_rating = 1200
        elsif  pressure > 620 and pressure <= 1030 
        flange_class = "1500"
        pressure_rating = 1030
        temperature_rating = 1200
        elsif  pressure > 1030 and pressure <= 1715 
        flange_class = "2500"
        pressure_rating = 1715
        temperature_rating = 1200
        
        end
    elsif temperature > 1200 and temperature <= 1250 
        if pressure > 180 
        flange_class = "300"
        pressure_rating = 180
        temperature_rating = 1250
        elsif  pressure > 180 and pressure <= 245 
        flange_class = "400"
        pressure_rating = 245
        temperature_rating = 1250
        elsif  pressure > 245 and pressure <= 365 
        flange_class = "600"
        pressure_rating = 365
        temperature_rating = 1250
        elsif  pressure > 365 and pressure <= 545 
        flange_class = "900"
        pressure_rating = 545
        temperature_rating = 1250
        elsif  pressure > 545 and pressure <= 910 
        flange_class = "1500"
        pressure_rating = 910
        temperature_rating = 1250
        elsif  pressure > 910 and pressure <= 1515 
        flange_class = "2500"
        pressure_rating = 1515
        temperature_rating = 1250
        
        end
    elsif temperature > 1250 and temperature <= 1300 
        if pressure > 140 
        flange_class = "300"
        pressure_rating = 140
        temperature_rating = 1300
        elsif  pressure > 140 and pressure <= 185 
        flange_class = "400"
        pressure_rating = 185
        temperature_rating = 1300
        elsif  pressure > 185 and pressure <= 275 
        flange_class = "600"
        pressure_rating = 275
        temperature_rating = 1300
        elsif  pressure > 275 and pressure <= 410 
        flange_class = "900"
        pressure_rating = 410
        temperature_rating = 1300
        elsif  pressure > 410 and pressure <= 685 
        flange_class = "1500"
        pressure_rating = 685
        temperature_rating = 1300
        elsif  pressure > 685 and pressure <= 1145 
        flange_class = "2500"
        pressure_rating = 1145
        temperature_rating = 1300
        
        end
    elsif temperature > 1300 and temperature <= 1350 
        if pressure > 105 
        flange_class = "300"
        pressure_rating = 105
        temperature_rating = 1350
        elsif  pressure > 105 and pressure <= 140 
        flange_class = "400"
        pressure_rating = 140
        temperature_rating = 1350
        elsif  pressure > 140 and pressure <= 205 
        flange_class = "600"
        pressure_rating = 205
        temperature_rating = 1350
        elsif  pressure > 205 and pressure <= 310 
        flange_class = "900"
        pressure_rating = 310
        temperature_rating = 1350
        elsif  pressure > 310 and pressure <= 515 
        flange_class = "1500"
        pressure_rating = 515
        temperature_rating = 1350
        elsif  pressure > 515 and pressure <= 860 
        flange_class = "2500"
        pressure_rating = 860
        temperature_rating = 1350
        
        end
    elsif temperature > 1350 and temperature <= 1400 
        if pressure > 75 
        flange_class = "300"
        pressure_rating = 75
        temperature_rating = 1400
        elsif  pressure > 75 and pressure <= 100 
        flange_class = "400"
        pressure_rating = 100
        temperature_rating = 1400
        elsif  pressure > 100 and pressure <= 150 
        flange_class = "600"
        pressure_rating = 150
        temperature_rating = 1400
        elsif  pressure > 150 and pressure <= 225 
        flange_class = "900"
        pressure_rating = 225
        temperature_rating = 1400
        elsif  pressure > 225 and pressure <= 380 
        flange_class = "1500"
        pressure_rating = 380
        temperature_rating = 1150
        elsif  pressure > 380 and pressure <= 630 
        flange_class = "2500"
        pressure_rating = 630
        temperature_rating = 1400
        
        end
    elsif temperature > 1400 and temperature <= 1450 
        if pressure > 60 
        flange_class = "300"
        pressure_rating = 60
        temperature_rating = 1450
        elsif  pressure > 60 and pressure <= 80 
        flange_class = "400"
        pressure_rating = 80
        temperature_rating = 1450
        elsif  pressure > 80 and pressure <= 115 
        flange_class = "600"
        pressure_rating = 115
        temperature_rating = 1450
        elsif  pressure > 115 and pressure <= 175 
        flange_class = "900"
        pressure_rating = 175
        temperature_rating = 1450
        elsif  pressure > 175 and pressure <= 290 
        flange_class = "1500"
        pressure_rating = 290
        temperature_rating = 1450
        elsif  pressure > 290 and pressure <= 485 
        flange_class = "2500"
        pressure_rating = 485
        temperature_rating = 1450
        
        end
    elsif temperature > 1450 and temperature <= 1500 
        if pressure > 40 
        flange_class = "300"
        pressure_rating = 40
        temperature_rating = 1500
        elsif  pressure > 40 and pressure <= 55 
        flange_class = "400"
        pressure_rating = 55
        temperature_rating = 1500
        elsif  pressure > 55 and pressure <= 85 
        flange_class = "600"
        pressure_rating = 85
        temperature_rating = 1500
        elsif  pressure > 85 and pressure <= 125 
        flange_class = "900"
        pressure_rating = 125
        temperature_rating = 1500
        elsif  pressure > 125 and pressure <= 205 
        flange_class = "1500"
        pressure_rating = 205
        temperature_rating = 1500
        elsif  pressure > 205 and pressure <= 345 
        flange_class = "2500"
        pressure_rating = 345
        temperature_rating = 1500
        
        end
    
    end
    
    if Worksheets("UOM").chkCustomary.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) Use solution annealed material only."
    elsif orksheets("UOM").chkSI.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) Use solution annealed material only."
    
    end
    
elsif material_group = "3.16" 
UserFormLineSegmentDesign.cmbMaterialDesignation.RowSource = "MaterialGroup3.16"
    if temperature >= -20 and temperature <= 100 
        if pressure <= 275 
        flange_class = "150"
        pressure_rating = 275
        temperature_rating = 100
        elsif  pressure > 275 and pressure <= 720 
        flange_class = "300"
        pressure_rating = 720
        temperature_rating = 100
        elsif  pressure > 720 and pressure <= 960 
        flange_class = "400"
        pressure_rating = 960
        temperature_rating = 100
        elsif  pressure > 960 and pressure <= 1440 
        flange_class = "600"
        pressure_rating = 1440
        temperature_rating = 100
        elsif  pressure > 1440 and pressure <= 2160 
        flange_class = "900"
        pressure_rating = 2160
        temperature_rating = 100
        elsif  pressure > 2160 and pressure <= 3600 
        flange_class = "1500"
        pressure_rating = 3600
        temperature_rating = 100
        elsif  pressure > 3600 and pressure <= 6000 
        flange_class = "2500"
        pressure_rating = 6000
        temperature_rating = 100
        
        end
    elsif temperature > 100 and temperature <= 200 
        if pressure <= 245 
        flange_class = "150"
        pressure_rating = 245
        temperature_rating = 200
        elsif  pressure > 245 and pressure <= 635 
        flange_class = "300"
        pressure_rating = 635
        temperature_rating = 200
        elsif  pressure > 635 and pressure <= 850 
        flange_class = "400"
        pressure_rating = 850
        temperature_rating = 200
        elsif  pressure > 850 and pressure <= 1270 
        flange_class = "600"
        pressure_rating = 1270
        temperature_rating = 200
        elsif  pressure > 1270 and pressure <= 1910 
        flange_class = "900"
        pressure_rating = 1910
        temperature_rating = 200
        elsif  pressure > 1910 and pressure <= 3180 
        flange_class = "1500"
        pressure_rating = 3180
        temperature_rating = 200
        elsif  pressure > 3180 and pressure <= 5300 
        flange_class = "2500"
        pressure_rating = 5300
        temperature_rating = 200
        
        end
    elsif temperature > 200 and temperature <= 300 
        if pressure <= 225 
        flange_class = "150"
        pressure_rating = 225
        temperature_rating = 300
        elsif  pressure > 225 and pressure <= 595 
        flange_class = "300"
        pressure_rating = 595
        temperature_rating = 300
        elsif  pressure > 595 and pressure <= 790 
        flange_class = "400"
        pressure_rating = 790
        temperature_rating = 300
        elsif  pressure > 790 and pressure <= 1185 
        flange_class = "600"
        pressure_rating = 1185
        temperature_rating = 300
        elsif  pressure > 1185 and pressure <= 1780 
        flange_class = "900"
        pressure_rating = 1780
        temperature_rating = 300
        elsif  pressure > 1780 and pressure <= 2965 
        flange_class = "1500"
        pressure_rating = 2965
        temperature_rating = 300
        elsif  pressure > 2965 and pressure <= 4940 
        flange_class = "2500"
        pressure_rating = 4940
        temperature_rating = 300
        
        end
    elsif temperature > 300 and temperature <= 400 
        if pressure <= 200 
        flange_class = "150"
        pressure_rating = 200
        temperature_rating = 400
        elsif  pressure > 200 and pressure <= 555 
        flange_class = "300"
        pressure_rating = 555
        temperature_rating = 400
        elsif  pressure > 555 and pressure <= 740 
        flange_class = "400"
        pressure_rating = 740
        temperature_rating = 400
        elsif  pressure > 740 and pressure <= 1115 
        flange_class = "600"
        pressure_rating = 1115
        temperature_rating = 400
        elsif  pressure > 1115 and pressure <= 1670 
        flange_class = "900"
        pressure_rating = 1670
        temperature_rating = 400
        elsif  pressure > 1670 and pressure <= 2785 
        flange_class = "1500"
        pressure_rating = 2785
        temperature_rating = 400
        elsif  pressure > 2785 and pressure <= 4640 
        flange_class = "2500"
        pressure_rating = 4640
        temperature_rating = 400
        
        end
    elsif temperature > 400 and temperature <= 500 
        if pressure <= 170 
        flange_class = "150"
        pressure_rating = 170
        temperature_rating = 500
        elsif  pressure > 170 and pressure <= 530 
        flange_class = "300"
        pressure_rating = 530
        temperature_rating = 500
        elsif  pressure > 530 and pressure <= 705 
        flange_class = "400"
        pressure_rating = 705
        temperature_rating = 500
        elsif  pressure > 705 and pressure <= 1055 
        flange_class = "600"
        pressure_rating = 1055
        temperature_rating = 500
        elsif  pressure > 1055 and pressure <= 1585 
        flange_class = "900"
        pressure_rating = 1585
        temperature_rating = 500
        elsif  pressure > 1585 and pressure <= 2640 
        flange_class = "1500"
        pressure_rating = 2640
        temperature_rating = 500
        elsif  pressure > 2640 and pressure <= 4400 
        flange_class = "2500"
        pressure_rating = 4400
        temperature_rating = 500
        
        end
    elsif temperature > 500 and temperature <= 600 
        if pressure <= 140 
        flange_class = "150"
        pressure_rating = 140
        temperature_rating = 600
        elsif  pressure > 140 and pressure <= 505 
        flange_class = "300"
        pressure_rating = 505
        temperature_rating = 600
        elsif  pressure > 505 and pressure <= 670 
        flange_class = "400"
        pressure_rating = 670
        temperature_rating = 600
        elsif  pressure > 670 and pressure <= 1010 
        flange_class = "600"
        pressure_rating = 1010
        temperature_rating = 600
        elsif  pressure > 1010 and pressure <= 1510 
        flange_class = "900"
        pressure_rating = 1510
        temperature_rating = 600
        elsif  pressure > 1510 and pressure <= 2520 
        flange_class = "1500"
        pressure_rating = 2520
        temperature_rating = 600
        elsif  pressure > 2520 and pressure <= 4200 
        flange_class = "2500"
        pressure_rating = 4200
        temperature_rating = 600
        
        end
    elsif temperature > 600 and temperature <= 650 
        if pressure <= 125 
        flange_class = "150"
        pressure_rating = 125
        temperature_rating = 650
        elsif  pressure > 125 and pressure <= 495 
        flange_class = "300"
        pressure_rating = 495
        temperature_rating = 650
        elsif  pressure > 495 and pressure <= 660 
        flange_class = "400"
        pressure_rating = 660
        temperature_rating = 650
        elsif  pressure > 660 and pressure <= 990 
        flange_class = "600"
        pressure_rating = 990
        temperature_rating = 650
        elsif  pressure > 990 and pressure <= 1485 
        flange_class = "900"
        pressure_rating = 1485
        temperature_rating = 650
        elsif  pressure > 1485 and pressure <= 2470 
        flange_class = "1500"
        pressure_rating = 2470
        temperature_rating = 650
        elsif  pressure > 2470 and pressure <= 4120 
        flange_class = "2500"
        pressure_rating = 4120
        temperature_rating = 650
        
        end
    elsif temperature > 650 and temperature <= 700 
        if pressure <= 110 
        flange_class = "150"
        pressure_rating = 110
        temperature_rating = 700
        elsif  pressure > 110 and pressure <= 480 
        flange_class = "300"
        pressure_rating = 480
        temperature_rating = 700
        elsif  pressure > 480 and pressure <= 645 
        flange_class = "400"
        pressure_rating = 645
        temperature_rating = 700
        elsif  pressure > 645 and pressure <= 965 
        flange_class = "600"
        pressure_rating = 965
        temperature_rating = 700
        elsif  pressure > 965 and pressure <= 1445 
        flange_class = "900"
        pressure_rating = 1445
        temperature_rating = 700
        elsif  pressure > 1445 and pressure <= 2410 
        flange_class = "1500"
        pressure_rating = 2410
        temperature_rating = 700
        elsif  pressure > 2410 and pressure <= 4020 
        flange_class = "2500"
        pressure_rating = 4020
        temperature_rating = 700
        
        end
    elsif temperature > 700 and temperature <= 750 
        if pressure <= 95 
        flange_class = "150"
        pressure_rating = 95
        temperature_rating = 750
        elsif  pressure > 95 and pressure <= 475 
        flange_class = "300"
        pressure_rating = 475
        temperature_rating = 750
        elsif  pressure > 475 and pressure <= 630 
        flange_class = "400"
        pressure_rating = 630
        temperature_rating = 750
        elsif  pressure > 630 and pressure <= 945 
        flange_class = "600"
        pressure_rating = 945
        temperature_rating = 750
        elsif  pressure > 945 and pressure <= 1420 
        flange_class = "900"
        pressure_rating = 1420
        temperature_rating = 750
        elsif  pressure > 1420 and pressure <= 2365 
        flange_class = "1500"
        pressure_rating = 2365
        temperature_rating = 750
        elsif  pressure > 2365 and pressure <= 3940 
        flange_class = "2500"
        pressure_rating = 3940
        temperature_rating = 750
        
        end
    elsif temperature > 750 and temperature <= 800 
        if pressure <= 80 
        flange_class = "150"
        pressure_rating = 80
        temperature_rating = 800
        elsif  pressure > 80 and pressure <= 465 
        flange_class = "300"
        pressure_rating = 465
        temperature_rating = 800
        elsif  pressure > 465 and pressure <= 620 
        flange_class = "400"
        pressure_rating = 620
        temperature_rating = 800
        elsif  pressure > 620 and pressure <= 925 
        flange_class = "600"
        pressure_rating = 925
        temperature_rating = 800
        elsif  pressure > 925 and pressure <= 1390 
        flange_class = "900"
        pressure_rating = 1390
        temperature_rating = 800
        elsif  pressure > 1390 and pressure <= 2315 
        flange_class = "1500"
        pressure_rating = 2315
        temperature_rating = 800
        elsif  pressure > 2315 and pressure <= 3860 
        flange_class = "2500"
        pressure_rating = 3860
        temperature_rating = 800
        
        end
    elsif temperature > 800 and temperature <= 850 
        if pressure <= 65 
        flange_class = "150"
        pressure_rating = 65
        temperature_rating = 850
        elsif  pressure > 65 and pressure <= 455 
        flange_class = "300"
        pressure_rating = 455
        temperature_rating = 850
        elsif  pressure > 455 and pressure <= 605 
        flange_class = "400"
        pressure_rating = 605
        temperature_rating = 850
        elsif  pressure > 605 and pressure <= 905 
        flange_class = "600"
        pressure_rating = 905
        temperature_rating = 850
        elsif  pressure > 905 and pressure <= 1360 
        flange_class = "900"
        pressure_rating = 1360
        temperature_rating = 850
        elsif  pressure > 1360 and pressure <= 2270 
        flange_class = "1500"
        pressure_rating = 2270
        temperature_rating = 850
        elsif  pressure > 2270 and pressure <= 3780 
        flange_class = "2500"
        pressure_rating = 3780
        temperature_rating = 850
        
        end
    elsif temperature > 850 and temperature <= 900 
        if pressure <= 50 
        flange_class = "150"
        pressure_rating = 50
        temperature_rating = 900
        elsif  pressure > 50 and pressure <= 445 
        flange_class = "300"
        pressure_rating = 445
        temperature_rating = 900
        elsif  pressure > 445 and pressure <= 590 
        flange_class = "400"
        pressure_rating = 590
        temperature_rating = 900
        elsif  pressure > 590 and pressure <= 890 
        flange_class = "600"
        pressure_rating = 890
        temperature_rating = 900
        elsif  pressure > 890 and pressure <= 1330 
        flange_class = "900"
        pressure_rating = 1330
        temperature_rating = 900
        elsif  pressure > 1330 and pressure <= 2220 
        flange_class = "1500"
        pressure_rating = 2220
        temperature_rating = 900
        elsif  pressure > 2220 and pressure <= 3700 
        flange_class = "2500"
        pressure_rating = 3700
        temperature_rating = 900
        
        end
    elsif temperature > 900 and temperature <= 950 
        if pressure <= 35 
        flange_class = "150"
        pressure_rating = 35
        temperature_rating = 950
        elsif  pressure > 35 and pressure <= 385 
        flange_class = "300"
        pressure_rating = 385
        temperature_rating = 950
        elsif  pressure > 385 and pressure <= 515 
        flange_class = "400"
        pressure_rating = 515
        temperature_rating = 950
        elsif  pressure > 515 and pressure <= 775 
        flange_class = "600"
        pressure_rating = 775
        temperature_rating = 950
        elsif  pressure > 775 and pressure <= 1160 
        flange_class = "900"
        pressure_rating = 1160
        temperature_rating = 950
        elsif  pressure > 1160 and pressure <= 1930 
        flange_class = "1500"
        pressure_rating = 1930
        temperature_rating = 950
        elsif  pressure > 1930 and pressure <= 3220 
        flange_class = "2500"
        pressure_rating = 3220
        temperature_rating = 950
        
        end
    elsif temperature > 950 and temperature <= 1000 
        if pressure <= 20 
        flange_class = "150"
        pressure_rating = 20
        temperature_rating = 1000
        elsif  pressure > 20 and pressure <= 365 
        flange_class = "300"
        pressure_rating = 365
        temperature_rating = 1000
        elsif  pressure > 365 and pressure <= 485 
        flange_class = "400"
        pressure_rating = 485
        temperature_rating = 1000
        elsif  pressure > 485 and pressure <= 725 
        flange_class = "600"
        pressure_rating = 725
        temperature_rating = 1000
        elsif  pressure > 725 and pressure <= 1090 
        flange_class = "900"
        pressure_rating = 1090
        temperature_rating = 1000
        elsif  pressure > 1090 and pressure <= 1820 
        flange_class = "1500"
        pressure_rating = 1820
        temperature_rating = 1000
        elsif  pressure > 1820 and pressure <= 3030 
        flange_class = "2500"
        pressure_rating = 3030
        temperature_rating = 1000
        
        end
    elsif temperature > 1000 and temperature <= 1050 
        if pressure > 345 
        flange_class = "300"
        pressure_rating = 345
        temperature_rating = 1050
        elsif  pressure > 345 and pressure <= 455 
        flange_class = "400"
        pressure_rating = 455
        temperature_rating = 1050
        elsif  pressure > 455 and pressure <= 685 
        flange_class = "600"
        pressure_rating = 685
        temperature_rating = 1050
        elsif  pressure > 685 and pressure <= 1030 
        flange_class = "900"
        pressure_rating = 1030
        temperature_rating = 1050
        elsif  pressure > 1030 and pressure <= 1715 
        flange_class = "1500"
        pressure_rating = 1715
        temperature_rating = 1050
        elsif  pressure > 1715 and pressure <= 2855 
        flange_class = "2500"
        pressure_rating = 2855
        temperature_rating = 1050
        
        end
    elsif temperature > 1050 and temperature <= 1100 
        if pressure > 265 
        flange_class = "300"
        pressure_rating = 265
        temperature_rating = 1100
        elsif  pressure > 265 and pressure <= 355 
        flange_class = "400"
        pressure_rating = 355
        temperature_rating = 1100
        elsif  pressure > 355 and pressure <= 535 
        flange_class = "600"
        pressure_rating = 535
        temperature_rating = 1100
        elsif  pressure > 535 and pressure <= 800 
        flange_class = "900"
        pressure_rating = 800
        temperature_rating = 1100
        elsif  pressure > 800 and pressure <= 1335 
        flange_class = "1500"
        pressure_rating = 1335
        temperature_rating = 1100
        elsif  pressure > 1335 and pressure <= 2230 
        flange_class = "2500"
        pressure_rating = 2230
        temperature_rating = 1100
        
        end
    elsif temperature > 1100 and temperature <= 1150 
        if pressure > 205 
        flange_class = "300"
        pressure_rating = 205
        temperature_rating = 1150
        elsif  pressure > 205 and pressure <= 275 
        flange_class = "400"
        pressure_rating = 275
        temperature_rating = 1150
        elsif  pressure > 275 and pressure <= 410 
        flange_class = "600"
        pressure_rating = 410
        temperature_rating = 1150
        elsif  pressure > 410 and pressure <= 615 
        flange_class = "900"
        pressure_rating = 615
        temperature_rating = 1150
        elsif  pressure > 615 and pressure <= 1030 
        flange_class = "1500"
        pressure_rating = 1030
        temperature_rating = 1150
        elsif  pressure > 1030 and pressure <= 1715 
        flange_class = "2500"
        pressure_rating = 1715
        temperature_rating = 1150
        
        end
    elsif temperature > 1150 and temperature <= 1200 
        if pressure > 160 
        flange_class = "300"
        pressure_rating = 160
        temperature_rating = 1200
        elsif  pressure > 160 and pressure <= 215 
        flange_class = "400"
        pressure_rating = 215
        temperature_rating = 1200
        elsif  pressure > 215 and pressure <= 320 
        flange_class = "600"
        pressure_rating = 320
        temperature_rating = 1200
        elsif  pressure > 320 and pressure <= 485 
        flange_class = "900"
        pressure_rating = 485
        temperature_rating = 1200
        elsif  pressure > 485 and pressure <= 805 
        flange_class = "1500"
        pressure_rating = 805
        temperature_rating = 1200
        elsif  pressure > 805 and pressure <= 1345 
        flange_class = "2500"
        pressure_rating = 1345
        temperature_rating = 1200
        
        end
    elsif temperature > 1200 and temperature <= 1250 
        if pressure > 130 
        flange_class = "300"
        pressure_rating = 130
        temperature_rating = 1250
        elsif  pressure > 130 and pressure <= 175 
        flange_class = "400"
        pressure_rating = 175
        temperature_rating = 1250
        elsif  pressure > 175 and pressure <= 260 
        flange_class = "600"
        pressure_rating = 260
        temperature_rating = 1250
        elsif  pressure > 260 and pressure <= 390 
        flange_class = "900"
        pressure_rating = 390
        temperature_rating = 1250
        elsif  pressure > 390 and pressure <= 650 
        flange_class = "1500"
        pressure_rating = 650
        temperature_rating = 1250
        elsif  pressure > 650 and pressure <= 1085 
        flange_class = "2500"
        pressure_rating = 1085
        temperature_rating = 1250
        
        end
    elsif temperature > 1250 and temperature <= 1300 
        if pressure > 105 
        flange_class = "300"
        pressure_rating = 105
        temperature_rating = 1300
        elsif  pressure > 105 and pressure <= 140 
        flange_class = "400"
        pressure_rating = 140
        temperature_rating = 1300
        elsif  pressure > 140 and pressure <= 215 
        flange_class = "600"
        pressure_rating = 215
        temperature_rating = 1300
        elsif  pressure > 215 and pressure <= 320 
        flange_class = "900"
        pressure_rating = 320
        temperature_rating = 1300
        elsif  pressure > 320 and pressure <= 530 
        flange_class = "1500"
        pressure_rating = 530
        temperature_rating = 1300
        elsif  pressure > 530 and pressure <= 885 
        flange_class = "2500"
        pressure_rating = 885
        temperature_rating = 1300
        
        end
    elsif temperature > 1300 and temperature <= 1350 
        if pressure > 80 
        flange_class = "300"
        pressure_rating = 80
        temperature_rating = 1350
        elsif  pressure > 80 and pressure <= 110 
        flange_class = "400"
        pressure_rating = 110
        temperature_rating = 1350
        elsif  pressure > 110 and pressure <= 165 
        flange_class = "600"
        pressure_rating = 165
        temperature_rating = 1350
        elsif  pressure > 165 and pressure <= 245 
        flange_class = "900"
        pressure_rating = 245
        temperature_rating = 1350
        elsif  pressure > 245 and pressure <= 410 
        flange_class = "1500"
        pressure_rating = 410
        temperature_rating = 1350
        elsif  pressure > 410 and pressure <= 685 
        flange_class = "2500"
        pressure_rating = 685
        temperature_rating = 1350
        
        end
    elsif temperature > 1350 and temperature <= 1400 
        if pressure > 60 
        flange_class = "300"
        pressure_rating = 60
        temperature_rating = 1400
        elsif  pressure > 60 and pressure <= 80 
        flange_class = "400"
        pressure_rating = 80
        temperature_rating = 1400
        elsif  pressure > 80 and pressure <= 125 
        flange_class = "600"
        pressure_rating = 125
        temperature_rating = 1400
        elsif  pressure > 125 and pressure <= 185 
        flange_class = "900"
        pressure_rating = 185
        temperature_rating = 1400
        elsif  pressure > 185 and pressure <= 310 
        flange_class = "1500"
        pressure_rating = 310
        temperature_rating = 1150
        elsif  pressure > 310 and pressure <= 515 
        flange_class = "2500"
        pressure_rating = 515
        temperature_rating = 1400
        
        end
    elsif temperature > 1400 and temperature <= 1450 
        if pressure > 50 
        flange_class = "300"
        pressure_rating = 50
        temperature_rating = 1450
        elsif  pressure > 50 and pressure <= 70 
        flange_class = "400"
        pressure_rating = 70
        temperature_rating = 1450
        elsif  pressure > 70 and pressure <= 105 
        flange_class = "600"
        pressure_rating = 105
        temperature_rating = 1450
        elsif  pressure > 105 and pressure <= 155 
        flange_class = "900"
        pressure_rating = 155
        temperature_rating = 1450
        elsif  pressure > 155 and pressure <= 255 
        flange_class = "1500"
        pressure_rating = 255
        temperature_rating = 1450
        elsif  pressure > 255 and pressure <= 430 
        flange_class = "2500"
        pressure_rating = 430
        temperature_rating = 1450
        
        end
    elsif temperature > 1450 and temperature <= 1500 
        if pressure > 40 
        flange_class = "300"
        pressure_rating = 40
        temperature_rating = 1500
        elsif  pressure > 40 and pressure <= 50 
        flange_class = "400"
        pressure_rating = 50
        temperature_rating = 1500
        elsif  pressure > 50 and pressure <= 75 
        flange_class = "600"
        pressure_rating = 75
        temperature_rating = 1500
        elsif  pressure > 75 and pressure <= 115 
        flange_class = "900"
        pressure_rating = 115
        temperature_rating = 1500
        elsif  pressure > 115 and pressure <= 190 
        flange_class = "1500"
        pressure_rating = 190
        temperature_rating = 1500
        elsif  pressure > 190 and pressure <= 315 
        flange_class = "2500"
        pressure_rating = 315
        temperature_rating = 1500
        
        end
    
    end
    
    if Worksheets("UOM").chkCustomary.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) Use solution annealed material only." & Chr(13) _
    & "(2) The chemical composition, mechanical properties, heat treating requirements, and grain size requirements shall conform to the applicable ASTM specification. The manufacturing procedures, tolerances, tests, certification, and markings shall be in accordance with ASTM B 564."
    elsif orksheets("UOM").chkSI.Value = True 
    UserFormLineSegmentDesign.lblNotes = "(1) Use solution annealed material only." & Chr(13) _
    & "(2) The chemical composition, mechanical properties, heat treating requirements, and grain size requirements shall conform to the applicable ASTM specification. The manufacturing procedures, tolerances, tests, certification, and markings shall be in accordance with ASTM B 564."
    
    end
    
elsif material_group = "3.17" 
UserFormLineSegmentDesign.cmbMaterialDesignation.RowSource = "MaterialGroup3.17"
    if temperature >= -20 and temperature <= 100 
        if pressure <= 230 
        flange_class = "150"
        pressure_rating = 230
        temperature_rating = 100
        elsif  pressure > 230 and pressure <= 600 
        flange_class = "300"
        pressure_rating = 600
        temperature_rating = 100
        elsif  pressure > 600 and pressure <= 800 
        flange_class = "400"
        pressure_rating = 800
        temperature_rating = 100
        elsif  pressure > 800 and pressure <= 1200 
        flange_class = "600"
        pressure_rating = 1200
        temperature_rating = 100
        elsif  pressure > 1200 and pressure <= 1800 
        flange_class = "900"
        pressure_rating = 1800
        temperature_rating = 100
        elsif  pressure > 1800 and pressure <= 3000 
        flange_class = "1500"
        pressure_rating = 3000
        temperature_rating = 100
        elsif  pressure > 3000 and pressure <= 5000 
        flange_class = "2500"
        pressure_rating = 5000
        temperature_rating = 100
        
        end
    elsif temperature > 100 and temperature <= 200 
        if pressure <= 200 
        flange_class = "150"
        pressure_rating = 200
        temperature_rating = 200
        elsif  pressure > 200 and pressure <= 520 
        flange_class = "300"
        pressure_rating = 520
        temperature_rating = 200
        elsif  pressure > 520 and pressure <= 690 
        flange_class = "400"
        pressure_rating = 690
        temperature_rating = 200
        elsif  pressure > 690 and pressure <= 1035 
        flange_class = "600"
        pressure_rating = 1035
        temperature_rating = 200
        elsif  pressure > 1035 and pressure <= 1555 
        flange_class = "900"
        pressure_rating = 1555
        temperature_rating = 200
        elsif  pressure > 1555 and pressure <= 2590 
        flange_class = "1500"
        pressure_rating = 2590
        temperature_rating = 200
        elsif  pressure > 2590 and pressure <= 4320 
        flange_class = "2500"
        pressure_rating = 4320
        temperature_rating = 200
        
        end
    elsif temperature > 200 and temperature <= 300 
        if pressure <= 180 
        flange_class = "150"
        pressure_rating = 180
        temperature_rating = 300
        elsif  pressure > 180 and pressure <= 465 
        flange_class = "300"
        pressure_rating = 465
        temperature_rating = 300
        elsif  pressure > 465 and pressure <= 620 
        flange_class = "400"
        pressure_rating = 620
        temperature_rating = 300
        elsif  pressure > 620 and pressure <= 930 
        flange_class = "600"
        pressure_rating = 930
        temperature_rating = 300
        elsif  pressure > 930 and pressure <= 1395 
        flange_class = "900"
        pressure_rating = 1395
        temperature_rating = 300
        elsif  pressure > 1395 and pressure <= 2330 
        flange_class = "1500"
        pressure_rating = 2330
        temperature_rating = 300
        elsif  pressure > 2330 and pressure <= 3880 
        flange_class = "2500"
        pressure_rating = 3880
        temperature_rating = 300
        
        end
    elsif temperature > 300 and temperature <= 400 
        if pressure <= 160 
        flange_class = "150"
        pressure_rating = 160
        temperature_rating = 400
        elsif  pressure > 160 and pressure <= 420 
        flange_class = "300"
        pressure_rating = 420
        temperature_rating = 400
        elsif  pressure > 420 and pressure <= 565 
        flange_class = "400"
        pressure_rating = 565
        temperature_rating = 400
        elsif  pressure > 565 and pressure <= 845 
        flange_class = "600"
        pressure_rating = 845
        temperature_rating = 400
        elsif  pressure > 845 and pressure <= 1265 
        flange_class = "900"
        pressure_rating = 1265
        temperature_rating = 400
        elsif  pressure > 1265 and pressure <= 2110 
        flange_class = "1500"
        pressure_rating = 2110
        temperature_rating = 400
        elsif  pressure > 2110 and pressure <= 3520 
        flange_class = "2500"
        pressure_rating = 3520
        temperature_rating = 400
        
        end
    elsif temperature > 400 and temperature <= 500 
        if pressure <= 150 
        flange_class = "150"
        pressure_rating = 150
        temperature_rating = 500
        elsif  pressure > 150 and pressure <= 390 
        flange_class = "300"
        pressure_rating = 390
        temperature_rating = 500
        elsif  pressure > 390 and pressure <= 520 
        flange_class = "400"
        pressure_rating = 520
        temperature_rating = 500
        elsif  pressure > 520 and pressure <= 780 
        flange_class = "600"
        pressure_rating = 780
        temperature_rating = 500
        elsif  pressure > 780 and pressure <= 1165 
        flange_class = "900"
        pressure_rating = 1165
        temperature_rating = 500
        elsif  pressure > 1165 and pressure <= 1945 
        flange_class = "1500"
        pressure_rating = 1945
        temperature_rating = 500
        elsif  pressure > 1945 and pressure <= 3240 
        flange_class = "2500"
        pressure_rating = 3240
        temperature_rating = 500
        
        end
    elsif temperature > 500 and temperature <= 600 
        if pressure <= 140 
        flange_class = "150"
        pressure_rating = 140
        temperature_rating = 600
        elsif  pressure > 140 and pressure <= 360 
        flange_class = "300"
        pressure_rating = 360
        temperature_rating = 600
        elsif  pressure > 360 and pressure <= 480 
        flange_class = "400"
        pressure_rating = 480
        temperature_rating = 600
        elsif  pressure > 480 and pressure <= 720 
        flange_class = "600"
        pressure_rating = 720
        temperature_rating = 600
        elsif  pressure > 720 and pressure <= 1080 
        flange_class = "900"
        pressure_rating = 1080
        temperature_rating = 600
        elsif  pressure > 1080 and pressure <= 1800 
        flange_class = "1500"
        pressure_rating = 1800
        temperature_rating = 600
        elsif  pressure > 1800 and pressure <= 3000 
        flange_class = "2500"
        pressure_rating = 3000
        temperature_rating = 600
        
        end
    
    end
    
    #If Worksheets("UOM").chkCustomary.Value = True 
    #UserFormLineSegmentDesign.lblNotes = "(1) Use solution annealed material only."
    #elsif orksheets("UOM").chkSI.Value = True 
    #UserFormLineSegmentDesign.lblNotes = "(1) Use solution annealed material only."
    #
    #end
=end
end
